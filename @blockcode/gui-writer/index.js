import{addLocalesMessages as T}from"@blockcode/core";var c={"writer.name":"Markdown Writer","writer.menus.file.exportMarkdown":"Export to Markdown...","writer.menus.file.exportHTML":"Export to HTML...","writer.menus.edit.openOutline":"Turn on Outline","writer.menus.edit.closeOutline":"Turn off Outline","writer.menus.edit.openAdvanced":"Turn on Advanced Mode","writer.menus.edit.closeAdvanced":"Turn off Advanced Mode","writer.menus.edit.openProfessional":"Turn on Professiona Mode","writer.menus.edit.closeProfessional":"Turn off Professiona Mode"};var w={"writer.name":"Markdown 编辑器","writer.menus.file.exportMarkdown":"导出 Markdown 文档…","writer.menus.file.exportHTML":"导出 HTML 页面…","writer.menus.edit.openOutline":"打开大纲","writer.menus.edit.closeOutline":"关闭大纲","writer.menus.edit.openAdvanced":"打开高级模式","writer.menus.edit.closeAdvanced":"关闭高级模式","writer.menus.edit.openProfessional":"打开专业模式","writer.menus.edit.closeProfessional":"关闭专业模式"};var f={"writer.name":"Markdown 編輯器","writer.menus.file.exportMarkdown":"匯出 Markdown 文檔…","writer.menus.file.exportHTML":"匯出 HTML 頁面…","writer.menus.edit.openOutline":"打開大綱","writer.menus.edit.closeOutline":"關閉大綱","writer.menus.edit.openAdvanced":"打開高級模式","writer.menus.edit.closeAdvanced":"關閉高級模式","writer.menus.edit.openProfessional":"打開專家模式","writer.menus.edit.closeProfessional":"關閉專家模式"};T({en:c,"zh-Hans":w,"zh-Hant":f});import{html2canvas as C}from"@blockcode/utils";import{MarkdownEditor as L,markdownTab as S}from"@blockcode/write";import{useCallback as k}from"preact/hooks";import{exportFile as A}from"@blockcode/utils";import{setAlert as u,Text as g,MenuSection as O,MenuItem as P}from"@blockcode/core";import{jsx as a}from"preact/jsx-runtime";function m({itemClassName:e}){let n=k(async()=>{if(window.currentVditor){let o=u("exporting"),t=await A(window.currentVditor.getValue());if(t.success)u("exportCompleted",{id:o},1000);else if(t.error==="AbortError")u("exportAbortError",{id:o},1000);else u("exportError",{id:o},1000)}},[]);return a(O,{children:a(P,{className:e,onClick:n,label:a(g,{id:"writer.menus.file.exportMarkdown",defaultMessage:"Export to Markdown..."})})})}import{useEffect as H,useCallback as M}from"preact/hooks";import{useAppContext as x,setAppState as s,Text as d,MenuSection as E,MenuItem as l}from"@blockcode/core";import{jsx as r,jsxs as h}from"preact/jsx-runtime";function p({itemClassName:e}){let{appState:n}=x();H(()=>{if(n.value?.outline==null)s({outline:!1,advancedMode:"wysiwyg"})},[]);let o=M(()=>{let i=!n.value.outline;s({outline:i})},[]),t=M((i)=>()=>{if(i===n.value.advancedMode)i="wysiwyg";document.querySelector(`[data-mode="${i}"]`).dispatchEvent(new CustomEvent("click")),s({advancedMode:i})},[]);return h(E,{children:[r(l,{className:e,onClick:o,children:n.value?.outline!==!0?r(d,{id:"writer.menus.edit.openOutline",defaultMessage:"Turn on Outline"}):r(d,{id:"writer.menus.edit.closeOutline",defaultMessage:"Turn off Outline"})}),r(l,{className:e,onClick:t("ir"),children:n.value?.advancedMode!=="ir"?r(d,{id:"writer.menus.edit.openAdvanced",defaultMessage:"Turn on Advanced Mode"}):r(d,{id:"writer.menus.edit.closeAdvanced",defaultMessage:"Turn off Advanced Mode"})}),r(l,{className:e,onClick:t("sv"),children:n.value?.advancedMode!=="sv"?r(d,{id:"writer.menus.edit.openProfessional",defaultMessage:"Turn on Professional Mode"}):r(d,{id:"writer.menus.edit.closeProfessional",defaultMessage:"Turn off Professional Mode"})})]})}var v={files:[{id:"markdown",content:`# Hello!
`}]};var ee={onNew(){return v},onSave(e,n){let o=window.currentVditor;return e=e.map((t)=>{return{id:t.id,content:o.getValue()}}),{files:e,assets:n}},async onThumb(){let e=window.currentVditor.getCurrentMode(),n=window.currentVditor.vditor[e].element;return(await C(n))?.toDataURL()},onUndo(e){if(e instanceof MouseEvent){let{vditor:n}=window.currentVditor;n.undo.undo(n)}},onRedo(e){if(e instanceof MouseEvent){let{vditor:n}=window.currentVditor;n.undo.redo(n)}},onEnableUndo(){let e=document.querySelector('[data-type="undo"].vditor-menu--disabled');return window.currentVditor&&!e},onEnableRedo(){let e=document.querySelector('[data-type="redo"].vditor-menu--disabled');return window.currentVditor&&!e},menuItems:[{id:"file",Menu:m},{id:"edit",Menu:p,disabledCoding:!0,disabledBlockStyle:!0},{id:"view",disabled:!0}],tabs:[{...S,Content:L}]};export{ee as default};
