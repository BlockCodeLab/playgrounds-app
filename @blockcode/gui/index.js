import{addLocalesMessages as B1}from"@blockcode/core";var Ri={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"Importing...","gui.alert.downloading":"Downloading...{progress}%","gui.alert.downloadCompleted":"Download completed.","gui.alert.connecting":"Connecting...","gui.alert.connected":"Connected.","gui.alert.connectionCancel":"Connection cancel.","gui.alert.connectionError":"Connection error or connection was lost.","gui.alert.erasing":"Erasing...","gui.alert.restoring":"Firmware restoring...{progress}%","gui.alert.recovering":"Recovering...","gui.alert.restoreCompleted":"Firmware resotre completed! Now press RESET key","gui.alert.reseting":"Reseting...","gui.alert.compiling":"Compiling...","gui.alert.compileCompleted":"Compilation completed.","gui.alert.compileError":"Compilation failed.","gui.alert.compileViewError":"View Message.","gui.alert.saving":"Saving project...","gui.alert.saved":"Saved.","gui.alert.savedComputer":"Saved to your computer.","gui.alert.saveAbortError":"Abort saving.","gui.alert.saveError":"Failed save.","gui.logs.changeDevice":"Device changed to {device}","gui.logs.connected":"Device connected","gui.logs.connectedType":"Device connected with {type}","gui.logs.disconnected":"Device disconnected","gui.logs.compiling":"Compiling...","gui.logs.compiled":"Compile completed","gui.logs.downloading":"Downloading...","gui.logs.downloaded":"Download completed","gui.logs.downloadError":"Download failed","gui.home.my":"My projects","gui.home.all":"View all","gui.home.allCounts":"View all ({counts})","gui.home.new":"Create new project","gui.home.examples":"Wonderful {label} projects","gui.home.slideshow.desktop.title":"The desktop application is here!","gui.home.slideshow.desktop.button":"Download","gui.home.slideshow.tankwar.title":"The Tank War is coming! Join us!","gui.home.slideshow.tankwar.button":"Join us","gui.home.slideshow.arcade.title":"The next game, create your own!","gui.home.slideshow.arcade.button":"Create now","gui.splash.loading":"Loading project...","gui.splash.errorTitle":"Error occurred","gui.splash.errorLabel":"Please refresh the page and reopen it.","gui.menubar.courses":"Courses","gui.menubar.tutorials":"Tutorials","gui.menubar.titlePlaceholder":"Project title here","gui.menubar.file":"File","gui.menubar.file.newProject":"New","gui.menubar.file.openProject":"Open...","gui.menubar.file.saveProject":"Save","gui.menubar.file.uploadProject":"Load from your computer...","gui.menubar.file.downloadProject":"save to your computer...","gui.menubar.edit":"Edit","gui.menubar.edit.undo":"Undo","gui.menubar.edit.redo":"Redo","gui.menubar.edit.openManualCoding":"Turn on Coding Mode","gui.menubar.edit.closeManualCoding":"Turn off Coding Mode","gui.menubar.edit.openCompactBlock":"Turn on Compact Block","gui.menubar.edit.closeCompactBlock":"Turn off Compact Block","gui.menubar.view":"View","gui.menubar.view.log":"Log Panel","gui.menubar.view.serial":"Serial Panel","gui.menubar.view.files":"Files Panel","gui.menubar.view.openAutoDisplayPanel":"Turn on auto display Log Panel","gui.menubar.view.closeAutoDisplayPanel":"Turn off auto display Log Panel","gui.menubar.device":"Device","gui.menubar.device.sync":"Sync program","gui.menubar.device.download":"Download program","gui.menubar.device.reset":"Reset device","gui.menubar.device.connect":"Connect device...","gui.menubar.device.connectUsb":"Connect device with USB...","gui.menubar.device.connectBle":"Connect device with Bluetooth (BLE)...","gui.menubar.device.disconnect":"Disconnect device","gui.menubar.device.firmware":"Restore firmware...","gui.menubar.device.firmwareVersion":"Restore v{version} firmware...","gui.menubar.device.caching":"Caching latest firmware...","gui.panelBox.logs":"Logs","gui.panelBox.serial":"Serial","gui.panelBox.files":"Files","gui.project.name":"Untitled Project","gui.project.shortname":"Untitled","gui.library.search":"Search","gui.library.projects.empty":"No project!","gui.library.projects.rename":"rename","gui.library.projects.duplicate":"duplicate","gui.library.projects.delete":"delete","gui.library.projects.notSaved":"Not saved","gui.library.projects.close":"Close current project?","gui.library.projects.deleteConfirm":'Do you want to delete the project "{name}"?',"gui.library.projects.replace":"Replace contents of the current project?","gui.library.projects.errorEditor":'This project is not currently editor creation, please switch to "{workspace}" and open it.',"gui.library.projects.notFoundEditor":'Not Found the "{editor}" Editor.',"gui.library.examples.interconnect":"The project requires two devices to work properly.","gui.library.tutorial.course":"Choose a course","gui.library.tutorial.tutorial":"Choose a tutorial","gui.tutorials.shrink":"Shrink","gui.tutorials.expand":"Expand","gui.tutorials.close":"Close","gui.tutorials.moreTry":"More things to try!","gui.tutorials.seeMore":"See more","gui.prompt.ok":"OK","gui.prompt.close":"Close","gui.prompt.cancel":"Cancel","gui.prompt.reconnect":"Reconnect","gui.connection.device":"Device Connection","gui.connection.search":"Start Searching","gui.connection.searching":"Searching...","gui.connection.connect":"Start Connecting","gui.connection.deviceName":"Device name","gui.about.title":"About...","gui.about.main":"Main program","gui.terms.title":"Terms of Use","gui.terms.content":`<b>Terms of Use</b>
`,"gui.privacy.title":"Privacy","gui.privacy.content":`<b>Privacy</b>
`};var Si={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"载入中…","gui.alert.downloading":"正在下载…{progress}%","gui.alert.downloadCompleted":"下载完成。","gui.alert.connecting":"正在连接…","gui.alert.connected":"已连接。","gui.alert.connectionCancel":"连接取消。","gui.alert.connectionError":"连接发生错误，或已断开。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在恢复固件…{progress}%","gui.alert.recovering":"恢复设备…","gui.alert.restoreCompleted":"恢复固件完成，请按下 RESET 键。","gui.alert.reseting":"正在复位…","gui.alert.compiling":"正在编译…","gui.alert.compileCompleted":"编译完成。","gui.alert.compileError":"编译失败。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存作品…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到电脑。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存作品失败。","gui.logs.changeDevice":"设备已更改为 {device}","gui.logs.connected":"设备已连接","gui.logs.connectedType":"设备已连接到 {type}","gui.logs.disconnected":"设备断开连接","gui.logs.compiling":"程序编译中…","gui.logs.compiled":"编译完成","gui.logs.downloading":"下载程序到设备…","gui.logs.downloaded":"下载完成","gui.logs.downloadError":"下载失败","gui.home.my":"我的作品","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"开始新作品","gui.home.examples":"{label} 精彩作品","gui.home.slideshow.desktop.title":"桌面端程序已就绪，快来下载！","gui.home.slideshow.desktop.button":"立即下载","gui.home.slideshow.tankwar.title":"战争一触即发，赶紧来战吧！","gui.home.slideshow.tankwar.button":"加入战斗","gui.home.slideshow.arcade.title":"玩的下一个游戏，就要自己创作！","gui.home.slideshow.arcade.button":"开始创作","gui.splash.loading":"加载作品…","gui.splash.errorTitle":"发生错误","gui.splash.errorLabel":"请刷新页面重新打开。","gui.menubar.courses":"课程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填写作品标题","gui.menubar.file":"文件","gui.menubar.file.newProject":"新作品","gui.menubar.file.openProject":"打开…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"从电脑中打开…","gui.menubar.file.downloadProject":"保存到电脑…","gui.menubar.edit":"编辑","gui.menubar.edit.undo":"撤销","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打开代码编程","gui.menubar.edit.closeManualCoding":"关闭代码编程","gui.menubar.edit.openCompactBlock":"打开紧凑积木样式","gui.menubar.edit.closeCompactBlock":"关闭紧凑积木样式","gui.menubar.view":"查看","gui.menubar.view.log":"日志","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文件管理","gui.menubar.view.openAutoDisplayPanel":"打开自动显示日志","gui.menubar.view.closeAutoDisplayPanel":"关闭自动显示日志","gui.menubar.device":"设备","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下载程序","gui.menubar.device.reset":"复位","gui.menubar.device.connect":"连接…","gui.menubar.device.connectUsb":"通过 USB 连接…","gui.menubar.device.connectBle":"通过蓝牙（BLE）连接…","gui.menubar.device.disconnect":"断开连接","gui.menubar.device.firmware":"恢复固件…","gui.menubar.device.firmwareVersion":"恢复 v{version} 固件…","gui.menubar.device.caching":"正在缓存最新固件…","gui.panelBox.logs":"日志","gui.panelBox.serial":"串口","gui.panelBox.files":"文件管理","gui.project.name":"未命名作品","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"没有作品！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"复制","gui.library.projects.delete":"删除","gui.library.projects.notSaved":"未保存作品","gui.library.projects.close":"要关闭当前作品吗？","gui.library.projects.deleteConfirm":"要删除“《{name}》”作品吗？","gui.library.projects.replace":"要创建新作品替换当前作品吗？","gui.library.projects.errorEditor":"这个作品不是当前编辑器创作，请切换至“{editor}”编辑器然后打开。","gui.library.projects.notFoundEditor":"没有发现“{editor}”编辑器。","gui.library.examples.interconnect":"该作品需要两台设备联机才能正常运行。","gui.library.tutorials.course":"选择一个课程","gui.library.tutorials.tutorial":"选择一个教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展开","gui.tutorials.close":"关闭","gui.tutorials.moreTry":"再试试这些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"确认","gui.prompt.close":"关闭","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新连接","gui.connection.device":"硬件连接","gui.connection.search":"开始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"开始连接","gui.connection.deviceName":"硬件名称","gui.about.title":"版本信息","gui.about.main":"主程序","gui.terms.title":"使用条款","gui.terms.content":`<b>使用条款</b>
`,"gui.privacy.title":"隐私","gui.privacy.content":`<b>隐私</b>
`};var Ui={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"載入中…","gui.alert.downloading":"正在下載…{progress}%","gui.alert.downloadCompleted":"下載完成。","gui.alert.connecting":"正在連接…","gui.alert.connected":"已連接。","gui.alert.connectionCancel":"連接取消。","gui.alert.connectionError":"連接發生錯誤，或已斷開。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在還原固件…{progress}%","gui.alert.recovering":"恢復設備…","gui.alert.restoreCompleted":"還原固件完成，請按下 RESET 鍵。","gui.alert.reseting":"正在重置…","gui.alert.compiling":"正在編譯…","gui.alert.compileCompleted":"編譯完成。","gui.alert.compileError":"編譯失敗。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存專案…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到電腦。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存專案失敗。","gui.logs.changeDevice":"設備已更改為 {device}","gui.logs.connected":"設備已連接","gui.logs.connectedType":"設備已連接到 {type}","gui.logs.disconnected":"設備斷開連接","gui.logs.compiling":"程序編譯中…","gui.logs.compiled":"編譯完成","gui.logs.downloading":"下載程序到設備…","gui.logs.downloaded":"下載完成","gui.logs.downloadError":"下載失敗","gui.home.my":"我的專案","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"開始新專案","gui.home.examples":"{label} 精彩專案","gui.home.slideshow.desktop.title":"桌面端程序已就緒，快來下載！","gui.home.slideshow.desktop.button":"立即下載","gui.home.slideshow.tankwar.title":"戰爭一觸即髮，趕緊來戰吧！","gui.home.slideshow.tankwar.button":"加入戰鬥","gui.home.slideshow.arcade.title":"玩的下一個遊戲，就要自己創作！","gui.home.slideshow.arcade.button":"開始創作","gui.splash.loading":"加載專案…","gui.splash.errorTitle":"發生錯誤","gui.splash.errorLabel":"請刷新頁面重新打開。","gui.menubar.courses":"課程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填寫專案標題","gui.menubar.file":"文檔","gui.menubar.file.newProject":"新專案","gui.menubar.file.openProject":"打開…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"從電腦中打開…","gui.menubar.file.downloadProject":"保存到電腦…","gui.menubar.edit":"編輯","gui.menubar.edit.undo":"撤銷","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打開代碼編程","gui.menubar.edit.closeManualCoding":"關閉代碼編程","gui.menubar.edit.openCompactBlock":"打開緊湊積木樣式","gui.menubar.edit.closeCompactBlock":"關閉緊湊積木樣式","gui.menubar.view":"查看","gui.menubar.view.log":"日誌","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文檔管理","gui.menubar.view.openAutoDisplayPanel":"打開自動顯示日誌","gui.menubar.view.closeAutoDisplayPanel":"關閉自動顯示日誌","gui.menubar.device":"設備","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下載程序","gui.menubar.device.reset":"重置","gui.menubar.device.connect":"連接…","gui.menubar.device.connectUsb":"通過 USB 連接…","gui.menubar.device.connectBle":"通過藍牙（BLE）連接…","gui.menubar.device.disconnect":"斷開連接","gui.menubar.device.firmware":"還原固件…","gui.menubar.device.firmwareVersion":"還原 v{version} 固件…","gui.menubar.device.caching":"正在緩存最新固件…","gui.panelBox.logs":"日誌","gui.panelBox.serial":"串口","gui.panelBox.files":"文檔管理","gui.project.name":"未命名專案","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"沒有專案！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"複製","gui.library.projects.delete":"刪除","gui.library.projects.notSaved":"未保存專案","gui.library.projects.close":"要關閉當前專案嗎？","gui.library.projects.deleteConfirm":"要刪除“《{name}》”專案嗎？","gui.library.projects.replace":"要創建新專案替換當前專案嗎？","gui.library.projects.errorEditor":"這個專案不是當前編輯器創作，請切換至“{editor}”編輯器然後打開。","gui.library.projects.notFoundEditor":"沒有發現「{editor}」編輯器。","gui.library.examples.interconnect":"該專案需要兩枱設備聯機纔能正常運行。","gui.library.tutorials.course":"選擇一個課程","gui.library.tutorials.tutorial":"選擇一個教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展開","gui.tutorials.close":"關閉","gui.tutorials.moreTry":"再試試這些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"確認","gui.prompt.close":"關閉","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新連接","gui.connection.device":"硬件連接","gui.connection.search":"開始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"開始連接","gui.connection.deviceName":"硬件名稱","gui.about.title":"版本信息","gui.about.main":"主程式","gui.terms.title":"使用條款","gui.terms.content":`<b>使用條款</b>
`,"gui.privacy.title":"隱私","gui.privacy.content":`<b>隱私</b>
`};B1({en:Ri,"zh-Hans":Si,"zh-Hant":Ui});import{render as Yo}from"preact";import{LocalesProvider as Ko,AppProvider as jo,ProjectProvider as en}from"@blockcode/core";import{useCallback as U,useEffect as Fi,useErrorBoundary as Ao}from"preact/hooks";import{batch as ve,useComputed as v1,useSignal as Ge,useSignalEffect as xo}from"@preact/signals";import{isElectron as $i,classNames as Wo,keyMirror as Do,openProjectFromURL as Io,getAutoDisplayPanel as Po}from"@blockcode/utils";import{useAppContext as Ro,useLocalesContext as So,useProjectContext as Uo,translate as Xo,maybeTranslate as To,showSplash as k1,hideSplash as Ho,openPromptModal as Ve,closePromptModal as w1,openLayout as No,closeLayout as zo,openTab as _1,openProject as Oo,closeProject as Go,setAlert as Vo,delAlert as Jo,setAppState as xe}from"@blockcode/core";import{getAutoDisplayPanel as ba,setAutoDisplayPanel as va}from"@blockcode/utils";import{Text as li}from"@blockcode/core";import{useCallback as Ie}from"preact/hooks";import{batch as E1}from"@preact/signals";import{isElectron as Xi,isMac as Ke,putProject as Z1,openProjectFromComputer as Q1,saveProjectToComputer as L1,sleepMs as F1}from"@blockcode/utils";import{useProjectContext as $1,setAlert as ii,openUserStorage as A1,setFile as x1,setModified as W1,ModifyTypes as D1,Keys as ee}from"@blockcode/core";import{Text as J,MenuSection as je,MenuItem as _e}from"@blockcode/core";function C(e){let r=globalThis.document,i=r.createElement("style");i.appendChild(r.createTextNode(e)),r.head.append(i)}C(".cbXT-q_menu-bar{box-sizing:border-box;height:var(--menu-bar-height);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:var(--menu-bar-standard-font-size);background-color:var(--theme-primary);color:var(--ui-white);-webkit-user-select:none;-webkit-app-region:drag;flex-flow:row;justify-content:space-between;font-weight:700;display:flex;box-shadow:0 0 3px #00000040}.cbXT-q_menu-bar-item{color:var(--ui-white);user-select:none;white-space:nowrap;height:var(--menu-bar-height);align-self:center;align-items:center;padding:0 .25rem;text-decoration:none;display:flex;position:relative}.cbXT-q_menu-bar-item.cbXT-q_growable{max-width:var(--menu-bar-item-max-width);flex:1}.cbXT-q_main-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_main-menu.cbXT-q_electron{margin-left:72px}.cbXT-q_right-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_menu-label{padding:0 .75rem}.cbXT-q_menu-label img{margin-right:.25rem}.cbXT-q_language-label{width:var(--language-selector-width);padding:0 .5rem}input.cbXT-q_menu-label{display:none}input.cbXT-q_menu-label+.cbXT-q_menu-bar-item:hover{cursor:pointer;background:var(--ui-black-transparent)}input.cbXT-q_menu-label:checked+.cbXT-q_menu-bar-item{background:var(--ui-black-transparent)}.cbXT-q_menu{top:var(--menu-bar-height);z-index:var(--z-index-menu-bar);border-radius:0 0 var(--space)var(--space);color:var(--ui-white);background:var(--theme-primary);min-width:186px;display:none}.cbXT-q_menu-item{font-weight:700}.cbXT-q_menu-item:hover{background:var(--ui-black-transparent)}.cbXT-q_language-icon{vertical-align:middle;height:1.5rem}.cbXT-q_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}.cbXT-q_check-icon.cbXT-q_checked{visibility:visible}.cbXT-q_divider{border-right:1px dashed var(--ui-black-transparent);height:34px;margin:0 .7rem}.cbXT-q_hoverable:hover{cursor:pointer;background:var(--ui-black-transparent)}.cbXT-q_tutorials-icon{margin-right:.35rem}.cbXT-q_title-field{border:1px dashed var(--ui-black-transparent);border-radius:var(--form-radius);-webkit-border-radius:var(--form-radius);-moz-border-radius:var(--form-radius);background-color:var(--ui-white-transparent);height:auto;color:var(--ui-white);-webkit-background-clip:padding-box;background-clip:padding-box;padding:.5rem;font-size:.8rem;font-weight:700}.cbXT-q_title-field::placeholder{color:var(--ui-white);font-size:.8rem;font-style:italic;font-weight:400}.cbXT-q_title-field:hover{background-color:#ffffff80}.cbXT-q_title-field:focus{border:1px solid var(--ui-transparent);-webkit-box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);background-color:var(--ui-white);color:var(--text-primary);outline:none}.cbXT-q_home-icon,.cbXT-q_closeIcon{padding:0 .35rem}.cbXT-q_blank-check-item>div{padding-left:calc(14px + var(--space)/2)}");var p={electron:"cbXT-q_electron",tutorialsIcon:"cbXT-q_tutorials-icon",rightMenu:"cbXT-q_right-menu",languageLabel:"cbXT-q_language-label",menu:"cbXT-q_menu",mainMenu:"cbXT-q_main-menu",checked:"cbXT-q_checked",homeIcon:"cbXT-q_home-icon",blankCheckItem:"cbXT-q_blank-check-item",menuBar:"cbXT-q_menu-bar",menuLabel:"cbXT-q_menu-label",menuBarItem:"cbXT-q_menu-bar-item",growable:"cbXT-q_growable",hoverable:"cbXT-q_hoverable",menuItem:"cbXT-q_menu-item",languageIcon:"cbXT-q_language-icon",checkIcon:"cbXT-q_check-icon",divider:"cbXT-q_divider",titleField:"cbXT-q_title-field",closeIcon:"cbXT-q_closeIcon"};import{jsx as L,jsxs as ei,Fragment as I1}from"preact/jsx-runtime";var Ti=(e=!1)=>ii({message:L(J,{id:"gui.alert.saving",defaultMessage:"Saving project..."})},e),Hi=(e,r=!1)=>ii({id:e,message:r?L(J,{id:"gui.alert.savedComputer",defaultMessage:"Saved to your computer."}):L(J,{id:"gui.alert.saved",defaultMessage:"Saved to local storage."})},2000),Ni=(e,r=!1)=>ii({id:e,mode:"warn",message:r?L(J,{id:"gui.alert.saveAbortError",defaultMessage:"Abort saving."}):L(J,{id:"gui.alert.saveError",defaultMessage:"Failed save."})},r?1000:2000);function zi({onNew:e,onOpen:r,onSave:i,onThumb:t,ExtendedMenu:o}){let{meta:a,key:n,name:c,files:m,assets:l}=$1(),g=Ie(async()=>{await F1(0);for(let X in a.value.monitors)if(a.value.monitors[X].deleting)a.value.monitors.splice(X,1);let u=[],s=m.value.map((X)=>{return u.push(X.extensions),Object.fromEntries(Object.entries(X).filter(([D,Ai])=>{if(["xmlDom","script","extensions"].includes(D))return!1;if(!a.value.manualCoding&&D==="content")return!1;return!0}))}),v=l.value?.filter((X)=>!X.uri),Q=await i(s,v,a.value);return Q.meta=Object.assign(Q.meta??{},{editor:a.value.editor,version:a.value.version,monitors:a.value.monitors,extensions:Array.from(new Set(u.flat())).filter(Boolean),manualCoding:a.value.manualCoding,compactBlock:a.value.compactBlock,users:a.value.users}),Q.name=c.value,Q},[i]),B=Ie(async()=>{let u=Ti(),s=await g();s.key=n.value;let v=await Z1(s,t);E1(()=>{if(s.key!==v)x1({key:v});W1(D1.Saved)}),Hi(u)},[g]),f=Ie(async()=>{let u=Ti(Xi?1000:!1),s=await g(),v=await L1(s);if(Xi)return;if(v.success)Hi(u,!0);else if(v.error==="AbortError")Ni(u,!0);else Ni(u)},[g]),b=Ie(async()=>{let u=await Q1();await r(u)},[r]);return ei(I1,{children:[L(je,{children:L(_e,{className:p.menuItem,label:L(J,{id:"gui.menubar.file.newProject",defaultMessage:"New"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.N],onClick:e})}),ei(je,{children:[L(_e,{className:p.menuItem,label:L(J,{id:"gui.menubar.file.openProject",defaultMessage:"Open"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.O],onClick:A1}),L(_e,{className:p.menuItem,label:L(J,{id:"gui.menubar.file.saveProject",defaultMessage:"Save"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.S],onClick:B})]}),ei(je,{children:[L(_e,{className:p.menuItem,label:L(J,{id:"gui.menubar.file.uploadProject",defaultMessage:"Load from your computer"}),onClick:b}),L(_e,{className:p.menuItem,label:L(J,{id:"gui.menubar.file.downloadProject",defaultMessage:"save to your computer"}),onClick:f})]}),o&&L(o,{itemClassName:p.menuItem,onOpen:r,onSave:g})]})}import{useCallback as Oi,useEffect as P1}from"preact/hooks";import{batch as R1,useSignal as Gi,useComputed as S1}from"@preact/signals";import{isMac as Vi,setCompactBlock as U1,getCompactBlock as X1}from"@blockcode/utils";import{useProjectContext as T1,Keys as ie,setMeta as Ji}from"@blockcode/core";import{Text as me,MenuSection as Yi,MenuItem as Pe}from"@blockcode/core";import{jsx as N,jsxs as ri,Fragment as H1}from"preact/jsx-runtime";function Ki({enableCoding:e,enableCompactBlock:r,onUndo:i,onRedo:t,onEnableUndo:o,onEnableRedo:a,ExtendedMenu:n}){let{meta:c,key:m,fileId:l,modified:g}=T1(),B=Gi(!0),f=Gi(!0),b=S1(()=>c.value.compactBlock??X1());P1(()=>{R1(()=>{B.value=!o(),f.value=!a()})},[m.value,l.value,g.value]);let u=Oi(()=>{Ji("manualCoding",!c.value.manualCoding)},[]),s=Oi(()=>{let v=!b.value;Ji("compactBlock",v),U1(v)},[]);return ri(H1,{children:[ri(Yi,{children:[N(Pe,{disabled:B.value,className:p.menuItem,label:N(me,{id:"gui.menubar.edit.undo",defaultMessage:"Undo"}),hotkey:[Vi?ie.COMMAND:ie.CONTROL,ie.Z],onClick:i}),N(Pe,{disabled:f.value,className:p.menuItem,label:N(me,{id:"gui.menubar.edit.redo",defaultMessage:"Redo"}),hotkey:Vi?[ie.SHIFT,ie.COMMAND,ie.Z]:[ie.CONTROL,ie.Y],onClick:t})]}),(e||r)&&ri(Yi,{children:[r&&N(Pe,{className:p.menuItem,label:b.value?N(me,{id:"gui.menubar.edit.closeCompactBlock",defaultMessage:"Turn off Compact Block"}):N(me,{id:"gui.menubar.edit.openCompactBlock",defaultMessage:"Turn on Compact Block"}),onClick:s}),e&&N(Pe,{className:p.menuItem,label:c.value.manualCoding?N(me,{id:"gui.menubar.edit.closeManualCoding",defaultMessage:"Turn off Coding Mode"}):N(me,{id:"gui.menubar.edit.openManualCoding",defaultMessage:"Turn on Coding Mode"}),onClick:u})]}),n&&N(n,{itemClassName:p.menuItem})]})}import{useEffect as al,useCallback as nr}from"preact/hooks";import{useComputed as na,useSignal as la}from"@preact/signals";import{classNames as Re,getAutoDisplayPanel as ca,setAutoDisplayPanel as ua}from"@blockcode/utils";import{useAppContext as ma,useProjectContext as ga,setAppState as pa,Keys as pe,Text as ye,MenuSection as lr,MenuItem as Se}from"@blockcode/core";import{useCallback as ai}from"preact/hooks";import{useComputed as ea}from"@preact/signals";import{keyMirror as ia,classNames as ti}from"@blockcode/utils";import{useAppContext as ra,Box as aa,Button as oi,Text as ni}from"@blockcode/core";import{useComputed as N1}from"@preact/signals";import{logger as z1,themeColors as ji}from"@blockcode/core";import{Terminal as O1}from"@blockcode/code";import{jsx as G1}from"preact/jsx-runtime";function er(){let e=N1(()=>z1.logs.join(`\r
`));return G1(O1,{textValue:e.value,options:{theme:{cursor:"#fff",foreground:ji.ui.text.primary,background:"#fff",selection:ji.ui.text.primary}}})}import{Terminal as V1}from"@blockcode/code";import{jsx as J1}from"preact/jsx-runtime";function ir(){return J1(V1,{compactMode:!0})}C(".hPjAUa_button{--button-height:calc(var(--standard-font-size)*2.4);padding:0 calc(var(--space)*1.5);height:var(--button-height);border-radius:calc(var(--button-height)/2);margin-left:var(--space);border-color:var(--blocks-tertiary);background:var(--blocks-secondary);color:var(--ui-white)}.hPjAUa_button .hPjAUa_icon{filter:brightness(100);width:16px;margin-right:4px}.hPjAUa_button:hover:not(:disabled):not(.hPjAUa_button-actived){background:var(--blocks-tertiary)}.hPjAUa_button-actived{background:var(--ui-white);color:var(--text-primary)}.hPjAUa_button-actived .hPjAUa_icon{filter:unset}");var Y={icon:"hPjAUa_icon",buttonActived:"hPjAUa_button-actived",button:"hPjAUa_button"};var rr="./assets/icon-logs-xymnjv7g.svg";var ar="./assets/icon-serial-xw0zbnx8.svg";var tr="./assets/icon-files-c1wm773z.svg";import{jsx as re,jsxs as Ce,Fragment as ta}from"preact/jsx-runtime";var A=ia({Logs:null,Serial:null,Files:null});function or({panelId:e,onPanelChange:r,onClose:i}){let{menuItems:t}=ra(),o=ea(()=>t.value?.find((a)=>a.id==="view"));return Ce(aa,{header:Ce(ta,{children:[Ce(oi,{className:ti(Y.button,{[Y.buttonActived]:e===A.Logs}),onClick:ai(()=>r(A.Logs),[]),children:[re("img",{className:Y.icon,src:rr}),re(ni,{id:"gui.panelBox.logs",defaultMessage:"Logs"})]}),Ce(oi,{className:ti(Y.button,{[Y.buttonActived]:e===A.Serial}),onClick:ai(()=>r(A.Serial),[]),children:[re("img",{className:Y.icon,src:ar}),re(ni,{id:"gui.panelBox.serial",defaultMessage:"Serial"})]}),o.value?.options?.disabledFiles!==!0&&Ce(oi,{disabled:!0,className:ti(Y.button,{[Y.buttonActived]:e===A.Files}),onClick:ai(()=>r(A.Files),[]),children:[re("img",{className:Y.icon,src:tr}),re(ni,{id:"gui.panelBox.files",defaultMessage:"Files"})]})]}),onClose:i,children:[e===A.Logs&&re(er,{}),e===A.Serial&&re(ir,{})]})}var ge="./assets/icon-check-f984n1c2.svg";import{jsx as z,jsxs as Me,Fragment as da}from"preact/jsx-runtime";function cr({enableFiles:e,ExtendedMenu:r}){let{appState:i}=ma(),{meta:t}=ga(),o=la(ca(t.value.editor)),a=na(()=>i.value?.panelBoxId),n=nr((m)=>()=>{if(m===a.value)m=null;pa("panelBoxId",m)},[]),c=nr(()=>{o.value=!o.value,ua(t.value.editor,o.value)},[]);return Me(da,{children:[Me(lr,{children:[Me(Se,{className:p.menuItem,hotkey:[pe.CONTROL,pe.D1],onClick:n(A.Logs),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Logs}),src:ge}),z(ye,{id:"gui.menubar.view.log",defaultMessage:"Log Panel"})]}),Me(Se,{className:p.menuItem,hotkey:[pe.CONTROL,pe.D2],onClick:n(A.Serial),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Serial}),src:ge}),z(ye,{id:"gui.menubar.view.serial",defaultMessage:"Serial Panel"})]}),e&&Me(Se,{disabled:!0,className:p.menuItem,hotkey:[pe.CONTROL,pe.D3],onClick:n(A.Files),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Files}),src:ge}),z(ye,{id:"gui.menubar.view.files",defaultMessage:"Files Panel"})]})]}),r&&z(r,{itemClassName:p.menuItem}),z(lr,{children:z(Se,{className:Re(p.menuItem,p.blankCheckItem),label:o.value?z(ye,{id:"gui.menubar.view.closeAutoDisplayPanel",defaultMessage:"Turn off auto display panel"}):z(ye,{id:"gui.menubar.view.openAutoDisplayPanel",defaultMessage:"Turn on auto display panel"}),onClick:c})})]})}var ur="./assets/icon-file-egaz1kfx.svg";var mr="./assets/icon-edit-jejnm7yb.svg";var gr="./assets/icon-view-c3skbdpn.svg";import{jsx as de}from"preact/jsx-runtime";function pr(e,r,i){let t=(l)=>i(l,r.editor),o=e.menuItems?.find((l)=>l.id==="file"),a=e.menuItems?.find((l)=>l.id==="edit"),n=e.menuItems?.find((l)=>l.id==="view"),c=ba(r.editor)??n?.autoDisplayPanel===!0;va(r.editor,c);let m=async()=>{let l=JSON.parse(JSON.stringify(await e.onNew()));if(!l.meta)l.meta=r;if(!l.meta.editor)l.meta.editor=r.editor,l.meta.version=r.version;t(l,r.editor)};return[{id:"file",icon:ur,label:de(li,{id:"gui.menubar.file",defaultMessage:"File"}),Menu:()=>de(zi,{ExtendedMenu:o?.Menu,onNew:m,onOpen:t,onSave:e.onSave,onThumb:e.onThumb}),options:o},{id:"edit",icon:mr,label:de(li,{id:"gui.menubar.edit",defaultMessage:"Edit"}),Menu:()=>de(Ki,{enableCoding:a?.disabledCoding!==!0,enableCompactBlock:a?.disabledCompactBlock!==!0,ExtendedMenu:a?.Menu,onUndo:e.onUndo,onRedo:e.onRedo,onEnableUndo:e.onEnableUndo,onEnableRedo:e.onEnableRedo}),options:a},n?.disabled!==!0&&{id:"view",icon:gr,label:de(li,{id:"gui.menubar.view",defaultMessage:"View"}),Menu:()=>de(cr,{enableFiles:n?.disabledFiles!==!0,ExtendedMenu:n?.Menu}),options:n}].concat(e.menuItems?.filter((l)=>!["file","edit","view"].includes(l.id))??[]).filter(Boolean)}import{Text as ke}from"@blockcode/core";import{classNames as wa}from"@blockcode/utils";import{maybeTranslate as _a,Button as sr}from"@blockcode/core";C(".lkaaPa_alerts-wrapper{width:100%;z-index:var(--z-index-alerts);top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute}.lkaaPa_alert-wrapper{pointer-events:all;background:var(--ui-light);border:1px solid var(--blocks-tertiary);min-width:200px;max-width:548px;min-height:1.5rem;box-shadow:0px 0px 0px 2px var(--ui-light);border-radius:.5rem;flex-direction:row;justify-content:flex-start;align-items:center;margin-bottom:7px;padding:.875rem 1rem;display:flex;overflow:hidden}.lkaaPa_warn{border:1px solid var(--error-primary)}.lkaaPa_icon{min-width:1.25rem;min-height:1.25rem;padding-right:1rem;display:flex}.lkaaPa_message{justify-content:flex-end;align-items:center;padding-right:.5rem;font-size:.8125rem;font-weight:700;line-height:.875rem;display:flex}.lkaaPa_warn .lkaaPa_message{color:var(--error-secondary)}.lkaaPa_success .lkaaPa_message{color:#555}.lkaaPa_button{color:var(--ui-white);margin-left:var(--space);padding:var(--space)calc(var(--space)*2.5);background:#ff8c1a;border:#ff8c1a}.lkaaPa_close-button{width:1.75rem;height:1.75rem;margin-left:calc(var(--space)*2);background:#ff861433;border:0;border-radius:50%;padding:0;transition:all .15s ease-out;box-shadow:0 0 0 2px #ff861433}.lkaaPa_close-button:hover{transform:scale(1.1);box-shadow:0 0 0 4px #ff861433}.lkaaPa_close-button img{margin:0 auto}");var K={icon:"lkaaPa_icon",button:"lkaaPa_button",success:"lkaaPa_success",message:"lkaaPa_message",alertsWrapper:"lkaaPa_alerts-wrapper",alertWrapper:"lkaaPa_alert-wrapper",closeButton:"lkaaPa_close-button",warn:"lkaaPa_warn"};var dr="./assets/icon-close-bazpdng8.svg";import{jsx as se,jsxs as Ca}from"preact/jsx-runtime";function hr({mode:e,icon:r,message:i,options:t,button:o,onClose:a}){return Ca("div",{className:wa(K.alertWrapper,{[K.success]:e==="success",[K.warn]:e==="warn"}),children:[se("div",{className:K.icon,children:typeof r==="string"?se("img",{src:r}):r}),se("div",{className:K.message,children:_a(i,t)}),o&&se(sr,{className:K.button,onClick:o.onClick,children:o.label}),a&&se(sr,{className:K.closeButton,onClick:a,children:se("img",{src:dr})})]})}import{jsx as fr}from"preact/jsx-runtime";function br({items:e}){return fr("div",{className:K.alertsWrapper,children:e.map(({id:r,mode:i,icon:t,message:o,button:a,onClose:n,...c})=>fr(hr,{mode:i??"success",icon:t,message:o,options:c,button:a,onClose:n},r))})}import{useCallback as Ma}from"preact/hooks";import{useSignal as qa}from"@preact/signals";import{classNames as Ue}from"@blockcode/utils";import{Text as qe,Button as kr,Modal as Ba}from"@blockcode/core";C(".Zq10BW_prompt-modal{width:480px}.Zq10BW_prompt-header{background:var(--blocks-primary)}.Zq10BW_prompt-content{background:var(--ui-white)}.Zq10BW_device-list{background:var(--theme-light-transparent);width:100%;height:170px;padding:.5rem;overflow-y:auto}.Zq10BW_device-search{justify-content:center;align-items:center;width:100%;height:100%;display:flex}.Zq10BW_device-search-icon{width:120px;height:120px}@keyframes Zq10BW_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.Zq10BW_device-searching-icon{animation:1.5s linear infinite Zq10BW_spin}.Zq10BW_device-item{background:var(--ui-white);border-radius:calc(var(--space)/2);border:2px solid var(--ui-white);flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:50px;margin-bottom:.5rem;padding:10px;display:flex}.Zq10BW_device-item.Zq10BW_selected{border:2px solid var(--theme-primary)}.Zq10BW_device-name-bar{align-items:center;display:flex}.Zq10BW_device-image{width:40px;margin-right:.5rem}.Zq10BW_device-name-wrapper{flex-direction:column;justify-content:center;align-items:flex-start;display:flex}.Zq10BW_device-name-label{font-size:.625rem;font-weight:700}.Zq10BW_device-name-text{font-size:.875rem}.Zq10BW_button-row{text-align:right;text-align:center;padding:1.5rem 2.25rem;font-weight:bolder}.Zq10BW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.Zq10BW_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var Z={promptContent:"Zq10BW_prompt-content",deviceSearch:"Zq10BW_device-search",deviceSearchIcon:"Zq10BW_device-search-icon",selected:"Zq10BW_selected",deviceList:"Zq10BW_device-list",okButton:"Zq10BW_ok-button",promptModal:"Zq10BW_prompt-modal",deviceItem:"Zq10BW_device-item",deviceSearchingIcon:"Zq10BW_device-searching-icon",promptHeader:"Zq10BW_prompt-header",deviceNameLabel:"Zq10BW_device-name-label",deviceImage:"Zq10BW_device-image",deviceNameWrapper:"Zq10BW_device-name-wrapper",deviceNameBar:"Zq10BW_device-name-bar",button:"Zq10BW_button",buttonRow:"Zq10BW_button-row",deviceNameText:"Zq10BW_device-name-text",spin:"Zq10BW_spin"};var vr="./assets/searching-tt57cegv.png";import{jsx as $,jsxs as Xe}from"preact/jsx-runtime";function wr({title:e,icon:r,devices:i,onClose:t,onSearch:o,onConnect:a}){let n=qa(""),c=Ma(()=>{if(!n.value)return;a(n.value),n.value=""},[a]);return $(Ba,{title:e??$(qe,{id:"gui.connection.device",defaultMessage:"Device"}),className:Z.promptModal,headerClassName:Z.header,onClose:t,children:Xe("div",{className:Z.promptContent,children:[$("div",{className:Z.deviceList,children:Array.isArray(i)&&i.length>0?i.map((m)=>Xe("div",{className:Ue(Z.deviceItem,{[Z.selected]:m.id===n.value}),onClick:()=>n.value=m.id,children:[Xe("div",{className:Z.deviceNameBar,children:[r&&$("img",{}),Xe("div",{className:Z.deviceNameWrapper,children:[$("div",{className:Z.deviceNameLabel,children:$(qe,{id:"gui.connection.deviceName",defaultMessage:"Device name"})}),$("div",{className:Z.deviceNameText,children:m.name})]})]}),m.rssi&&$("div",{className:Z.deviceSignalBar})]})):$("div",{className:Z.deviceSearch,children:$("img",{className:Ue(Z.deviceSearchIcon,{[Z.deviceSearchingIcon]:Array.isArray(i)}),src:vr})})}),$("div",{className:Z.buttonRow,children:i===!0?$(kr,{className:Ue(Z.button,Z.okButton),onClick:()=>o(),children:$(qe,{id:"gui.connection.search",defaultMessage:"Start Searching"})}):$(kr,{disabled:!n.value,className:Ue(Z.button,Z.okButton),onClick:c,children:!n.value?$(qe,{id:"gui.connection.searching",defaultMessage:"Searching"}):$(qe,{id:"gui.connection.connect",defaultMessage:"Start Connecting"})})})]})})}import{useEffect as za,useCallback as Ze}from"preact/hooks";import{batch as Oa,useSignal as He,useSignalEffect as Ga}from"@preact/signals";import{classNames as Qe,getProjectsThumbs as Va,getProject as Ja,cloneProject as Ya,renameProject as Ka,delProject as ja,openProjectFromURL as et}from"@blockcode/utils";import{maybeTranslate as di,setAlert as it,delAlert as rt,openPromptModal as si,openUserStorage as at}from"@blockcode/core";var ci="1.2.0";import{Text as F,ContextMenu as tt,LibraryItem as hi}from"@blockcode/core";import{useEffect as Za}from"preact/hooks";import{useSignal as Qa}from"@preact/signals";import{classNames as _r}from"@blockcode/utils";import{Button as La}from"@blockcode/core";C(".tyiNqW_cover-wrapper{width:100%;position:relative}.tyiNqW_cover{opacity:1;background-position:50%;background-repeat:no-repeat;background-size:cover;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 2rem;transition:opacity 1s;display:flex;position:absolute;top:0;left:0}.tyiNqW_cover.tyiNqW_hidden{opacity:0;pointer-events:none}.tyiNqW_title{color:#000;padding-right:1.5rem;font-size:2rem;font-weight:600}.tyiNqW_button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-top:calc(2*var(--space));padding:.75rem 1rem;font-size:.85rem;font-weight:600}.tyiNqW_feature{max-height:90%;margin-right:5%}");var oe={coverWrapper:"tyiNqW_cover-wrapper",hidden:"tyiNqW_hidden",cover:"tyiNqW_cover",title:"tyiNqW_title",button:"tyiNqW_button",feature:"tyiNqW_feature"};import{jsx as Te,jsxs as Cr}from"preact/jsx-runtime";function yr({pages:e,className:r}){let i=Qa(0);return Za(()=>{setInterval(()=>i.value=(i.value+1)%e.length,7000)},[]),Te("div",{className:_r(oe.coverWrapper,r),children:e.map((t,o)=>Cr("div",{className:_r(oe.cover,{[oe.hidden]:o!==i.value}),style:{backgroundImage:`url(${t.backgroundImage})`},children:[Cr("div",{children:[Te("div",{className:oe.title,children:t.title}),Te(La,{className:oe.button,onClick:t.onClick,children:t.buttonText})]}),Te("img",{className:oe.feature,src:t.featureImage})]},o))})}C("._9IQa7q_home-wrapper{background:var(--ui-secondary);top:var(--menu-bar-height);width:100%;height:calc(100% - var(--menu-bar-height));z-index:calc(var(--z-index-alerts) - 10);user-select:none;position:absolute;overflow:hidden auto}._9IQa7q_getting-started{height:240px;margin-bottom:1.5rem}._9IQa7q_link{cursor:pointer;color:var(--theme-primary)}._9IQa7q_view-all{font-weight:400;font-size:var(--standard-font-size);margin-left:1.5rem}._9IQa7q_delete-menu-item:hover{background:var(--error-primary)}._9IQa7q_footer{color:var(--text-primary);font-size:var(--small-font-size);padding:3.5rem 0 var(--space);text-align:center}._9IQa7q_footer-item{padding:0 var(--space)}._9IQa7q_footer-item:not(:first-child){border-left:1px solid var(--ui-black-transparent)}._9IQa7q_library-grid{background:var(--ui-secondary);flex-wrap:wrap;flex-grow:1;place-content:flex-start;align-items:flex-start;height:auto;padding:.5rem;display:flex;overflow-y:auto}._9IQa7q_library-label{color:var(--text-primary);padding:1.5rem calc(.5rem + var(--space)).5rem;font-weight:800}._9IQa7q_about-version-content{width:300px}._9IQa7q_about-version-row{margin:var(--space)0;justify-content:space-between;display:flex}");var M={link:"_9IQa7q_link",deleteMenuItem:"_9IQa7q_delete-menu-item",aboutVersionRow:"_9IQa7q_about-version-row",footerItem:"_9IQa7q_footer-item",viewAll:"_9IQa7q_view-all",gettingStarted:"_9IQa7q_getting-started",footer:"_9IQa7q_footer",libraryLabel:"_9IQa7q_library-label",libraryGrid:"_9IQa7q_library-grid",homeWrapper:"_9IQa7q_home-wrapper",aboutVersionContent:"_9IQa7q_about-version-content"};import{Text as Br}from"@blockcode/core";var Mr="./assets/arcade-rd4cktbf.png";var qr="./assets/arcade-bg-fajmd34e.jpg";import{jsx as Er}from"preact/jsx-runtime";function ui(e){return{title:Er(Br,{id:"gui.home.slideshow.arcade.title",defaultMessage:"The Tank War is coming! Join us! NOW!"}),backgroundImage:qr,featureImage:Mr,buttonText:Er(Br,{id:"gui.home.slideshow.arcade.button",defaultMessage:"Play now"}),onClick:()=>e("@blockcode/gui-arcade")}}import{Text as Lr}from"@blockcode/core";var Zr="./assets/desktop-s3hfwbpz.png";var Qr="./assets/desktop-bg-pqrd17t9.jpg";import{jsx as Fr}from"preact/jsx-runtime";var $r={title:Fr(Lr,{id:"gui.home.slideshow.desktop.title",defaultMessage:"The desktop application is here!"}),backgroundImage:Qr,featureImage:Zr,buttonText:Fr(Lr,{id:"gui.home.slideshow.desktop.button",defaultMessage:"Download"}),onClick:()=>window.open("//app.blockcode.fun/#/?id=download")};function mi(e,r){return[$r,ui(e)]}async function gi(e){let r=await fetch("https://hub.blockcode.fun/home.json").then((i)=>i.json());return Promise.all(r.filter((i)=>i.editor?e.find((t)=>t.id===i.editor):!0).map(async(i)=>{let t=e.find((a)=>a.id===i.editor),o=await fetch(`https://hub.blockcode.fun/${i.import}`).then((a)=>a.json());return{name:t?.name,examples:o.filter((a)=>e.find((n)=>n.id===a.editor)).map((a)=>({...a,file:`https://hub.blockcode.fun/${a.file}`,thumb:`https://hub.blockcode.fun/${a.thumb}`}))}}))}function j(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Ar(e,r){var i="",t=0,o=-1,a=0,n;for(var c=0;c<=e.length;++c){if(c<e.length)n=e.charCodeAt(c);else if(n===47)break;else n=47;if(n===47){if(o===c-1||a===1);else if(o!==c-1&&a===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var m=i.lastIndexOf("/");if(m!==i.length-1){if(m===-1)i="",t=0;else i=i.slice(0,m),t=i.length-1-i.lastIndexOf("/");o=c,a=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=c,a=0;continue}}if(r){if(i.length>0)i+="/..";else i="..";t=2}}else{if(i.length>0)i+="/"+e.slice(o+1,c);else i=e.slice(o+1,c);t=c-o-1}o=c,a=0}else if(n===46&&a!==-1)++a;else a=-1}return i}function Wa(e,r){var i=r.dir||r.root,t=r.base||(r.name||"")+(r.ext||"");if(!i)return t;if(i===r.root)return i+t;return i+e+t}function Be(){var e="",r=!1,i;for(var t=arguments.length-1;t>=-1&&!r;t--){var o;if(t>=0)o=arguments[t];else{if(i===void 0)i=process.cwd();o=i}if(j(o),o.length===0)continue;e=o+"/"+e,r=o.charCodeAt(0)===47}if(e=Ar(e,!r),r)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function xr(e){if(j(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;if(e=Ar(e,!r),e.length===0&&!r)e=".";if(e.length>0&&i)e+="/";if(r)return"/"+e;return e}function Da(e){return j(e),e.length>0&&e.charCodeAt(0)===47}function Ia(){if(arguments.length===0)return".";var e;for(var r=0;r<arguments.length;++r){var i=arguments[r];if(j(i),i.length>0)if(e===void 0)e=i;else e+="/"+i}if(e===void 0)return".";return xr(e)}function Pa(e,r){if(j(e),j(r),e===r)return"";if(e=Be(e),r=Be(r),e===r)return"";var i=1;for(;i<e.length;++i)if(e.charCodeAt(i)!==47)break;var t=e.length,o=t-i,a=1;for(;a<r.length;++a)if(r.charCodeAt(a)!==47)break;var n=r.length,c=n-a,m=o<c?o:c,l=-1,g=0;for(;g<=m;++g){if(g===m){if(c>m){if(r.charCodeAt(a+g)===47)return r.slice(a+g+1);else if(g===0)return r.slice(a+g)}else if(o>m){if(e.charCodeAt(i+g)===47)l=g;else if(g===0)l=0}break}var B=e.charCodeAt(i+g),f=r.charCodeAt(a+g);if(B!==f)break;else if(B===47)l=g}var b="";for(g=i+l+1;g<=t;++g)if(g===t||e.charCodeAt(g)===47)if(b.length===0)b+="..";else b+="/..";if(b.length>0)return b+r.slice(a+l);else{if(a+=l,r.charCodeAt(a)===47)++a;return r.slice(a)}}function Ra(e){return e}function pi(e){if(j(e),e.length===0)return".";var r=e.charCodeAt(0),i=r===47,t=-1,o=!0;for(var a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!o){t=a;break}}else o=!1;if(t===-1)return i?"/":".";if(i&&t===1)return"//";return e.slice(0,t)}function Sa(e,r){if(r!==void 0&&typeof r!=="string")throw TypeError('"ext" argument must be a string');j(e);var i=0,t=-1,o=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var n=r.length-1,c=-1;for(a=e.length-1;a>=0;--a){var m=e.charCodeAt(a);if(m===47){if(!o){i=a+1;break}}else{if(c===-1)o=!1,c=a+1;if(n>=0)if(m===r.charCodeAt(n)){if(--n===-1)t=a}else n=-1,t=c}}if(i===t)t=c;else if(t===-1)t=e.length;return e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){i=a+1;break}}else if(t===-1)o=!1,t=a+1;if(t===-1)return"";return e.slice(i,t)}}function Ua(e){j(e);var r=-1,i=0,t=-1,o=!0,a=0;for(var n=e.length-1;n>=0;--n){var c=e.charCodeAt(n);if(c===47){if(!o){i=n+1;break}continue}if(t===-1)o=!1,t=n+1;if(c===46){if(r===-1)r=n;else if(a!==1)a=1}else if(r!==-1)a=-1}if(r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1)return"";return e.slice(r,t)}function Xa(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Wa("/",e)}function Ta(e){j(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,o;if(t)r.root="/",o=1;else o=0;var a=-1,n=0,c=-1,m=!0,l=e.length-1,g=0;for(;l>=o;--l){if(i=e.charCodeAt(l),i===47){if(!m){n=l+1;break}continue}if(c===-1)m=!1,c=l+1;if(i===46){if(a===-1)a=l;else if(g!==1)g=1}else if(a!==-1)g=-1}if(a===-1||c===-1||g===0||g===1&&a===c-1&&a===n+1){if(c!==-1)if(n===0&&t)r.base=r.name=e.slice(1,c);else r.base=r.name=e.slice(n,c)}else{if(n===0&&t)r.name=e.slice(1,a),r.base=e.slice(1,c);else r.name=e.slice(n,a),r.base=e.slice(n,c);r.ext=e.slice(a,c)}if(n>0)r.dir=e.slice(0,n-1);else if(t)r.dir="/";return r}var Ha="/",Na=":",q2=((e)=>(e.posix=e,e))({resolve:Be,normalize:xr,isAbsolute:Da,join:Ia,relative:Pa,_makeLong:Ra,dirname:pi,basename:Sa,extname:Ua,format:Xa,parse:Ta,sep:Ha,delimiter:Na,win32:null,posix:null});function Ee(){let e=window.electron?.getLocalEditors()??[];return Promise.all([].concat(Object.values(e).map(async(r)=>{let{default:i}=await import(r.info);return i.id=r.id,i.image=Be(pi(r.info),i.image),i}),["@yeqin/gui-tankwar","@blockcode/gui-arcade2","@blockcode/gui-arcade","@blockcode/gui-microbit","@blockcode/gui-esp32","@blockcode/gui-arduino","@blockcode/gui-writer","@blockcode/gui-iotbit","@blockcode/gui-matrix"].map(async(r)=>{let{default:i}=await import(`${r}/info`);return i.id=r,i})))}import{jsx as h,jsxs as R,Fragment as fi}from"preact/jsx-runtime";function Wr({onOpenEditor:e,onOpenProject:r}){let i=Math.floor((document.body.clientWidth-20)/176),t=Math.floor((document.body.clientWidth-20)/236)*2,o=He(null),a=He(0),n=He(null),c=He(null),m=Ze(async()=>{let u=await Va();Oa(()=>{a.value=u.length,o.value=u.filter((s,v)=>v<i)})},[]);za(m,[]);let l=Ze((u,s)=>{si({title:h(F,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:h(F,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:di(s??h(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(v)=>{if(v?.name)await Ka(u,v.name),m()}})},[]),g=Ze(async(u)=>{await Ya(u),m()},[]),B=Ze((u,s)=>{si({title:h(F,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:h(F,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:di(s||h(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await ja(u),m()}})},[]),f=Ze((u)=>async()=>{let s=await Ja(u);r(s)},[r]),b=()=>{return o.value?.map((u)=>h(tt,{menuItems:[[{label:h(F,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>l(u.key,u.name)},{label:h(F,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>g(u.key)}],[{label:h(F,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:M.deleteMenuItem,onClick:()=>B(u.key,u.name)}]],children:h(hi,{id:u.key,name:u.name||h(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}),image:u.thumb,onSelect:f(u.key)})},u.key))};return Ga(async()=>{let u=await Ee();u=u.map((s)=>Object.assign(s,{beta:s.beta||!1,disabled:s.disabled||s.beta,onSelect:()=>e(s.id)})),u=u.filter((s)=>{if(s.hidden)return!1;if(s.disabled)return!1;return!0}),n.value=u.sort((s,v)=>s.sortIndex-v.sortIndex),c.value=await gi(u)}),R("div",{className:M.homeWrapper,children:[h(yr,{className:M.gettingStarted,pages:mi(e,r)}),o.value?.length>0&&R(fi,{children:[R("div",{className:M.libraryLabel,children:[h("span",{children:h(F,{id:"gui.home.my",defaultMessage:"My projects"})}),a.value>i&&h("span",{className:Qe(M.viewAll,M.link),onClick:at,children:h(F,{id:"gui.home.allCounts",defaultMessage:"View all ({counts})",counts:a.value})})]}),h("div",{className:M.libraryGrid,children:h(b,{})})]}),n.value?.length>0&&R(fi,{children:[h("div",{className:M.libraryLabel,children:h(F,{id:"gui.home.new",defaultMessage:"Create new project"})}),h("div",{className:M.libraryGrid,children:n.value.map((u,s)=>h(hi,{featured:!0,id:s,disabled:u.disabled,beta:u.beta||u.preview,image:u.image,name:u.name,description:u.description,collaborator:u.collaborator,blocksRequired:u.blocksRequired,micropythonRequired:u.micropythonRequired,clangRequired:u.clangRequired,onSelect:u.onSelect},s))})]}),c.value?.map((u)=>u.examples.length>0&&R(fi,{children:[R("div",{className:M.libraryLabel,children:[h("span",{children:h(F,{id:"gui.home.examples",defaultMessage:"Wonderful {label} examples",label:di(u.name)})}),u.examples.length>t&&h("span",{className:Qe(M.viewAll,M.link),children:h(F,{id:"gui.home.all",defaultMessage:"View all"})})]}),h("div",{className:M.libraryGrid,children:u.examples.map((s,v)=>h(hi,{large:!0,id:v,name:s.name,author:s.author,copyright:s.copyright,image:s.thumb,onSelect:async()=>{it("importing",{id:s.name});let Q=await et(s.file);rt(s.name),r(Q)}}))})]})),R("div",{className:M.footer,children:[h("span",{className:Qe(M.footerItem,M.link),onClick:()=>window.open("https://lab.blockcode.fun/","_blank"),children:"BlockCode Lab"}),h("span",{className:Qe(M.footerItem,M.link),onClick:()=>window.open("https://github.com/BlockCodeLab/playgrounds-app","_blank"),children:"GitHub"}),R("span",{className:Qe(M.footerItem,M.link),onClick:()=>{si({title:h(F,{id:"gui.about.title",defaultMessage:"About..."}),body:R("div",{className:M.aboutVersionContent,children:[R("div",{className:M.aboutVersionRow,children:[h("div",{children:h("b",{children:h(F,{id:"gui.about.main",defaultMessage:"Main program"})})}),R("div",{children:["v",ci]})]}),h("div",{className:M.aboutVersionRow}),n.value.filter((u)=>!u.disabled).map((u)=>R("div",{className:M.aboutVersionRow,children:[h("div",{children:h("b",{children:u.name})}),R("div",{children:["v",u.version]})]}))]})})},children:["v",ci]})]})]})}import{useEffect as Zt}from"preact/hooks";import{classNames as Fe,isMac as Qt}from"@blockcode/utils";import{useLocalesContext as Lt,useAppContext as Ft,setLanguage as $t,translate as zr,setMacosMenuBarStyled as At}from"@blockcode/core";import{Menu as Or,MenuItem as xt}from"@blockcode/core";import{cloneElement as mt}from"preact";import{useMemo as gt}from"preact/hooks";import{flatChildren as pt}from"@blockcode/utils";var Dr=Object.create(null),bi=document.createElement("div"),Ir=document.createElement("style");document.body.insertBefore(Ir,document.body.firstChild);var ot=(e)=>{return bi.style="",Object.entries(e).forEach(([r,i])=>bi.style[r]=i),bi.style.cssText},nt=()=>{Ir.textContent=Object.entries(Dr).map(([e,r])=>`${e}{${ot(r)}}`).join(`
`)};function ae(e){Object.assign(Dr,e),nt()}import{Menu as dt}from"@blockcode/core";import{useCallback as vi}from"preact/hooks";import{classNames as lt}from"@blockcode/utils";import{jsx as Pr,jsxs as ut,Fragment as ct}from"preact/jsx-runtime";function Le({id:e,className:r,checked:i,children:t,name:o}){let a=vi((m)=>{let l=()=>{m.target.checked=!1,document.removeEventListener("click",l)};document.addEventListener("click",l)},[]),n=vi((m)=>{let l=m.getBoundingClientRect().left;ae({[`#${e}-menu-${o}`]:{left:`${l}px`}})},[e,o]),c=vi((m)=>{if(m.target.classList.contains(p.menuLabel))n(m.target);else n(m.target.parentElement)},[]);return ut(ct,{children:[Pr("input",{checked:i,className:p.menuLabel,id:`${e}-label-${o}`,name:`${e}-menu`,type:"radio",value:o,onChange:a}),Pr("label",{className:lt(p.menuLabel,r),for:`${e}-label-${o}`,onClick:c,children:t})]})}import{jsxs as ht,Fragment as st}from"preact/jsx-runtime";function Rr({id:e,children:r}){let i=gt(()=>pt(r).map((t)=>t&&mt(t,{id:e})),[e,r]);return ht(st,{children:[i.filter((t)=>t.type===Le),i.filter((t)=>t.type===dt).map((t)=>{let o=`${e}-label-${t.props.name}`,a=`${e}-menu-${t.props.name}`;return ae({[`#${o}:checked~#${a}`]:{display:"block"}}),t})]})}import{classNames as bt}from"@blockcode/utils";import{Text as vt}from"@blockcode/core";var Ne="./assets/icon-tutorials-bh6n0ck2.svg";import{jsx as ki,jsxs as Sr,Fragment as kt}from"preact/jsx-runtime";function Ur({onClick:e}){return Sr(kt,{children:[ki("div",{className:p.divider}),Sr("div",{className:bt(p.menuBarItem,p.menuLabel,p.hoverable),onClick:e,children:[ki("img",{className:p.tutorialsIcon,src:Ne}),ki(vt,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]})]})}import{useProjectContext as wt,BufferedInput as _t,renameProject as Ct}from"@blockcode/core";import{jsx as wi,jsxs as Mt,Fragment as yt}from"preact/jsx-runtime";function Xr({placeholder:e,defaultValue:r}){let{name:i}=wt();return Mt(yt,{children:[wi("div",{className:p.divider}),wi("div",{className:p.menuBarItem,children:wi(_t,{className:p.titleField,placeholder:e,value:i.value||r,onSubmit:Ct})})]})}var Tr="./assets/icon-language-3wan1389.svg";var Hr="./assets/icon-dropdown-caret-y4j91xc6.svg";var Nr="./assets/icon-home-jt8mdkv3.svg";import{jsx as T,jsxs as ne,Fragment as Wt}from"preact/jsx-runtime";function Gr({className:e,showHomeButton:r,onRequestHome:i,onOpenTutorialLibrary:t}){let{language:o,languageNames:a}=Lt(),{menuItems:n,tutorials:c,macosMenuBarStyled:m}=Ft();return Zt(()=>{window.electron?.onChangeFullscreen((l)=>At(Qt&&!l))},[]),ne("div",{className:Fe(p.menuBar,e),children:[ne("div",{className:Fe(p.mainMenu,{[p.electron]:m.value}),children:[ne(Rr,{id:p.mainMenu,children:[ne(Le,{className:Fe(p.menuBarItem,p.languageLabel),name:"language-selector",children:[T("img",{className:p.languageIcon,src:Tr}),T("img",{src:Hr})]}),T(Or,{className:p.menu,name:"language-selector",children:Array.from(a.entries()).map(([l,g])=>ne(xt,{className:p.menuItem,onClick:()=>$t(l),children:[T("img",{className:Fe(p.checkIcon,{[p.checked]:o.value===l}),src:ge}),g.languageName]},l))}),n.value&&n.value.map(({icon:l,label:g,Menu:B},f)=>ne(Wt,{children:[ne(Le,{className:p.menuBarItem,name:f,children:[typeof l==="string"?T("img",{src:l}):l,g]},f),T(Or,{className:p.menu,name:f,children:T(B,{itemClassName:p.menuItem})},f)]}))]}),c.value&&T(Ur,{onClick:t}),r&&T(Xr,{placeholder:zr("gui.menubar.titlePlaceholder","Project title here"),defaultValue:zr("gui.project.name","BlockCode Project")})]}),T("div",{className:p.rightMenu,children:r&&T("div",{className:Fe(p.menuBarItem,p.hoverable),onClick:i,children:T("img",{className:p.homeIcon,src:Nr})})})]})}import{classNames as Dt}from"@blockcode/utils";C(".fflkNG_pane-wrapper{flex-direction:column;display:flex;position:relative}.fflkNG_pane{display:none}.fflkNG_pane-header{background:var(--ui-white);padding:calc(var(--space)/2);text-align:center;color:var(--text-primary);cursor:pointer;border:1px solid var(--ui-black-transparent);border-radius:var(--space)var(--space)0 0;flex:1;font-size:.85rem}.fflkNG_pane-left .fflkNG_pane-header{border-top-left-radius:0}.fflkNG_pane-right .fflkNG_pane-header{border-top-right-radius:0}.fflkNG_pane-content{border-left:1px solid var(--ui-black-transparent);border-right:1px solid var(--ui-black-transparent);min-height:5.5rem;display:none;position:relative}.fflkNG_pane-left .fflkNG_pane-content{border-left:0}.fflkNG_pane-right .fflkNG_pane-content{border-right:0}.fflkNG_pane:checked~.fflkNG_pane-content{display:flex}");var le={paneHeader:"fflkNG_pane-header",paneWrapper:"fflkNG_pane-wrapper",paneRight:"fflkNG_pane-right",paneContent:"fflkNG_pane-content",paneLeft:"fflkNG_pane-left",pane:"fflkNG_pane"};import{jsx as _i,jsxs as It}from"preact/jsx-runtime";function Vr({className:e,id:r,title:i,left:t,right:o,children:a}){return It("div",{className:Dt(le.paneWrapper,e,{[le.paneLeft]:t,[le.paneRight]:o}),children:[_i("input",{id:`${r}-pane`,type:"checkbox",className:le.pane}),_i("label",{className:le.paneHeader,for:`${r}-pane`,children:i}),_i("div",{className:le.paneContent,children:a})]})}import{classNames as Jr}from"@blockcode/utils";import{maybeTranslate as Pt,Text as Ci,Button as yi,Modal as Rt}from"@blockcode/core";C(".ulcaFG_prompt-modal{width:360px}.ulcaFG_prompt-modal.ulcaFG_wide{width:600px}.ulcaFG_prompt-modal.ulcaFG_auto{width:auto;max-width:60vw}.ulcaFG_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.ulcaFG_label{margin:0 0 1.5rem;font-weight:500}.ulcaFG_label.ulcaFG_input-label{margin-bottom:.75rem}.ulcaFG_content{font-size:var(--standard-font-size);color:var(--text-primary);max-height:400px;margin-bottom:1.5rem;overflow:auto}.ulcaFG_content a{color:var(--theme-primary);border-bottom:1px solid;text-decoration-line:none}.ulcaFG_text-input{border:1px solid var(--ui-black-transparent);width:100%;height:3rem;color:var(--text-primary);border-radius:5px;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.ulcaFG_button-row{text-align:right;font-weight:bolder}.ulcaFG_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.ulcaFG_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var q={inputLabel:"ulcaFG_input-label",auto:"ulcaFG_auto",label:"ulcaFG_label",textInput:"ulcaFG_text-input",promptModal:"ulcaFG_prompt-modal",content:"ulcaFG_content",buttonRow:"ulcaFG_button-row",button:"ulcaFG_button",promptContent:"ulcaFG_prompt-content",wide:"ulcaFG_wide",okButton:"ulcaFG_ok-button"};import{useCallback as St}from"preact/hooks";import{jsx as O,jsxs as Yr,Fragment as Ut}from"preact/jsx-runtime";function Kr({title:e,label:r,content:i,redStyle:t,children:o,onClose:a,onSubmit:n}){let c=St(()=>{n(),a()},[a,n]);return O(Rt,{title:e,redStyle:t,className:Jr(q.promptModal,{[q.wide]:i,[q.auto]:o}),onClose:a,children:Yr("div",{className:q.promptContent,children:[r&&O("div",{className:q.label,children:r}),i?O("div",{className:q.content,dangerouslySetInnerHTML:{__html:Pt(i)}}):O("div",{className:q.content,children:o}),O("div",{className:q.buttonRow,children:n?Yr(Ut,{children:[O(yi,{className:q.button,onClick:a,children:O(Ci,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),O(yi,{className:Jr(q.button,q.okButton),onClick:c,children:O(Ci,{id:"gui.prompt.ok",defaultMessage:"OK"})})]}):O(yi,{className:q.button,onClick:a,children:O(Ci,{id:"gui.prompt.close",defaultMessage:"Close"})})})]})})}import{useCallback as Mi,useEffect as Xt}from"preact/hooks";import{useSignal as Tt}from"@preact/signals";import{classNames as jr}from"@blockcode/utils";import{maybeTranslate as e1,Text as i1,BufferedInput as Ht,Button as r1,Modal as Nt}from"@blockcode/core";import{jsx as te,jsxs as qi,Fragment as zt}from"preact/jsx-runtime";function a1({title:e,inputItems:r,content:i,onClose:t,onSubmit:o}){let a=Tt(Object.fromEntries(r.map(({name:l,defaultValue:g})=>[l,g]))),n=Mi((l)=>{if(l.stopPropagation(),l.key==="Escape")t()},[t]),c=Mi(()=>{o(a.value),t()},[t,o]),m=Mi((l)=>(g)=>{a.value={...a.value,[l]:g}},[]);return Xt(()=>{return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),te(Nt,{title:e,className:q.promptModal,onClose:t,children:qi("div",{className:q.promptContent,children:[r.map(({name:l,label:g,placeholder:B,defaultValue:f},b)=>qi(zt,{children:[g&&te("div",{className:jr(q.label,q.inputLabel),children:g}),te(Ht,{autoFocus:b===0,className:q.textInput,placeholder:e1(B),defaultValue:f,onSubmit:m(l)},b)]})),i&&te("div",{className:q.content,dangerouslySetInnerHTML:{__html:e1(i)}}),qi("div",{className:q.buttonRow,children:[te(r1,{className:q.button,onClick:t,children:te(i1,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),te(r1,{className:jr(q.button,q.okButton),onClick:c,children:te(i1,{id:"gui.prompt.ok",defaultMessage:"OK"})})]})]})})}import{classNames as Ot}from"@blockcode/utils";import{Text as Bi,Spinner as Gt}from"@blockcode/core";C(".LkfKFW_splash{background:var(--theme-primary);z-index:var(--z-index-modal);flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute;inset:0}.LkfKFW_spinner{margin-bottom:calc(4*var(--space))}.LkfKFW_error{background:var(--error-primary)}.LkfKFW_title{color:var(--ui-white);margin:var(--space);font-size:2rem}.LkfKFW_label{color:var(--ui-white);margin:var(--space)}");var he={error:"LkfKFW_error",label:"LkfKFW_label",title:"LkfKFW_title",spinner:"LkfKFW_spinner",splash:"LkfKFW_splash"};import{jsx as fe,jsxs as Vt}from"preact/jsx-runtime";function t1({error:e}){return Vt("div",{className:Ot(he.splash,{[he.error]:e}),children:[!e&&fe(Gt,{large:!0,level:"info",className:he.spinner}),fe("div",{className:he.title,children:e?fe(Bi,{id:"gui.splash.errorTitle",defaultMessage:"Error Occurred"}):fe(Bi,{id:"gui.splash.loading",defaultMessage:"Loading project..."})}),fe("div",{className:he.label,children:e&&fe(Bi,{id:"gui.splash.errorLabel",defaultMessage:"Please refresh the page and reopen it."})})]})}import{cloneElement as io}from"preact";import{useMemo as ro}from"preact/hooks";import{classNames as ao,flatChildren as to}from"@blockcode/utils";import{classNames as Jt}from"@blockcode/utils";C(".M5TDuW_tabs-wrapper{white-space:nowrap;position:relative}.M5TDuW_tab-label{--line-height:calc(var(--tool-bar-height)*.8 - 2px);--margin-top:calc(var(--tool-bar-height)*.2 + 1px);font-weight:500;font-size:var(--standard-font-size);line-height:var(--line-height);border:1px solid var(--ui-black-transparent);background:var(--ui-tertiary);color:var(--text-transparent);margin-top:var(--margin-top);white-space:nowrap;border-radius:1rem 1rem 0 0;justify-content:center;padding:0 1.25rem;display:inline-flex;position:relative}.M5TDuW_tab-label.M5TDuW_disabled{filter:opacity(.5);cursor:default;pointer-events:none}.M5TDuW_tab-label:nth-of-type(n+2){margin-left:calc(-1*var(--space))}.M5TDuW_tab-label:last-of-type{margin-right:var(--space)}.M5TDuW_tab-label:not(.M5TDuW_disabled):hover{cursor:pointer;background:var(--ui-primary)}.M5TDuW_tab-label img{filter:grayscale();width:1.375rem}.M5TDuW_tab{display:none}.M5TDuW_tab:checked+.M5TDuW_tab-label{--scale:var(--space)/2;line-height:calc(var(--line-height) + var(--scale));margin-top:calc(var(--margin-top) - var(--scale));color:var(--theme-primary);background:var(--ui-white)}.M5TDuW_tab:checked+.M5TDuW_tab-label img{filter:none}.M5TDuW_tab-panel{top:var(--tool-bar-height);width:100%;height:calc(100% - var(--tool-bar-height));border:1px solid var(--ui-black-transparent);border-radius:0 var(--space)var(--space)var(--space);flex-direction:column;display:flex;position:absolute;bottom:0;transform:translateY(200%)}");var G={tabPanel:"M5TDuW_tab-panel",tabLabel:"M5TDuW_tab-label",tab:"M5TDuW_tab",tabsWrapper:"M5TDuW_tabs-wrapper",disabled:"M5TDuW_disabled"};import{jsx as o1,jsxs as Kt,Fragment as Yt}from"preact/jsx-runtime";function ze({id:e,className:r,disabled:i,checked:t,children:o,name:a,onSelect:n}){return Kt(Yt,{children:[o1("input",{disabled:i,checked:t,className:G.tab,id:`${e}-tab-${a}`,name:`${e}-tab`,type:"radio",value:a}),o1("label",{className:Jt(G.tabLabel,r,{[G.disabled]:i}),for:`${e}-tab-${a}`,onClick:n,children:o})]})}import{classNames as jt}from"@blockcode/utils";import{jsx as eo}from"preact/jsx-runtime";function Oe({id:e,className:r,name:i,children:t}){return eo("div",{className:jt(G.tabPanel,r),id:`${e}-panel-${i}`,children:t})}import{jsxs as oo}from"preact/jsx-runtime";function n1({id:e,className:r,children:i}){let t=ro(()=>to(i).filter((o)=>o).map((o)=>io(o,{id:e})),[e,i]);return ae({[`.${G.tab}:checked+.${G.tabLabel}`]:{zIndex:`${t.length+1}`}}),oo("div",{className:ao(G.tabsWrapper,r),children:[t.filter((o)=>o.type===ze).map((o,a,n)=>{return ae({[`.${G.tabLabel}:nth-of-type(${a+1})`]:{zIndex:`${n.length-a}`}}),o}),t.filter((o)=>o.type===Oe).map((o)=>{let a=`${e}-tab-${o.props.name}`,n=`${e}-panel-${o.props.name}`;return ae({[`#${a}:checked~#${n}`]:{transform:"none"}}),o})]})}import{useRef as mo,useEffect as m1,useCallback as Zi}from"preact/hooks";import{batch as go,useComputed as po,useSignal as Qi}from"@preact/signals";import{classNames as so}from"@blockcode/utils";import{useAppContext as ho,Text as be,Button as fo}from"@blockcode/core";C("._4EOxpW_tutorial-box-wrapper{pointer-events:auto;z-index:var(--z-index-card);min-width:468px;position:absolute;bottom:10%;left:50%;transform:translate(-50%)}._4EOxpW_tutorial-card{border:1px solid var(--ui-tertiary);border-radius:calc(var(--space)*1.8);cursor:move;box-shadow:0px 5px 25px 5px var(--ui-black-transparent);z-index:20;flex-direction:column;align-items:center;display:flex;overflow:hidden}._4EOxpW_card-header{background:var(--blocks-primary);width:100%;font-size:var(--small-font-size);flex-direction:row;justify-content:space-between;align-items:center;font-weight:700;display:flex}._4EOxpW_header-button-group{flex-direction:row;display:flex}._4EOxpW_header-button{cursor:pointer;color:#fff;flex-direction:column;justify-content:center;align-items:center;padding:.75rem;display:flex}._4EOxpW_header-button:hover{background:var(--ui-black-transparent)}._4EOxpW_button-icon{border:0;height:1.25rem}._4EOxpW_step-list{flex-direction:row;justify-content:center;align-items:center;display:flex}._4EOxpW_step-pip{cursor:pointer;background:var(--ui-white-transparent);border-radius:100%;width:.5rem;height:.5rem;margin:0 .25rem}._4EOxpW_step-pip._4EOxpW_actived{background:var(--ui-white);-webkit-box-shadow:0px 0px 0px 2px var(--ui-black-transparent);box-shadow:0px 0px 0px 2px var(--ui-black-transparent)}._4EOxpW_card-body{background:var(--ui-white);border-top:1px solid var(--blocks-tertiary);text-align:center;width:100%;min-height:256px;color:var(--text-primary);flex-direction:column;justify-content:center;align-items:center;display:flex;position:relative}._4EOxpW_title{text-align:center;margin:.9rem;font-size:.9rem;font-weight:700}._4EOxpW_image{object-fit:contain;background:var(--ui-secondary);border-radius:var(--space);max-width:450px;max-height:200px;margin:0 var(--space)var(--space);overflow:hidden}._4EOxpW_text{max-width:450px;height:200px;margin:0 var(--space)2.7rem var(--space);flex-direction:column;justify-content:center;font-size:1rem;display:flex}._4EOxpW_image+._4EOxpW_text{height:auto}._4EOxpW_more{padding:0 .9rem var(--space);flex-direction:row;justify-content:space-around;display:flex}._4EOxpW_more-item{margin:0 var(--space)var(--space);cursor:pointer;border-radius:var(--space);border:1px solid #00000026;flex-direction:column;display:flex;overflow:hidden}._4EOxpW_more-item-image{object-fit:cover;width:200px;height:100px}._4EOxpW_more-item-name{color:var(--theme-primary);margin:calc(var(--space)*1.2)0px;text-align:center;text-align:center;max-width:200px;font-size:.85rem;font-weight:700}._4EOxpW_see-more-button{background:var(--theme-primary);color:var(--ui-white);border:0;margin-bottom:2.7rem}._4EOxpW_left-page,._4EOxpW_right-page{background:var(--ui-white);border:1px solid var(--ui-black-transparent);height:90%;width:calc(var(--space)*1.8);opacity:.9;z-index:10;position:absolute;top:5%;overflow:hidden}._4EOxpW_left-page:after,._4EOxpW_right-page:after{content:\"\";background:var(--blocks-primary);width:100%;height:2.5rem;position:absolute;top:0;left:0}._4EOxpW_left-button,._4EOxpW_right-button{user-select:none;cursor:pointer;background:var(--blocks-primary);box-shadow:0 0 0 4px var(--blocks-transparent);z-index:30;border-radius:100%;justify-content:center;align-items:center;width:44px;height:44px;margin-top:-15px;transition:all .25s;display:flex;position:absolute;top:50%}._4EOxpW_left-button:hover,._4EOxpW_right-button:hover{box-shadow:0 0 0 6px var(--blocks-transparent);transform:scale(1.125)}._4EOxpW_left-button img,._4EOxpW_right-button img{width:1.75rem}._4EOxpW_left-page{border-top-left-radius:calc(var(--space)*1.8);border-bottom-left-radius:calc(var(--space)*1.8);border-right:0;left:0;transform:translate(-100%)}._4EOxpW_left-button{left:-27px}._4EOxpW_right-page{border-top-right-radius:calc(var(--space)*1.8);border-bottom-right-radius:calc(var(--space)*1.8);border-left:0;right:0;transform:translate(100%)}._4EOxpW_right-button{right:-27px}._4EOxpW_right-button img{transform:rotateY(180deg)}");var w={buttonIcon:"_4EOxpW_button-icon",headerButton:"_4EOxpW_header-button",leftPage:"_4EOxpW_left-page",stepPip:"_4EOxpW_step-pip",cardHeader:"_4EOxpW_card-header",stepList:"_4EOxpW_step-list",cardBody:"_4EOxpW_card-body",moreItemImage:"_4EOxpW_more-item-image",text:"_4EOxpW_text",moreItemName:"_4EOxpW_more-item-name",tutorialCard:"_4EOxpW_tutorial-card",title:"_4EOxpW_title",image:"_4EOxpW_image",moreItem:"_4EOxpW_more-item",actived:"_4EOxpW_actived",more:"_4EOxpW_more",rightPage:"_4EOxpW_right-page",leftButton:"_4EOxpW_left-button",rightButton:"_4EOxpW_right-button",headerButtonGroup:"_4EOxpW_header-button-group",tutorialBoxWrapper:"_4EOxpW_tutorial-box-wrapper",seeMoreButton:"_4EOxpW_see-more-button"};var l1="./assets/icon-shrink-8vdqegra.svg";var c1="./assets/icon-expand-67bgdn61.svg";var u1="./assets/icon-close-dy7x7fdb.svg";var Ei="./assets/icon-arrow-ddhj68kd.svg";import{jsx as y,jsxs as S,Fragment as $e}from"preact/jsx-runtime";function g1({tutorialId:e,onOpenTutorial:r,onBack:i,onClose:t}){let o=mo(),{tutorials:a}=ho(),n=Qi(null),c=Qi(-1),m=Qi(!0),l=po(()=>n.value?.[c.value]),g=Zi(()=>{c.value=(c.value+1)%n.value.length},[]),B=Zi(()=>{c.value=(c.value-1)%n.value.length},[]);return m1(()=>{let f=a.value.lessons[e];if(!f){t();return}go(()=>{n.value=[].concat(f.pages,f.next?{next:f.next.filter((b)=>a.value.lessons[b]).map((b)=>({id:b,title:a.value.lessons[b].title,image:a.value.lessons[b].image}))}:[]),c.value=0})},[e]),m1(()=>{if(o.current){let f=o.current.parentElement,b,u,s=(Q)=>{let X=b-Q.clientX,D=u-Q.clientY;b=Q.clientX,u=Q.clientY,f.style.top=`${f.offsetTop-D}px`,f.style.left=`${f.offsetLeft-X}px`,f.style.bottom="unset"},v=()=>{document.removeEventListener("pointerup",v),document.removeEventListener("pointermove",s)};o.current.addEventListener("pointerdown",(Q)=>{b=Q.clientX,u=Q.clientY,s(Q),document.addEventListener("pointerup",v),document.addEventListener("pointermove",s)})}},[]),S("div",{className:w.tutorialBoxWrapper,children:[S("div",{ref:o,className:w.tutorialCard,children:[S("div",{className:w.cardHeader,children:[S("div",{className:w.headerButton,onClick:i,children:[y("img",{className:w.buttonIcon,src:Ne}),y(be,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]}),y("div",{className:w.stepList,children:n.value?.map((f,b)=>y("div",{className:so(w.stepPip,{[w.actived]:b===c.value}),onClick:()=>c.value=b},b))}),S("div",{className:w.headerButtonGroup,children:[y("div",{className:w.headerButton,onClick:Zi(()=>m.value=!m.value,[]),children:m.value?S($e,{children:[y("img",{className:w.buttonIcon,src:l1}),y(be,{id:"gui.tutorials.shrink",defaultMessage:"Shrink"})]}):S($e,{children:[y("img",{className:w.buttonIcon,src:c1}),y(be,{id:"gui.tutorials.expand",defaultMessage:"Expand"})]})}),S("div",{className:w.headerButton,onClick:t,children:[y("img",{className:w.buttonIcon,src:u1}),y(be,{id:"gui.tutorials.close",defaultMessage:"Close"})]})]})]}),m.value&&l.value&&S("div",{className:w.cardBody,children:[(l.value.title||l.value.next)&&y("div",{className:w.title,children:l.value.title||y(be,{id:"gui.tutorials.moreTry",defaultMessage:"More things to try!"})}),l.value.image&&y("img",{className:w.image,src:l.value.image}),l.value.text&&y("div",{className:w.text,children:l.value.text}),l.value.next&&S($e,{children:[y("div",{className:w.more,children:l.value.next.map((f)=>S("div",{className:w.moreItem,onClick:()=>r(f.id),children:[y("img",{className:w.moreItemImage,src:f.image}),y("div",{className:w.moreItemName,children:f.title})]},f.id))}),y(fo,{className:w.seeMoreButton,onClick:i,children:y(be,{id:"gui.tutorials.seeMore",defaultMessage:"See more"})})]})]})]}),m.value&&c.value>0&&S($e,{children:[y("div",{className:w.leftPage}),y("div",{className:w.leftButton,onClick:B,children:y("img",{src:Ei})})]}),m.value&&n.value&&c.value<n.value.length-1&&S($e,{children:[y("div",{className:w.rightPage}),y("div",{className:w.rightButton,onClick:g,children:y("img",{src:Ei})})]})]})}import{useComputed as bo}from"@preact/signals";import{useAppContext as vo,Text as ko,Library as wo}from"@blockcode/core";import{jsx as d1}from"preact/jsx-runtime";var _o=d1(ko,{id:"gui.library.tutorials.tutorial",defaultMessage:"Choose a tutorial"});function p1({onOpenTutorial:e,onClose:r}){let{tutorials:i}=vo(),t=bo(()=>{return Object.entries(i.value.lessons).map(([a,n])=>({title:n.title,image:n.image,tags:n.tags,onSelect:()=>e(a)}))});return d1(wo,{featured:!0,items:t.value,title:i.value.title||_o,filterable:i.value.tags,tags:i.value.tags,onClose:r})}import{useCallback as Ae,useEffect as Co}from"preact/hooks";import{useComputed as yo,useSignal as Mo}from"@preact/signals";import{getProjectsThumbs as qo,getProject as Bo,cloneProject as Eo,renameProject as Zo,delProject as Qo}from"@blockcode/utils";import{useProjectContext as Lo,closeUserStorage as h1,maybeTranslate as Li,openPromptModal as f1}from"@blockcode/core";import{Text as V,Library as Fo}from"@blockcode/core";C(".mLGZyG_delete-menu-item:hover{background:var(--error-primary)}");var s1={deleteMenuItem:"mLGZyG_delete-menu-item"};import{jsx as H}from"preact/jsx-runtime";var $o=30;function b1({onOpenProject:e}){let{meta:r}=Lo(),i=Mo([]),t=yo(()=>i.value.length),o=Ae((l,g)=>{f1({title:H(V,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:H(V,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:Li(g??H(V,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(B)=>{if(B?.name)await Zo(l,B.name),m()}})},[]),a=Ae(async(l)=>{await Eo(l),m()},[]),n=Ae((l,g)=>{f1({title:H(V,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:H(V,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:Li(g||H(V,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await Qo(l),m()}})},[]),c=Ae((l)=>async()=>{let g=await Bo(l);e(g),h1()},[]),m=Ae(async()=>{let l=await qo();if(r.value?.editor)l=l.filter((g)=>g.meta.editor===r.value.editor);l=l.sort((g,B)=>B.modifiedDate-g.modifiedDate),i.value=l.map((g)=>({name:Li(g.name??H(V,{id:"gui.project.shortname",defaultMessage:"Untitled"})),image:g.thumb,onSelect:c(g.key),contextMenu:[[{label:H(V,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>o(g.key,g.name)},{label:H(V,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>a(g.key)}],[{label:H(V,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:s1.deleteMenuItem,onClick:()=>n(g.key,g.name)}]]}))},[c,o,n]);return Co(()=>m(),[m]),H(Fo,{items:i.value,filterable:t.value>$o,emptyMessage:H(V,{id:"gui.library.projects.empty",defaultMessage:"No project!"}),onClose:h1})}C("._3HqakW_gui-wrapper{height:100%}._3HqakW_alerts-container{width:100%;z-index:var(--z-index-alerts);margin-top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;justify-content:center;display:flex;position:absolute}._3HqakW_menu-bar-position{z-index:var(--z-index-menu-bar);position:relative}._3HqakW_body-wrapper{height:calc(100% - var(--menu-bar-height));background:var(--ui-primary)}._3HqakW_body-wrapper *{box-sizing:border-box}._3HqakW_workspace-wrapper{flex-direction:row;height:100%;display:flex;overflow-y:hidden}._3HqakW_sidebar-wrapper{margin:0 var(--space);display:flex;position:relative}._3HqakW_editor-wrapper{flex-direction:column;flex-grow:1;flex-shrink:0;display:flex;position:relative}._3HqakW_tabs-wrapper{flex-grow:1;position:relative}._3HqakW_tab-panel-no-left{border-bottom-left-radius:0}._3HqakW_tab-panel-no-right{border-top-right-radius:0;border-bottom-right-radius:0}._3HqakW_tab-panel-no-bottom{border-bottom-right-radius:0;border-bottom-left-radius:0}._3HqakW_pane-wrapper{margin:var(--space)0 0 0;display:flex;position:relative}");var I={sidebarWrapper:"_3HqakW_sidebar-wrapper",editorWrapper:"_3HqakW_editor-wrapper",workspaceWrapper:"_3HqakW_workspace-wrapper",tabPanelNoLeft:"_3HqakW_tab-panel-no-left",bodyWrapper:"_3HqakW_body-wrapper",guiWrapper:"_3HqakW_gui-wrapper",alertsContainer:"_3HqakW_alerts-container",menuBarPosition:"_3HqakW_menu-bar-position",tabsWrapper:"_3HqakW_tabs-wrapper",tabPanelNoBottom:"_3HqakW_tab-panel-no-bottom",tabPanelNoRight:"_3HqakW_tab-panel-no-right",paneWrapper:"_3HqakW_pane-wrapper"};import{jsx as _,jsxs as We,Fragment as C1}from"preact/jsx-runtime";var we=Do({Bluetooth:null,SerialPort:null});function y1(){let[e]=Ao(),{language:r}=So(),i=Ro();Fi(()=>{document.title=Xo("gui.name","BlockCode Playgrounds")},[r.value]);let t=v1(()=>{let d={};return i.docks.value?.forEach((k)=>{if(k.expand==="bottom")d.paneLabel=k.label,d.PaneContent=k.Content;else if(k.expand==="left")d.LeftDockContent=k.Content;else d.RightDockContent=k.Content}),d}),{LeftDockContent:o,RightDockContent:a,PaneContent:n}=t.value,c=Wo({[I.tabPanelNoLeft]:!o,[I.tabPanelNoRight]:!a,[I.tabPanelNoBottom]:!n}),m=Ge(null);Fi(()=>{if($i)window.electron.serial.onScan((d)=>{m.value=d&&{devices:d,type:we.SerialPort}}),window.electron.bluetooth.onScan((d)=>{m.value=d&&{devices:d,type:we.Bluetooth}})},[]);let l=()=>{},g=U(()=>{if($i){if(m.value.type===we.SerialPort)window.electron.serial.cancel();if(m.value.type===we.Bluetooth)window.electron.bluetooth.cancel();m.value=null}},[]),B=U((d)=>{if($i){if(m.value.type===we.SerialPort)window.electron.serial.connect(d);if(m.value.type===we.Bluetooth)window.electron.bluetooth.connect(d)}},[]),f=Ge({});xo(async()=>{let d=await Ee();d=d.map((k)=>[k.id,{name:k.name,version:k.version}]),f.value=Object.fromEntries(d)});let b=U(()=>{ve(()=>{i.appState.value?.device?.disconnect(),xe("device",null),Go(),zo()})},[]),u=U((d)=>{ve(()=>{k1(),Oo(Object.assign(JSON.parse(JSON.stringify(d)),{fileId:d.fileId??d.files?.[0]?.id})),_1(0)})},[]),s=Ge(!1),v=Ge(null),Q=U(()=>{ve(()=>{v.value=null,s.value=!0})},[]),X=U((d)=>{let k=i.tutorials.value.lessons[d];ve(async()=>{if(k.project){Vo("importing",{id:d});let P=await Io(k.project);Jo(d),u(P)}v.value=d,s.value=!1})},[]),{meta:D,key:Ai,modified:xi}=Uo(),Wi=v1(()=>!D.value),M1=U(()=>{if(xi.value)Ve({title:_(ke,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(ke,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:b});else b()},[]),Je=U((d,k)=>{if(k!==d.meta.editor){Ve({label:_(ke,{id:"gui.library.projects.errorEditor",defaultMessage:'This project is not currently editor creation, please switch to "{editor}" and open it.',editor:To(f.value[d.meta.editor]?.name)}),redStyle:!0});return}if(Ai.value===d.key)return;if(xi.value)Ve({title:_(ke,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(ke,{id:"gui.library.projects.replace",defaultMessage:"Replace contents of the current project?"}),onSubmit:()=>u(d)});else u(d)},[]),Di=U(async(d,k)=>{ve(()=>{b(),k1()});let P=d,Pi=window.electron?.getLocalEditors();if(Pi?.[d]?.main)P=Pi[d].main;let ue;try{ue=(await import(P)).default}catch(an){Ve({label:_(ke,{id:"gui.library.projects.notFoundEditor",defaultMessage:'Not Found the "{editor}" Editor.',editor:d}),redStyle:!0}),Ho();return}let Ye={editor:d,version:f.value[d]?.version};if(!k)k=JSON.parse(JSON.stringify(await ue.onNew()));if(!k.meta)k.meta=Ye;if(!k.meta.editor)k.meta.editor=d,k.meta.version=Ye.version;let q1={menuItems:pr(ue,Ye,Je),tabs:ue.tabs,docks:ue.docks,tutorials:window.electron?.getLocalTutorials(d,r.value)??ue.tutorials};ve(()=>{No(q1),Je(k,d)})},[]),Ii=U((d)=>{if(D.value?.editor!==d.meta.editor){b(),Di(d.meta.editor,d);return}Je(d,D.value.editor)},[]);return Fi(()=>{if(D.value?.editor){if(Po(D.value.editor))xe("panelBoxId","Logs")}else xe("panelBoxId",null)},[D.value?.editor]),We(C1,{children:[(i.splashVisible.value||e)&&_(t1,{error:e}),_(br,{items:i.alerts.value}),_(Gr,{className:I.menuBarPosition,showHomeButton:!Wi.value,onRequestHome:M1,onOpenTutorialLibrary:Q}),_("div",{className:I.bodyWrapper,children:We("div",{className:I.workspaceWrapper,children:[o&&_("div",{className:I.sidebarWrapper,children:_(o,{})}),We("div",{className:I.editorWrapper,children:[_(n1,{id:I.tabsWrapper,className:I.tabsWrapper,children:i.tabs.value?.map(({Content:d,...k},P)=>We(C1,{children:[We(ze,{name:P,disabled:k.disabled,checked:P===i.tabIndex.value,onSelect:()=>_1(P),children:[_("img",{src:k.icon}),k.label]},P),_(Oe,{name:P,className:c,children:(P===0||i.tabIndex.value===P)&&d&&_(d,{})},P)]}))}),n&&_(Vr,{id:I.paneWrapper,className:I.paneWrapper,title:t.value.paneLabel,right:!a,left:!o,children:_(n,{})})]}),a&&_("div",{className:I.sidebarWrapper,children:_(a,{})})]})}),i.appState.value?.panelBoxId&&_(or,{panelId:i.appState.value.panelBoxId,onPanelChange:U((d)=>xe("panelBoxId",d),[]),onClose:U(()=>xe("panelBoxId",null),[])}),m.value&&_(wr,{title:D.value.deviceName,icon:D.value.deviceIcon,devices:m.value.devices,onClose:g,onConnect:B}),v.value&&_(g1,{tutorialId:v.value,onOpenTutorial:X,onBack:Q,onClose:()=>v.value=null}),s.value&&_(p1,{onOpenTutorial:X,onClose:U(()=>s.value=!1,[])}),Wi.value&&_(Wr,{onOpenEditor:Di,onOpenProject:Ii}),i.userStorageVisible.value&&_(b1,{onOpenProject:Ii}),i.prompt.value&&(i.prompt.value.inputItems?_(a1,{title:i.prompt.value.title,content:i.prompt.value.content,inputItems:i.prompt.value.inputItems,onClose:w1,onSubmit:i.prompt.value.onSubmit}):_(Kr,{title:i.prompt.value.title,label:i.prompt.value.label,content:i.prompt.value.content,redStyle:i.prompt.value.redStyle,onClose:w1,onSubmit:i.prompt.value.onSubmit,children:i.prompt.value.body}))]})}import{addAlertConfig as x,Text as W,Spinner as ce}from"@blockcode/core";import{jsx as E}from"preact/jsx-runtime";x("importing",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.importing",defaultMessage:"Importing..."})});x("downloading",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.downloading",defaultMessage:"Downloading...{progress}%"})});x("downloadCompleted",{icon:null,message:E(W,{id:"gui.alert.downloadCompleted",defaultMessage:"Download completed."})});x("connecting",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.connecting",defaultMessage:"Connecting..."})});x("connected",{icon:null,message:E(W,{id:"gui.alert.connected",defaultMessage:"Connected."})});x("connectionCancel",{icon:null,mode:"warn",message:E(W,{id:"gui.alert.connectionCancel",defaultMessage:"Connection cancel."})});x("connectionError",{icon:null,mode:"warn",message:E(W,{id:"gui.alert.connectionError",defaultMessage:"Connection error or connection was lost."})});x("erasing",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.erasing",defaultMessage:"Erasing..."})});x("restoring",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.restoring",defaultMessage:"Firmware restoring...{progress}%"})});x("recovering",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.recovering",defaultMessage:"Recovering..."})});x("restoreCompleted",{icon:null,message:E(W,{id:"gui.alert.restoreCompleted",defaultMessage:"Firmware resotre completed! Now press RESET key"})});x("compiling",{icon:E(ce,{level:"success"}),message:E(W,{id:"gui.alert.compiling",defaultMessage:"Compiling..."})});x("compileCompleted",{icon:null,message:E(W,{id:"gui.alert.compileCompleted",defaultMessage:"Compilation completed."})});x("compileError",{icon:null,mode:"warn",message:E(W,{id:"gui.alert.compileError",defaultMessage:"Compilation error."})});x("reseting",{icon:null,message:E(W,{id:"gui.alert.reseting",defaultMessage:"Reseting..."})});import{jsx as De}from"preact/jsx-runtime";function rn(){return De(Ko,{children:De(jo,{children:De(en,{children:De(y1,{})})})})}Yo(De(rn,{}),document.getElementById("root"));
