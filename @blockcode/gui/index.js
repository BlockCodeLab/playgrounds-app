import{addLocalesMessages as $r}from"@blockcode/core";var R1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"Importing...","gui.alert.downloading":"Downloading...{progress}%","gui.alert.downloadCompleted":"Download completed.","gui.alert.connecting":"Connecting...","gui.alert.connected":"Connected.","gui.alert.connectionCancel":"Connection cancel.","gui.alert.connectionError":"Connection error or connection was lost.","gui.alert.erasing":"Erasing...","gui.alert.restoring":"Firmware restoring...{progress}%","gui.alert.recovering":"Recovering...","gui.alert.restoreCompleted":"Firmware resotre completed! Now press RESET key","gui.alert.reseting":"Reseting...","gui.alert.compiling":"Compiling...","gui.alert.compileCompleted":"Compilation completed.","gui.alert.compileError":"Compilation failed.","gui.alert.compileViewError":"View Message.","gui.alert.saving":"Saving project...","gui.alert.saved":"Saved.","gui.alert.savedComputer":"Saved to your computer.","gui.alert.saveAbortError":"Abort saving.","gui.alert.saveError":"Failed save.","gui.alert.logsCopied":"Logs copied to clipboard.","gui.alert.logsCopyFailed":"Failed to copy logs to clipboard.","gui.logs.changeDevice":"Device changed to {device}","gui.logs.connected":"Device connected","gui.logs.connectedType":"Device connected with {type}","gui.logs.disconnected":"Device disconnected","gui.logs.compiling":"Compiling...","gui.logs.compiled":"Compile completed","gui.logs.downloading":"Downloading...","gui.logs.downloaded":"Download completed","gui.logs.downloadError":"Download failed","gui.home.my":"My projects","gui.home.all":"View all","gui.home.allCounts":"View all ({counts})","gui.home.new":"Create new project","gui.home.examples":"Wonderful {label} projects","gui.home.slideshow.desktop.title":"The desktop application is here!","gui.home.slideshow.desktop.button":"Download","gui.home.slideshow.tankwar.title":"The Tank War is coming! Join us!","gui.home.slideshow.tankwar.button":"Join us","gui.home.slideshow.arcade.title":"The next game, create your own!","gui.home.slideshow.arcade.button":"Create now","gui.splash.loading":"Loading project...","gui.splash.errorTitle":"Error occurred","gui.splash.errorLabel":"Please refresh the page and reopen it.","gui.menubar.courses":"Courses","gui.menubar.tutorials":"Tutorials","gui.menubar.titlePlaceholder":"Project title here","gui.menubar.file":"File","gui.menubar.file.newProject":"New","gui.menubar.file.openProject":"Open...","gui.menubar.file.saveProject":"Save","gui.menubar.file.uploadProject":"Load from your computer...","gui.menubar.file.downloadProject":"save to your computer...","gui.menubar.edit":"Edit","gui.menubar.edit.undo":"Undo","gui.menubar.edit.redo":"Redo","gui.menubar.edit.openManualCoding":"Turn on Coding Mode","gui.menubar.edit.closeManualCoding":"Turn off Coding Mode","gui.menubar.edit.openCompactBlock":"Turn on Compact Block","gui.menubar.edit.closeCompactBlock":"Turn off Compact Block","gui.menubar.view":"View","gui.menubar.view.log":"Log Panel","gui.menubar.view.serial":"Serial Panel","gui.menubar.view.files":"Files Panel","gui.menubar.view.openAutoDisplayPanel":"Turn on auto display Log Panel","gui.menubar.view.closeAutoDisplayPanel":"Turn off auto display Log Panel","gui.menubar.device":"Device","gui.menubar.device.sync":"Sync program","gui.menubar.device.download":"Download program","gui.menubar.device.reset":"Reset device","gui.menubar.device.connect":"Connect device...","gui.menubar.device.connectUsb":"Connect device with USB...","gui.menubar.device.connectBle":"Connect device with Bluetooth (BLE)...","gui.menubar.device.disconnect":"Disconnect device","gui.menubar.device.firmware":"Restore firmware...","gui.menubar.device.firmwareVersion":"Restore v{version} firmware...","gui.menubar.device.caching":"Caching latest firmware...","gui.panelBox.logs":"Logs","gui.panelBox.logsCopy":"Copy","gui.panelBox.serial":"Serial","gui.panelBox.serialClean":"Clean","gui.panelBox.files":"Files","gui.panelBox.filesAdd":"Add","gui.project.name":"Untitled Project","gui.project.shortname":"Untitled","gui.library.search":"Search","gui.library.projects.empty":"No project!","gui.library.projects.rename":"rename","gui.library.projects.duplicate":"duplicate","gui.library.projects.delete":"delete","gui.library.projects.notSaved":"Not saved","gui.library.projects.close":"Close current project?","gui.library.projects.deleteConfirm":'Do you want to delete the project "{name}"?',"gui.library.projects.replace":"Replace contents of the current project?","gui.library.projects.errorEditor":'This project is not currently editor creation, please switch to "{workspace}" and open it.',"gui.library.projects.notFoundEditor":'Not Found the "{editor}" Editor.',"gui.library.examples.interconnect":"The project requires two devices to work properly.","gui.library.tutorial.course":"Choose a course","gui.library.tutorial.tutorial":"Choose a tutorial","gui.tutorials.shrink":"Shrink","gui.tutorials.expand":"Expand","gui.tutorials.close":"Close","gui.tutorials.moreTry":"More things to try!","gui.tutorials.seeMore":"See more","gui.prompt.ok":"OK","gui.prompt.close":"Close","gui.prompt.cancel":"Cancel","gui.prompt.reconnect":"Reconnect","gui.connection.device":"Device Connection","gui.connection.search":"Start Searching","gui.connection.searching":"Searching...","gui.connection.connect":"Start Connecting","gui.connection.deviceName":"Device name","gui.about.title":"About...","gui.about.main":"Main program","gui.terms.title":"Terms of Use","gui.terms.content":`<b>Terms of Use</b>
`,"gui.privacy.title":"Privacy","gui.privacy.content":`<b>Privacy</b>
`};var U1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"载入中…","gui.alert.downloading":"正在下载…{progress}%","gui.alert.downloadCompleted":"下载完成。","gui.alert.connecting":"正在连接…","gui.alert.connected":"已连接。","gui.alert.connectionCancel":"连接取消。","gui.alert.connectionError":"连接发生错误，或已断开。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在恢复固件…{progress}%","gui.alert.recovering":"恢复设备…","gui.alert.restoreCompleted":"恢复固件完成，请按下 RESET 键。","gui.alert.reseting":"正在复位…","gui.alert.compiling":"正在编译…","gui.alert.compileCompleted":"编译完成。","gui.alert.compileError":"编译失败。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存作品…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到电脑。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存作品失败。","gui.alert.logsCopied":"日志已复制。","gui.alert.logsCopyFailed":"日志复制失败。","gui.logs.changeDevice":"设备已更改为 {device}","gui.logs.connected":"设备已连接","gui.logs.connectedType":"设备已连接到 {type}","gui.logs.disconnected":"设备断开连接","gui.logs.compiling":"程序编译中…","gui.logs.compiled":"编译完成","gui.logs.downloading":"下载程序到设备…","gui.logs.downloaded":"下载完成","gui.logs.downloadError":"下载失败","gui.home.my":"我的作品","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"开始新作品","gui.home.examples":"{label} 精彩作品","gui.home.slideshow.desktop.title":"桌面端程序已就绪，快来下载！","gui.home.slideshow.desktop.button":"立即下载","gui.home.slideshow.tankwar.title":"战争一触即发，赶紧来战吧！","gui.home.slideshow.tankwar.button":"加入战斗","gui.home.slideshow.arcade.title":"玩的下一个游戏，就要自己创作！","gui.home.slideshow.arcade.button":"开始创作","gui.splash.loading":"加载作品…","gui.splash.errorTitle":"发生错误","gui.splash.errorLabel":"请刷新页面重新打开。","gui.menubar.courses":"课程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填写作品标题","gui.menubar.file":"文件","gui.menubar.file.newProject":"新作品","gui.menubar.file.openProject":"打开…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"从电脑中打开…","gui.menubar.file.downloadProject":"保存到电脑…","gui.menubar.edit":"编辑","gui.menubar.edit.undo":"撤销","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打开代码编程","gui.menubar.edit.closeManualCoding":"关闭代码编程","gui.menubar.edit.openCompactBlock":"打开紧凑积木样式","gui.menubar.edit.closeCompactBlock":"关闭紧凑积木样式","gui.menubar.view":"查看","gui.menubar.view.log":"日志","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文件管理","gui.menubar.view.openAutoDisplayPanel":"打开自动显示日志","gui.menubar.view.closeAutoDisplayPanel":"关闭自动显示日志","gui.menubar.device":"设备","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下载程序","gui.menubar.device.reset":"复位","gui.menubar.device.connect":"连接…","gui.menubar.device.connectUsb":"通过 USB 连接…","gui.menubar.device.connectBle":"通过蓝牙（BLE）连接…","gui.menubar.device.disconnect":"断开连接","gui.menubar.device.firmware":"恢复固件…","gui.menubar.device.firmwareVersion":"恢复 v{version} 固件…","gui.menubar.device.caching":"正在缓存最新固件…","gui.panelBox.logs":"日志","gui.panelBox.logsCopy":"复制","gui.panelBox.serial":"串口","gui.panelBox.serialClean":"清除","gui.panelBox.files":"文件管理","gui.panelBox.logsAdd":"添加","gui.project.name":"未命名作品","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"没有作品！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"复制","gui.library.projects.delete":"删除","gui.library.projects.notSaved":"未保存作品","gui.library.projects.close":"要关闭当前作品吗？","gui.library.projects.deleteConfirm":"要删除“《{name}》”作品吗？","gui.library.projects.replace":"要创建新作品替换当前作品吗？","gui.library.projects.errorEditor":"这个作品不是当前编辑器创作，请切换至“{editor}”编辑器然后打开。","gui.library.projects.notFoundEditor":"没有发现“{editor}”编辑器。","gui.library.examples.interconnect":"该作品需要两台设备联机才能正常运行。","gui.library.tutorials.course":"选择一个课程","gui.library.tutorials.tutorial":"选择一个教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展开","gui.tutorials.close":"关闭","gui.tutorials.moreTry":"再试试这些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"确认","gui.prompt.close":"关闭","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新连接","gui.connection.device":"硬件连接","gui.connection.search":"开始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"开始连接","gui.connection.deviceName":"硬件名称","gui.about.title":"版本信息","gui.about.main":"主程序","gui.terms.title":"使用条款","gui.terms.content":`<b>使用条款</b>
`,"gui.privacy.title":"隐私","gui.privacy.content":`<b>隐私</b>
`};var S1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"載入中…","gui.alert.downloading":"正在下載…{progress}%","gui.alert.downloadCompleted":"下載完成。","gui.alert.connecting":"正在連接…","gui.alert.connected":"已連接。","gui.alert.connectionCancel":"連接取消。","gui.alert.connectionError":"連接發生錯誤，或已斷開。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在還原固件…{progress}%","gui.alert.recovering":"恢復設備…","gui.alert.restoreCompleted":"還原固件完成，請按下 RESET 鍵。","gui.alert.reseting":"正在重置…","gui.alert.compiling":"正在編譯…","gui.alert.compileCompleted":"編譯完成。","gui.alert.compileError":"編譯失敗。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存專案…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到電腦。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存專案失敗。","gui.alert.logsCopied":"日誌已複製。","gui.alert.logsCopyFailed":"日誌複製失敗。","gui.logs.changeDevice":"設備已更改為 {device}","gui.logs.connected":"設備已連接","gui.logs.connectedType":"設備已連接到 {type}","gui.logs.disconnected":"設備斷開連接","gui.logs.compiling":"程序編譯中…","gui.logs.compiled":"編譯完成","gui.logs.downloading":"下載程序到設備…","gui.logs.downloaded":"下載完成","gui.logs.downloadError":"下載失敗","gui.home.my":"我的專案","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"開始新專案","gui.home.examples":"{label} 精彩專案","gui.home.slideshow.desktop.title":"桌面端程序已就緒，快來下載！","gui.home.slideshow.desktop.button":"立即下載","gui.home.slideshow.tankwar.title":"戰爭一觸即髮，趕緊來戰吧！","gui.home.slideshow.tankwar.button":"加入戰鬥","gui.home.slideshow.arcade.title":"玩的下一個遊戲，就要自己創作！","gui.home.slideshow.arcade.button":"開始創作","gui.splash.loading":"加載專案…","gui.splash.errorTitle":"發生錯誤","gui.splash.errorLabel":"請刷新頁面重新打開。","gui.menubar.courses":"課程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填寫專案標題","gui.menubar.file":"文檔","gui.menubar.file.newProject":"新專案","gui.menubar.file.openProject":"打開…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"從電腦中打開…","gui.menubar.file.downloadProject":"保存到電腦…","gui.menubar.edit":"編輯","gui.menubar.edit.undo":"撤銷","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打開代碼編程","gui.menubar.edit.closeManualCoding":"關閉代碼編程","gui.menubar.edit.openCompactBlock":"打開緊湊積木樣式","gui.menubar.edit.closeCompactBlock":"關閉緊湊積木樣式","gui.menubar.view":"查看","gui.menubar.view.log":"日誌","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文檔管理","gui.menubar.view.openAutoDisplayPanel":"打開自動顯示日誌","gui.menubar.view.closeAutoDisplayPanel":"關閉自動顯示日誌","gui.menubar.device":"設備","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下載程序","gui.menubar.device.reset":"重置","gui.menubar.device.connect":"連接…","gui.menubar.device.connectUsb":"通過 USB 連接…","gui.menubar.device.connectBle":"通過藍牙（BLE）連接…","gui.menubar.device.disconnect":"斷開連接","gui.menubar.device.firmware":"還原固件…","gui.menubar.device.firmwareVersion":"還原 v{version} 固件…","gui.menubar.device.caching":"正在緩存最新固件…","gui.panelBox.logs":"日誌","gui.panelBox.logsCopy":"複製","gui.panelBox.serial":"串口","gui.panelBox.serialClean":"清除","gui.panelBox.files":"文檔管理","gui.panelBox.logsAdd":"添加","gui.project.name":"未命名專案","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"沒有專案！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"複製","gui.library.projects.delete":"刪除","gui.library.projects.notSaved":"未保存專案","gui.library.projects.close":"要關閉當前專案嗎？","gui.library.projects.deleteConfirm":"要刪除“《{name}》”專案嗎？","gui.library.projects.replace":"要創建新專案替換當前專案嗎？","gui.library.projects.errorEditor":"這個專案不是當前編輯器創作，請切換至“{editor}”編輯器然後打開。","gui.library.projects.notFoundEditor":"沒有發現「{editor}」編輯器。","gui.library.examples.interconnect":"該專案需要兩枱設備聯機纔能正常運行。","gui.library.tutorials.course":"選擇一個課程","gui.library.tutorials.tutorial":"選擇一個教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展開","gui.tutorials.close":"關閉","gui.tutorials.moreTry":"再試試這些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"確認","gui.prompt.close":"關閉","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新連接","gui.connection.device":"硬件連接","gui.connection.search":"開始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"開始連接","gui.connection.deviceName":"硬件名稱","gui.about.title":"版本信息","gui.about.main":"主程式","gui.terms.title":"使用條款","gui.terms.content":`<b>使用條款</b>
`,"gui.privacy.title":"隱私","gui.privacy.content":`<b>隱私</b>
`};$r({en:R1,"zh-Hans":U1,"zh-Hant":S1});import{render as ln}from"preact";import{LocalesProvider as cn,AppProvider as un,ProjectProvider as mn}from"@blockcode/core";import{useCallback as T,useEffect as F1,useErrorBoundary as Xo}from"preact/hooks";import{batch as Ce,useComputed as Mr,useSignal as Ve,useSignalEffect as To}from"@preact/signals";import{isElectron as $1,classNames as Ho,keyMirror as zo,openProjectFromURL as No,getAutoDisplayPanel as Oo}from"@blockcode/utils";import{useAppContext as Go,useLocalesContext as Vo,useProjectContext as Jo,translate as Yo,maybeTranslate as Ko,showSplash as qr,hideSplash as jo,openPromptModal as Je,closePromptModal as Br,openLayout as en,closeLayout as rn,openTab as Er,openProject as an,closeProject as tn,setAlert as on,delAlert as nn,setAppState as De}from"@blockcode/core";import{getAutoDisplayPanel as Ea,setAutoDisplayPanel as Za}from"@blockcode/utils";import{Text as l1}from"@blockcode/core";import{useCallback as Pe}from"preact/hooks";import{batch as Ar}from"@preact/signals";import{isElectron as X1,isMac as je,putProject as Wr,openProjectFromComputer as Dr,saveProjectToComputer as xr,sleepMs as Ir}from"@blockcode/utils";import{useProjectContext as Pr,setAlert as r1,openUserStorage as Rr,setFile as Ur,setModified as Sr,ModifyTypes as Xr,Keys as re}from"@blockcode/core";import{Text as j,MenuSection as e1,MenuItem as ye}from"@blockcode/core";function _(e){let r=globalThis.document,i=r.createElement("style");i.appendChild(r.createTextNode(e)),r.head.append(i)}_(".cbXT-q_menu-bar{box-sizing:border-box;height:var(--menu-bar-height);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:var(--menu-bar-standard-font-size);background-color:var(--theme-primary);color:var(--ui-white);-webkit-user-select:none;-webkit-app-region:drag;flex-flow:row;justify-content:space-between;font-weight:700;display:flex;box-shadow:0 0 3px #00000040}.cbXT-q_menu-bar-item{color:var(--ui-white);user-select:none;white-space:nowrap;height:var(--menu-bar-height);align-self:center;align-items:center;padding:0 .25rem;text-decoration:none;display:flex;position:relative}.cbXT-q_menu-bar-item.cbXT-q_growable{max-width:var(--menu-bar-item-max-width);flex:1}.cbXT-q_menu-bar-item[disabled]{opacity:.5;pointer-events:none}.cbXT-q_main-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_main-menu.cbXT-q_electron{margin-left:72px}.cbXT-q_right-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_menu-label{padding:0 .75rem}.cbXT-q_menu-label img:not(:only-child){margin-right:.25rem}.cbXT-q_language-label{width:var(--language-selector-width);padding:0 .5rem}input.cbXT-q_menu-label{display:none}input.cbXT-q_menu-label+.cbXT-q_menu-bar-item:hover{cursor:pointer;background:var(--ui-black-transparent)}input.cbXT-q_menu-label:checked+.cbXT-q_menu-bar-item{background:var(--ui-black-transparent)}.cbXT-q_main-menu>.cbXT-q_menu{border-radius:0 0 var(--space)var(--space)}.cbXT-q_menu{top:var(--menu-bar-height);z-index:var(--z-index-menu-bar);border-radius:var(--space);color:var(--ui-white);background:var(--theme-primary);min-width:186px;display:none}.cbXT-q_menu-item{font-weight:700}.cbXT-q_menu-item:hover{background:var(--ui-black-transparent)}.cbXT-q_language-icon{vertical-align:middle;height:1.5rem}.cbXT-q_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}.cbXT-q_check-icon.cbXT-q_checked{visibility:visible}.cbXT-q_divider{border-right:1px dashed var(--ui-black-transparent);height:34px;margin:0 .7rem}.cbXT-q_hoverable:not([disabled]):hover{cursor:pointer;background:var(--ui-black-transparent)}.cbXT-q_tutorials-icon{margin-right:.35rem}.cbXT-q_title-field{border:1px dashed var(--ui-black-transparent);border-radius:var(--form-radius);-webkit-border-radius:var(--form-radius);-moz-border-radius:var(--form-radius);background-color:var(--ui-white-transparent);height:auto;color:var(--ui-white);-webkit-background-clip:padding-box;background-clip:padding-box;padding:.5rem;font-size:.8rem;font-weight:700}.cbXT-q_title-field::placeholder{color:var(--ui-white);font-size:.8rem;font-style:italic;font-weight:400}.cbXT-q_title-field:hover{background-color:#ffffff80}.cbXT-q_title-field:focus{border:1px solid var(--ui-transparent);-webkit-box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);background-color:var(--ui-white);color:var(--text-primary);outline:none}.cbXT-q_blank-check-item>div{padding-left:calc(14px + var(--space)/2)}");var l={mainMenu:"cbXT-q_main-menu",electron:"cbXT-q_electron",menuBarItem:"cbXT-q_menu-bar-item",checkIcon:"cbXT-q_check-icon",menu:"cbXT-q_menu",titleField:"cbXT-q_title-field",blankCheckItem:"cbXT-q_blank-check-item",tutorialsIcon:"cbXT-q_tutorials-icon",languageLabel:"cbXT-q_language-label",menuBar:"cbXT-q_menu-bar",menuItem:"cbXT-q_menu-item",hoverable:"cbXT-q_hoverable",languageIcon:"cbXT-q_language-icon",rightMenu:"cbXT-q_right-menu",divider:"cbXT-q_divider",growable:"cbXT-q_growable",menuLabel:"cbXT-q_menu-label",checked:"cbXT-q_checked"};import{jsx as F,jsxs as i1,Fragment as Tr}from"preact/jsx-runtime";var T1=(e=!1)=>r1({message:F(j,{id:"gui.alert.saving",defaultMessage:"Saving project..."})},e),H1=(e,r=!1)=>r1({id:e,message:r?F(j,{id:"gui.alert.savedComputer",defaultMessage:"Saved to your computer."}):F(j,{id:"gui.alert.saved",defaultMessage:"Saved to local storage."})},2000),z1=(e,r=!1)=>r1({id:e,mode:"warn",message:r?F(j,{id:"gui.alert.saveAbortError",defaultMessage:"Abort saving."}):F(j,{id:"gui.alert.saveError",defaultMessage:"Failed save."})},r?1000:2000);function N1({onNew:e,onOpen:r,onSave:i,onThumb:t,ExtendedMenu:o}){let{meta:a,key:n,name:u,files:g,assets:c}=Pr(),p=Pe(async()=>{await Ir(0);for(let H in a.value.monitors)if(a.value.monitors[H].deleting)a.value.monitors.splice(H,1);let m=[],f=g.value.map((H)=>{return m.push(H.extensions),Object.fromEntries(Object.entries(H).filter(([I,A1])=>{if(["xmlDom","script","extensions"].includes(I))return!1;if(!a.value.manualCoding&&I==="content")return!1;return!0}))}),v=c.value?.filter((H)=>!H.uri),Q=await i(f,v,a.value);return Q.meta=Object.assign(Q.meta??{},{editor:a.value.editor,version:a.value.version,monitors:a.value.monitors,extensions:Array.from(new Set(m.flat())).filter(Boolean),manualCoding:a.value.manualCoding,compactBlock:a.value.compactBlock,users:a.value.users}),Q.name=u.value,Q},[i]),B=Pe(async()=>{let m=T1(),f=await p();f.key=n.value;let v=await Wr(f,t);Ar(()=>{if(f.key!==v)Ur({key:v});Sr(Xr.Saved)}),H1(m)},[p]),d=Pe(async()=>{let m=T1(X1?1000:!1),f=await p(),v=await xr(f);if(X1)return;if(v.success)H1(m,!0);else if(v.error==="AbortError")z1(m,!0);else z1(m)},[p]),h=Pe(async()=>{let m=await Dr();await r(m)},[r]);return i1(Tr,{children:[F(e1,{children:F(ye,{className:l.menuItem,label:F(j,{id:"gui.menubar.file.newProject",defaultMessage:"New"}),hotkey:[je?re.COMMAND:re.CONTROL,re.N],onClick:e})}),i1(e1,{children:[F(ye,{className:l.menuItem,label:F(j,{id:"gui.menubar.file.openProject",defaultMessage:"Open"}),hotkey:[je?re.COMMAND:re.CONTROL,re.O],onClick:Rr}),F(ye,{className:l.menuItem,label:F(j,{id:"gui.menubar.file.saveProject",defaultMessage:"Save"}),hotkey:[je?re.COMMAND:re.CONTROL,re.S],onClick:B})]}),i1(e1,{children:[F(ye,{className:l.menuItem,label:F(j,{id:"gui.menubar.file.uploadProject",defaultMessage:"Load from your computer"}),onClick:h}),F(ye,{className:l.menuItem,label:F(j,{id:"gui.menubar.file.downloadProject",defaultMessage:"save to your computer"}),onClick:d})]}),o&&F(o,{className:l.menu,itemClassName:l.menuItem,onOpen:r,onSave:p})]})}import{useCallback as O1,useEffect as Hr}from"preact/hooks";import{batch as zr,useSignal as G1,useComputed as Nr}from"@preact/signals";import{isMac as V1,setCompactBlock as Or,getCompactBlock as Gr}from"@blockcode/utils";import{useProjectContext as Vr,Keys as ae,setMeta as J1}from"@blockcode/core";import{Text as pe,MenuSection as Y1,MenuItem as Re}from"@blockcode/core";import{jsx as O,jsxs as a1,Fragment as Jr}from"preact/jsx-runtime";function K1({enableCoding:e,enableCompactBlock:r,onUndo:i,onRedo:t,onEnableUndo:o,onEnableRedo:a,ExtendedMenu:n}){let{meta:u,key:g,fileId:c,modified:p}=Vr(),B=G1(!0),d=G1(!0),h=Nr(()=>u.value.compactBlock??Gr());Hr(()=>{zr(()=>{B.value=!o(),d.value=!a()})},[g.value,c.value,p.value]);let m=O1(()=>{J1("manualCoding",!u.value.manualCoding)},[]),f=O1(()=>{let v=!h.value;J1("compactBlock",v),Or(v)},[]);return a1(Jr,{children:[a1(Y1,{children:[O(Re,{disabled:B.value,className:l.menuItem,label:O(pe,{id:"gui.menubar.edit.undo",defaultMessage:"Undo"}),hotkey:[V1?ae.COMMAND:ae.CONTROL,ae.Z],onClick:i}),O(Re,{disabled:d.value,className:l.menuItem,label:O(pe,{id:"gui.menubar.edit.redo",defaultMessage:"Redo"}),hotkey:V1?[ae.SHIFT,ae.COMMAND,ae.Z]:[ae.CONTROL,ae.Y],onClick:t})]}),(e||r)&&a1(Y1,{children:[r&&O(Re,{className:l.menuItem,label:h.value?O(pe,{id:"gui.menubar.edit.closeCompactBlock",defaultMessage:"Turn off Compact Block"}):O(pe,{id:"gui.menubar.edit.openCompactBlock",defaultMessage:"Turn on Compact Block"}),onClick:f}),e&&O(Re,{className:l.menuItem,label:u.value.manualCoding?O(pe,{id:"gui.menubar.edit.closeManualCoding",defaultMessage:"Turn off Coding Mode"}):O(pe,{id:"gui.menubar.edit.openManualCoding",defaultMessage:"Turn on Coding Mode"}),onClick:m})]}),n&&O(n,{className:l.menu,itemClassName:l.menuItem})]})}import{useEffect as f6,useCallback as ui}from"preact/hooks";import{useComputed as fa,useSignal as ba}from"@preact/signals";import{classNames as Ue,getAutoDisplayPanel as va,setAutoDisplayPanel as ka}from"@blockcode/utils";import{useAppContext as Ca,useProjectContext as wa,setAppState as _a,Keys as se,Text as qe,MenuSection as mi,MenuItem as Se}from"@blockcode/core";import{useCallback as t1}from"preact/hooks";import{useComputed as ca}from"@preact/signals";import{keyMirror as ua,classNames as o1}from"@blockcode/utils";import{useAppContext as ma,setAppState as ga,setAlert as li,logger as pa,Box as da,Button as n1,Text as ce}from"@blockcode/core";import{useComputed as Yr}from"@preact/signals";import{logger as Kr,themeColors as j1}from"@blockcode/core";import{Terminal as jr}from"@blockcode/code";import{jsx as ea}from"preact/jsx-runtime";function ei(){let e=Yr(()=>Kr.logs.join(`\r
`));return ea(jr,{textValue:e.value,options:{theme:{cursor:"#fff",foreground:j1.ui.text.primary,background:"#fff",selection:j1.ui.text.primary}}})}import{Terminal as ia}from"@blockcode/code";import{jsx as ra}from"preact/jsx-runtime";function ii(){return ra(ia,{compactMode:!0})}_(".hPjAUa_button{--button-height:calc(var(--standard-font-size)*2.4);padding:0 calc(var(--space)*1.5);height:var(--button-height);border-radius:calc(var(--button-height)/2);margin-left:var(--space);border-color:var(--blocks-tertiary);background:var(--blocks-secondary);color:var(--ui-white)}.hPjAUa_button .hPjAUa_icon{filter:brightness(100);width:16px;margin-right:4px}.hPjAUa_button:hover:not(:disabled):not(.hPjAUa_button-actived){background:var(--blocks-tertiary)}.hPjAUa_button-actived{background:var(--ui-white);color:var(--text-primary)}.hPjAUa_button-actived .hPjAUa_icon{filter:unset}");var ee={icon:"hPjAUa_icon",button:"hPjAUa_button",buttonActived:"hPjAUa_button-actived"};var ri="./assets/icon-logs-xymnjv7g.svg";var ai="./assets/icon-serial-xw0zbnx8.svg";var ti="./assets/icon-files-c1wm773z.svg";var oi="./assets/icon-copy-r0kx9k44.svg";var ni="./assets/icon-clean-vv72f5q7.svg";import{jsx as z,jsxs as Me,Fragment as sa}from"preact/jsx-runtime";var $=ua({Logs:null,Serial:null,Files:null});function ci({panelId:e,onPanelChange:r,onClose:i}){let{menuItems:t}=ma(),o=ca(()=>t.value?.find((a)=>a.id==="view"));return Me(da,{header:Me(sa,{children:[Me(n1,{className:o1(ee.button,{[ee.buttonActived]:e===$.Logs}),onClick:t1(()=>r($.Logs),[]),children:[z("img",{className:ee.icon,src:ri}),z(ce,{id:"gui.panelBox.logs",defaultMessage:"Logs"})]}),Me(n1,{className:o1(ee.button,{[ee.buttonActived]:e===$.Serial}),onClick:t1(()=>r($.Serial),[]),children:[z("img",{className:ee.icon,src:ai}),z(ce,{id:"gui.panelBox.serial",defaultMessage:"Serial"})]}),o.value?.options?.disabledFiles!==!0&&Me(n1,{disabled:!0,className:o1(ee.button,{[ee.buttonActived]:e===$.Files}),onClick:t1(()=>r($.Files),[]),children:[z("img",{className:ee.icon,src:ti}),z(ce,{id:"gui.panelBox.files",defaultMessage:"Files"})]})]}),buttons:[e===$.Logs&&{icon:oi,label:z(ce,{id:"gui.panelBox.logsCopy",defaultMessage:"Copy"}),async onClick(){let a=pa.logs.join(`\r
`);try{a=a.replace(/\x1B\[[0-?]*[ -/]*[@-~]/g,""),await navigator.clipboard.writeText(a),li({type:"success",message:z(ce,{id:"gui.alert.logsCopied",defaultMessage:"Logs copied to clipboard"})},2000)}catch(n){li({type:"warn",message:z(ce,{id:"gui.alert.logsCopyFailed",defaultMessage:"Failed to copy logs to clipboard"})},2000)}}},e===$.Serial&&{icon:ni,label:z(ce,{id:"gui.panelBox.serialClean",defaultMessage:"Clean"}),onClick(){ga("terminalCache",null)}}].filter(Boolean),onClose:i,children:[e===$.Logs&&z(ei,{}),e===$.Serial&&z(ii,{})]})}var de="./assets/icon-check-f984n1c2.svg";import{jsx as G,jsxs as Be,Fragment as ya}from"preact/jsx-runtime";function gi({enableFiles:e,ExtendedMenu:r}){let{appState:i}=Ca(),{meta:t}=wa(),o=ba(va(t.value.editor)),a=fa(()=>i.value?.panelBoxId),n=ui((g)=>()=>{if(g===a.value)g=null;_a("panelBoxId",g)},[]),u=ui(()=>{o.value=!o.value,ka(t.value.editor,o.value)},[]);return Be(ya,{children:[Be(mi,{children:[Be(Se,{className:l.menuItem,hotkey:[se.CONTROL,se.D1],onClick:n($.Logs),children:[G("img",{className:Ue(l.checkIcon,{[l.checked]:a.value===$.Logs}),src:de}),G(qe,{id:"gui.menubar.view.log",defaultMessage:"Log Panel"})]}),Be(Se,{className:l.menuItem,hotkey:[se.CONTROL,se.D2],onClick:n($.Serial),children:[G("img",{className:Ue(l.checkIcon,{[l.checked]:a.value===$.Serial}),src:de}),G(qe,{id:"gui.menubar.view.serial",defaultMessage:"Serial Panel"})]}),e&&Be(Se,{disabled:!0,className:l.menuItem,hotkey:[se.CONTROL,se.D3],onClick:n($.Files),children:[G("img",{className:Ue(l.checkIcon,{[l.checked]:a.value===$.Files}),src:de}),G(qe,{id:"gui.menubar.view.files",defaultMessage:"Files Panel"})]})]}),r&&G(r,{className:l.menu,itemClassName:l.menuItem}),G(mi,{children:G(Se,{className:Ue(l.menuItem,l.blankCheckItem),label:o.value?G(qe,{id:"gui.menubar.view.closeAutoDisplayPanel",defaultMessage:"Turn off auto display panel"}):G(qe,{id:"gui.menubar.view.openAutoDisplayPanel",defaultMessage:"Turn on auto display panel"}),onClick:u})})]})}var pi="./assets/icon-file-egaz1kfx.svg";var di="./assets/icon-edit-jejnm7yb.svg";var si="./assets/icon-view-c3skbdpn.svg";import{jsx as he}from"preact/jsx-runtime";function hi(e,r,i){let t=(c)=>i(c,r.editor),o=e.menuItems?.find((c)=>c.id==="file"),a=e.menuItems?.find((c)=>c.id==="edit"),n=e.menuItems?.find((c)=>c.id==="view"),u=Ea(r.editor)??n?.autoDisplayPanel===!0;Za(r.editor,u);let g=async()=>{let c=JSON.parse(JSON.stringify(await e.onNew()));if(!c.meta)c.meta=r;if(!c.meta.editor)c.meta.editor=r.editor,c.meta.version=r.version;t(c,r.editor)};return[{id:"file",icon:pi,label:he(l1,{id:"gui.menubar.file",defaultMessage:"File"}),Menu:()=>he(N1,{ExtendedMenu:o?.Menu,onNew:g,onOpen:t,onSave:e.onSave,onThumb:e.onThumb}),options:o},{id:"edit",icon:di,label:he(l1,{id:"gui.menubar.edit",defaultMessage:"Edit"}),Menu:()=>he(K1,{enableCoding:a?.disabledCoding!==!0,enableCompactBlock:a?.disabledCompactBlock!==!0,ExtendedMenu:a?.Menu,onUndo:e.onUndo,onRedo:e.onRedo,onEnableUndo:e.onEnableUndo,onEnableRedo:e.onEnableRedo}),options:a},n?.disabled!==!0&&{id:"view",icon:si,label:he(l1,{id:"gui.menubar.view",defaultMessage:"View"}),Menu:()=>he(gi,{enableFiles:n?.disabledFiles!==!0,ExtendedMenu:n?.Menu}),options:n}].concat(e.menuItems?.filter((c)=>!["file","edit","view"].includes(c.id))??[]).filter(Boolean)}import{Text as we}from"@blockcode/core";import{classNames as Qa}from"@blockcode/utils";import{maybeTranslate as Fa,Button as bi}from"@blockcode/core";_(".lkaaPa_alerts-wrapper{width:100%;z-index:var(--z-index-alerts);top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute}.lkaaPa_alert-wrapper{pointer-events:all;background:var(--ui-light);border:1px solid var(--blocks-tertiary);min-width:200px;max-width:548px;min-height:1.5rem;box-shadow:0px 0px 0px 2px var(--ui-light);border-radius:.5rem;flex-direction:row;justify-content:flex-start;align-items:center;margin-bottom:7px;padding:.875rem 1rem;display:flex;overflow:hidden}.lkaaPa_warn{border:1px solid var(--error-primary)}.lkaaPa_icon{min-width:1.25rem;min-height:1.25rem;padding-right:1rem;display:flex}.lkaaPa_message{justify-content:flex-end;align-items:center;padding-right:.5rem;font-size:.8125rem;font-weight:700;line-height:.875rem;display:flex}.lkaaPa_warn .lkaaPa_message{color:var(--error-secondary)}.lkaaPa_success .lkaaPa_message{color:#555}.lkaaPa_buttons-group{align-items:center;display:flex}.lkaaPa_button{color:var(--ui-white);margin-left:var(--space);padding:var(--space)calc(var(--space)*2.5);background:#ff8c1a;border:#ff8c1a}.lkaaPa_close-button{width:1.75rem;height:1.75rem;margin-left:calc(var(--space)*2);background:#ff861433;border:0;border-radius:50%;padding:0;transition:all .15s ease-out;box-shadow:0 0 0 2px #ff861433}.lkaaPa_close-button:hover{transform:scale(1.1);box-shadow:0 0 0 4px #ff861433}.lkaaPa_close-button img{margin:0 auto}");var V={buttonsGroup:"lkaaPa_buttons-group",success:"lkaaPa_success",message:"lkaaPa_message",warn:"lkaaPa_warn",icon:"lkaaPa_icon",alertWrapper:"lkaaPa_alert-wrapper",button:"lkaaPa_button",alertsWrapper:"lkaaPa_alerts-wrapper",closeButton:"lkaaPa_close-button"};var fi="./assets/icon-close-bazpdng8.svg";import{jsx as fe,jsxs as vi}from"preact/jsx-runtime";function ki({mode:e,icon:r,message:i,options:t,button:o,onClose:a}){return vi("div",{className:Qa(V.alertWrapper,{[V.success]:e==="success",[V.warn]:e==="warn"}),children:[fe("div",{className:V.icon,children:typeof r==="string"?fe("img",{src:r}):r}),fe("div",{className:V.message,children:Fa(i,t)}),vi("div",{className:V.buttonsGroup,children:[o&&fe(bi,{className:V.button,onClick:o.onClick,children:o.label}),a&&fe(bi,{className:V.closeButton,onClick:a,children:fe("img",{src:fi})})]})]})}import{jsx as Ci}from"preact/jsx-runtime";function wi({items:e}){return Ci("div",{className:V.alertsWrapper,children:e.map(({id:r,mode:i,icon:t,message:o,button:a,onClose:n,...u})=>Ci(ki,{mode:i??"success",icon:t,message:o,options:u,button:a,onClose:n},r))})}import{useCallback as Aa}from"preact/hooks";import{useSignal as Wa}from"@preact/signals";import{classNames as Xe}from"@blockcode/utils";import{Text as Ee,Button as yi,Modal as Da}from"@blockcode/core";_(".Zq10BW_prompt-modal{width:480px}.Zq10BW_prompt-header{background:var(--blocks-primary)}.Zq10BW_prompt-content{background:var(--ui-white)}.Zq10BW_device-list{background:var(--theme-light-transparent);width:100%;height:170px;padding:.5rem;overflow-y:auto}.Zq10BW_device-search{justify-content:center;align-items:center;width:100%;height:100%;display:flex}.Zq10BW_device-search-icon{width:120px;height:120px}@keyframes Zq10BW_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.Zq10BW_device-searching-icon{animation:1.5s linear infinite Zq10BW_spin}.Zq10BW_device-item{background:var(--ui-white);border-radius:calc(var(--space)/2);border:2px solid var(--ui-white);flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:50px;margin-bottom:.5rem;padding:10px;display:flex}.Zq10BW_device-item.Zq10BW_selected{border:2px solid var(--theme-primary)}.Zq10BW_device-name-bar{align-items:center;display:flex}.Zq10BW_device-image{width:40px;margin-right:.5rem}.Zq10BW_device-name-wrapper{flex-direction:column;justify-content:center;align-items:flex-start;display:flex}.Zq10BW_device-name-label{font-size:.625rem;font-weight:700}.Zq10BW_device-name-text{font-size:.875rem}.Zq10BW_button-row{text-align:right;text-align:center;padding:1.5rem 2.25rem;font-weight:bolder}.Zq10BW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.Zq10BW_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var L={deviceNameBar:"Zq10BW_device-name-bar",deviceNameLabel:"Zq10BW_device-name-label",promptContent:"Zq10BW_prompt-content",selected:"Zq10BW_selected",deviceImage:"Zq10BW_device-image",promptModal:"Zq10BW_prompt-modal",spin:"Zq10BW_spin",deviceNameWrapper:"Zq10BW_device-name-wrapper",deviceSearch:"Zq10BW_device-search",okButton:"Zq10BW_ok-button",deviceSearchingIcon:"Zq10BW_device-searching-icon",deviceList:"Zq10BW_device-list",buttonRow:"Zq10BW_button-row",deviceSearchIcon:"Zq10BW_device-search-icon",deviceItem:"Zq10BW_device-item",deviceNameText:"Zq10BW_device-name-text",promptHeader:"Zq10BW_prompt-header",button:"Zq10BW_button"};var _i="./assets/searching-tt57cegv.png";import{jsx as W,jsxs as Te}from"preact/jsx-runtime";function Mi({title:e,icon:r,devices:i,onClose:t,onSearch:o,onConnect:a}){let n=Wa(""),u=Aa(()=>{if(!n.value)return;a(n.value),n.value=""},[a]);return W(Da,{title:e??W(Ee,{id:"gui.connection.device",defaultMessage:"Device"}),className:L.promptModal,headerClassName:L.header,onClose:t,children:Te("div",{className:L.promptContent,children:[W("div",{className:L.deviceList,children:Array.isArray(i)&&i.length>0?i.map((g)=>Te("div",{className:Xe(L.deviceItem,{[L.selected]:g.id===n.value}),onClick:()=>n.value=g.id,children:[Te("div",{className:L.deviceNameBar,children:[r&&W("img",{}),Te("div",{className:L.deviceNameWrapper,children:[W("div",{className:L.deviceNameLabel,children:W(Ee,{id:"gui.connection.deviceName",defaultMessage:"Device name"})}),W("div",{className:L.deviceNameText,children:g.name})]})]}),g.rssi&&W("div",{className:L.deviceSignalBar})]})):W("div",{className:L.deviceSearch,children:W("img",{className:Xe(L.deviceSearchIcon,{[L.deviceSearchingIcon]:Array.isArray(i)}),src:_i})})}),W("div",{className:L.buttonRow,children:i===!0?W(yi,{className:Xe(L.button,L.okButton),onClick:()=>o(),children:W(Ee,{id:"gui.connection.search",defaultMessage:"Start Searching"})}):W(yi,{disabled:!n.value,className:Xe(L.button,L.okButton),onClick:u,children:!n.value?W(Ee,{id:"gui.connection.searching",defaultMessage:"Searching"}):W(Ee,{id:"gui.connection.connect",defaultMessage:"Start Connecting"})})})]})})}import{useEffect as it,useCallback as Qe}from"preact/hooks";import{batch as rt,useSignal as ze,useSignalEffect as at}from"@preact/signals";import{classNames as Fe,getProjectsThumbs as tt,getProject as ot,cloneProject as nt,renameProject as lt,delProject as ct,openProjectFromURL as ut}from"@blockcode/utils";import{maybeTranslate as d1,setAlert as mt,delAlert as gt,openPromptModal as s1,openUserStorage as pt}from"@blockcode/core";var c1="1.3.2";import{Text as A,ContextMenu as dt,LibraryItem as h1}from"@blockcode/core";import{useEffect as Ia}from"preact/hooks";import{useSignal as Pa}from"@preact/signals";import{classNames as qi}from"@blockcode/utils";import{Button as Ra}from"@blockcode/core";_(".tyiNqW_cover-wrapper{width:100%;position:relative}.tyiNqW_cover{opacity:1;background-position:50%;background-repeat:no-repeat;background-size:cover;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 2rem;transition:opacity 1s;display:flex;position:absolute;top:0;left:0}.tyiNqW_cover.tyiNqW_hidden{opacity:0;pointer-events:none}.tyiNqW_title{color:#000;padding-right:1.5rem;font-size:2rem;font-weight:600}.tyiNqW_button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-top:calc(2*var(--space));padding:.75rem 1rem;font-size:.85rem;font-weight:600}.tyiNqW_feature{max-height:90%;margin-right:5%}");var ue={button:"tyiNqW_button",title:"tyiNqW_title",coverWrapper:"tyiNqW_cover-wrapper",hidden:"tyiNqW_hidden",feature:"tyiNqW_feature",cover:"tyiNqW_cover"};import{jsx as He,jsxs as Bi}from"preact/jsx-runtime";function Ei({pages:e,className:r}){let i=Pa(0);return Ia(()=>{setInterval(()=>i.value=(i.value+1)%e.length,7000)},[]),He("div",{className:qi(ue.coverWrapper,r),children:e.map((t,o)=>Bi("div",{className:qi(ue.cover,{[ue.hidden]:o!==i.value}),style:{backgroundImage:`url(${t.backgroundImage})`},children:[Bi("div",{children:[He("div",{className:ue.title,children:t.title}),He(Ra,{className:ue.button,onClick:t.onClick,children:t.buttonText})]}),He("img",{className:ue.feature,src:t.featureImage})]},o))})}_("._9IQa7q_home-wrapper{background:var(--ui-secondary);top:var(--menu-bar-height);width:100%;height:calc(100% - var(--menu-bar-height));z-index:calc(var(--z-index-alerts) - 10);user-select:none;position:absolute;overflow:hidden auto}._9IQa7q_getting-started{height:240px;margin-bottom:1.5rem}._9IQa7q_link{cursor:pointer;color:var(--theme-primary)}._9IQa7q_view-all{font-weight:400;font-size:var(--standard-font-size);margin-left:1.5rem}._9IQa7q_delete-menu-item:hover{background:var(--error-primary)}._9IQa7q_footer{color:var(--text-primary);font-size:var(--small-font-size);padding:3.5rem 0 var(--space);text-align:center}._9IQa7q_footer-item{padding:0 var(--space)}._9IQa7q_footer-item:not(:first-child){border-left:1px solid var(--ui-black-transparent)}._9IQa7q_library-grid{background:var(--ui-secondary);flex-wrap:wrap;flex-grow:1;place-content:flex-start;align-items:flex-start;height:auto;padding:.5rem;display:flex;overflow-y:auto}._9IQa7q_library-label{color:var(--text-primary);padding:1.5rem calc(.5rem + var(--space)).5rem;font-weight:800}._9IQa7q_about-version-content{width:300px}._9IQa7q_about-version-row{margin:var(--space)0;justify-content:space-between;display:flex}");var M={libraryLabel:"_9IQa7q_library-label",libraryGrid:"_9IQa7q_library-grid",footer:"_9IQa7q_footer",footerItem:"_9IQa7q_footer-item",aboutVersionContent:"_9IQa7q_about-version-content",viewAll:"_9IQa7q_view-all",deleteMenuItem:"_9IQa7q_delete-menu-item",link:"_9IQa7q_link",aboutVersionRow:"_9IQa7q_about-version-row",gettingStarted:"_9IQa7q_getting-started",homeWrapper:"_9IQa7q_home-wrapper"};import{Text as Qi}from"@blockcode/core";var Zi="./assets/arcade-rd4cktbf.png";var Li="./assets/arcade-bg-fajmd34e.jpg";import{jsx as Fi}from"preact/jsx-runtime";function u1(e){return{title:Fi(Qi,{id:"gui.home.slideshow.arcade.title",defaultMessage:"The Tank War is coming! Join us! NOW!"}),backgroundImage:Li,featureImage:Zi,buttonText:Fi(Qi,{id:"gui.home.slideshow.arcade.button",defaultMessage:"Play now"}),onClick:()=>e("@blockcode/gui-arcade")}}import{Text as Wi}from"@blockcode/core";var $i="./assets/desktop-s3hfwbpz.png";var Ai="./assets/desktop-bg-pqrd17t9.jpg";import{jsx as Di}from"preact/jsx-runtime";var xi={title:Di(Wi,{id:"gui.home.slideshow.desktop.title",defaultMessage:"The desktop application is here!"}),backgroundImage:Ai,featureImage:$i,buttonText:Di(Wi,{id:"gui.home.slideshow.desktop.button",defaultMessage:"Download"}),onClick:()=>window.open("//app.blockcode.fun/#/?id=download")};function m1(e,r){return[xi,u1(e)]}async function g1(e){let r=await fetch("https://hub.blockcode.fun/home.json").then((i)=>i.json());return Promise.all(r.filter((i)=>i.editor?e.find((t)=>t.id===i.editor):!0).map(async(i)=>{let t=e.find((a)=>a.id===i.editor),o=await fetch(`https://hub.blockcode.fun/${i.import}`).then((a)=>a.json());return{name:t?.name,examples:o.filter((a)=>e.find((n)=>n.id===a.editor)).map((a)=>({...a,file:`https://hub.blockcode.fun/${a.file}`,thumb:`https://hub.blockcode.fun/${a.thumb}`}))}}))}function ie(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Ii(e,r){var i="",t=0,o=-1,a=0,n;for(var u=0;u<=e.length;++u){if(u<e.length)n=e.charCodeAt(u);else if(n===47)break;else n=47;if(n===47){if(o===u-1||a===1);else if(o!==u-1&&a===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var g=i.lastIndexOf("/");if(g!==i.length-1){if(g===-1)i="",t=0;else i=i.slice(0,g),t=i.length-1-i.lastIndexOf("/");o=u,a=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=u,a=0;continue}}if(r){if(i.length>0)i+="/..";else i="..";t=2}}else{if(i.length>0)i+="/"+e.slice(o+1,u);else i=e.slice(o+1,u);t=u-o-1}o=u,a=0}else if(n===46&&a!==-1)++a;else a=-1}return i}function Ha(e,r){var i=r.dir||r.root,t=r.base||(r.name||"")+(r.ext||"");if(!i)return t;if(i===r.root)return i+t;return i+e+t}function Ze(){var e="",r=!1,i;for(var t=arguments.length-1;t>=-1&&!r;t--){var o;if(t>=0)o=arguments[t];else{if(i===void 0)i=process.cwd();o=i}if(ie(o),o.length===0)continue;e=o+"/"+e,r=o.charCodeAt(0)===47}if(e=Ii(e,!r),r)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function Pi(e){if(ie(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;if(e=Ii(e,!r),e.length===0&&!r)e=".";if(e.length>0&&i)e+="/";if(r)return"/"+e;return e}function za(e){return ie(e),e.length>0&&e.charCodeAt(0)===47}function Na(){if(arguments.length===0)return".";var e;for(var r=0;r<arguments.length;++r){var i=arguments[r];if(ie(i),i.length>0)if(e===void 0)e=i;else e+="/"+i}if(e===void 0)return".";return Pi(e)}function Oa(e,r){if(ie(e),ie(r),e===r)return"";if(e=Ze(e),r=Ze(r),e===r)return"";var i=1;for(;i<e.length;++i)if(e.charCodeAt(i)!==47)break;var t=e.length,o=t-i,a=1;for(;a<r.length;++a)if(r.charCodeAt(a)!==47)break;var n=r.length,u=n-a,g=o<u?o:u,c=-1,p=0;for(;p<=g;++p){if(p===g){if(u>g){if(r.charCodeAt(a+p)===47)return r.slice(a+p+1);else if(p===0)return r.slice(a+p)}else if(o>g){if(e.charCodeAt(i+p)===47)c=p;else if(p===0)c=0}break}var B=e.charCodeAt(i+p),d=r.charCodeAt(a+p);if(B!==d)break;else if(B===47)c=p}var h="";for(p=i+c+1;p<=t;++p)if(p===t||e.charCodeAt(p)===47)if(h.length===0)h+="..";else h+="/..";if(h.length>0)return h+r.slice(a+c);else{if(a+=c,r.charCodeAt(a)===47)++a;return r.slice(a)}}function Ga(e){return e}function p1(e){if(ie(e),e.length===0)return".";var r=e.charCodeAt(0),i=r===47,t=-1,o=!0;for(var a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!o){t=a;break}}else o=!1;if(t===-1)return i?"/":".";if(i&&t===1)return"//";return e.slice(0,t)}function Va(e,r){if(r!==void 0&&typeof r!=="string")throw TypeError('"ext" argument must be a string');ie(e);var i=0,t=-1,o=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var n=r.length-1,u=-1;for(a=e.length-1;a>=0;--a){var g=e.charCodeAt(a);if(g===47){if(!o){i=a+1;break}}else{if(u===-1)o=!1,u=a+1;if(n>=0)if(g===r.charCodeAt(n)){if(--n===-1)t=a}else n=-1,t=u}}if(i===t)t=u;else if(t===-1)t=e.length;return e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){i=a+1;break}}else if(t===-1)o=!1,t=a+1;if(t===-1)return"";return e.slice(i,t)}}function Ja(e){ie(e);var r=-1,i=0,t=-1,o=!0,a=0;for(var n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(u===47){if(!o){i=n+1;break}continue}if(t===-1)o=!1,t=n+1;if(u===46){if(r===-1)r=n;else if(a!==1)a=1}else if(r!==-1)a=-1}if(r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1)return"";return e.slice(r,t)}function Ya(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Ha("/",e)}function Ka(e){ie(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,o;if(t)r.root="/",o=1;else o=0;var a=-1,n=0,u=-1,g=!0,c=e.length-1,p=0;for(;c>=o;--c){if(i=e.charCodeAt(c),i===47){if(!g){n=c+1;break}continue}if(u===-1)g=!1,u=c+1;if(i===46){if(a===-1)a=c;else if(p!==1)p=1}else if(a!==-1)p=-1}if(a===-1||u===-1||p===0||p===1&&a===u-1&&a===n+1){if(u!==-1)if(n===0&&t)r.base=r.name=e.slice(1,u);else r.base=r.name=e.slice(n,u)}else{if(n===0&&t)r.name=e.slice(1,a),r.base=e.slice(1,u);else r.name=e.slice(n,a),r.base=e.slice(n,u);r.ext=e.slice(a,u)}if(n>0)r.dir=e.slice(0,n-1);else if(t)r.dir="/";return r}var ja="/",et=":",P2=((e)=>(e.posix=e,e))({resolve:Ze,normalize:Pi,isAbsolute:za,join:Na,relative:Oa,_makeLong:Ga,dirname:p1,basename:Va,extname:Ja,format:Ya,parse:Ka,sep:ja,delimiter:et,win32:null,posix:null});function Le(){let e=window.electron?.getLocalEditors()??[];return Promise.all([].concat(Object.values(e).map(async(r)=>{let{default:i}=await import(r.info);return i.id=r.id,i.image=Ze(p1(r.info),i.image),i}),["@yeqin/gui-tankwar","@blockcode/gui-arcade2","@blockcode/gui-arcade","@blockcode/gui-microbit","@blockcode/gui-esp32","@blockcode/gui-arduino","@blockcode/gui-writer","@blockcode/gui-iotbit","@blockcode/gui-matrix"].map(async(r)=>{let{default:i}=await import(`${r}/info`);return i.id=r,i})))}import{jsx as b,jsxs as U,Fragment as f1}from"preact/jsx-runtime";function Ri({onOpenEditor:e,onOpenProject:r}){let i=Math.floor((document.body.clientWidth-20)/176),t=Math.floor((document.body.clientWidth-20)/236)*2,o=ze(null),a=ze(0),n=ze(null),u=ze(null),g=Qe(async()=>{let m=await tt();rt(()=>{a.value=m.length,o.value=m.filter((f,v)=>v<i)})},[]);it(g,[]);let c=Qe((m,f)=>{s1({title:b(A,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:b(A,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:d1(f??b(A,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(v)=>{if(v?.name)await lt(m,v.name),g()}})},[]),p=Qe(async(m)=>{await nt(m),g()},[]),B=Qe((m,f)=>{s1({title:b(A,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:b(A,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:d1(f||b(A,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await ct(m),g()}})},[]),d=Qe((m)=>async()=>{let f=await ot(m);r(f)},[r]),h=()=>{return o.value?.map((m)=>b(dt,{menuItems:[[{label:b(A,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>c(m.key,m.name)},{label:b(A,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>p(m.key)}],[{label:b(A,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:M.deleteMenuItem,onClick:()=>B(m.key,m.name)}]],children:b(h1,{id:m.key,name:m.name||b(A,{id:"gui.project.shortname",defaultMessage:"Untitled"}),image:m.thumb,onSelect:d(m.key)})},m.key))};return at(async()=>{let m=await Le();m=m.map((f)=>Object.assign(f,{beta:f.beta||!1,disabled:f.disabled||!1,onSelect:()=>e(f.id)})),m=m.filter((f)=>{if(f.hidden)return!1;return!0}),n.value=m.sort((f,v)=>f.sortIndex-v.sortIndex),u.value=await g1(m)}),U("div",{className:M.homeWrapper,children:[b(Ei,{className:M.gettingStarted,pages:m1(e,r)}),o.value?.length>0&&U(f1,{children:[U("div",{className:M.libraryLabel,children:[b("span",{children:b(A,{id:"gui.home.my",defaultMessage:"My projects"})}),a.value>i&&b("span",{className:Fe(M.viewAll,M.link),onClick:pt,children:b(A,{id:"gui.home.allCounts",defaultMessage:"View all ({counts})",counts:a.value})})]}),b("div",{className:M.libraryGrid,children:b(h,{})})]}),n.value?.length>0&&U(f1,{children:[b("div",{className:M.libraryLabel,children:b(A,{id:"gui.home.new",defaultMessage:"Create new project"})}),b("div",{className:M.libraryGrid,children:n.value.map((m,f)=>b(h1,{featured:!0,id:f,disabled:m.disabled,beta:m.beta||m.preview,image:m.image,name:m.name,description:m.description,collaborator:m.collaborator,blocksRequired:m.blocksRequired,micropythonRequired:m.micropythonRequired,clangRequired:m.clangRequired,onSelect:m.onSelect},f))})]}),u.value?.map((m)=>m.examples.length>0&&U(f1,{children:[U("div",{className:M.libraryLabel,children:[b("span",{children:b(A,{id:"gui.home.examples",defaultMessage:"Wonderful {label} examples",label:d1(m.name)})}),m.examples.length>t&&b("span",{className:Fe(M.viewAll,M.link),children:b(A,{id:"gui.home.all",defaultMessage:"View all"})})]}),b("div",{className:M.libraryGrid,children:m.examples.map((f,v)=>b(h1,{large:!0,id:v,name:f.name,author:f.author,copyright:f.copyright,image:f.thumb,onSelect:async()=>{mt("importing",{id:f.name});let Q=await ut(f.file);gt(f.name),r(Q)}}))})]})),U("div",{className:M.footer,children:[b("span",{className:Fe(M.footerItem,M.link),onClick:()=>window.open("https://lab.blockcode.fun/","_blank"),children:"BlockCode Lab"}),b("span",{className:Fe(M.footerItem,M.link),onClick:()=>window.open("https://github.com/BlockCodeLab/playgrounds-app","_blank"),children:"GitHub"}),U("span",{className:Fe(M.footerItem,M.link),onClick:()=>{s1({title:b(A,{id:"gui.about.title",defaultMessage:"About..."}),body:U("div",{className:M.aboutVersionContent,children:[U("div",{className:M.aboutVersionRow,children:[b("div",{children:b("b",{children:b(A,{id:"gui.about.main",defaultMessage:"Main program"})})}),U("div",{children:["v",c1]})]}),b("div",{className:M.aboutVersionRow}),n.value.filter((m)=>!m.disabled).map((m)=>U("div",{className:M.aboutVersionRow,children:[b("div",{children:b("b",{children:m.name})}),U("div",{children:["v",m.version]})]}))]})})},children:["v",c1]})]})]})}import{useComputed as Ji}from"@preact/signals";import{useEffect as It}from"preact/hooks";import{classNames as S,isMac as Pt}from"@blockcode/utils";import{useLocalesContext as Rt,useAppContext as Ut,setLanguage as St,translate as Yi,setMacosMenuBarStyled as Xt}from"@blockcode/core";import{Menu as Ki,MenuItem as Tt,Tooltip as ji}from"@blockcode/core";import{cloneElement as kt}from"preact";import{useMemo as Ct}from"preact/hooks";import{flatChildren as wt}from"@blockcode/utils";var Ui=Object.create(null),b1=document.createElement("div"),Si=document.createElement("style");document.body.insertBefore(Si,document.body.firstChild);var st=(e)=>{return b1.style="",Object.entries(e).forEach(([r,i])=>b1.style[r]=i),b1.style.cssText},ht=()=>{Si.textContent=Object.entries(Ui).map(([e,r])=>`${e}{${st(r)}}`).join(`
`)};function te(e){Object.assign(Ui,e),ht()}import{Menu as _t}from"@blockcode/core";import{useCallback as v1}from"preact/hooks";import{classNames as ft}from"@blockcode/utils";import{jsx as Xi,jsxs as vt,Fragment as bt}from"preact/jsx-runtime";function $e({id:e,className:r,checked:i,children:t,name:o}){let a=v1((g)=>{let c=()=>{g.target.checked=!1,document.removeEventListener("click",c)};document.addEventListener("click",c)},[]),n=v1((g)=>{let c=g.getBoundingClientRect().left;te({[`#${e}-menu-${o}`]:{left:`${c}px`}})},[e,o]),u=v1((g)=>{if(g.target.classList.contains(l.menuLabel))n(g.target);else n(g.target.parentElement)},[]);return vt(bt,{children:[Xi("input",{checked:i,className:l.menuLabel,id:`${e}-label-${o}`,name:`${e}-menu`,type:"radio",value:o,onChange:a}),Xi("label",{className:ft(l.menuLabel,r),for:`${e}-label-${o}`,onClick:u,children:t})]})}import{jsxs as Mt,Fragment as yt}from"preact/jsx-runtime";function Ti({id:e,children:r}){let i=Ct(()=>wt(r).map((t)=>t&&kt(t,{id:e})),[e,r]);return Mt(yt,{children:[i.filter((t)=>t.type===$e),i.filter((t)=>t.type===_t).map((t)=>{let o=`${e}-label-${t.props.name}`,a=`${e}-menu-${t.props.name}`;return te({[`#${o}:checked~#${a}`]:{display:"block"}}),t})]})}import{classNames as Bt}from"@blockcode/utils";import{Text as Et}from"@blockcode/core";var Ne="./assets/icon-tutorials-bh6n0ck2.svg";import{jsx as k1,jsxs as Hi,Fragment as Zt}from"preact/jsx-runtime";function zi({onClick:e}){return Hi(Zt,{children:[k1("div",{className:l.divider}),Hi("div",{className:Bt(l.menuBarItem,l.menuLabel,l.hoverable),onClick:e,children:[k1("img",{className:l.tutorialsIcon,src:Ne}),k1(Et,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]})]})}import{useProjectContext as Lt,BufferedInput as Qt,renameProject as Ft}from"@blockcode/core";import{jsx as C1,jsxs as At,Fragment as $t}from"preact/jsx-runtime";function Ni({placeholder:e,defaultValue:r}){let{name:i}=Lt();return At($t,{children:[C1("div",{className:l.divider}),C1("div",{className:l.menuBarItem,children:C1(Qt,{className:l.titleField,placeholder:e,value:i.value||r,onSubmit:Ft})})]})}var Oi="./assets/icon-language-3wan1389.svg";var Gi="./assets/icon-dropdown-caret-y4j91xc6.svg";var Vi="./assets/icon-home-jt8mdkv3.svg";import{jsx as E,jsxs as oe,Fragment as Ht}from"preact/jsx-runtime";function er({className:e,showHomeButton:r,onRequestHome:i,onOpenTutorialLibrary:t}){let{language:o,languageNames:a}=Rt(),{barItems:n,menuItems:u,tutorials:g,macosMenuBarStyled:c}=Ut(),p=Ji(()=>n.value?.filter((d)=>d.align!=="right")),B=Ji(()=>n.value?.filter((d)=>d.align==="right"));return It(()=>{window.electron?.onChangeFullscreen((d)=>Xt(Pt&&!d))},[]),oe("div",{className:S(l.menuBar,e),children:[oe("div",{className:S(l.mainMenu,{[l.electron]:c.value}),children:[oe(Ti,{id:l.mainMenu,children:[oe($e,{className:S(l.menuBarItem,l.languageLabel),name:"language-selector",children:[E("img",{className:l.languageIcon,src:Oi}),E("img",{src:Gi})]}),E(Ki,{className:l.menu,name:"language-selector",children:Array.from(a.entries()).map(([d,h])=>oe(Tt,{className:l.menuItem,onClick:()=>St(d),children:[E("img",{className:S(l.checkIcon,{[l.checked]:o.value===d}),src:de}),h.languageName]},d))}),u.value&&u.value.map(({icon:d,label:h,Menu:m},f)=>oe(Ht,{children:[oe($e,{className:l.menuBarItem,name:f,children:[typeof d==="string"?E("img",{src:d}):d,E("span",{children:h})]},f),E(Ki,{className:l.menu,name:f,children:E(m,{className:l.menu,itemClassName:l.menuItem})},f)]}))]}),g.value&&E(zi,{onClick:t}),r&&E(Ni,{placeholder:Yi("gui.menubar.titlePlaceholder","Project title here"),defaultValue:Yi("gui.project.name","BlockCode Project")}),p.value?.length>0&&p.value.map(({Label:d,...h})=>h.tooltip?E(ji,{placement:h.tooltipPlacement??"bottom",content:h.tooltip,children:d?E(d,{className:S(l.menuBarItem,l.menuLabel,l.hoverable)}):E("label",{className:S(l.menuBarItem,l.menuLabel,l.hoverable),children:h.label})}):d?E(d,{className:S(l.menuBarItem,l.menuLabel,l.hoverable)}):E("label",{className:S(l.menuBarItem,l.menuLabel,l.hoverable),onClick:h.onClick,children:h.label}))]}),oe("div",{className:l.rightMenu,children:[B.value?.length>0&&B.value.map(({Label:d,...h})=>h.tooltip?E(ji,{placement:h.tooltipPlacement??"bottom",content:h.tooltip,children:d?E(d,{className:S(l.menuBarItem,l.menuLabel,l.hoverable)}):E("label",{className:S(l.menuBarItem,l.menuLabel,l.hoverable),children:h.label})}):d?E(d,{className:S(l.menuBarItem,l.menuLabel,l.hoverable)}):E("label",{className:S(l.menuBarItem,l.menuLabel,l.hoverable),onClick:h.onClick,children:h.label})),r&&E("label",{className:S(l.menuBarItem,l.menuLabel,l.hoverable),onClick:i,children:E("img",{src:Vi})})]})]})}import{classNames as zt}from"@blockcode/utils";_(".fflkNG_pane-wrapper{flex-direction:column;display:flex;position:relative}.fflkNG_pane{display:none}.fflkNG_pane-header{background:var(--ui-white);padding:calc(var(--space)/2);text-align:center;color:var(--text-primary);cursor:pointer;border:1px solid var(--ui-black-transparent);border-radius:var(--space)var(--space)0 0;flex:1;font-size:.85rem}.fflkNG_pane-left .fflkNG_pane-header{border-top-left-radius:0}.fflkNG_pane-right .fflkNG_pane-header{border-top-right-radius:0}.fflkNG_pane-content{border-left:1px solid var(--ui-black-transparent);border-right:1px solid var(--ui-black-transparent);min-height:5.5rem;display:none;position:relative}.fflkNG_pane-left .fflkNG_pane-content{border-left:0}.fflkNG_pane-right .fflkNG_pane-content{border-right:0}.fflkNG_pane:checked~.fflkNG_pane-content{display:flex}");var me={paneRight:"fflkNG_pane-right",paneWrapper:"fflkNG_pane-wrapper",pane:"fflkNG_pane",paneHeader:"fflkNG_pane-header",paneLeft:"fflkNG_pane-left",paneContent:"fflkNG_pane-content"};import{jsx as w1,jsxs as Nt}from"preact/jsx-runtime";function ir({className:e,id:r,title:i,left:t,right:o,children:a}){return Nt("div",{className:zt(me.paneWrapper,e,{[me.paneLeft]:t,[me.paneRight]:o}),children:[w1("input",{id:`${r}-pane`,type:"checkbox",className:me.pane}),w1("label",{className:me.paneHeader,for:`${r}-pane`,children:i}),w1("div",{className:me.paneContent,children:a})]})}import{classNames as rr}from"@blockcode/utils";import{maybeTranslate as Ot,Text as _1,Button as y1,Modal as Gt}from"@blockcode/core";_(".ulcaFG_prompt-modal{width:360px}.ulcaFG_prompt-modal.ulcaFG_wide{width:600px}.ulcaFG_prompt-modal.ulcaFG_auto{width:auto;max-width:60vw}.ulcaFG_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.ulcaFG_label{margin:0 0 1.5rem;font-weight:500}.ulcaFG_label.ulcaFG_input-label{margin-bottom:.75rem}.ulcaFG_content{font-size:var(--standard-font-size);color:var(--text-primary);max-height:400px;margin-bottom:1.5rem;overflow:auto}.ulcaFG_content a{color:var(--theme-primary);border-bottom:1px solid;text-decoration-line:none}.ulcaFG_text-input{border:1px solid var(--ui-black-transparent);width:100%;height:3rem;color:var(--text-primary);border-radius:5px;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.ulcaFG_button-row{text-align:right;font-weight:bolder}.ulcaFG_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.ulcaFG_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var q={promptContent:"ulcaFG_prompt-content",wide:"ulcaFG_wide",textInput:"ulcaFG_text-input",buttonRow:"ulcaFG_button-row",promptModal:"ulcaFG_prompt-modal",button:"ulcaFG_button",okButton:"ulcaFG_ok-button",content:"ulcaFG_content",inputLabel:"ulcaFG_input-label",auto:"ulcaFG_auto",label:"ulcaFG_label"};import{useCallback as Vt}from"preact/hooks";import{jsx as J,jsxs as ar,Fragment as Jt}from"preact/jsx-runtime";function tr({title:e,label:r,content:i,redStyle:t,children:o,onClose:a,onSubmit:n}){let u=Vt(()=>{n(),a()},[a,n]);return J(Gt,{title:e,redStyle:t,className:rr(q.promptModal,{[q.wide]:i,[q.auto]:o}),onClose:a,children:ar("div",{className:q.promptContent,children:[r&&J("div",{className:q.label,children:r}),i?J("div",{className:q.content,dangerouslySetInnerHTML:{__html:Ot(i)}}):J("div",{className:q.content,children:o}),J("div",{className:q.buttonRow,children:n?ar(Jt,{children:[J(y1,{className:q.button,onClick:a,children:J(_1,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),J(y1,{className:rr(q.button,q.okButton),onClick:u,children:J(_1,{id:"gui.prompt.ok",defaultMessage:"OK"})})]}):J(y1,{className:q.button,onClick:a,children:J(_1,{id:"gui.prompt.close",defaultMessage:"Close"})})})]})})}import{useCallback as M1,useEffect as Yt}from"preact/hooks";import{useSignal as Kt}from"@preact/signals";import{classNames as or}from"@blockcode/utils";import{maybeTranslate as nr,Text as lr,BufferedInput as jt,Button as cr,Modal as eo}from"@blockcode/core";import{jsx as ne,jsxs as q1,Fragment as io}from"preact/jsx-runtime";function ur({title:e,inputItems:r,content:i,onClose:t,onSubmit:o}){let a=Kt(Object.fromEntries(r.map(({name:c,defaultValue:p})=>[c,p]))),n=M1((c)=>{if(c.stopPropagation(),c.key==="Escape")t()},[t]),u=M1(()=>{o(a.value),t()},[t,o]),g=M1((c)=>(p)=>{a.value={...a.value,[c]:p}},[]);return Yt(()=>{return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),ne(eo,{title:e,className:q.promptModal,onClose:t,children:q1("div",{className:q.promptContent,children:[r.map(({name:c,label:p,placeholder:B,defaultValue:d},h)=>q1(io,{children:[p&&ne("div",{className:or(q.label,q.inputLabel),children:p}),ne(jt,{autoFocus:h===0,className:q.textInput,placeholder:nr(B),defaultValue:d,onSubmit:g(c)},h)]})),i&&ne("div",{className:q.content,dangerouslySetInnerHTML:{__html:nr(i)}}),q1("div",{className:q.buttonRow,children:[ne(cr,{className:q.button,onClick:t,children:ne(lr,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),ne(cr,{className:or(q.button,q.okButton),onClick:u,children:ne(lr,{id:"gui.prompt.ok",defaultMessage:"OK"})})]})]})})}import{classNames as ro}from"@blockcode/utils";import{Text as B1,Spinner as ao}from"@blockcode/core";_(".LkfKFW_splash{background:var(--theme-primary);z-index:var(--z-index-modal);flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute;inset:0}.LkfKFW_spinner{margin-bottom:calc(4*var(--space))}.LkfKFW_error{background:var(--error-primary)}.LkfKFW_title{color:var(--ui-white);margin:var(--space);font-size:2rem}.LkfKFW_label{color:var(--ui-white);margin:var(--space)}");var be={spinner:"LkfKFW_spinner",error:"LkfKFW_error",splash:"LkfKFW_splash",title:"LkfKFW_title",label:"LkfKFW_label"};import{jsx as ve,jsxs as to}from"preact/jsx-runtime";function mr({error:e}){return to("div",{className:ro(be.splash,{[be.error]:e}),children:[!e&&ve(ao,{large:!0,level:"info",className:be.spinner}),ve("div",{className:be.title,children:e?ve(B1,{id:"gui.splash.errorTitle",defaultMessage:"Error Occurred"}):ve(B1,{id:"gui.splash.loading",defaultMessage:"Loading project..."})}),ve("div",{className:be.label,children:e&&ve(B1,{id:"gui.splash.errorLabel",defaultMessage:"Please refresh the page and reopen it."})})]})}import{cloneElement as mo}from"preact";import{useMemo as go}from"preact/hooks";import{classNames as po,flatChildren as so}from"@blockcode/utils";import{classNames as oo}from"@blockcode/utils";_(".M5TDuW_tabs-wrapper{white-space:nowrap;position:relative}.M5TDuW_tab-label{--line-height:calc(var(--tool-bar-height)*.8 - 2px);--margin-top:calc(var(--tool-bar-height)*.2 + 1px);font-weight:500;font-size:var(--standard-font-size);line-height:var(--line-height);border:1px solid var(--ui-black-transparent);background:var(--ui-tertiary);color:var(--text-transparent);margin-top:var(--margin-top);white-space:nowrap;border-radius:1rem 1rem 0 0;justify-content:center;padding:0 1.25rem;display:inline-flex;position:relative}.M5TDuW_tab-label.M5TDuW_disabled{filter:opacity(.5);cursor:default;pointer-events:none}.M5TDuW_tab-label:nth-of-type(n+2){margin-left:calc(-1*var(--space))}.M5TDuW_tab-label:last-of-type{margin-right:var(--space)}.M5TDuW_tab-label:not(.M5TDuW_disabled):hover{cursor:pointer;background:var(--ui-primary)}.M5TDuW_tab-label img{filter:grayscale();width:1.375rem}.M5TDuW_tab{display:none}.M5TDuW_tab:checked+.M5TDuW_tab-label{--scale:var(--space)/2;line-height:calc(var(--line-height) + var(--scale));margin-top:calc(var(--margin-top) - var(--scale));color:var(--theme-primary);background:var(--ui-white)}.M5TDuW_tab:checked+.M5TDuW_tab-label img{filter:none}.M5TDuW_tab-panel{top:var(--tool-bar-height);width:100%;height:calc(100% - var(--tool-bar-height));border:1px solid var(--ui-black-transparent);border-radius:0 var(--space)var(--space)var(--space);flex-direction:column;display:flex;position:absolute;bottom:0;transform:translateY(200%)}");var Y={tabsWrapper:"M5TDuW_tabs-wrapper",tab:"M5TDuW_tab",tabPanel:"M5TDuW_tab-panel",disabled:"M5TDuW_disabled",tabLabel:"M5TDuW_tab-label"};import{jsx as gr,jsxs as lo,Fragment as no}from"preact/jsx-runtime";function Oe({id:e,className:r,disabled:i,checked:t,children:o,name:a,onSelect:n}){return lo(no,{children:[gr("input",{disabled:i,checked:t,className:Y.tab,id:`${e}-tab-${a}`,name:`${e}-tab`,type:"radio",value:a}),gr("label",{className:oo(Y.tabLabel,r,{[Y.disabled]:i}),for:`${e}-tab-${a}`,onClick:n,children:o})]})}import{classNames as co}from"@blockcode/utils";import{jsx as uo}from"preact/jsx-runtime";function Ge({id:e,className:r,name:i,children:t}){return uo("div",{className:co(Y.tabPanel,r),id:`${e}-panel-${i}`,children:t})}import{jsxs as ho}from"preact/jsx-runtime";function pr({id:e,className:r,children:i}){let t=go(()=>so(i).filter((o)=>o).map((o)=>mo(o,{id:e})),[e,i]);return te({[`.${Y.tab}:checked+.${Y.tabLabel}`]:{zIndex:`${t.length+1}`}}),ho("div",{className:po(Y.tabsWrapper,r),children:[t.filter((o)=>o.type===Oe).map((o,a,n)=>{return te({[`.${Y.tabLabel}:nth-of-type(${a+1})`]:{zIndex:`${n.length-a}`}}),o}),t.filter((o)=>o.type===Ge).map((o)=>{let a=`${e}-tab-${o.props.name}`,n=`${e}-panel-${o.props.name}`;return te({[`#${a}:checked~#${n}`]:{transform:"none"}}),o})]})}import{useRef as Co,useEffect as fr,useCallback as Z1}from"preact/hooks";import{batch as wo,useComputed as _o,useSignal as L1}from"@preact/signals";import{classNames as yo}from"@blockcode/utils";import{useAppContext as Mo,Text as ke,Button as qo}from"@blockcode/core";_("._4EOxpW_tutorial-box-wrapper{pointer-events:auto;z-index:var(--z-index-card);min-width:468px;position:absolute;bottom:10%;left:50%;transform:translate(-50%)}._4EOxpW_tutorial-card{border:1px solid var(--ui-tertiary);border-radius:calc(var(--space)*1.8);cursor:move;box-shadow:0px 5px 25px 5px var(--ui-black-transparent);z-index:20;flex-direction:column;align-items:center;display:flex;overflow:hidden}._4EOxpW_card-header{background:var(--blocks-primary);width:100%;font-size:var(--small-font-size);flex-direction:row;justify-content:space-between;align-items:center;font-weight:700;display:flex}._4EOxpW_header-button-group{flex-direction:row;display:flex}._4EOxpW_header-button{cursor:pointer;color:#fff;flex-direction:column;justify-content:center;align-items:center;padding:.75rem;display:flex}._4EOxpW_header-button:hover{background:var(--ui-black-transparent)}._4EOxpW_button-icon{border:0;height:1.25rem}._4EOxpW_step-list{flex-direction:row;justify-content:center;align-items:center;display:flex}._4EOxpW_step-pip{cursor:pointer;background:var(--ui-white-transparent);border-radius:100%;width:.5rem;height:.5rem;margin:0 .25rem}._4EOxpW_step-pip._4EOxpW_actived{background:var(--ui-white);-webkit-box-shadow:0px 0px 0px 2px var(--ui-black-transparent);box-shadow:0px 0px 0px 2px var(--ui-black-transparent)}._4EOxpW_card-body{background:var(--ui-white);border-top:1px solid var(--blocks-tertiary);text-align:center;width:100%;min-height:256px;color:var(--text-primary);flex-direction:column;justify-content:center;align-items:center;display:flex;position:relative}._4EOxpW_title{text-align:center;margin:.9rem;font-size:.9rem;font-weight:700}._4EOxpW_image{object-fit:contain;background:var(--ui-secondary);border-radius:var(--space);max-width:450px;max-height:200px;margin:0 var(--space)var(--space);overflow:hidden}._4EOxpW_text{max-width:450px;height:200px;margin:0 var(--space)2.7rem var(--space);flex-direction:column;justify-content:center;font-size:1rem;display:flex}._4EOxpW_image+._4EOxpW_text{height:auto}._4EOxpW_more{padding:0 .9rem var(--space);flex-direction:row;justify-content:space-around;display:flex}._4EOxpW_more-item{margin:0 var(--space)var(--space);cursor:pointer;border-radius:var(--space);border:1px solid #00000026;flex-direction:column;display:flex;overflow:hidden}._4EOxpW_more-item-image{object-fit:cover;width:200px;height:100px}._4EOxpW_more-item-name{color:var(--theme-primary);margin:calc(var(--space)*1.2)0px;text-align:center;text-align:center;max-width:200px;font-size:.85rem;font-weight:700}._4EOxpW_see-more-button{background:var(--theme-primary);color:var(--ui-white);border:0;margin-bottom:2.7rem}._4EOxpW_left-page,._4EOxpW_right-page{background:var(--ui-white);border:1px solid var(--ui-black-transparent);height:90%;width:calc(var(--space)*1.8);opacity:.9;z-index:10;position:absolute;top:5%;overflow:hidden}._4EOxpW_left-page:after,._4EOxpW_right-page:after{content:\"\";background:var(--blocks-primary);width:100%;height:2.5rem;position:absolute;top:0;left:0}._4EOxpW_left-button,._4EOxpW_right-button{user-select:none;cursor:pointer;background:var(--blocks-primary);box-shadow:0 0 0 4px var(--blocks-transparent);z-index:30;border-radius:100%;justify-content:center;align-items:center;width:44px;height:44px;margin-top:-15px;transition:all .25s;display:flex;position:absolute;top:50%}._4EOxpW_left-button:hover,._4EOxpW_right-button:hover{box-shadow:0 0 0 6px var(--blocks-transparent);transform:scale(1.125)}._4EOxpW_left-button img,._4EOxpW_right-button img{width:1.75rem}._4EOxpW_left-page{border-top-left-radius:calc(var(--space)*1.8);border-bottom-left-radius:calc(var(--space)*1.8);border-right:0;left:0;transform:translate(-100%)}._4EOxpW_left-button{left:-27px}._4EOxpW_right-page{border-top-right-radius:calc(var(--space)*1.8);border-bottom-right-radius:calc(var(--space)*1.8);border-left:0;right:0;transform:translate(100%)}._4EOxpW_right-button{right:-27px}._4EOxpW_right-button img{transform:rotateY(180deg)}");var C={buttonIcon:"_4EOxpW_button-icon",more:"_4EOxpW_more",tutorialCard:"_4EOxpW_tutorial-card",headerButtonGroup:"_4EOxpW_header-button-group",headerButton:"_4EOxpW_header-button",stepPip:"_4EOxpW_step-pip",cardBody:"_4EOxpW_card-body",moreItemImage:"_4EOxpW_more-item-image",cardHeader:"_4EOxpW_card-header",moreItemName:"_4EOxpW_more-item-name",seeMoreButton:"_4EOxpW_see-more-button",text:"_4EOxpW_text",actived:"_4EOxpW_actived",moreItem:"_4EOxpW_more-item",rightPage:"_4EOxpW_right-page",stepList:"_4EOxpW_step-list",tutorialBoxWrapper:"_4EOxpW_tutorial-box-wrapper",image:"_4EOxpW_image",leftButton:"_4EOxpW_left-button",rightButton:"_4EOxpW_right-button",title:"_4EOxpW_title",leftPage:"_4EOxpW_left-page"};var dr="./assets/icon-shrink-8vdqegra.svg";var sr="./assets/icon-expand-67bgdn61.svg";var hr="./assets/icon-close-dy7x7fdb.svg";var E1="./assets/icon-arrow-ddhj68kd.svg";import{jsx as y,jsxs as X,Fragment as Ae}from"preact/jsx-runtime";function br({tutorialId:e,onOpenTutorial:r,onBack:i,onClose:t}){let o=Co(),{tutorials:a}=Mo(),n=L1(null),u=L1(-1),g=L1(!0),c=_o(()=>n.value?.[u.value]),p=Z1(()=>{u.value=(u.value+1)%n.value.length},[]),B=Z1(()=>{u.value=(u.value-1)%n.value.length},[]);return fr(()=>{let d=a.value.lessons[e];if(!d){t();return}wo(()=>{n.value=[].concat(d.pages,d.next?{next:d.next.filter((h)=>a.value.lessons[h]).map((h)=>({id:h,title:a.value.lessons[h].title,image:a.value.lessons[h].image}))}:[]),u.value=0})},[e]),fr(()=>{if(o.current){let d=o.current.parentElement,h,m,f=(Q)=>{let H=h-Q.clientX,I=m-Q.clientY;h=Q.clientX,m=Q.clientY,d.style.top=`${d.offsetTop-I}px`,d.style.left=`${d.offsetLeft-H}px`,d.style.bottom="unset"},v=()=>{document.removeEventListener("pointerup",v),document.removeEventListener("pointermove",f)};o.current.addEventListener("pointerdown",(Q)=>{h=Q.clientX,m=Q.clientY,f(Q),document.addEventListener("pointerup",v),document.addEventListener("pointermove",f)})}},[]),X("div",{className:C.tutorialBoxWrapper,children:[X("div",{ref:o,className:C.tutorialCard,children:[X("div",{className:C.cardHeader,children:[X("div",{className:C.headerButton,onClick:i,children:[y("img",{className:C.buttonIcon,src:Ne}),y(ke,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]}),y("div",{className:C.stepList,children:n.value?.map((d,h)=>y("div",{className:yo(C.stepPip,{[C.actived]:h===u.value}),onClick:()=>u.value=h},h))}),X("div",{className:C.headerButtonGroup,children:[y("div",{className:C.headerButton,onClick:Z1(()=>g.value=!g.value,[]),children:g.value?X(Ae,{children:[y("img",{className:C.buttonIcon,src:dr}),y(ke,{id:"gui.tutorials.shrink",defaultMessage:"Shrink"})]}):X(Ae,{children:[y("img",{className:C.buttonIcon,src:sr}),y(ke,{id:"gui.tutorials.expand",defaultMessage:"Expand"})]})}),X("div",{className:C.headerButton,onClick:t,children:[y("img",{className:C.buttonIcon,src:hr}),y(ke,{id:"gui.tutorials.close",defaultMessage:"Close"})]})]})]}),g.value&&c.value&&X("div",{className:C.cardBody,children:[(c.value.title||c.value.next)&&y("div",{className:C.title,children:c.value.title||y(ke,{id:"gui.tutorials.moreTry",defaultMessage:"More things to try!"})}),c.value.image&&y("img",{className:C.image,src:c.value.image}),c.value.text&&y("div",{className:C.text,children:c.value.text}),c.value.next&&X(Ae,{children:[y("div",{className:C.more,children:c.value.next.map((d)=>X("div",{className:C.moreItem,onClick:()=>r(d.id),children:[y("img",{className:C.moreItemImage,src:d.image}),y("div",{className:C.moreItemName,children:d.title})]},d.id))}),y(qo,{className:C.seeMoreButton,onClick:i,children:y(ke,{id:"gui.tutorials.seeMore",defaultMessage:"See more"})})]})]})]}),g.value&&u.value>0&&X(Ae,{children:[y("div",{className:C.leftPage}),y("div",{className:C.leftButton,onClick:B,children:y("img",{src:E1})})]}),g.value&&n.value&&u.value<n.value.length-1&&X(Ae,{children:[y("div",{className:C.rightPage}),y("div",{className:C.rightButton,onClick:p,children:y("img",{src:E1})})]})]})}import{useComputed as Bo}from"@preact/signals";import{useAppContext as Eo,Text as Zo,Library as Lo}from"@blockcode/core";import{jsx as kr}from"preact/jsx-runtime";var Qo=kr(Zo,{id:"gui.library.tutorials.tutorial",defaultMessage:"Choose a tutorial"});function vr({onOpenTutorial:e,onClose:r}){let{tutorials:i}=Eo(),t=Bo(()=>{return Object.entries(i.value.lessons).map(([a,n])=>({title:n.title,image:n.image,tags:n.tags,onSelect:()=>e(a)}))});return kr(Lo,{featured:!0,items:t.value,title:i.value.title||Qo,filterable:i.value.tags,tags:i.value.tags,onClose:r})}import{useCallback as We,useEffect as Fo}from"preact/hooks";import{useComputed as $o,useSignal as Ao}from"@preact/signals";import{getProjectsThumbs as Wo,getProject as Do,cloneProject as xo,renameProject as Io,delProject as Po}from"@blockcode/utils";import{useProjectContext as Ro,closeUserStorage as wr,maybeTranslate as Q1,openPromptModal as _r}from"@blockcode/core";import{Text as K,Library as Uo}from"@blockcode/core";_(".mLGZyG_delete-menu-item:hover{background:var(--error-primary)}");var Cr={deleteMenuItem:"mLGZyG_delete-menu-item"};import{jsx as N}from"preact/jsx-runtime";var So=30;function yr({onOpenProject:e}){let{meta:r}=Ro(),i=Ao([]),t=$o(()=>i.value.length),o=We((c,p)=>{_r({title:N(K,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:N(K,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:Q1(p??N(K,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(B)=>{if(B?.name)await Io(c,B.name),g()}})},[]),a=We(async(c)=>{await xo(c),g()},[]),n=We((c,p)=>{_r({title:N(K,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:N(K,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:Q1(p||N(K,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await Po(c),g()}})},[]),u=We((c)=>async()=>{let p=await Do(c);e(p),wr()},[]),g=We(async()=>{let c=await Wo();if(r.value?.editor)c=c.filter((p)=>p.meta.editor===r.value.editor);c=c.sort((p,B)=>B.modifiedDate-p.modifiedDate),i.value=c.map((p)=>({name:Q1(p.name??N(K,{id:"gui.project.shortname",defaultMessage:"Untitled"})),image:p.thumb,onSelect:u(p.key),contextMenu:[[{label:N(K,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>o(p.key,p.name)},{label:N(K,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>a(p.key)}],[{label:N(K,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:Cr.deleteMenuItem,onClick:()=>n(p.key,p.name)}]]}))},[u,o,n]);return Fo(()=>g(),[g]),N(Uo,{items:i.value,filterable:t.value>So,emptyMessage:N(K,{id:"gui.library.projects.empty",defaultMessage:"No project!"}),onClose:wr})}_("._3HqakW_gui-wrapper{height:100%}._3HqakW_alerts-container{width:100%;z-index:var(--z-index-alerts);margin-top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;justify-content:center;display:flex;position:absolute}._3HqakW_menu-bar-position{z-index:var(--z-index-menu-bar);position:relative}._3HqakW_body-wrapper{height:calc(100% - var(--menu-bar-height));background:var(--ui-primary)}._3HqakW_body-wrapper *{box-sizing:border-box}._3HqakW_workspace-wrapper{flex-direction:row;height:100%;display:flex;overflow-y:hidden}._3HqakW_sidebar-wrapper{margin:0 var(--space);display:flex;position:relative}._3HqakW_editor-wrapper{flex-direction:column;flex-grow:1;flex-shrink:0;display:flex;position:relative}._3HqakW_tabs-wrapper{flex-grow:1;position:relative}._3HqakW_tab-panel-no-left{border-bottom-left-radius:0}._3HqakW_tab-panel-no-right{border-top-right-radius:0;border-bottom-right-radius:0}._3HqakW_tab-panel-no-bottom{border-bottom-right-radius:0;border-bottom-left-radius:0}._3HqakW_pane-wrapper{margin:var(--space)0 0 0;display:flex;position:relative}");var P={tabPanelNoRight:"_3HqakW_tab-panel-no-right",alertsContainer:"_3HqakW_alerts-container",menuBarPosition:"_3HqakW_menu-bar-position",bodyWrapper:"_3HqakW_body-wrapper",guiWrapper:"_3HqakW_gui-wrapper",editorWrapper:"_3HqakW_editor-wrapper",paneWrapper:"_3HqakW_pane-wrapper",sidebarWrapper:"_3HqakW_sidebar-wrapper",tabPanelNoLeft:"_3HqakW_tab-panel-no-left",tabsWrapper:"_3HqakW_tabs-wrapper",tabPanelNoBottom:"_3HqakW_tab-panel-no-bottom",workspaceWrapper:"_3HqakW_workspace-wrapper"};import{jsx as w,jsxs as xe,Fragment as Zr}from"preact/jsx-runtime";var _e=zo({Bluetooth:null,SerialPort:null});function Lr(){let[e]=Xo(),{language:r}=Vo(),i=Go();F1(()=>{document.title=Yo("gui.name","BlockCode Playgrounds"),document.title+=" [BETA]"},[r.value]);let t=Mr(()=>{let s={};return i.docks.value?.forEach((k)=>{if(k.expand==="bottom")s.paneLabel=k.label,s.PaneContent=k.Content;else if(k.expand==="left")s.LeftDockContent=k.Content;else s.RightDockContent=k.Content}),s}),{LeftDockContent:o,RightDockContent:a,PaneContent:n}=t.value,u=Ho({[P.tabPanelNoLeft]:!o,[P.tabPanelNoRight]:!a,[P.tabPanelNoBottom]:!n}),g=Ve(null);F1(()=>{if($1)window.electron.serial.onScan((s)=>{g.value=s&&{devices:s,type:_e.SerialPort}}),window.electron.bluetooth.onScan((s)=>{g.value=s&&{devices:s,type:_e.Bluetooth}})},[]);let c=()=>{},p=T(()=>{if($1){if(g.value.type===_e.SerialPort)window.electron.serial.cancel();if(g.value.type===_e.Bluetooth)window.electron.bluetooth.cancel();g.value=null}},[]),B=T((s)=>{if($1){if(g.value.type===_e.SerialPort)window.electron.serial.connect(s);if(g.value.type===_e.Bluetooth)window.electron.bluetooth.connect(s)}},[]),d=Ve({});To(async()=>{let s=await Le();s=s.map((k)=>[k.id,{name:k.name,version:k.version}]),d.value=Object.fromEntries(s)});let h=T(()=>{Ce(()=>{i.appState.value?.device?.disconnect(),De("device",null),tn(),rn()})},[]),m=T((s)=>{Ce(()=>{qr(),an(Object.assign(JSON.parse(JSON.stringify(s)),{fileId:s.fileId??s.files?.[0]?.id})),Er(0)})},[]),f=Ve(!1),v=Ve(null),Q=T(()=>{Ce(()=>{v.value=null,f.value=!0})},[]),H=T((s)=>{let k=i.tutorials.value.lessons[s];Ce(async()=>{if(k.project){on("importing",{id:s});let R=await No(k.project);nn(s),m(R)}v.value=s,f.value=!1})},[]),{meta:I,key:A1,modified:W1}=Jo(),D1=Mr(()=>!I.value),Qr=T(()=>{if(W1.value)Je({title:w(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:w(we,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:h});else h()},[]),Ye=T((s,k)=>{if(k!==s.meta.editor){Je({label:w(we,{id:"gui.library.projects.errorEditor",defaultMessage:'This project is not currently editor creation, please switch to "{editor}" and open it.',editor:Ko(d.value[s.meta.editor]?.name)}),redStyle:!0});return}if(A1.value===s.key)return;if(W1.value)Je({title:w(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:w(we,{id:"gui.library.projects.replace",defaultMessage:"Replace contents of the current project?"}),onSubmit:()=>m(s)});else m(s)},[]),x1=T(async(s,k)=>{Ce(()=>{h(),qr()});let R=s,P1=window.electron?.getLocalEditors();if(P1?.[s]?.main)R=P1[s].main;let le;try{le=(await import(R)).default}catch(pn){Je({label:w(we,{id:"gui.library.projects.notFoundEditor",defaultMessage:'Not Found the "{editor}" Editor.',editor:s}),redStyle:!0}),jo();return}let Ke={editor:s,version:d.value[s]?.version};if(!k)k=JSON.parse(JSON.stringify(await le.onNew()));if(!k.meta)k.meta=Ke;if(!k.meta.editor)k.meta.editor=s,k.meta.version=Ke.version;let Fr={menuItems:hi(le,Ke,Ye),barItems:le.barItems,tabs:le.tabs,docks:le.docks,tutorials:window.electron?.getLocalTutorials(s,r.value)??le.tutorials};Ce(()=>{en(Fr),Ye(k,s)})},[]),I1=T((s)=>{if(I.value?.editor!==s.meta.editor){h(),x1(s.meta.editor,s);return}Ye(s,I.value.editor)},[]);return F1(()=>{if(I.value?.editor){if(Oo(I.value.editor))De("panelBoxId","Logs")}else De("panelBoxId",null)},[I.value?.editor]),xe(Zr,{children:[(i.splashVisible.value||e)&&w(mr,{error:e}),w(wi,{items:i.alerts.value}),w(er,{className:P.menuBarPosition,showHomeButton:!D1.value,onRequestHome:Qr,onOpenTutorialLibrary:Q}),w("div",{className:P.bodyWrapper,children:xe("div",{className:P.workspaceWrapper,children:[o&&w("div",{className:P.sidebarWrapper,children:w(o,{})}),xe("div",{className:P.editorWrapper,children:[w(pr,{id:P.tabsWrapper,className:P.tabsWrapper,children:i.tabs.value?.map(({Content:s,...k},R)=>xe(Zr,{children:[xe(Oe,{name:R,disabled:k.disabled,checked:R===i.tabIndex.value,onSelect:()=>Er(R),children:[w("img",{src:k.icon}),k.label]},R),w(Ge,{name:R,className:u,children:(R===0||i.tabIndex.value===R)&&s&&w(s,{})},R)]}))}),n&&w(ir,{id:P.paneWrapper,className:P.paneWrapper,title:t.value.paneLabel,right:!a,left:!o,children:w(n,{})})]}),a&&w("div",{className:P.sidebarWrapper,children:w(a,{})})]})}),i.appState.value?.panelBoxId&&w(ci,{panelId:i.appState.value.panelBoxId,onPanelChange:T((s)=>De("panelBoxId",s),[]),onClose:T(()=>De("panelBoxId",null),[])}),g.value&&w(Mi,{title:I.value.deviceName,icon:I.value.deviceIcon,devices:g.value.devices,onClose:p,onConnect:B}),v.value&&w(br,{tutorialId:v.value,onOpenTutorial:H,onBack:Q,onClose:()=>v.value=null}),f.value&&w(vr,{onOpenTutorial:H,onClose:T(()=>f.value=!1,[])}),D1.value&&w(Ri,{onOpenEditor:x1,onOpenProject:I1}),i.userStorageVisible.value&&w(yr,{onOpenProject:I1}),i.prompt.value&&(i.prompt.value.inputItems?w(ur,{title:i.prompt.value.title,content:i.prompt.value.content,inputItems:i.prompt.value.inputItems,onClose:Br,onSubmit:i.prompt.value.onSubmit}):w(tr,{title:i.prompt.value.title,label:i.prompt.value.label,content:i.prompt.value.content,redStyle:i.prompt.value.redStyle,onClose:Br,onSubmit:i.prompt.value.onSubmit,children:i.prompt.value.body}))]})}import{addAlertConfig as D,Text as x,Spinner as ge}from"@blockcode/core";import{jsx as Z}from"preact/jsx-runtime";D("importing",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.importing",defaultMessage:"Importing..."})});D("downloading",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.downloading",defaultMessage:"Downloading...{progress}%"})});D("downloadCompleted",{icon:null,message:Z(x,{id:"gui.alert.downloadCompleted",defaultMessage:"Download completed."})});D("connecting",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.connecting",defaultMessage:"Connecting..."})});D("connected",{icon:null,message:Z(x,{id:"gui.alert.connected",defaultMessage:"Connected."})});D("connectionCancel",{icon:null,mode:"warn",message:Z(x,{id:"gui.alert.connectionCancel",defaultMessage:"Connection cancel."})});D("connectionError",{icon:null,mode:"warn",message:Z(x,{id:"gui.alert.connectionError",defaultMessage:"Connection error or connection was lost."})});D("erasing",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.erasing",defaultMessage:"Erasing..."})});D("restoring",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.restoring",defaultMessage:"Firmware restoring...{progress}%"})});D("recovering",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.recovering",defaultMessage:"Recovering..."})});D("restoreCompleted",{icon:null,message:Z(x,{id:"gui.alert.restoreCompleted",defaultMessage:"Firmware resotre completed! Now press RESET key"})});D("compiling",{icon:Z(ge,{level:"success"}),message:Z(x,{id:"gui.alert.compiling",defaultMessage:"Compiling..."})});D("compileCompleted",{icon:null,message:Z(x,{id:"gui.alert.compileCompleted",defaultMessage:"Compilation completed."})});D("compileError",{icon:null,mode:"warn",message:Z(x,{id:"gui.alert.compileError",defaultMessage:"Compilation error."})});D("reseting",{icon:null,message:Z(x,{id:"gui.alert.reseting",defaultMessage:"Reseting..."})});import{jsx as Ie}from"preact/jsx-runtime";function gn(){return Ie(cn,{children:Ie(un,{children:Ie(mn,{children:Ie(Lr,{})})})})}ln(Ie(gn,{}),document.getElementById("root"));
