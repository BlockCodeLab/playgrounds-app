import{addLocalesMessages as E1}from"@blockcode/core";var Ri={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"Importing...","gui.alert.downloading":"Downloading...{progress}%","gui.alert.downloadCompleted":"Download completed.","gui.alert.connecting":"Connecting...","gui.alert.connected":"Connected.","gui.alert.connectionCancel":"Connection cancel.","gui.alert.connectionError":"Connection error or connection was lost.","gui.alert.erasing":"Erasing...","gui.alert.restoring":"Firmware restoring...{progress}%","gui.alert.recovering":"Recovering...","gui.alert.restoreCompleted":"Firmware resotre completed! Now press RESET key","gui.alert.reseting":"Reseting...","gui.alert.compiling":"Compiling...","gui.alert.compileCompleted":"Compilation completed.","gui.alert.compileError":"Compilation failed.","gui.alert.compileViewError":"View Message.","gui.alert.saving":"Saving project...","gui.alert.saved":"Saved.","gui.alert.savedComputer":"Saved to your computer.","gui.alert.saveAbortError":"Abort saving.","gui.alert.saveError":"Failed save.","gui.logs.changeDevice":"Device changed to {device}","gui.logs.connected":"Device connected","gui.logs.connectedType":"Device connected with {type}","gui.logs.disconnected":"Device disconnected","gui.logs.compiling":"Compiling...","gui.logs.compiled":"Compile completed","gui.logs.downloading":"Downloading...","gui.logs.downloaded":"Download completed","gui.logs.downloadError":"Download failed","gui.home.my":"My projects","gui.home.all":"View all","gui.home.allCounts":"View all ({counts})","gui.home.new":"Create new project","gui.home.examples":"Wonderful {label} projects","gui.home.slideshow.desktop.title":"The desktop application is here!","gui.home.slideshow.desktop.button":"Download","gui.home.slideshow.tankwar.title":"The Tank War is coming! Join us!","gui.home.slideshow.tankwar.button":"Join us","gui.home.slideshow.arcade.title":"The next game, create your own!","gui.home.slideshow.arcade.button":"Create now","gui.splash.loading":"Loading project...","gui.splash.errorTitle":"Error occurred","gui.splash.errorLabel":"Please refresh the page and reopen it.","gui.menubar.courses":"Courses","gui.menubar.tutorials":"Tutorials","gui.menubar.titlePlaceholder":"Project title here","gui.menubar.file":"File","gui.menubar.file.newProject":"New","gui.menubar.file.openProject":"Open...","gui.menubar.file.saveProject":"Save","gui.menubar.file.uploadProject":"Load from your computer...","gui.menubar.file.downloadProject":"save to your computer...","gui.menubar.edit":"Edit","gui.menubar.edit.undo":"Undo","gui.menubar.edit.redo":"Redo","gui.menubar.edit.openManualCoding":"Turn on Coding Mode","gui.menubar.edit.closeManualCoding":"Turn off Coding Mode","gui.menubar.edit.openCompactBlock":"Turn on Compact Block","gui.menubar.edit.closeCompactBlock":"Turn off Compact Block","gui.menubar.view":"View","gui.menubar.view.log":"Log Panel","gui.menubar.view.serial":"Serial Panel","gui.menubar.view.files":"Files Panel","gui.menubar.view.openAutoDisplayPanel":"Turn on auto display Log Panel","gui.menubar.view.closeAutoDisplayPanel":"Turn off auto display Log Panel","gui.menubar.device":"Device","gui.menubar.device.sync":"Sync program","gui.menubar.device.download":"Download program","gui.menubar.device.reset":"Reset device","gui.menubar.device.connect":"Connect device...","gui.menubar.device.connectUsb":"Connect device with USB...","gui.menubar.device.connectBle":"Connect device with Bluetooth (BLE)...","gui.menubar.device.disconnect":"Disconnect device","gui.menubar.device.firmware":"Restore firmware...","gui.menubar.device.firmwareVersion":"Restore v{version} firmware...","gui.menubar.device.caching":"Caching latest firmware...","gui.panelBox.logs":"Logs","gui.panelBox.serial":"Serial","gui.panelBox.files":"Files","gui.project.name":"Untitled Project","gui.project.shortname":"Untitled","gui.library.search":"Search","gui.library.projects.empty":"No project!","gui.library.projects.rename":"rename","gui.library.projects.duplicate":"duplicate","gui.library.projects.delete":"delete","gui.library.projects.notSaved":"Not saved","gui.library.projects.close":"Close current project?","gui.library.projects.deleteConfirm":'Do you want to delete the project "{name}"?',"gui.library.projects.replace":"Replace contents of the current project?","gui.library.projects.errorEditor":'This project is not currently editor creation, please switch to "{workspace}" and open it.',"gui.library.projects.notFoundEditor":'Not Found the "{editor}" Editor.',"gui.library.examples.interconnect":"The project requires two devices to work properly.","gui.library.tutorial.course":"Choose a course","gui.library.tutorial.tutorial":"Choose a tutorial","gui.tutorials.shrink":"Shrink","gui.tutorials.expand":"Expand","gui.tutorials.close":"Close","gui.tutorials.moreTry":"More things to try!","gui.tutorials.seeMore":"See more","gui.prompt.ok":"OK","gui.prompt.close":"Close","gui.prompt.cancel":"Cancel","gui.prompt.reconnect":"Reconnect","gui.connection.device":"Device Connection","gui.connection.search":"Start Searching","gui.connection.searching":"Searching...","gui.connection.connect":"Start Connecting","gui.connection.deviceName":"Device name","gui.about.title":"About...","gui.about.main":"Main program","gui.terms.title":"Terms of Use","gui.terms.content":`<b>Terms of Use</b>
`,"gui.privacy.title":"Privacy","gui.privacy.content":`<b>Privacy</b>
`};var Si={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"载入中…","gui.alert.downloading":"正在下载…{progress}%","gui.alert.downloadCompleted":"下载完成。","gui.alert.connecting":"正在连接…","gui.alert.connected":"已连接。","gui.alert.connectionCancel":"连接取消。","gui.alert.connectionError":"连接发生错误，或已断开。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在恢复固件…{progress}%","gui.alert.recovering":"恢复设备…","gui.alert.restoreCompleted":"恢复固件完成，请按下 RESET 键。","gui.alert.reseting":"正在复位…","gui.alert.compiling":"正在编译…","gui.alert.compileCompleted":"编译完成。","gui.alert.compileError":"编译失败。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存作品…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到电脑。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存作品失败。","gui.logs.changeDevice":"设备已更改为 {device}","gui.logs.connected":"设备已连接","gui.logs.connectedType":"设备已连接到 {type}","gui.logs.disconnected":"设备断开连接","gui.logs.compiling":"程序编译中…","gui.logs.compiled":"编译完成","gui.logs.downloading":"下载程序到设备…","gui.logs.downloaded":"下载完成","gui.logs.downloadError":"下载失败","gui.home.my":"我的作品","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"开始新作品","gui.home.examples":"{label} 精彩作品","gui.home.slideshow.desktop.title":"桌面端程序已就绪，快来下载！","gui.home.slideshow.desktop.button":"立即下载","gui.home.slideshow.tankwar.title":"战争一触即发，赶紧来战吧！","gui.home.slideshow.tankwar.button":"加入战斗","gui.home.slideshow.arcade.title":"玩的下一个游戏，就要自己创作！","gui.home.slideshow.arcade.button":"开始创作","gui.splash.loading":"加载作品…","gui.splash.errorTitle":"发生错误","gui.splash.errorLabel":"请刷新页面重新打开。","gui.menubar.courses":"课程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填写作品标题","gui.menubar.file":"文件","gui.menubar.file.newProject":"新作品","gui.menubar.file.openProject":"打开…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"从电脑中打开…","gui.menubar.file.downloadProject":"保存到电脑…","gui.menubar.edit":"编辑","gui.menubar.edit.undo":"撤销","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打开代码编程","gui.menubar.edit.closeManualCoding":"关闭代码编程","gui.menubar.edit.openCompactBlock":"打开紧凑积木样式","gui.menubar.edit.closeCompactBlock":"关闭紧凑积木样式","gui.menubar.view":"查看","gui.menubar.view.log":"日志","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文件管理","gui.menubar.view.openAutoDisplayPanel":"打开自动显示日志","gui.menubar.view.closeAutoDisplayPanel":"关闭自动显示日志","gui.menubar.device":"设备","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下载程序","gui.menubar.device.reset":"复位","gui.menubar.device.connect":"连接…","gui.menubar.device.connectUsb":"通过 USB 连接…","gui.menubar.device.connectBle":"通过蓝牙（BLE）连接…","gui.menubar.device.disconnect":"断开连接","gui.menubar.device.firmware":"恢复固件…","gui.menubar.device.firmwareVersion":"恢复 v{version} 固件…","gui.menubar.device.caching":"正在缓存最新固件…","gui.panelBox.logs":"日志","gui.panelBox.serial":"串口","gui.panelBox.files":"文件管理","gui.project.name":"未命名作品","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"没有作品！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"复制","gui.library.projects.delete":"删除","gui.library.projects.notSaved":"未保存作品","gui.library.projects.close":"要关闭当前作品吗？","gui.library.projects.deleteConfirm":"要删除“《{name}》”作品吗？","gui.library.projects.replace":"要创建新作品替换当前作品吗？","gui.library.projects.errorEditor":"这个作品不是当前编辑器创作，请切换至“{editor}”编辑器然后打开。","gui.library.projects.notFoundEditor":"没有发现“{editor}”编辑器。","gui.library.examples.interconnect":"该作品需要两台设备联机才能正常运行。","gui.library.tutorials.course":"选择一个课程","gui.library.tutorials.tutorial":"选择一个教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展开","gui.tutorials.close":"关闭","gui.tutorials.moreTry":"再试试这些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"确认","gui.prompt.close":"关闭","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新连接","gui.connection.device":"硬件连接","gui.connection.search":"开始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"开始连接","gui.connection.deviceName":"硬件名称","gui.about.title":"版本信息","gui.about.main":"主程序","gui.terms.title":"使用条款","gui.terms.content":`<b>使用条款</b>
`,"gui.privacy.title":"隐私","gui.privacy.content":`<b>隐私</b>
`};var Ui={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"載入中…","gui.alert.downloading":"正在下載…{progress}%","gui.alert.downloadCompleted":"下載完成。","gui.alert.connecting":"正在連接…","gui.alert.connected":"已連接。","gui.alert.connectionCancel":"連接取消。","gui.alert.connectionError":"連接發生錯誤，或已斷開。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在還原固件…{progress}%","gui.alert.recovering":"恢復設備…","gui.alert.restoreCompleted":"還原固件完成，請按下 RESET 鍵。","gui.alert.reseting":"正在重置…","gui.alert.compiling":"正在編譯…","gui.alert.compileCompleted":"編譯完成。","gui.alert.compileError":"編譯失敗。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存專案…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到電腦。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存專案失敗。","gui.logs.changeDevice":"設備已更改為 {device}","gui.logs.connected":"設備已連接","gui.logs.connectedType":"設備已連接到 {type}","gui.logs.disconnected":"設備斷開連接","gui.logs.compiling":"程序編譯中…","gui.logs.compiled":"編譯完成","gui.logs.downloading":"下載程序到設備…","gui.logs.downloaded":"下載完成","gui.logs.downloadError":"下載失敗","gui.home.my":"我的專案","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"開始新專案","gui.home.examples":"{label} 精彩專案","gui.home.slideshow.desktop.title":"桌面端程序已就緒，快來下載！","gui.home.slideshow.desktop.button":"立即下載","gui.home.slideshow.tankwar.title":"戰爭一觸即髮，趕緊來戰吧！","gui.home.slideshow.tankwar.button":"加入戰鬥","gui.home.slideshow.arcade.title":"玩的下一個遊戲，就要自己創作！","gui.home.slideshow.arcade.button":"開始創作","gui.splash.loading":"加載專案…","gui.splash.errorTitle":"發生錯誤","gui.splash.errorLabel":"請刷新頁面重新打開。","gui.menubar.courses":"課程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填寫專案標題","gui.menubar.file":"文檔","gui.menubar.file.newProject":"新專案","gui.menubar.file.openProject":"打開…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"從電腦中打開…","gui.menubar.file.downloadProject":"保存到電腦…","gui.menubar.edit":"編輯","gui.menubar.edit.undo":"撤銷","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打開代碼編程","gui.menubar.edit.closeManualCoding":"關閉代碼編程","gui.menubar.edit.openCompactBlock":"打開緊湊積木樣式","gui.menubar.edit.closeCompactBlock":"關閉緊湊積木樣式","gui.menubar.view":"查看","gui.menubar.view.log":"日誌","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文檔管理","gui.menubar.view.openAutoDisplayPanel":"打開自動顯示日誌","gui.menubar.view.closeAutoDisplayPanel":"關閉自動顯示日誌","gui.menubar.device":"設備","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下載程序","gui.menubar.device.reset":"重置","gui.menubar.device.connect":"連接…","gui.menubar.device.connectUsb":"通過 USB 連接…","gui.menubar.device.connectBle":"通過藍牙（BLE）連接…","gui.menubar.device.disconnect":"斷開連接","gui.menubar.device.firmware":"還原固件…","gui.menubar.device.firmwareVersion":"還原 v{version} 固件…","gui.menubar.device.caching":"正在緩存最新固件…","gui.panelBox.logs":"日誌","gui.panelBox.serial":"串口","gui.panelBox.files":"文檔管理","gui.project.name":"未命名專案","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"沒有專案！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"複製","gui.library.projects.delete":"刪除","gui.library.projects.notSaved":"未保存專案","gui.library.projects.close":"要關閉當前專案嗎？","gui.library.projects.deleteConfirm":"要刪除“《{name}》”專案嗎？","gui.library.projects.replace":"要創建新專案替換當前專案嗎？","gui.library.projects.errorEditor":"這個專案不是當前編輯器創作，請切換至“{editor}”編輯器然後打開。","gui.library.projects.notFoundEditor":"沒有發現「{editor}」編輯器。","gui.library.examples.interconnect":"該專案需要兩枱設備聯機纔能正常運行。","gui.library.tutorials.course":"選擇一個課程","gui.library.tutorials.tutorial":"選擇一個教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展開","gui.tutorials.close":"關閉","gui.tutorials.moreTry":"再試試這些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"確認","gui.prompt.close":"關閉","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新連接","gui.connection.device":"硬件連接","gui.connection.search":"開始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"開始連接","gui.connection.deviceName":"硬件名稱","gui.about.title":"版本信息","gui.about.main":"主程式","gui.terms.title":"使用條款","gui.terms.content":`<b>使用條款</b>
`,"gui.privacy.title":"隱私","gui.privacy.content":`<b>隱私</b>
`};E1({en:Ri,"zh-Hans":Si,"zh-Hant":Ui});import{render as Ko}from"preact";import{LocalesProvider as jo,AppProvider as en,ProjectProvider as rn}from"@blockcode/core";import{useCallback as X,useEffect as Fi,useErrorBoundary as Wo}from"preact/hooks";import{batch as ke,useComputed as k1,useSignal as Ge,useSignalEffect as xo}from"@preact/signals";import{isElectron as $i,classNames as Do,keyMirror as Io,openProjectFromURL as Po,getAutoDisplayPanel as Ro}from"@blockcode/utils";import{useAppContext as So,useLocalesContext as Uo,useProjectContext as Xo,translate as To,maybeTranslate as No,showSplash as w1,hideSplash as Ho,openPromptModal as Ve,closePromptModal as _1,openLayout as zo,closeLayout as Oo,openTab as C1,openProject as Go,closeProject as Vo,setAlert as Jo,delAlert as Yo,setAppState as We}from"@blockcode/core";import{getAutoDisplayPanel as va,setAutoDisplayPanel as ka}from"@blockcode/utils";import{Text as li}from"@blockcode/core";import{useCallback as Ie}from"preact/hooks";import{batch as Z1}from"@preact/signals";import{isElectron as Xi,isMac as Ke,putProject as Q1,openProjectFromComputer as L1,saveProjectToComputer as F1,sleepMs as $1}from"@blockcode/utils";import{useProjectContext as A1,setAlert as ii,openUserStorage as W1,setFile as x1,setModified as D1,ModifyTypes as I1,Keys as ee}from"@blockcode/core";import{Text as Y,MenuSection as je,MenuItem as Ce}from"@blockcode/core";function C(e){let r=globalThis.document,i=r.createElement("style");i.appendChild(r.createTextNode(e)),r.head.append(i)}C(".cbXT-q_menu-bar{box-sizing:border-box;height:var(--menu-bar-height);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:var(--menu-bar-standard-font-size);background-color:var(--theme-primary);color:var(--ui-white);-webkit-user-select:none;-webkit-app-region:drag;flex-flow:row;justify-content:space-between;font-weight:700;display:flex;box-shadow:0 0 3px #00000040}.cbXT-q_menu-bar-item{color:var(--ui-white);user-select:none;white-space:nowrap;height:var(--menu-bar-height);align-self:center;align-items:center;padding:0 .25rem;text-decoration:none;display:flex;position:relative}.cbXT-q_menu-bar-item.cbXT-q_growable{max-width:var(--menu-bar-item-max-width);flex:1}.cbXT-q_main-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_main-menu.cbXT-q_electron{margin-left:72px}.cbXT-q_right-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_menu-label{padding:0 .75rem}.cbXT-q_menu-label img{margin-right:.25rem}.cbXT-q_language-label{width:var(--language-selector-width);padding:0 .5rem}input.cbXT-q_menu-label{display:none}input.cbXT-q_menu-label+.cbXT-q_menu-bar-item:hover{cursor:pointer;background:var(--ui-black-transparent)}input.cbXT-q_menu-label:checked+.cbXT-q_menu-bar-item{background:var(--ui-black-transparent)}.cbXT-q_main-menu>.cbXT-q_menu{border-radius:0 0 var(--space)var(--space)}.cbXT-q_menu{top:var(--menu-bar-height);z-index:var(--z-index-menu-bar);border-radius:var(--space);color:var(--ui-white);background:var(--theme-primary);min-width:186px;display:none}.cbXT-q_menu-item{font-weight:700}.cbXT-q_menu-item:hover{background:var(--ui-black-transparent)}.cbXT-q_language-icon{vertical-align:middle;height:1.5rem}.cbXT-q_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}.cbXT-q_check-icon.cbXT-q_checked{visibility:visible}.cbXT-q_divider{border-right:1px dashed var(--ui-black-transparent);height:34px;margin:0 .7rem}.cbXT-q_hoverable:hover{cursor:pointer;background:var(--ui-black-transparent)}.cbXT-q_tutorials-icon{margin-right:.35rem}.cbXT-q_title-field{border:1px dashed var(--ui-black-transparent);border-radius:var(--form-radius);-webkit-border-radius:var(--form-radius);-moz-border-radius:var(--form-radius);background-color:var(--ui-white-transparent);height:auto;color:var(--ui-white);-webkit-background-clip:padding-box;background-clip:padding-box;padding:.5rem;font-size:.8rem;font-weight:700}.cbXT-q_title-field::placeholder{color:var(--ui-white);font-size:.8rem;font-style:italic;font-weight:400}.cbXT-q_title-field:hover{background-color:#ffffff80}.cbXT-q_title-field:focus{border:1px solid var(--ui-transparent);-webkit-box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);background-color:var(--ui-white);color:var(--text-primary);outline:none}.cbXT-q_right-menu .cbXT-q_menu-bar-item>img{padding:0 .35rem}.cbXT-q_blank-check-item>div{padding-left:calc(14px + var(--space)/2)}");var p={menuBarItem:"cbXT-q_menu-bar-item",languageIcon:"cbXT-q_language-icon",mainMenu:"cbXT-q_main-menu",checkIcon:"cbXT-q_check-icon",titleField:"cbXT-q_title-field",electron:"cbXT-q_electron",hoverable:"cbXT-q_hoverable",growable:"cbXT-q_growable",menu:"cbXT-q_menu",checked:"cbXT-q_checked",languageLabel:"cbXT-q_language-label",divider:"cbXT-q_divider",menuBar:"cbXT-q_menu-bar",menuItem:"cbXT-q_menu-item",blankCheckItem:"cbXT-q_blank-check-item",rightMenu:"cbXT-q_right-menu",menuLabel:"cbXT-q_menu-label",tutorialsIcon:"cbXT-q_tutorials-icon"};import{jsx as L,jsxs as ei,Fragment as P1}from"preact/jsx-runtime";var Ti=(e=!1)=>ii({message:L(Y,{id:"gui.alert.saving",defaultMessage:"Saving project..."})},e),Ni=(e,r=!1)=>ii({id:e,message:r?L(Y,{id:"gui.alert.savedComputer",defaultMessage:"Saved to your computer."}):L(Y,{id:"gui.alert.saved",defaultMessage:"Saved to local storage."})},2000),Hi=(e,r=!1)=>ii({id:e,mode:"warn",message:r?L(Y,{id:"gui.alert.saveAbortError",defaultMessage:"Abort saving."}):L(Y,{id:"gui.alert.saveError",defaultMessage:"Failed save."})},r?1000:2000);function zi({onNew:e,onOpen:r,onSave:i,onThumb:t,ExtendedMenu:o}){let{meta:a,key:n,name:u,files:g,assets:c}=A1(),l=Ie(async()=>{await $1(0);for(let T in a.value.monitors)if(a.value.monitors[T].deleting)a.value.monitors.splice(T,1);let m=[],s=g.value.map((T)=>{return m.push(T.extensions),Object.fromEntries(Object.entries(T).filter(([D,Ai])=>{if(["xmlDom","script","extensions"].includes(D))return!1;if(!a.value.manualCoding&&D==="content")return!1;return!0}))}),v=c.value?.filter((T)=>!T.uri),Q=await i(s,v,a.value);return Q.meta=Object.assign(Q.meta??{},{editor:a.value.editor,version:a.value.version,monitors:a.value.monitors,extensions:Array.from(new Set(m.flat())).filter(Boolean),manualCoding:a.value.manualCoding,compactBlock:a.value.compactBlock,users:a.value.users}),Q.name=u.value,Q},[i]),B=Ie(async()=>{let m=Ti(),s=await l();s.key=n.value;let v=await Q1(s,t);Z1(()=>{if(s.key!==v)x1({key:v});D1(I1.Saved)}),Ni(m)},[l]),b=Ie(async()=>{let m=Ti(Xi?1000:!1),s=await l(),v=await F1(s);if(Xi)return;if(v.success)Ni(m,!0);else if(v.error==="AbortError")Hi(m,!0);else Hi(m)},[l]),h=Ie(async()=>{let m=await L1();await r(m)},[r]);return ei(P1,{children:[L(je,{children:L(Ce,{className:p.menuItem,label:L(Y,{id:"gui.menubar.file.newProject",defaultMessage:"New"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.N],onClick:e})}),ei(je,{children:[L(Ce,{className:p.menuItem,label:L(Y,{id:"gui.menubar.file.openProject",defaultMessage:"Open"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.O],onClick:W1}),L(Ce,{className:p.menuItem,label:L(Y,{id:"gui.menubar.file.saveProject",defaultMessage:"Save"}),hotkey:[Ke?ee.COMMAND:ee.CONTROL,ee.S],onClick:B})]}),ei(je,{children:[L(Ce,{className:p.menuItem,label:L(Y,{id:"gui.menubar.file.uploadProject",defaultMessage:"Load from your computer"}),onClick:h}),L(Ce,{className:p.menuItem,label:L(Y,{id:"gui.menubar.file.downloadProject",defaultMessage:"save to your computer"}),onClick:b})]}),o&&L(o,{className:p.menu,itemClassName:p.menuItem,onOpen:r,onSave:l})]})}import{useCallback as Oi,useEffect as R1}from"preact/hooks";import{batch as S1,useSignal as Gi,useComputed as U1}from"@preact/signals";import{isMac as Vi,setCompactBlock as X1,getCompactBlock as T1}from"@blockcode/utils";import{useProjectContext as N1,Keys as ie,setMeta as Ji}from"@blockcode/core";import{Text as ge,MenuSection as Yi,MenuItem as Pe}from"@blockcode/core";import{jsx as H,jsxs as ri,Fragment as H1}from"preact/jsx-runtime";function Ki({enableCoding:e,enableCompactBlock:r,onUndo:i,onRedo:t,onEnableUndo:o,onEnableRedo:a,ExtendedMenu:n}){let{meta:u,key:g,fileId:c,modified:l}=N1(),B=Gi(!0),b=Gi(!0),h=U1(()=>u.value.compactBlock??T1());R1(()=>{S1(()=>{B.value=!o(),b.value=!a()})},[g.value,c.value,l.value]);let m=Oi(()=>{Ji("manualCoding",!u.value.manualCoding)},[]),s=Oi(()=>{let v=!h.value;Ji("compactBlock",v),X1(v)},[]);return ri(H1,{children:[ri(Yi,{children:[H(Pe,{disabled:B.value,className:p.menuItem,label:H(ge,{id:"gui.menubar.edit.undo",defaultMessage:"Undo"}),hotkey:[Vi?ie.COMMAND:ie.CONTROL,ie.Z],onClick:i}),H(Pe,{disabled:b.value,className:p.menuItem,label:H(ge,{id:"gui.menubar.edit.redo",defaultMessage:"Redo"}),hotkey:Vi?[ie.SHIFT,ie.COMMAND,ie.Z]:[ie.CONTROL,ie.Y],onClick:t})]}),(e||r)&&ri(Yi,{children:[r&&H(Pe,{className:p.menuItem,label:h.value?H(ge,{id:"gui.menubar.edit.closeCompactBlock",defaultMessage:"Turn off Compact Block"}):H(ge,{id:"gui.menubar.edit.openCompactBlock",defaultMessage:"Turn on Compact Block"}),onClick:s}),e&&H(Pe,{className:p.menuItem,label:u.value.manualCoding?H(ge,{id:"gui.menubar.edit.closeManualCoding",defaultMessage:"Turn off Coding Mode"}):H(ge,{id:"gui.menubar.edit.openManualCoding",defaultMessage:"Turn on Coding Mode"}),onClick:m})]}),n&&H(n,{className:p.menu,itemClassName:p.menuItem})]})}import{useEffect as tl,useCallback as nr}from"preact/hooks";import{useComputed as la,useSignal as ca}from"@preact/signals";import{classNames as Re,getAutoDisplayPanel as ua,setAutoDisplayPanel as ma}from"@blockcode/utils";import{useAppContext as ga,useProjectContext as pa,setAppState as da,Keys as de,Text as Me,MenuSection as lr,MenuItem as Se}from"@blockcode/core";import{useCallback as ai}from"preact/hooks";import{useComputed as ia}from"@preact/signals";import{keyMirror as ra,classNames as ti}from"@blockcode/utils";import{useAppContext as aa,Box as ta,Button as oi,Text as ni}from"@blockcode/core";import{useComputed as z1}from"@preact/signals";import{logger as O1,themeColors as ji}from"@blockcode/core";import{Terminal as G1}from"@blockcode/code";import{jsx as V1}from"preact/jsx-runtime";function er(){let e=z1(()=>O1.logs.join(`\r
`));return V1(G1,{textValue:e.value,options:{theme:{cursor:"#fff",foreground:ji.ui.text.primary,background:"#fff",selection:ji.ui.text.primary}}})}import{Terminal as J1}from"@blockcode/code";import{jsx as Y1}from"preact/jsx-runtime";function ir(){return Y1(J1,{compactMode:!0})}C(".hPjAUa_button{--button-height:calc(var(--standard-font-size)*2.4);padding:0 calc(var(--space)*1.5);height:var(--button-height);border-radius:calc(var(--button-height)/2);margin-left:var(--space);border-color:var(--blocks-tertiary);background:var(--blocks-secondary);color:var(--ui-white)}.hPjAUa_button .hPjAUa_icon{filter:brightness(100);width:16px;margin-right:4px}.hPjAUa_button:hover:not(:disabled):not(.hPjAUa_button-actived){background:var(--blocks-tertiary)}.hPjAUa_button-actived{background:var(--ui-white);color:var(--text-primary)}.hPjAUa_button-actived .hPjAUa_icon{filter:unset}");var K={button:"hPjAUa_button",buttonActived:"hPjAUa_button-actived",icon:"hPjAUa_icon"};var rr="./assets/icon-logs-xymnjv7g.svg";var ar="./assets/icon-serial-xw0zbnx8.svg";var tr="./assets/icon-files-c1wm773z.svg";import{jsx as re,jsxs as ye,Fragment as oa}from"preact/jsx-runtime";var A=ra({Logs:null,Serial:null,Files:null});function or({panelId:e,onPanelChange:r,onClose:i}){let{menuItems:t}=aa(),o=ia(()=>t.value?.find((a)=>a.id==="view"));return ye(ta,{header:ye(oa,{children:[ye(oi,{className:ti(K.button,{[K.buttonActived]:e===A.Logs}),onClick:ai(()=>r(A.Logs),[]),children:[re("img",{className:K.icon,src:rr}),re(ni,{id:"gui.panelBox.logs",defaultMessage:"Logs"})]}),ye(oi,{className:ti(K.button,{[K.buttonActived]:e===A.Serial}),onClick:ai(()=>r(A.Serial),[]),children:[re("img",{className:K.icon,src:ar}),re(ni,{id:"gui.panelBox.serial",defaultMessage:"Serial"})]}),o.value?.options?.disabledFiles!==!0&&ye(oi,{disabled:!0,className:ti(K.button,{[K.buttonActived]:e===A.Files}),onClick:ai(()=>r(A.Files),[]),children:[re("img",{className:K.icon,src:tr}),re(ni,{id:"gui.panelBox.files",defaultMessage:"Files"})]})]}),onClose:i,children:[e===A.Logs&&re(er,{}),e===A.Serial&&re(ir,{})]})}var pe="./assets/icon-check-f984n1c2.svg";import{jsx as z,jsxs as Be,Fragment as sa}from"preact/jsx-runtime";function cr({enableFiles:e,ExtendedMenu:r}){let{appState:i}=ga(),{meta:t}=pa(),o=ca(ua(t.value.editor)),a=la(()=>i.value?.panelBoxId),n=nr((g)=>()=>{if(g===a.value)g=null;da("panelBoxId",g)},[]),u=nr(()=>{o.value=!o.value,ma(t.value.editor,o.value)},[]);return Be(sa,{children:[Be(lr,{children:[Be(Se,{className:p.menuItem,hotkey:[de.CONTROL,de.D1],onClick:n(A.Logs),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Logs}),src:pe}),z(Me,{id:"gui.menubar.view.log",defaultMessage:"Log Panel"})]}),Be(Se,{className:p.menuItem,hotkey:[de.CONTROL,de.D2],onClick:n(A.Serial),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Serial}),src:pe}),z(Me,{id:"gui.menubar.view.serial",defaultMessage:"Serial Panel"})]}),e&&Be(Se,{disabled:!0,className:p.menuItem,hotkey:[de.CONTROL,de.D3],onClick:n(A.Files),children:[z("img",{className:Re(p.checkIcon,{[p.checked]:a.value===A.Files}),src:pe}),z(Me,{id:"gui.menubar.view.files",defaultMessage:"Files Panel"})]})]}),r&&z(r,{className:p.menu,itemClassName:p.menuItem}),z(lr,{children:z(Se,{className:Re(p.menuItem,p.blankCheckItem),label:o.value?z(Me,{id:"gui.menubar.view.closeAutoDisplayPanel",defaultMessage:"Turn off auto display panel"}):z(Me,{id:"gui.menubar.view.openAutoDisplayPanel",defaultMessage:"Turn on auto display panel"}),onClick:u})})]})}var ur="./assets/icon-file-egaz1kfx.svg";var mr="./assets/icon-edit-jejnm7yb.svg";var gr="./assets/icon-view-c3skbdpn.svg";import{jsx as se}from"preact/jsx-runtime";function pr(e,r,i){let t=(c)=>i(c,r.editor),o=e.menuItems?.find((c)=>c.id==="file"),a=e.menuItems?.find((c)=>c.id==="edit"),n=e.menuItems?.find((c)=>c.id==="view"),u=va(r.editor)??n?.autoDisplayPanel===!0;ka(r.editor,u);let g=async()=>{let c=JSON.parse(JSON.stringify(await e.onNew()));if(!c.meta)c.meta=r;if(!c.meta.editor)c.meta.editor=r.editor,c.meta.version=r.version;t(c,r.editor)};return[{id:"file",icon:ur,label:se(li,{id:"gui.menubar.file",defaultMessage:"File"}),Menu:()=>se(zi,{ExtendedMenu:o?.Menu,onNew:g,onOpen:t,onSave:e.onSave,onThumb:e.onThumb}),options:o},{id:"edit",icon:mr,label:se(li,{id:"gui.menubar.edit",defaultMessage:"Edit"}),Menu:()=>se(Ki,{enableCoding:a?.disabledCoding!==!0,enableCompactBlock:a?.disabledCompactBlock!==!0,ExtendedMenu:a?.Menu,onUndo:e.onUndo,onRedo:e.onRedo,onEnableUndo:e.onEnableUndo,onEnableRedo:e.onEnableRedo}),options:a},n?.disabled!==!0&&{id:"view",icon:gr,label:se(li,{id:"gui.menubar.view",defaultMessage:"View"}),Menu:()=>se(cr,{enableFiles:n?.disabledFiles!==!0,ExtendedMenu:n?.Menu}),options:n}].concat(e.menuItems?.filter((c)=>!["file","edit","view"].includes(c.id))??[]).filter(Boolean)}import{Text as we}from"@blockcode/core";import{classNames as _a}from"@blockcode/utils";import{maybeTranslate as Ca,Button as sr}from"@blockcode/core";C(".lkaaPa_alerts-wrapper{width:100%;z-index:var(--z-index-alerts);top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute}.lkaaPa_alert-wrapper{pointer-events:all;background:var(--ui-light);border:1px solid var(--blocks-tertiary);min-width:200px;max-width:548px;min-height:1.5rem;box-shadow:0px 0px 0px 2px var(--ui-light);border-radius:.5rem;flex-direction:row;justify-content:flex-start;align-items:center;margin-bottom:7px;padding:.875rem 1rem;display:flex;overflow:hidden}.lkaaPa_warn{border:1px solid var(--error-primary)}.lkaaPa_icon{min-width:1.25rem;min-height:1.25rem;padding-right:1rem;display:flex}.lkaaPa_message{justify-content:flex-end;align-items:center;padding-right:.5rem;font-size:.8125rem;font-weight:700;line-height:.875rem;display:flex}.lkaaPa_warn .lkaaPa_message{color:var(--error-secondary)}.lkaaPa_success .lkaaPa_message{color:#555}.lkaaPa_buttons-group{align-items:center;display:flex}.lkaaPa_button{color:var(--ui-white);margin-left:var(--space);padding:var(--space)calc(var(--space)*2.5);background:#ff8c1a;border:#ff8c1a}.lkaaPa_close-button{width:1.75rem;height:1.75rem;margin-left:calc(var(--space)*2);background:#ff861433;border:0;border-radius:50%;padding:0;transition:all .15s ease-out;box-shadow:0 0 0 2px #ff861433}.lkaaPa_close-button:hover{transform:scale(1.1);box-shadow:0 0 0 4px #ff861433}.lkaaPa_close-button img{margin:0 auto}");var O={alertWrapper:"lkaaPa_alert-wrapper",button:"lkaaPa_button",buttonsGroup:"lkaaPa_buttons-group",closeButton:"lkaaPa_close-button",alertsWrapper:"lkaaPa_alerts-wrapper",warn:"lkaaPa_warn",message:"lkaaPa_message",icon:"lkaaPa_icon",success:"lkaaPa_success"};var dr="./assets/icon-close-bazpdng8.svg";import{jsx as he,jsxs as hr}from"preact/jsx-runtime";function fr({mode:e,icon:r,message:i,options:t,button:o,onClose:a}){return hr("div",{className:_a(O.alertWrapper,{[O.success]:e==="success",[O.warn]:e==="warn"}),children:[he("div",{className:O.icon,children:typeof r==="string"?he("img",{src:r}):r}),he("div",{className:O.message,children:Ca(i,t)}),hr("div",{className:O.buttonsGroup,children:[o&&he(sr,{className:O.button,onClick:o.onClick,children:o.label}),a&&he(sr,{className:O.closeButton,onClick:a,children:he("img",{src:dr})})]})]})}import{jsx as br}from"preact/jsx-runtime";function vr({items:e}){return br("div",{className:O.alertsWrapper,children:e.map(({id:r,mode:i,icon:t,message:o,button:a,onClose:n,...u})=>br(fr,{mode:i??"success",icon:t,message:o,options:u,button:a,onClose:n},r))})}import{useCallback as Ma}from"preact/hooks";import{useSignal as Ba}from"@preact/signals";import{classNames as Ue}from"@blockcode/utils";import{Text as qe,Button as wr,Modal as qa}from"@blockcode/core";C(".Zq10BW_prompt-modal{width:480px}.Zq10BW_prompt-header{background:var(--blocks-primary)}.Zq10BW_prompt-content{background:var(--ui-white)}.Zq10BW_device-list{background:var(--theme-light-transparent);width:100%;height:170px;padding:.5rem;overflow-y:auto}.Zq10BW_device-search{justify-content:center;align-items:center;width:100%;height:100%;display:flex}.Zq10BW_device-search-icon{width:120px;height:120px}@keyframes Zq10BW_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.Zq10BW_device-searching-icon{animation:1.5s linear infinite Zq10BW_spin}.Zq10BW_device-item{background:var(--ui-white);border-radius:calc(var(--space)/2);border:2px solid var(--ui-white);flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:50px;margin-bottom:.5rem;padding:10px;display:flex}.Zq10BW_device-item.Zq10BW_selected{border:2px solid var(--theme-primary)}.Zq10BW_device-name-bar{align-items:center;display:flex}.Zq10BW_device-image{width:40px;margin-right:.5rem}.Zq10BW_device-name-wrapper{flex-direction:column;justify-content:center;align-items:flex-start;display:flex}.Zq10BW_device-name-label{font-size:.625rem;font-weight:700}.Zq10BW_device-name-text{font-size:.875rem}.Zq10BW_button-row{text-align:right;text-align:center;padding:1.5rem 2.25rem;font-weight:bolder}.Zq10BW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.Zq10BW_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var Z={deviceSearchingIcon:"Zq10BW_device-searching-icon",button:"Zq10BW_button",spin:"Zq10BW_spin",deviceNameWrapper:"Zq10BW_device-name-wrapper",deviceNameText:"Zq10BW_device-name-text",promptModal:"Zq10BW_prompt-modal",deviceNameLabel:"Zq10BW_device-name-label",deviceSearchIcon:"Zq10BW_device-search-icon",deviceSearch:"Zq10BW_device-search",promptHeader:"Zq10BW_prompt-header",deviceImage:"Zq10BW_device-image",deviceList:"Zq10BW_device-list",deviceItem:"Zq10BW_device-item",okButton:"Zq10BW_ok-button",selected:"Zq10BW_selected",promptContent:"Zq10BW_prompt-content",buttonRow:"Zq10BW_button-row",deviceNameBar:"Zq10BW_device-name-bar"};var kr="./assets/searching-tt57cegv.png";import{jsx as $,jsxs as Xe}from"preact/jsx-runtime";function _r({title:e,icon:r,devices:i,onClose:t,onSearch:o,onConnect:a}){let n=Ba(""),u=Ma(()=>{if(!n.value)return;a(n.value),n.value=""},[a]);return $(qa,{title:e??$(qe,{id:"gui.connection.device",defaultMessage:"Device"}),className:Z.promptModal,headerClassName:Z.header,onClose:t,children:Xe("div",{className:Z.promptContent,children:[$("div",{className:Z.deviceList,children:Array.isArray(i)&&i.length>0?i.map((g)=>Xe("div",{className:Ue(Z.deviceItem,{[Z.selected]:g.id===n.value}),onClick:()=>n.value=g.id,children:[Xe("div",{className:Z.deviceNameBar,children:[r&&$("img",{}),Xe("div",{className:Z.deviceNameWrapper,children:[$("div",{className:Z.deviceNameLabel,children:$(qe,{id:"gui.connection.deviceName",defaultMessage:"Device name"})}),$("div",{className:Z.deviceNameText,children:g.name})]})]}),g.rssi&&$("div",{className:Z.deviceSignalBar})]})):$("div",{className:Z.deviceSearch,children:$("img",{className:Ue(Z.deviceSearchIcon,{[Z.deviceSearchingIcon]:Array.isArray(i)}),src:kr})})}),$("div",{className:Z.buttonRow,children:i===!0?$(wr,{className:Ue(Z.button,Z.okButton),onClick:()=>o(),children:$(qe,{id:"gui.connection.search",defaultMessage:"Start Searching"})}):$(wr,{disabled:!n.value,className:Ue(Z.button,Z.okButton),onClick:u,children:!n.value?$(qe,{id:"gui.connection.searching",defaultMessage:"Searching"}):$(qe,{id:"gui.connection.connect",defaultMessage:"Start Connecting"})})})]})})}import{useEffect as za,useCallback as Qe}from"preact/hooks";import{batch as Oa,useSignal as Ne,useSignalEffect as Ga}from"@preact/signals";import{classNames as Le,getProjectsThumbs as Va,getProject as Ja,cloneProject as Ya,renameProject as Ka,delProject as ja,openProjectFromURL as et}from"@blockcode/utils";import{maybeTranslate as di,setAlert as it,delAlert as rt,openPromptModal as si,openUserStorage as at}from"@blockcode/core";var ci="1.3.1";import{Text as F,ContextMenu as tt,LibraryItem as hi}from"@blockcode/core";import{useEffect as Za}from"preact/hooks";import{useSignal as Qa}from"@preact/signals";import{classNames as Cr}from"@blockcode/utils";import{Button as La}from"@blockcode/core";C(".tyiNqW_cover-wrapper{width:100%;position:relative}.tyiNqW_cover{opacity:1;background-position:50%;background-repeat:no-repeat;background-size:cover;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 2rem;transition:opacity 1s;display:flex;position:absolute;top:0;left:0}.tyiNqW_cover.tyiNqW_hidden{opacity:0;pointer-events:none}.tyiNqW_title{color:#000;padding-right:1.5rem;font-size:2rem;font-weight:600}.tyiNqW_button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-top:calc(2*var(--space));padding:.75rem 1rem;font-size:.85rem;font-weight:600}.tyiNqW_feature{max-height:90%;margin-right:5%}");var le={title:"tyiNqW_title",feature:"tyiNqW_feature",button:"tyiNqW_button",coverWrapper:"tyiNqW_cover-wrapper",hidden:"tyiNqW_hidden",cover:"tyiNqW_cover"};import{jsx as Te,jsxs as yr}from"preact/jsx-runtime";function Mr({pages:e,className:r}){let i=Qa(0);return Za(()=>{setInterval(()=>i.value=(i.value+1)%e.length,7000)},[]),Te("div",{className:Cr(le.coverWrapper,r),children:e.map((t,o)=>yr("div",{className:Cr(le.cover,{[le.hidden]:o!==i.value}),style:{backgroundImage:`url(${t.backgroundImage})`},children:[yr("div",{children:[Te("div",{className:le.title,children:t.title}),Te(La,{className:le.button,onClick:t.onClick,children:t.buttonText})]}),Te("img",{className:le.feature,src:t.featureImage})]},o))})}C("._9IQa7q_home-wrapper{background:var(--ui-secondary);top:var(--menu-bar-height);width:100%;height:calc(100% - var(--menu-bar-height));z-index:calc(var(--z-index-alerts) - 10);user-select:none;position:absolute;overflow:hidden auto}._9IQa7q_getting-started{height:240px;margin-bottom:1.5rem}._9IQa7q_link{cursor:pointer;color:var(--theme-primary)}._9IQa7q_view-all{font-weight:400;font-size:var(--standard-font-size);margin-left:1.5rem}._9IQa7q_delete-menu-item:hover{background:var(--error-primary)}._9IQa7q_footer{color:var(--text-primary);font-size:var(--small-font-size);padding:3.5rem 0 var(--space);text-align:center}._9IQa7q_footer-item{padding:0 var(--space)}._9IQa7q_footer-item:not(:first-child){border-left:1px solid var(--ui-black-transparent)}._9IQa7q_library-grid{background:var(--ui-secondary);flex-wrap:wrap;flex-grow:1;place-content:flex-start;align-items:flex-start;height:auto;padding:.5rem;display:flex;overflow-y:auto}._9IQa7q_library-label{color:var(--text-primary);padding:1.5rem calc(.5rem + var(--space)).5rem;font-weight:800}._9IQa7q_about-version-content{width:300px}._9IQa7q_about-version-row{margin:var(--space)0;justify-content:space-between;display:flex}");var M={libraryLabel:"_9IQa7q_library-label",footerItem:"_9IQa7q_footer-item",aboutVersionContent:"_9IQa7q_about-version-content",aboutVersionRow:"_9IQa7q_about-version-row",homeWrapper:"_9IQa7q_home-wrapper",deleteMenuItem:"_9IQa7q_delete-menu-item",libraryGrid:"_9IQa7q_library-grid",link:"_9IQa7q_link",footer:"_9IQa7q_footer",viewAll:"_9IQa7q_view-all",gettingStarted:"_9IQa7q_getting-started"};import{Text as Er}from"@blockcode/core";var Br="./assets/arcade-rd4cktbf.png";var qr="./assets/arcade-bg-fajmd34e.jpg";import{jsx as Zr}from"preact/jsx-runtime";function ui(e){return{title:Zr(Er,{id:"gui.home.slideshow.arcade.title",defaultMessage:"The Tank War is coming! Join us! NOW!"}),backgroundImage:qr,featureImage:Br,buttonText:Zr(Er,{id:"gui.home.slideshow.arcade.button",defaultMessage:"Play now"}),onClick:()=>e("@blockcode/gui-arcade")}}import{Text as Fr}from"@blockcode/core";var Qr="./assets/desktop-s3hfwbpz.png";var Lr="./assets/desktop-bg-pqrd17t9.jpg";import{jsx as $r}from"preact/jsx-runtime";var Ar={title:$r(Fr,{id:"gui.home.slideshow.desktop.title",defaultMessage:"The desktop application is here!"}),backgroundImage:Lr,featureImage:Qr,buttonText:$r(Fr,{id:"gui.home.slideshow.desktop.button",defaultMessage:"Download"}),onClick:()=>window.open("//app.blockcode.fun/#/?id=download")};function mi(e,r){return[Ar,ui(e)]}async function gi(e){let r=await fetch("https://hub.blockcode.fun/home.json").then((i)=>i.json());return Promise.all(r.filter((i)=>i.editor?e.find((t)=>t.id===i.editor):!0).map(async(i)=>{let t=e.find((a)=>a.id===i.editor),o=await fetch(`https://hub.blockcode.fun/${i.import}`).then((a)=>a.json());return{name:t?.name,examples:o.filter((a)=>e.find((n)=>n.id===a.editor)).map((a)=>({...a,file:`https://hub.blockcode.fun/${a.file}`,thumb:`https://hub.blockcode.fun/${a.thumb}`}))}}))}function j(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Wr(e,r){var i="",t=0,o=-1,a=0,n;for(var u=0;u<=e.length;++u){if(u<e.length)n=e.charCodeAt(u);else if(n===47)break;else n=47;if(n===47){if(o===u-1||a===1);else if(o!==u-1&&a===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var g=i.lastIndexOf("/");if(g!==i.length-1){if(g===-1)i="",t=0;else i=i.slice(0,g),t=i.length-1-i.lastIndexOf("/");o=u,a=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=u,a=0;continue}}if(r){if(i.length>0)i+="/..";else i="..";t=2}}else{if(i.length>0)i+="/"+e.slice(o+1,u);else i=e.slice(o+1,u);t=u-o-1}o=u,a=0}else if(n===46&&a!==-1)++a;else a=-1}return i}function xa(e,r){var i=r.dir||r.root,t=r.base||(r.name||"")+(r.ext||"");if(!i)return t;if(i===r.root)return i+t;return i+e+t}function Ee(){var e="",r=!1,i;for(var t=arguments.length-1;t>=-1&&!r;t--){var o;if(t>=0)o=arguments[t];else{if(i===void 0)i=process.cwd();o=i}if(j(o),o.length===0)continue;e=o+"/"+e,r=o.charCodeAt(0)===47}if(e=Wr(e,!r),r)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function xr(e){if(j(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;if(e=Wr(e,!r),e.length===0&&!r)e=".";if(e.length>0&&i)e+="/";if(r)return"/"+e;return e}function Da(e){return j(e),e.length>0&&e.charCodeAt(0)===47}function Ia(){if(arguments.length===0)return".";var e;for(var r=0;r<arguments.length;++r){var i=arguments[r];if(j(i),i.length>0)if(e===void 0)e=i;else e+="/"+i}if(e===void 0)return".";return xr(e)}function Pa(e,r){if(j(e),j(r),e===r)return"";if(e=Ee(e),r=Ee(r),e===r)return"";var i=1;for(;i<e.length;++i)if(e.charCodeAt(i)!==47)break;var t=e.length,o=t-i,a=1;for(;a<r.length;++a)if(r.charCodeAt(a)!==47)break;var n=r.length,u=n-a,g=o<u?o:u,c=-1,l=0;for(;l<=g;++l){if(l===g){if(u>g){if(r.charCodeAt(a+l)===47)return r.slice(a+l+1);else if(l===0)return r.slice(a+l)}else if(o>g){if(e.charCodeAt(i+l)===47)c=l;else if(l===0)c=0}break}var B=e.charCodeAt(i+l),b=r.charCodeAt(a+l);if(B!==b)break;else if(B===47)c=l}var h="";for(l=i+c+1;l<=t;++l)if(l===t||e.charCodeAt(l)===47)if(h.length===0)h+="..";else h+="/..";if(h.length>0)return h+r.slice(a+c);else{if(a+=c,r.charCodeAt(a)===47)++a;return r.slice(a)}}function Ra(e){return e}function pi(e){if(j(e),e.length===0)return".";var r=e.charCodeAt(0),i=r===47,t=-1,o=!0;for(var a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!o){t=a;break}}else o=!1;if(t===-1)return i?"/":".";if(i&&t===1)return"//";return e.slice(0,t)}function Sa(e,r){if(r!==void 0&&typeof r!=="string")throw TypeError('"ext" argument must be a string');j(e);var i=0,t=-1,o=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var n=r.length-1,u=-1;for(a=e.length-1;a>=0;--a){var g=e.charCodeAt(a);if(g===47){if(!o){i=a+1;break}}else{if(u===-1)o=!1,u=a+1;if(n>=0)if(g===r.charCodeAt(n)){if(--n===-1)t=a}else n=-1,t=u}}if(i===t)t=u;else if(t===-1)t=e.length;return e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){i=a+1;break}}else if(t===-1)o=!1,t=a+1;if(t===-1)return"";return e.slice(i,t)}}function Ua(e){j(e);var r=-1,i=0,t=-1,o=!0,a=0;for(var n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(u===47){if(!o){i=n+1;break}continue}if(t===-1)o=!1,t=n+1;if(u===46){if(r===-1)r=n;else if(a!==1)a=1}else if(r!==-1)a=-1}if(r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1)return"";return e.slice(r,t)}function Xa(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return xa("/",e)}function Ta(e){j(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,o;if(t)r.root="/",o=1;else o=0;var a=-1,n=0,u=-1,g=!0,c=e.length-1,l=0;for(;c>=o;--c){if(i=e.charCodeAt(c),i===47){if(!g){n=c+1;break}continue}if(u===-1)g=!1,u=c+1;if(i===46){if(a===-1)a=c;else if(l!==1)l=1}else if(a!==-1)l=-1}if(a===-1||u===-1||l===0||l===1&&a===u-1&&a===n+1){if(u!==-1)if(n===0&&t)r.base=r.name=e.slice(1,u);else r.base=r.name=e.slice(n,u)}else{if(n===0&&t)r.name=e.slice(1,a),r.base=e.slice(1,u);else r.name=e.slice(n,a),r.base=e.slice(n,u);r.ext=e.slice(a,u)}if(n>0)r.dir=e.slice(0,n-1);else if(t)r.dir="/";return r}var Na="/",Ha=":",q2=((e)=>(e.posix=e,e))({resolve:Ee,normalize:xr,isAbsolute:Da,join:Ia,relative:Pa,_makeLong:Ra,dirname:pi,basename:Sa,extname:Ua,format:Xa,parse:Ta,sep:Na,delimiter:Ha,win32:null,posix:null});function Ze(){let e=window.electron?.getLocalEditors()??[];return Promise.all([].concat(Object.values(e).map(async(r)=>{let{default:i}=await import(r.info);return i.id=r.id,i.image=Ee(pi(r.info),i.image),i}),["@yeqin/gui-tankwar","@blockcode/gui-arcade2","@blockcode/gui-arcade","@blockcode/gui-microbit","@blockcode/gui-esp32","@blockcode/gui-arduino","@blockcode/gui-writer","@blockcode/gui-iotbit","@blockcode/gui-matrix"].map(async(r)=>{let{default:i}=await import(`${r}/info`);return i.id=r,i})))}import{jsx as f,jsxs as S,Fragment as fi}from"preact/jsx-runtime";function Dr({onOpenEditor:e,onOpenProject:r}){let i=Math.floor((document.body.clientWidth-20)/176),t=Math.floor((document.body.clientWidth-20)/236)*2,o=Ne(null),a=Ne(0),n=Ne(null),u=Ne(null),g=Qe(async()=>{let m=await Va();Oa(()=>{a.value=m.length,o.value=m.filter((s,v)=>v<i)})},[]);za(g,[]);let c=Qe((m,s)=>{si({title:f(F,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:f(F,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:di(s??f(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(v)=>{if(v?.name)await Ka(m,v.name),g()}})},[]),l=Qe(async(m)=>{await Ya(m),g()},[]),B=Qe((m,s)=>{si({title:f(F,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:f(F,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:di(s||f(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await ja(m),g()}})},[]),b=Qe((m)=>async()=>{let s=await Ja(m);r(s)},[r]),h=()=>{return o.value?.map((m)=>f(tt,{menuItems:[[{label:f(F,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>c(m.key,m.name)},{label:f(F,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>l(m.key)}],[{label:f(F,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:M.deleteMenuItem,onClick:()=>B(m.key,m.name)}]],children:f(hi,{id:m.key,name:m.name||f(F,{id:"gui.project.shortname",defaultMessage:"Untitled"}),image:m.thumb,onSelect:b(m.key)})},m.key))};return Ga(async()=>{let m=await Ze();m=m.map((s)=>Object.assign(s,{beta:s.beta||!1,disabled:s.disabled||s.beta,onSelect:()=>e(s.id)})),m=m.filter((s)=>{if(s.hidden)return!1;if(s.disabled)return!1;return!0}),n.value=m.sort((s,v)=>s.sortIndex-v.sortIndex),u.value=await gi(m)}),S("div",{className:M.homeWrapper,children:[f(Mr,{className:M.gettingStarted,pages:mi(e,r)}),o.value?.length>0&&S(fi,{children:[S("div",{className:M.libraryLabel,children:[f("span",{children:f(F,{id:"gui.home.my",defaultMessage:"My projects"})}),a.value>i&&f("span",{className:Le(M.viewAll,M.link),onClick:at,children:f(F,{id:"gui.home.allCounts",defaultMessage:"View all ({counts})",counts:a.value})})]}),f("div",{className:M.libraryGrid,children:f(h,{})})]}),n.value?.length>0&&S(fi,{children:[f("div",{className:M.libraryLabel,children:f(F,{id:"gui.home.new",defaultMessage:"Create new project"})}),f("div",{className:M.libraryGrid,children:n.value.map((m,s)=>f(hi,{featured:!0,id:s,disabled:m.disabled,beta:m.beta||m.preview,image:m.image,name:m.name,description:m.description,collaborator:m.collaborator,blocksRequired:m.blocksRequired,micropythonRequired:m.micropythonRequired,clangRequired:m.clangRequired,onSelect:m.onSelect},s))})]}),u.value?.map((m)=>m.examples.length>0&&S(fi,{children:[S("div",{className:M.libraryLabel,children:[f("span",{children:f(F,{id:"gui.home.examples",defaultMessage:"Wonderful {label} examples",label:di(m.name)})}),m.examples.length>t&&f("span",{className:Le(M.viewAll,M.link),children:f(F,{id:"gui.home.all",defaultMessage:"View all"})})]}),f("div",{className:M.libraryGrid,children:m.examples.map((s,v)=>f(hi,{large:!0,id:v,name:s.name,author:s.author,copyright:s.copyright,image:s.thumb,onSelect:async()=>{it("importing",{id:s.name});let Q=await et(s.file);rt(s.name),r(Q)}}))})]})),S("div",{className:M.footer,children:[f("span",{className:Le(M.footerItem,M.link),onClick:()=>window.open("https://lab.blockcode.fun/","_blank"),children:"BlockCode Lab"}),f("span",{className:Le(M.footerItem,M.link),onClick:()=>window.open("https://github.com/BlockCodeLab/playgrounds-app","_blank"),children:"GitHub"}),S("span",{className:Le(M.footerItem,M.link),onClick:()=>{si({title:f(F,{id:"gui.about.title",defaultMessage:"About..."}),body:S("div",{className:M.aboutVersionContent,children:[S("div",{className:M.aboutVersionRow,children:[f("div",{children:f("b",{children:f(F,{id:"gui.about.main",defaultMessage:"Main program"})})}),S("div",{children:["v",ci]})]}),f("div",{className:M.aboutVersionRow}),n.value.filter((m)=>!m.disabled).map((m)=>S("div",{className:M.aboutVersionRow,children:[f("div",{children:f("b",{children:m.name})}),S("div",{children:["v",m.version]})]}))]})})},children:["v",ci]})]})]})}import{useEffect as Zt}from"preact/hooks";import{classNames as ce,isMac as Qt}from"@blockcode/utils";import{useLocalesContext as Lt,useAppContext as Ft,setLanguage as $t,translate as Or,setMacosMenuBarStyled as At}from"@blockcode/core";import{Menu as Gr,MenuItem as Wt,Tooltip as xt}from"@blockcode/core";import{cloneElement as mt}from"preact";import{useMemo as gt}from"preact/hooks";import{flatChildren as pt}from"@blockcode/utils";var Ir=Object.create(null),bi=document.createElement("div"),Pr=document.createElement("style");document.body.insertBefore(Pr,document.body.firstChild);var ot=(e)=>{return bi.style="",Object.entries(e).forEach(([r,i])=>bi.style[r]=i),bi.style.cssText},nt=()=>{Pr.textContent=Object.entries(Ir).map(([e,r])=>`${e}{${ot(r)}}`).join(`
`)};function ae(e){Object.assign(Ir,e),nt()}import{Menu as dt}from"@blockcode/core";import{useCallback as vi}from"preact/hooks";import{classNames as lt}from"@blockcode/utils";import{jsx as Rr,jsxs as ut,Fragment as ct}from"preact/jsx-runtime";function Fe({id:e,className:r,checked:i,children:t,name:o}){let a=vi((g)=>{let c=()=>{g.target.checked=!1,document.removeEventListener("click",c)};document.addEventListener("click",c)},[]),n=vi((g)=>{let c=g.getBoundingClientRect().left;ae({[`#${e}-menu-${o}`]:{left:`${c}px`}})},[e,o]),u=vi((g)=>{if(g.target.classList.contains(p.menuLabel))n(g.target);else n(g.target.parentElement)},[]);return ut(ct,{children:[Rr("input",{checked:i,className:p.menuLabel,id:`${e}-label-${o}`,name:`${e}-menu`,type:"radio",value:o,onChange:a}),Rr("label",{className:lt(p.menuLabel,r),for:`${e}-label-${o}`,onClick:u,children:t})]})}import{jsxs as ht,Fragment as st}from"preact/jsx-runtime";function Sr({id:e,children:r}){let i=gt(()=>pt(r).map((t)=>t&&mt(t,{id:e})),[e,r]);return ht(st,{children:[i.filter((t)=>t.type===Fe),i.filter((t)=>t.type===dt).map((t)=>{let o=`${e}-label-${t.props.name}`,a=`${e}-menu-${t.props.name}`;return ae({[`#${o}:checked~#${a}`]:{display:"block"}}),t})]})}import{classNames as bt}from"@blockcode/utils";import{Text as vt}from"@blockcode/core";var He="./assets/icon-tutorials-bh6n0ck2.svg";import{jsx as ki,jsxs as Ur,Fragment as kt}from"preact/jsx-runtime";function Xr({onClick:e}){return Ur(kt,{children:[ki("div",{className:p.divider}),Ur("div",{className:bt(p.menuBarItem,p.menuLabel,p.hoverable),onClick:e,children:[ki("img",{className:p.tutorialsIcon,src:He}),ki(vt,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]})]})}import{useProjectContext as wt,BufferedInput as _t,renameProject as Ct}from"@blockcode/core";import{jsx as wi,jsxs as Mt,Fragment as yt}from"preact/jsx-runtime";function Tr({placeholder:e,defaultValue:r}){let{name:i}=wt();return Mt(yt,{children:[wi("div",{className:p.divider}),wi("div",{className:p.menuBarItem,children:wi(_t,{className:p.titleField,placeholder:e,value:i.value||r,onSubmit:Ct})})]})}var Nr="./assets/icon-language-3wan1389.svg";var Hr="./assets/icon-dropdown-caret-y4j91xc6.svg";var zr="./assets/icon-home-jt8mdkv3.svg";import{jsx as I,jsxs as te,Fragment as Dt}from"preact/jsx-runtime";function Vr({className:e,showHomeButton:r,onRequestHome:i,onOpenTutorialLibrary:t}){let{language:o,languageNames:a}=Lt(),{barItems:n,menuItems:u,tutorials:g,macosMenuBarStyled:c}=Ft();return Zt(()=>{window.electron?.onChangeFullscreen((l)=>At(Qt&&!l))},[]),te("div",{className:ce(p.menuBar,e),children:[te("div",{className:ce(p.mainMenu,{[p.electron]:c.value}),children:[te(Sr,{id:p.mainMenu,children:[te(Fe,{className:ce(p.menuBarItem,p.languageLabel),name:"language-selector",children:[I("img",{className:p.languageIcon,src:Nr}),I("img",{src:Hr})]}),I(Gr,{className:p.menu,name:"language-selector",children:Array.from(a.entries()).map(([l,B])=>te(Wt,{className:p.menuItem,onClick:()=>$t(l),children:[I("img",{className:ce(p.checkIcon,{[p.checked]:o.value===l}),src:pe}),B.languageName]},l))}),u.value&&u.value.map(({icon:l,label:B,Menu:b},h)=>te(Dt,{children:[te(Fe,{className:p.menuBarItem,name:h,children:[typeof l==="string"?I("img",{src:l}):l,B]},h),I(Gr,{className:p.menu,name:h,children:I(b,{className:p.menu,itemClassName:p.menuItem})},h)]}))]}),g.value&&I(Xr,{onClick:t}),r&&I(Tr,{placeholder:Or("gui.menubar.titlePlaceholder","Project title here"),defaultValue:Or("gui.project.name","BlockCode Project")})]}),te("div",{className:p.rightMenu,children:[n.value&&n.value.map((l)=>l.tooltip?I(xt,{placement:l.tooltipPlacement??"bottom",content:l.tooltip,children:I("div",{className:ce(p.menuBarItem,p.hoverable),children:l.label})}):I("div",{className:ce(p.menuBarItem,p.hoverable),onClick:l.onClick,children:l.label})),r&&I("div",{className:ce(p.menuBarItem,p.hoverable),onClick:i,children:I("img",{src:zr})})]})]})}import{classNames as It}from"@blockcode/utils";C(".fflkNG_pane-wrapper{flex-direction:column;display:flex;position:relative}.fflkNG_pane{display:none}.fflkNG_pane-header{background:var(--ui-white);padding:calc(var(--space)/2);text-align:center;color:var(--text-primary);cursor:pointer;border:1px solid var(--ui-black-transparent);border-radius:var(--space)var(--space)0 0;flex:1;font-size:.85rem}.fflkNG_pane-left .fflkNG_pane-header{border-top-left-radius:0}.fflkNG_pane-right .fflkNG_pane-header{border-top-right-radius:0}.fflkNG_pane-content{border-left:1px solid var(--ui-black-transparent);border-right:1px solid var(--ui-black-transparent);min-height:5.5rem;display:none;position:relative}.fflkNG_pane-left .fflkNG_pane-content{border-left:0}.fflkNG_pane-right .fflkNG_pane-content{border-right:0}.fflkNG_pane:checked~.fflkNG_pane-content{display:flex}");var ue={paneRight:"fflkNG_pane-right",paneLeft:"fflkNG_pane-left",paneContent:"fflkNG_pane-content",paneHeader:"fflkNG_pane-header",pane:"fflkNG_pane",paneWrapper:"fflkNG_pane-wrapper"};import{jsx as _i,jsxs as Pt}from"preact/jsx-runtime";function Jr({className:e,id:r,title:i,left:t,right:o,children:a}){return Pt("div",{className:It(ue.paneWrapper,e,{[ue.paneLeft]:t,[ue.paneRight]:o}),children:[_i("input",{id:`${r}-pane`,type:"checkbox",className:ue.pane}),_i("label",{className:ue.paneHeader,for:`${r}-pane`,children:i}),_i("div",{className:ue.paneContent,children:a})]})}import{classNames as Yr}from"@blockcode/utils";import{maybeTranslate as Rt,Text as Ci,Button as yi,Modal as St}from"@blockcode/core";C(".ulcaFG_prompt-modal{width:360px}.ulcaFG_prompt-modal.ulcaFG_wide{width:600px}.ulcaFG_prompt-modal.ulcaFG_auto{width:auto;max-width:60vw}.ulcaFG_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.ulcaFG_label{margin:0 0 1.5rem;font-weight:500}.ulcaFG_label.ulcaFG_input-label{margin-bottom:.75rem}.ulcaFG_content{font-size:var(--standard-font-size);color:var(--text-primary);max-height:400px;margin-bottom:1.5rem;overflow:auto}.ulcaFG_content a{color:var(--theme-primary);border-bottom:1px solid;text-decoration-line:none}.ulcaFG_text-input{border:1px solid var(--ui-black-transparent);width:100%;height:3rem;color:var(--text-primary);border-radius:5px;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.ulcaFG_button-row{text-align:right;font-weight:bolder}.ulcaFG_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.ulcaFG_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var q={content:"ulcaFG_content",buttonRow:"ulcaFG_button-row",button:"ulcaFG_button",inputLabel:"ulcaFG_input-label",textInput:"ulcaFG_text-input",auto:"ulcaFG_auto",label:"ulcaFG_label",okButton:"ulcaFG_ok-button",promptContent:"ulcaFG_prompt-content",wide:"ulcaFG_wide",promptModal:"ulcaFG_prompt-modal"};import{useCallback as Ut}from"preact/hooks";import{jsx as G,jsxs as Kr,Fragment as Xt}from"preact/jsx-runtime";function jr({title:e,label:r,content:i,redStyle:t,children:o,onClose:a,onSubmit:n}){let u=Ut(()=>{n(),a()},[a,n]);return G(St,{title:e,redStyle:t,className:Yr(q.promptModal,{[q.wide]:i,[q.auto]:o}),onClose:a,children:Kr("div",{className:q.promptContent,children:[r&&G("div",{className:q.label,children:r}),i?G("div",{className:q.content,dangerouslySetInnerHTML:{__html:Rt(i)}}):G("div",{className:q.content,children:o}),G("div",{className:q.buttonRow,children:n?Kr(Xt,{children:[G(yi,{className:q.button,onClick:a,children:G(Ci,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),G(yi,{className:Yr(q.button,q.okButton),onClick:u,children:G(Ci,{id:"gui.prompt.ok",defaultMessage:"OK"})})]}):G(yi,{className:q.button,onClick:a,children:G(Ci,{id:"gui.prompt.close",defaultMessage:"Close"})})})]})})}import{useCallback as Mi,useEffect as Tt}from"preact/hooks";import{useSignal as Nt}from"@preact/signals";import{classNames as e1}from"@blockcode/utils";import{maybeTranslate as i1,Text as r1,BufferedInput as Ht,Button as a1,Modal as zt}from"@blockcode/core";import{jsx as oe,jsxs as Bi,Fragment as Ot}from"preact/jsx-runtime";function t1({title:e,inputItems:r,content:i,onClose:t,onSubmit:o}){let a=Nt(Object.fromEntries(r.map(({name:c,defaultValue:l})=>[c,l]))),n=Mi((c)=>{if(c.stopPropagation(),c.key==="Escape")t()},[t]),u=Mi(()=>{o(a.value),t()},[t,o]),g=Mi((c)=>(l)=>{a.value={...a.value,[c]:l}},[]);return Tt(()=>{return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),oe(zt,{title:e,className:q.promptModal,onClose:t,children:Bi("div",{className:q.promptContent,children:[r.map(({name:c,label:l,placeholder:B,defaultValue:b},h)=>Bi(Ot,{children:[l&&oe("div",{className:e1(q.label,q.inputLabel),children:l}),oe(Ht,{autoFocus:h===0,className:q.textInput,placeholder:i1(B),defaultValue:b,onSubmit:g(c)},h)]})),i&&oe("div",{className:q.content,dangerouslySetInnerHTML:{__html:i1(i)}}),Bi("div",{className:q.buttonRow,children:[oe(a1,{className:q.button,onClick:t,children:oe(r1,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),oe(a1,{className:e1(q.button,q.okButton),onClick:u,children:oe(r1,{id:"gui.prompt.ok",defaultMessage:"OK"})})]})]})})}import{classNames as Gt}from"@blockcode/utils";import{Text as qi,Spinner as Vt}from"@blockcode/core";C(".LkfKFW_splash{background:var(--theme-primary);z-index:var(--z-index-modal);flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute;inset:0}.LkfKFW_spinner{margin-bottom:calc(4*var(--space))}.LkfKFW_error{background:var(--error-primary)}.LkfKFW_title{color:var(--ui-white);margin:var(--space);font-size:2rem}.LkfKFW_label{color:var(--ui-white);margin:var(--space)}");var fe={splash:"LkfKFW_splash",title:"LkfKFW_title",label:"LkfKFW_label",spinner:"LkfKFW_spinner",error:"LkfKFW_error"};import{jsx as be,jsxs as Jt}from"preact/jsx-runtime";function o1({error:e}){return Jt("div",{className:Gt(fe.splash,{[fe.error]:e}),children:[!e&&be(Vt,{large:!0,level:"info",className:fe.spinner}),be("div",{className:fe.title,children:e?be(qi,{id:"gui.splash.errorTitle",defaultMessage:"Error Occurred"}):be(qi,{id:"gui.splash.loading",defaultMessage:"Loading project..."})}),be("div",{className:fe.label,children:e&&be(qi,{id:"gui.splash.errorLabel",defaultMessage:"Please refresh the page and reopen it."})})]})}import{cloneElement as ro}from"preact";import{useMemo as ao}from"preact/hooks";import{classNames as to,flatChildren as oo}from"@blockcode/utils";import{classNames as Yt}from"@blockcode/utils";C(".M5TDuW_tabs-wrapper{white-space:nowrap;position:relative}.M5TDuW_tab-label{--line-height:calc(var(--tool-bar-height)*.8 - 2px);--margin-top:calc(var(--tool-bar-height)*.2 + 1px);font-weight:500;font-size:var(--standard-font-size);line-height:var(--line-height);border:1px solid var(--ui-black-transparent);background:var(--ui-tertiary);color:var(--text-transparent);margin-top:var(--margin-top);white-space:nowrap;border-radius:1rem 1rem 0 0;justify-content:center;padding:0 1.25rem;display:inline-flex;position:relative}.M5TDuW_tab-label.M5TDuW_disabled{filter:opacity(.5);cursor:default;pointer-events:none}.M5TDuW_tab-label:nth-of-type(n+2){margin-left:calc(-1*var(--space))}.M5TDuW_tab-label:last-of-type{margin-right:var(--space)}.M5TDuW_tab-label:not(.M5TDuW_disabled):hover{cursor:pointer;background:var(--ui-primary)}.M5TDuW_tab-label img{filter:grayscale();width:1.375rem}.M5TDuW_tab{display:none}.M5TDuW_tab:checked+.M5TDuW_tab-label{--scale:var(--space)/2;line-height:calc(var(--line-height) + var(--scale));margin-top:calc(var(--margin-top) - var(--scale));color:var(--theme-primary);background:var(--ui-white)}.M5TDuW_tab:checked+.M5TDuW_tab-label img{filter:none}.M5TDuW_tab-panel{top:var(--tool-bar-height);width:100%;height:calc(100% - var(--tool-bar-height));border:1px solid var(--ui-black-transparent);border-radius:0 var(--space)var(--space)var(--space);flex-direction:column;display:flex;position:absolute;bottom:0;transform:translateY(200%)}");var V={tab:"M5TDuW_tab",tabsWrapper:"M5TDuW_tabs-wrapper",tabPanel:"M5TDuW_tab-panel",disabled:"M5TDuW_disabled",tabLabel:"M5TDuW_tab-label"};import{jsx as n1,jsxs as jt,Fragment as Kt}from"preact/jsx-runtime";function ze({id:e,className:r,disabled:i,checked:t,children:o,name:a,onSelect:n}){return jt(Kt,{children:[n1("input",{disabled:i,checked:t,className:V.tab,id:`${e}-tab-${a}`,name:`${e}-tab`,type:"radio",value:a}),n1("label",{className:Yt(V.tabLabel,r,{[V.disabled]:i}),for:`${e}-tab-${a}`,onClick:n,children:o})]})}import{classNames as eo}from"@blockcode/utils";import{jsx as io}from"preact/jsx-runtime";function Oe({id:e,className:r,name:i,children:t}){return io("div",{className:eo(V.tabPanel,r),id:`${e}-panel-${i}`,children:t})}import{jsxs as no}from"preact/jsx-runtime";function l1({id:e,className:r,children:i}){let t=ao(()=>oo(i).filter((o)=>o).map((o)=>ro(o,{id:e})),[e,i]);return ae({[`.${V.tab}:checked+.${V.tabLabel}`]:{zIndex:`${t.length+1}`}}),no("div",{className:to(V.tabsWrapper,r),children:[t.filter((o)=>o.type===ze).map((o,a,n)=>{return ae({[`.${V.tabLabel}:nth-of-type(${a+1})`]:{zIndex:`${n.length-a}`}}),o}),t.filter((o)=>o.type===Oe).map((o)=>{let a=`${e}-tab-${o.props.name}`,n=`${e}-panel-${o.props.name}`;return ae({[`#${a}:checked~#${n}`]:{transform:"none"}}),o})]})}import{useRef as go,useEffect as g1,useCallback as Zi}from"preact/hooks";import{batch as po,useComputed as so,useSignal as Qi}from"@preact/signals";import{classNames as ho}from"@blockcode/utils";import{useAppContext as fo,Text as ve,Button as bo}from"@blockcode/core";C("._4EOxpW_tutorial-box-wrapper{pointer-events:auto;z-index:var(--z-index-card);min-width:468px;position:absolute;bottom:10%;left:50%;transform:translate(-50%)}._4EOxpW_tutorial-card{border:1px solid var(--ui-tertiary);border-radius:calc(var(--space)*1.8);cursor:move;box-shadow:0px 5px 25px 5px var(--ui-black-transparent);z-index:20;flex-direction:column;align-items:center;display:flex;overflow:hidden}._4EOxpW_card-header{background:var(--blocks-primary);width:100%;font-size:var(--small-font-size);flex-direction:row;justify-content:space-between;align-items:center;font-weight:700;display:flex}._4EOxpW_header-button-group{flex-direction:row;display:flex}._4EOxpW_header-button{cursor:pointer;color:#fff;flex-direction:column;justify-content:center;align-items:center;padding:.75rem;display:flex}._4EOxpW_header-button:hover{background:var(--ui-black-transparent)}._4EOxpW_button-icon{border:0;height:1.25rem}._4EOxpW_step-list{flex-direction:row;justify-content:center;align-items:center;display:flex}._4EOxpW_step-pip{cursor:pointer;background:var(--ui-white-transparent);border-radius:100%;width:.5rem;height:.5rem;margin:0 .25rem}._4EOxpW_step-pip._4EOxpW_actived{background:var(--ui-white);-webkit-box-shadow:0px 0px 0px 2px var(--ui-black-transparent);box-shadow:0px 0px 0px 2px var(--ui-black-transparent)}._4EOxpW_card-body{background:var(--ui-white);border-top:1px solid var(--blocks-tertiary);text-align:center;width:100%;min-height:256px;color:var(--text-primary);flex-direction:column;justify-content:center;align-items:center;display:flex;position:relative}._4EOxpW_title{text-align:center;margin:.9rem;font-size:.9rem;font-weight:700}._4EOxpW_image{object-fit:contain;background:var(--ui-secondary);border-radius:var(--space);max-width:450px;max-height:200px;margin:0 var(--space)var(--space);overflow:hidden}._4EOxpW_text{max-width:450px;height:200px;margin:0 var(--space)2.7rem var(--space);flex-direction:column;justify-content:center;font-size:1rem;display:flex}._4EOxpW_image+._4EOxpW_text{height:auto}._4EOxpW_more{padding:0 .9rem var(--space);flex-direction:row;justify-content:space-around;display:flex}._4EOxpW_more-item{margin:0 var(--space)var(--space);cursor:pointer;border-radius:var(--space);border:1px solid #00000026;flex-direction:column;display:flex;overflow:hidden}._4EOxpW_more-item-image{object-fit:cover;width:200px;height:100px}._4EOxpW_more-item-name{color:var(--theme-primary);margin:calc(var(--space)*1.2)0px;text-align:center;text-align:center;max-width:200px;font-size:.85rem;font-weight:700}._4EOxpW_see-more-button{background:var(--theme-primary);color:var(--ui-white);border:0;margin-bottom:2.7rem}._4EOxpW_left-page,._4EOxpW_right-page{background:var(--ui-white);border:1px solid var(--ui-black-transparent);height:90%;width:calc(var(--space)*1.8);opacity:.9;z-index:10;position:absolute;top:5%;overflow:hidden}._4EOxpW_left-page:after,._4EOxpW_right-page:after{content:\"\";background:var(--blocks-primary);width:100%;height:2.5rem;position:absolute;top:0;left:0}._4EOxpW_left-button,._4EOxpW_right-button{user-select:none;cursor:pointer;background:var(--blocks-primary);box-shadow:0 0 0 4px var(--blocks-transparent);z-index:30;border-radius:100%;justify-content:center;align-items:center;width:44px;height:44px;margin-top:-15px;transition:all .25s;display:flex;position:absolute;top:50%}._4EOxpW_left-button:hover,._4EOxpW_right-button:hover{box-shadow:0 0 0 6px var(--blocks-transparent);transform:scale(1.125)}._4EOxpW_left-button img,._4EOxpW_right-button img{width:1.75rem}._4EOxpW_left-page{border-top-left-radius:calc(var(--space)*1.8);border-bottom-left-radius:calc(var(--space)*1.8);border-right:0;left:0;transform:translate(-100%)}._4EOxpW_left-button{left:-27px}._4EOxpW_right-page{border-top-right-radius:calc(var(--space)*1.8);border-bottom-right-radius:calc(var(--space)*1.8);border-left:0;right:0;transform:translate(100%)}._4EOxpW_right-button{right:-27px}._4EOxpW_right-button img{transform:rotateY(180deg)}");var w={text:"_4EOxpW_text",more:"_4EOxpW_more",rightPage:"_4EOxpW_right-page",moreItemName:"_4EOxpW_more-item-name",image:"_4EOxpW_image",leftButton:"_4EOxpW_left-button",tutorialCard:"_4EOxpW_tutorial-card",tutorialBoxWrapper:"_4EOxpW_tutorial-box-wrapper",headerButtonGroup:"_4EOxpW_header-button-group",title:"_4EOxpW_title",cardBody:"_4EOxpW_card-body",moreItem:"_4EOxpW_more-item",rightButton:"_4EOxpW_right-button",actived:"_4EOxpW_actived",stepPip:"_4EOxpW_step-pip",seeMoreButton:"_4EOxpW_see-more-button",stepList:"_4EOxpW_step-list",headerButton:"_4EOxpW_header-button",buttonIcon:"_4EOxpW_button-icon",leftPage:"_4EOxpW_left-page",cardHeader:"_4EOxpW_card-header",moreItemImage:"_4EOxpW_more-item-image"};var c1="./assets/icon-shrink-8vdqegra.svg";var u1="./assets/icon-expand-67bgdn61.svg";var m1="./assets/icon-close-dy7x7fdb.svg";var Ei="./assets/icon-arrow-ddhj68kd.svg";import{jsx as y,jsxs as U,Fragment as $e}from"preact/jsx-runtime";function p1({tutorialId:e,onOpenTutorial:r,onBack:i,onClose:t}){let o=go(),{tutorials:a}=fo(),n=Qi(null),u=Qi(-1),g=Qi(!0),c=so(()=>n.value?.[u.value]),l=Zi(()=>{u.value=(u.value+1)%n.value.length},[]),B=Zi(()=>{u.value=(u.value-1)%n.value.length},[]);return g1(()=>{let b=a.value.lessons[e];if(!b){t();return}po(()=>{n.value=[].concat(b.pages,b.next?{next:b.next.filter((h)=>a.value.lessons[h]).map((h)=>({id:h,title:a.value.lessons[h].title,image:a.value.lessons[h].image}))}:[]),u.value=0})},[e]),g1(()=>{if(o.current){let b=o.current.parentElement,h,m,s=(Q)=>{let T=h-Q.clientX,D=m-Q.clientY;h=Q.clientX,m=Q.clientY,b.style.top=`${b.offsetTop-D}px`,b.style.left=`${b.offsetLeft-T}px`,b.style.bottom="unset"},v=()=>{document.removeEventListener("pointerup",v),document.removeEventListener("pointermove",s)};o.current.addEventListener("pointerdown",(Q)=>{h=Q.clientX,m=Q.clientY,s(Q),document.addEventListener("pointerup",v),document.addEventListener("pointermove",s)})}},[]),U("div",{className:w.tutorialBoxWrapper,children:[U("div",{ref:o,className:w.tutorialCard,children:[U("div",{className:w.cardHeader,children:[U("div",{className:w.headerButton,onClick:i,children:[y("img",{className:w.buttonIcon,src:He}),y(ve,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]}),y("div",{className:w.stepList,children:n.value?.map((b,h)=>y("div",{className:ho(w.stepPip,{[w.actived]:h===u.value}),onClick:()=>u.value=h},h))}),U("div",{className:w.headerButtonGroup,children:[y("div",{className:w.headerButton,onClick:Zi(()=>g.value=!g.value,[]),children:g.value?U($e,{children:[y("img",{className:w.buttonIcon,src:c1}),y(ve,{id:"gui.tutorials.shrink",defaultMessage:"Shrink"})]}):U($e,{children:[y("img",{className:w.buttonIcon,src:u1}),y(ve,{id:"gui.tutorials.expand",defaultMessage:"Expand"})]})}),U("div",{className:w.headerButton,onClick:t,children:[y("img",{className:w.buttonIcon,src:m1}),y(ve,{id:"gui.tutorials.close",defaultMessage:"Close"})]})]})]}),g.value&&c.value&&U("div",{className:w.cardBody,children:[(c.value.title||c.value.next)&&y("div",{className:w.title,children:c.value.title||y(ve,{id:"gui.tutorials.moreTry",defaultMessage:"More things to try!"})}),c.value.image&&y("img",{className:w.image,src:c.value.image}),c.value.text&&y("div",{className:w.text,children:c.value.text}),c.value.next&&U($e,{children:[y("div",{className:w.more,children:c.value.next.map((b)=>U("div",{className:w.moreItem,onClick:()=>r(b.id),children:[y("img",{className:w.moreItemImage,src:b.image}),y("div",{className:w.moreItemName,children:b.title})]},b.id))}),y(bo,{className:w.seeMoreButton,onClick:i,children:y(ve,{id:"gui.tutorials.seeMore",defaultMessage:"See more"})})]})]})]}),g.value&&u.value>0&&U($e,{children:[y("div",{className:w.leftPage}),y("div",{className:w.leftButton,onClick:B,children:y("img",{src:Ei})})]}),g.value&&n.value&&u.value<n.value.length-1&&U($e,{children:[y("div",{className:w.rightPage}),y("div",{className:w.rightButton,onClick:l,children:y("img",{src:Ei})})]})]})}import{useComputed as vo}from"@preact/signals";import{useAppContext as ko,Text as wo,Library as _o}from"@blockcode/core";import{jsx as s1}from"preact/jsx-runtime";var Co=s1(wo,{id:"gui.library.tutorials.tutorial",defaultMessage:"Choose a tutorial"});function d1({onOpenTutorial:e,onClose:r}){let{tutorials:i}=ko(),t=vo(()=>{return Object.entries(i.value.lessons).map(([a,n])=>({title:n.title,image:n.image,tags:n.tags,onSelect:()=>e(a)}))});return s1(_o,{featured:!0,items:t.value,title:i.value.title||Co,filterable:i.value.tags,tags:i.value.tags,onClose:r})}import{useCallback as Ae,useEffect as yo}from"preact/hooks";import{useComputed as Mo,useSignal as Bo}from"@preact/signals";import{getProjectsThumbs as qo,getProject as Eo,cloneProject as Zo,renameProject as Qo,delProject as Lo}from"@blockcode/utils";import{useProjectContext as Fo,closeUserStorage as f1,maybeTranslate as Li,openPromptModal as b1}from"@blockcode/core";import{Text as J,Library as $o}from"@blockcode/core";C(".mLGZyG_delete-menu-item:hover{background:var(--error-primary)}");var h1={deleteMenuItem:"mLGZyG_delete-menu-item"};import{jsx as N}from"preact/jsx-runtime";var Ao=30;function v1({onOpenProject:e}){let{meta:r}=Fo(),i=Bo([]),t=Mo(()=>i.value.length),o=Ae((c,l)=>{b1({title:N(J,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:N(J,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:Li(l??N(J,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(B)=>{if(B?.name)await Qo(c,B.name),g()}})},[]),a=Ae(async(c)=>{await Zo(c),g()},[]),n=Ae((c,l)=>{b1({title:N(J,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:N(J,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:Li(l||N(J,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await Lo(c),g()}})},[]),u=Ae((c)=>async()=>{let l=await Eo(c);e(l),f1()},[]),g=Ae(async()=>{let c=await qo();if(r.value?.editor)c=c.filter((l)=>l.meta.editor===r.value.editor);c=c.sort((l,B)=>B.modifiedDate-l.modifiedDate),i.value=c.map((l)=>({name:Li(l.name??N(J,{id:"gui.project.shortname",defaultMessage:"Untitled"})),image:l.thumb,onSelect:u(l.key),contextMenu:[[{label:N(J,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>o(l.key,l.name)},{label:N(J,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>a(l.key)}],[{label:N(J,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:h1.deleteMenuItem,onClick:()=>n(l.key,l.name)}]]}))},[u,o,n]);return yo(()=>g(),[g]),N($o,{items:i.value,filterable:t.value>Ao,emptyMessage:N(J,{id:"gui.library.projects.empty",defaultMessage:"No project!"}),onClose:f1})}C("._3HqakW_gui-wrapper{height:100%}._3HqakW_alerts-container{width:100%;z-index:var(--z-index-alerts);margin-top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;justify-content:center;display:flex;position:absolute}._3HqakW_menu-bar-position{z-index:var(--z-index-menu-bar);position:relative}._3HqakW_body-wrapper{height:calc(100% - var(--menu-bar-height));background:var(--ui-primary)}._3HqakW_body-wrapper *{box-sizing:border-box}._3HqakW_workspace-wrapper{flex-direction:row;height:100%;display:flex;overflow-y:hidden}._3HqakW_sidebar-wrapper{margin:0 var(--space);display:flex;position:relative}._3HqakW_editor-wrapper{flex-direction:column;flex-grow:1;flex-shrink:0;display:flex;position:relative}._3HqakW_tabs-wrapper{flex-grow:1;position:relative}._3HqakW_tab-panel-no-left{border-bottom-left-radius:0}._3HqakW_tab-panel-no-right{border-top-right-radius:0;border-bottom-right-radius:0}._3HqakW_tab-panel-no-bottom{border-bottom-right-radius:0;border-bottom-left-radius:0}._3HqakW_pane-wrapper{margin:var(--space)0 0 0;display:flex;position:relative}");var P={tabPanelNoLeft:"_3HqakW_tab-panel-no-left",tabsWrapper:"_3HqakW_tabs-wrapper",tabPanelNoBottom:"_3HqakW_tab-panel-no-bottom",editorWrapper:"_3HqakW_editor-wrapper",bodyWrapper:"_3HqakW_body-wrapper",paneWrapper:"_3HqakW_pane-wrapper",guiWrapper:"_3HqakW_gui-wrapper",menuBarPosition:"_3HqakW_menu-bar-position",sidebarWrapper:"_3HqakW_sidebar-wrapper",tabPanelNoRight:"_3HqakW_tab-panel-no-right",alertsContainer:"_3HqakW_alerts-container",workspaceWrapper:"_3HqakW_workspace-wrapper"};import{jsx as _,jsxs as xe,Fragment as y1}from"preact/jsx-runtime";var _e=Io({Bluetooth:null,SerialPort:null});function M1(){let[e]=Wo(),{language:r}=Uo(),i=So();Fi(()=>{document.title=To("gui.name","BlockCode Playgrounds")},[r.value]);let t=k1(()=>{let d={};return i.docks.value?.forEach((k)=>{if(k.expand==="bottom")d.paneLabel=k.label,d.PaneContent=k.Content;else if(k.expand==="left")d.LeftDockContent=k.Content;else d.RightDockContent=k.Content}),d}),{LeftDockContent:o,RightDockContent:a,PaneContent:n}=t.value,u=Do({[P.tabPanelNoLeft]:!o,[P.tabPanelNoRight]:!a,[P.tabPanelNoBottom]:!n}),g=Ge(null);Fi(()=>{if($i)window.electron.serial.onScan((d)=>{g.value=d&&{devices:d,type:_e.SerialPort}}),window.electron.bluetooth.onScan((d)=>{g.value=d&&{devices:d,type:_e.Bluetooth}})},[]);let c=()=>{},l=X(()=>{if($i){if(g.value.type===_e.SerialPort)window.electron.serial.cancel();if(g.value.type===_e.Bluetooth)window.electron.bluetooth.cancel();g.value=null}},[]),B=X((d)=>{if($i){if(g.value.type===_e.SerialPort)window.electron.serial.connect(d);if(g.value.type===_e.Bluetooth)window.electron.bluetooth.connect(d)}},[]),b=Ge({});xo(async()=>{let d=await Ze();d=d.map((k)=>[k.id,{name:k.name,version:k.version}]),b.value=Object.fromEntries(d)});let h=X(()=>{ke(()=>{i.appState.value?.device?.disconnect(),We("device",null),Vo(),Oo()})},[]),m=X((d)=>{ke(()=>{w1(),Go(Object.assign(JSON.parse(JSON.stringify(d)),{fileId:d.fileId??d.files?.[0]?.id})),C1(0)})},[]),s=Ge(!1),v=Ge(null),Q=X(()=>{ke(()=>{v.value=null,s.value=!0})},[]),T=X((d)=>{let k=i.tutorials.value.lessons[d];ke(async()=>{if(k.project){Jo("importing",{id:d});let R=await Po(k.project);Yo(d),m(R)}v.value=d,s.value=!1})},[]),{meta:D,key:Ai,modified:Wi}=Xo(),xi=k1(()=>!D.value),B1=X(()=>{if(Wi.value)Ve({title:_(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(we,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:h});else h()},[]),Je=X((d,k)=>{if(k!==d.meta.editor){Ve({label:_(we,{id:"gui.library.projects.errorEditor",defaultMessage:'This project is not currently editor creation, please switch to "{editor}" and open it.',editor:No(b.value[d.meta.editor]?.name)}),redStyle:!0});return}if(Ai.value===d.key)return;if(Wi.value)Ve({title:_(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(we,{id:"gui.library.projects.replace",defaultMessage:"Replace contents of the current project?"}),onSubmit:()=>m(d)});else m(d)},[]),Di=X(async(d,k)=>{ke(()=>{h(),w1()});let R=d,Pi=window.electron?.getLocalEditors();if(Pi?.[d]?.main)R=Pi[d].main;let ne;try{ne=(await import(R)).default}catch(tn){Ve({label:_(we,{id:"gui.library.projects.notFoundEditor",defaultMessage:'Not Found the "{editor}" Editor.',editor:d}),redStyle:!0}),Ho();return}let Ye={editor:d,version:b.value[d]?.version};if(!k)k=JSON.parse(JSON.stringify(await ne.onNew()));if(!k.meta)k.meta=Ye;if(!k.meta.editor)k.meta.editor=d,k.meta.version=Ye.version;let q1={menuItems:pr(ne,Ye,Je),barItems:ne.barItems,tabs:ne.tabs,docks:ne.docks,tutorials:window.electron?.getLocalTutorials(d,r.value)??ne.tutorials};ke(()=>{zo(q1),Je(k,d)})},[]),Ii=X((d)=>{if(D.value?.editor!==d.meta.editor){h(),Di(d.meta.editor,d);return}Je(d,D.value.editor)},[]);return Fi(()=>{if(D.value?.editor){if(Ro(D.value.editor))We("panelBoxId","Logs")}else We("panelBoxId",null)},[D.value?.editor]),xe(y1,{children:[(i.splashVisible.value||e)&&_(o1,{error:e}),_(vr,{items:i.alerts.value}),_(Vr,{className:P.menuBarPosition,showHomeButton:!xi.value,onRequestHome:B1,onOpenTutorialLibrary:Q}),_("div",{className:P.bodyWrapper,children:xe("div",{className:P.workspaceWrapper,children:[o&&_("div",{className:P.sidebarWrapper,children:_(o,{})}),xe("div",{className:P.editorWrapper,children:[_(l1,{id:P.tabsWrapper,className:P.tabsWrapper,children:i.tabs.value?.map(({Content:d,...k},R)=>xe(y1,{children:[xe(ze,{name:R,disabled:k.disabled,checked:R===i.tabIndex.value,onSelect:()=>C1(R),children:[_("img",{src:k.icon}),k.label]},R),_(Oe,{name:R,className:u,children:(R===0||i.tabIndex.value===R)&&d&&_(d,{})},R)]}))}),n&&_(Jr,{id:P.paneWrapper,className:P.paneWrapper,title:t.value.paneLabel,right:!a,left:!o,children:_(n,{})})]}),a&&_("div",{className:P.sidebarWrapper,children:_(a,{})})]})}),i.appState.value?.panelBoxId&&_(or,{panelId:i.appState.value.panelBoxId,onPanelChange:X((d)=>We("panelBoxId",d),[]),onClose:X(()=>We("panelBoxId",null),[])}),g.value&&_(_r,{title:D.value.deviceName,icon:D.value.deviceIcon,devices:g.value.devices,onClose:l,onConnect:B}),v.value&&_(p1,{tutorialId:v.value,onOpenTutorial:T,onBack:Q,onClose:()=>v.value=null}),s.value&&_(d1,{onOpenTutorial:T,onClose:X(()=>s.value=!1,[])}),xi.value&&_(Dr,{onOpenEditor:Di,onOpenProject:Ii}),i.userStorageVisible.value&&_(v1,{onOpenProject:Ii}),i.prompt.value&&(i.prompt.value.inputItems?_(t1,{title:i.prompt.value.title,content:i.prompt.value.content,inputItems:i.prompt.value.inputItems,onClose:_1,onSubmit:i.prompt.value.onSubmit}):_(jr,{title:i.prompt.value.title,label:i.prompt.value.label,content:i.prompt.value.content,redStyle:i.prompt.value.redStyle,onClose:_1,onSubmit:i.prompt.value.onSubmit,children:i.prompt.value.body}))]})}import{addAlertConfig as W,Text as x,Spinner as me}from"@blockcode/core";import{jsx as E}from"preact/jsx-runtime";W("importing",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.importing",defaultMessage:"Importing..."})});W("downloading",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.downloading",defaultMessage:"Downloading...{progress}%"})});W("downloadCompleted",{icon:null,message:E(x,{id:"gui.alert.downloadCompleted",defaultMessage:"Download completed."})});W("connecting",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.connecting",defaultMessage:"Connecting..."})});W("connected",{icon:null,message:E(x,{id:"gui.alert.connected",defaultMessage:"Connected."})});W("connectionCancel",{icon:null,mode:"warn",message:E(x,{id:"gui.alert.connectionCancel",defaultMessage:"Connection cancel."})});W("connectionError",{icon:null,mode:"warn",message:E(x,{id:"gui.alert.connectionError",defaultMessage:"Connection error or connection was lost."})});W("erasing",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.erasing",defaultMessage:"Erasing..."})});W("restoring",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.restoring",defaultMessage:"Firmware restoring...{progress}%"})});W("recovering",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.recovering",defaultMessage:"Recovering..."})});W("restoreCompleted",{icon:null,message:E(x,{id:"gui.alert.restoreCompleted",defaultMessage:"Firmware resotre completed! Now press RESET key"})});W("compiling",{icon:E(me,{level:"success"}),message:E(x,{id:"gui.alert.compiling",defaultMessage:"Compiling..."})});W("compileCompleted",{icon:null,message:E(x,{id:"gui.alert.compileCompleted",defaultMessage:"Compilation completed."})});W("compileError",{icon:null,mode:"warn",message:E(x,{id:"gui.alert.compileError",defaultMessage:"Compilation error."})});W("reseting",{icon:null,message:E(x,{id:"gui.alert.reseting",defaultMessage:"Reseting..."})});import{jsx as De}from"preact/jsx-runtime";function an(){return De(jo,{children:De(en,{children:De(rn,{children:De(M1,{})})})})}Ko(De(an,{}),document.getElementById("root"));
