import{addLocalesMessages as Q1}from"@blockcode/core";var Ri={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"Importing...","gui.alert.downloading":"Downloading...{progress}%","gui.alert.downloadCompleted":"Download completed.","gui.alert.connecting":"Connecting...","gui.alert.connected":"Connected.","gui.alert.connectionCancel":"Connection cancel.","gui.alert.connectionError":"Connection error or connection was lost.","gui.alert.erasing":"Erasing...","gui.alert.restoring":"Firmware restoring...{progress}%","gui.alert.recovering":"Recovering...","gui.alert.restoreCompleted":"Firmware resotre completed! Now press RESET key","gui.alert.reseting":"Reseting...","gui.alert.compiling":"Compiling...","gui.alert.compileCompleted":"Compilation completed.","gui.alert.compileError":"Compilation failed.","gui.alert.compileViewError":"View Message.","gui.alert.saving":"Saving project...","gui.alert.saved":"Saved.","gui.alert.savedComputer":"Saved to your computer.","gui.alert.saveAbortError":"Abort saving.","gui.alert.saveError":"Failed save.","gui.logs.changeDevice":"Device changed to {device}","gui.logs.connected":"Device connected","gui.logs.connectedType":"Device connected with {type}","gui.logs.disconnected":"Device disconnected","gui.logs.compiling":"Compiling...","gui.logs.compiled":"Compile completed","gui.logs.downloading":"Downloading...","gui.logs.downloaded":"Download completed","gui.logs.downloadError":"Download failed","gui.home.my":"My projects","gui.home.all":"View all","gui.home.allCounts":"View all ({counts})","gui.home.new":"Create new project","gui.home.examples":"Wonderful {label} projects","gui.home.slideshow.desktop.title":"The desktop application is here!","gui.home.slideshow.desktop.button":"Download","gui.home.slideshow.tankwar.title":"The Tank War is coming! Join us!","gui.home.slideshow.tankwar.button":"Join us","gui.home.slideshow.arcade.title":"The next game, create your own!","gui.home.slideshow.arcade.button":"Create now","gui.splash.loading":"Loading project...","gui.splash.errorTitle":"Error occurred","gui.splash.errorLabel":"Please refresh the page and reopen it.","gui.menubar.courses":"Courses","gui.menubar.tutorials":"Tutorials","gui.menubar.titlePlaceholder":"Project title here","gui.menubar.file":"File","gui.menubar.file.newProject":"New","gui.menubar.file.openProject":"Open...","gui.menubar.file.saveProject":"Save","gui.menubar.file.uploadProject":"Load from your computer...","gui.menubar.file.downloadProject":"save to your computer...","gui.menubar.edit":"Edit","gui.menubar.edit.undo":"Undo","gui.menubar.edit.redo":"Redo","gui.menubar.edit.openManualCoding":"Turn on Coding Mode","gui.menubar.edit.closeManualCoding":"Turn off Coding Mode","gui.menubar.edit.openCompactBlock":"Turn on Compact Block","gui.menubar.edit.closeCompactBlock":"Turn off Compact Block","gui.menubar.view":"View","gui.menubar.view.log":"Log Panel","gui.menubar.view.serial":"Serial Panel","gui.menubar.view.files":"Files Panel","gui.menubar.view.openAutoDisplayPanel":"Turn on auto display Log Panel","gui.menubar.view.closeAutoDisplayPanel":"Turn off auto display Log Panel","gui.menubar.device":"Device","gui.menubar.device.sync":"Sync program","gui.menubar.device.download":"Download program","gui.menubar.device.reset":"Reset device","gui.menubar.device.connect":"Connect device...","gui.menubar.device.connectUsb":"Connect device with USB...","gui.menubar.device.connectBle":"Connect device with Bluetooth (BLE)...","gui.menubar.device.disconnect":"Disconnect device","gui.menubar.device.firmware":"Restore firmware...","gui.menubar.device.firmwareVersion":"Restore v{version} firmware...","gui.menubar.device.caching":"Caching latest firmware...","gui.panelBox.logs":"Logs","gui.panelBox.serial":"Serial","gui.panelBox.files":"Files","gui.project.name":"Untitled Project","gui.project.shortname":"Untitled","gui.library.search":"Search","gui.library.projects.empty":"No project!","gui.library.projects.rename":"rename","gui.library.projects.duplicate":"duplicate","gui.library.projects.delete":"delete","gui.library.projects.notSaved":"Not saved","gui.library.projects.close":"Close current project?","gui.library.projects.deleteConfirm":'Do you want to delete the project "{name}"?',"gui.library.projects.replace":"Replace contents of the current project?","gui.library.projects.errorEditor":'This project is not currently editor creation, please switch to "{workspace}" and open it.',"gui.library.projects.notFoundEditor":'Not Found the "{editor}" Editor.',"gui.library.examples.interconnect":"The project requires two devices to work properly.","gui.library.tutorial.course":"Choose a course","gui.library.tutorial.tutorial":"Choose a tutorial","gui.tutorials.shrink":"Shrink","gui.tutorials.expand":"Expand","gui.tutorials.close":"Close","gui.tutorials.moreTry":"More things to try!","gui.tutorials.seeMore":"See more","gui.prompt.ok":"OK","gui.prompt.close":"Close","gui.prompt.cancel":"Cancel","gui.prompt.reconnect":"Reconnect","gui.connection.device":"Device Connection","gui.connection.search":"Start Searching","gui.connection.searching":"Searching...","gui.connection.connect":"Start Connecting","gui.connection.deviceName":"Device name","gui.about.title":"About...","gui.about.main":"Main program","gui.terms.title":"Terms of Use","gui.terms.content":`<b>Terms of Use</b>
`,"gui.privacy.title":"Privacy","gui.privacy.content":`<b>Privacy</b>
`};var Si={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"载入中…","gui.alert.downloading":"正在下载…{progress}%","gui.alert.downloadCompleted":"下载完成。","gui.alert.connecting":"正在连接…","gui.alert.connected":"已连接。","gui.alert.connectionCancel":"连接取消。","gui.alert.connectionError":"连接发生错误，或已断开。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在恢复固件…{progress}%","gui.alert.recovering":"恢复设备…","gui.alert.restoreCompleted":"恢复固件完成，请按下 RESET 键。","gui.alert.reseting":"正在复位…","gui.alert.compiling":"正在编译…","gui.alert.compileCompleted":"编译完成。","gui.alert.compileError":"编译失败。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存作品…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到电脑。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存作品失败。","gui.logs.changeDevice":"设备已更改为 {device}","gui.logs.connected":"设备已连接","gui.logs.connectedType":"设备已连接到 {type}","gui.logs.disconnected":"设备断开连接","gui.logs.compiling":"程序编译中…","gui.logs.compiled":"编译完成","gui.logs.downloading":"下载程序到设备…","gui.logs.downloaded":"下载完成","gui.logs.downloadError":"下载失败","gui.home.my":"我的作品","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"开始新作品","gui.home.examples":"{label} 精彩作品","gui.home.slideshow.desktop.title":"桌面端程序已就绪，快来下载！","gui.home.slideshow.desktop.button":"立即下载","gui.home.slideshow.tankwar.title":"战争一触即发，赶紧来战吧！","gui.home.slideshow.tankwar.button":"加入战斗","gui.home.slideshow.arcade.title":"玩的下一个游戏，就要自己创作！","gui.home.slideshow.arcade.button":"开始创作","gui.splash.loading":"加载作品…","gui.splash.errorTitle":"发生错误","gui.splash.errorLabel":"请刷新页面重新打开。","gui.menubar.courses":"课程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填写作品标题","gui.menubar.file":"文件","gui.menubar.file.newProject":"新作品","gui.menubar.file.openProject":"打开…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"从电脑中打开…","gui.menubar.file.downloadProject":"保存到电脑…","gui.menubar.edit":"编辑","gui.menubar.edit.undo":"撤销","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打开代码编程","gui.menubar.edit.closeManualCoding":"关闭代码编程","gui.menubar.edit.openCompactBlock":"打开紧凑积木样式","gui.menubar.edit.closeCompactBlock":"关闭紧凑积木样式","gui.menubar.view":"查看","gui.menubar.view.log":"日志","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文件管理","gui.menubar.view.openAutoDisplayPanel":"打开自动显示日志","gui.menubar.view.closeAutoDisplayPanel":"关闭自动显示日志","gui.menubar.device":"设备","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下载程序","gui.menubar.device.reset":"复位","gui.menubar.device.connect":"连接…","gui.menubar.device.connectUsb":"通过 USB 连接…","gui.menubar.device.connectBle":"通过蓝牙（BLE）连接…","gui.menubar.device.disconnect":"断开连接","gui.menubar.device.firmware":"恢复固件…","gui.menubar.device.firmwareVersion":"恢复 v{version} 固件…","gui.menubar.device.caching":"正在缓存最新固件…","gui.panelBox.logs":"日志","gui.panelBox.serial":"串口","gui.panelBox.files":"文件管理","gui.project.name":"未命名作品","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"没有作品！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"复制","gui.library.projects.delete":"删除","gui.library.projects.notSaved":"未保存作品","gui.library.projects.close":"要关闭当前作品吗？","gui.library.projects.deleteConfirm":"要删除“《{name}》”作品吗？","gui.library.projects.replace":"要创建新作品替换当前作品吗？","gui.library.projects.errorEditor":"这个作品不是当前编辑器创作，请切换至“{editor}”编辑器然后打开。","gui.library.projects.notFoundEditor":"没有发现“{editor}”编辑器。","gui.library.examples.interconnect":"该作品需要两台设备联机才能正常运行。","gui.library.tutorials.course":"选择一个课程","gui.library.tutorials.tutorial":"选择一个教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展开","gui.tutorials.close":"关闭","gui.tutorials.moreTry":"再试试这些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"确认","gui.prompt.close":"关闭","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新连接","gui.connection.device":"硬件连接","gui.connection.search":"开始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"开始连接","gui.connection.deviceName":"硬件名称","gui.about.title":"版本信息","gui.about.main":"主程序","gui.terms.title":"使用条款","gui.terms.content":`<b>使用条款</b>
`,"gui.privacy.title":"隐私","gui.privacy.content":`<b>隐私</b>
`};var Ui={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"載入中…","gui.alert.downloading":"正在下載…{progress}%","gui.alert.downloadCompleted":"下載完成。","gui.alert.connecting":"正在連接…","gui.alert.connected":"已連接。","gui.alert.connectionCancel":"連接取消。","gui.alert.connectionError":"連接發生錯誤，或已斷開。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在還原固件…{progress}%","gui.alert.recovering":"恢復設備…","gui.alert.restoreCompleted":"還原固件完成，請按下 RESET 鍵。","gui.alert.reseting":"正在重置…","gui.alert.compiling":"正在編譯…","gui.alert.compileCompleted":"編譯完成。","gui.alert.compileError":"編譯失敗。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存專案…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到電腦。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存專案失敗。","gui.logs.changeDevice":"設備已更改為 {device}","gui.logs.connected":"設備已連接","gui.logs.connectedType":"設備已連接到 {type}","gui.logs.disconnected":"設備斷開連接","gui.logs.compiling":"程序編譯中…","gui.logs.compiled":"編譯完成","gui.logs.downloading":"下載程序到設備…","gui.logs.downloaded":"下載完成","gui.logs.downloadError":"下載失敗","gui.home.my":"我的專案","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"開始新專案","gui.home.examples":"{label} 精彩專案","gui.home.slideshow.desktop.title":"桌面端程序已就緒，快來下載！","gui.home.slideshow.desktop.button":"立即下載","gui.home.slideshow.tankwar.title":"戰爭一觸即髮，趕緊來戰吧！","gui.home.slideshow.tankwar.button":"加入戰鬥","gui.home.slideshow.arcade.title":"玩的下一個遊戲，就要自己創作！","gui.home.slideshow.arcade.button":"開始創作","gui.splash.loading":"加載專案…","gui.splash.errorTitle":"發生錯誤","gui.splash.errorLabel":"請刷新頁面重新打開。","gui.menubar.courses":"課程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填寫專案標題","gui.menubar.file":"文檔","gui.menubar.file.newProject":"新專案","gui.menubar.file.openProject":"打開…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"從電腦中打開…","gui.menubar.file.downloadProject":"保存到電腦…","gui.menubar.edit":"編輯","gui.menubar.edit.undo":"撤銷","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打開代碼編程","gui.menubar.edit.closeManualCoding":"關閉代碼編程","gui.menubar.edit.openCompactBlock":"打開緊湊積木樣式","gui.menubar.edit.closeCompactBlock":"關閉緊湊積木樣式","gui.menubar.view":"查看","gui.menubar.view.log":"日誌","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文檔管理","gui.menubar.view.openAutoDisplayPanel":"打開自動顯示日誌","gui.menubar.view.closeAutoDisplayPanel":"關閉自動顯示日誌","gui.menubar.device":"設備","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下載程序","gui.menubar.device.reset":"重置","gui.menubar.device.connect":"連接…","gui.menubar.device.connectUsb":"通過 USB 連接…","gui.menubar.device.connectBle":"通過藍牙（BLE）連接…","gui.menubar.device.disconnect":"斷開連接","gui.menubar.device.firmware":"還原固件…","gui.menubar.device.firmwareVersion":"還原 v{version} 固件…","gui.menubar.device.caching":"正在緩存最新固件…","gui.panelBox.logs":"日誌","gui.panelBox.serial":"串口","gui.panelBox.files":"文檔管理","gui.project.name":"未命名專案","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"沒有專案！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"複製","gui.library.projects.delete":"刪除","gui.library.projects.notSaved":"未保存專案","gui.library.projects.close":"要關閉當前專案嗎？","gui.library.projects.deleteConfirm":"要刪除“《{name}》”專案嗎？","gui.library.projects.replace":"要創建新專案替換當前專案嗎？","gui.library.projects.errorEditor":"這個專案不是當前編輯器創作，請切換至“{editor}”編輯器然後打開。","gui.library.projects.notFoundEditor":"沒有發現「{editor}」編輯器。","gui.library.examples.interconnect":"該專案需要兩枱設備聯機纔能正常運行。","gui.library.tutorials.course":"選擇一個課程","gui.library.tutorials.tutorial":"選擇一個教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展開","gui.tutorials.close":"關閉","gui.tutorials.moreTry":"再試試這些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"確認","gui.prompt.close":"關閉","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新連接","gui.connection.device":"硬件連接","gui.connection.search":"開始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"開始連接","gui.connection.deviceName":"硬件名稱","gui.about.title":"版本信息","gui.about.main":"主程式","gui.terms.title":"使用條款","gui.terms.content":`<b>使用條款</b>
`,"gui.privacy.title":"隱私","gui.privacy.content":`<b>隱私</b>
`};Q1({en:Ri,"zh-Hans":Si,"zh-Hant":Ui});import{render as jo}from"preact";import{LocalesProvider as en,AppProvider as rn,ProjectProvider as an}from"@blockcode/core";import{useCallback as T,useEffect as Fi,useErrorBoundary as Io}from"preact/hooks";import{batch as ke,useComputed as _1,useSignal as Ge,useSignalEffect as Do}from"@preact/signals";import{isElectron as $i,classNames as xo,keyMirror as Po,openProjectFromURL as Ro,getAutoDisplayPanel as So}from"@blockcode/utils";import{useAppContext as Uo,useLocalesContext as Xo,useProjectContext as To,translate as No,maybeTranslate as Ho,showSplash as C1,hideSplash as zo,openPromptModal as Ve,closePromptModal as y1,openLayout as Oo,closeLayout as Go,openTab as B1,openProject as Vo,closeProject as Jo,setAlert as Yo,delAlert as Ko,setAppState as We}from"@blockcode/core";import{getAutoDisplayPanel as wa,setAutoDisplayPanel as _a}from"@blockcode/utils";import{Text as li}from"@blockcode/core";import{useCallback as xe}from"preact/hooks";import{batch as L1}from"@preact/signals";import{isElectron as Xi,isMac as Ke,putProject as F1,openProjectFromComputer as $1,saveProjectToComputer as A1,sleepMs as W1}from"@blockcode/utils";import{useProjectContext as I1,setAlert as ii,openUserStorage as D1,setFile as x1,setModified as P1,ModifyTypes as R1,Keys as ie}from"@blockcode/core";import{Text as K,MenuSection as je,MenuItem as Ce}from"@blockcode/core";function C(e){let r=globalThis.document,i=r.createElement("style");i.appendChild(r.createTextNode(e)),r.head.append(i)}C(".cbXT-q_menu-bar{box-sizing:border-box;height:var(--menu-bar-height);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:var(--menu-bar-standard-font-size);background-color:var(--theme-primary);color:var(--ui-white);-webkit-user-select:none;-webkit-app-region:drag;flex-flow:row;justify-content:space-between;font-weight:700;display:flex;box-shadow:0 0 3px #00000040}.cbXT-q_menu-bar-item{color:var(--ui-white);user-select:none;white-space:nowrap;height:var(--menu-bar-height);align-self:center;align-items:center;padding:0 .25rem;text-decoration:none;display:flex;position:relative}.cbXT-q_menu-bar-item.cbXT-q_growable{max-width:var(--menu-bar-item-max-width);flex:1}.cbXT-q_menu-bar-item[disabled]{opacity:.5;pointer-events:none}.cbXT-q_main-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_main-menu.cbXT-q_electron{margin-left:72px}.cbXT-q_right-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_menu-label{padding:0 .75rem}.cbXT-q_menu-label img{margin-right:.25rem}.cbXT-q_language-label{width:var(--language-selector-width);padding:0 .5rem}input.cbXT-q_menu-label{display:none}input.cbXT-q_menu-label+.cbXT-q_menu-bar-item:hover{cursor:pointer;background:var(--ui-black-transparent)}input.cbXT-q_menu-label:checked+.cbXT-q_menu-bar-item{background:var(--ui-black-transparent)}.cbXT-q_main-menu>.cbXT-q_menu{border-radius:0 0 var(--space)var(--space)}.cbXT-q_menu{top:var(--menu-bar-height);z-index:var(--z-index-menu-bar);border-radius:var(--space);color:var(--ui-white);background:var(--theme-primary);min-width:186px;display:none}.cbXT-q_menu-item{font-weight:700}.cbXT-q_menu-item:hover{background:var(--ui-black-transparent)}.cbXT-q_language-icon{vertical-align:middle;height:1.5rem}.cbXT-q_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}.cbXT-q_check-icon.cbXT-q_checked{visibility:visible}.cbXT-q_divider{border-right:1px dashed var(--ui-black-transparent);height:34px;margin:0 .7rem}.cbXT-q_hoverable:not([disabled]):hover{cursor:pointer;background:var(--ui-black-transparent)}.cbXT-q_tutorials-icon{margin-right:.35rem}.cbXT-q_title-field{border:1px dashed var(--ui-black-transparent);border-radius:var(--form-radius);-webkit-border-radius:var(--form-radius);-moz-border-radius:var(--form-radius);background-color:var(--ui-white-transparent);height:auto;color:var(--ui-white);-webkit-background-clip:padding-box;background-clip:padding-box;padding:.5rem;font-size:.8rem;font-weight:700}.cbXT-q_title-field::placeholder{color:var(--ui-white);font-size:.8rem;font-style:italic;font-weight:400}.cbXT-q_title-field:hover{background-color:#ffffff80}.cbXT-q_title-field:focus{border:1px solid var(--ui-transparent);-webkit-box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);box-shadow:0 0 0 calc(var(--space)*.5)var(--ui-white-transparent);background-color:var(--ui-white);color:var(--text-primary);outline:none}.cbXT-q_menu-bar-icon>img{padding:0 .35rem}.cbXT-q_blank-check-item>div{padding-left:calc(14px + var(--space)/2)}");var l={menuBarItem:"cbXT-q_menu-bar-item",menuItem:"cbXT-q_menu-item",hoverable:"cbXT-q_hoverable",tutorialsIcon:"cbXT-q_tutorials-icon",languageIcon:"cbXT-q_language-icon",menuBarIcon:"cbXT-q_menu-bar-icon",blankCheckItem:"cbXT-q_blank-check-item",electron:"cbXT-q_electron",growable:"cbXT-q_growable",menuLabel:"cbXT-q_menu-label",checked:"cbXT-q_checked",rightMenu:"cbXT-q_right-menu",menu:"cbXT-q_menu",mainMenu:"cbXT-q_main-menu",menuBar:"cbXT-q_menu-bar",checkIcon:"cbXT-q_check-icon",languageLabel:"cbXT-q_language-label",divider:"cbXT-q_divider",titleField:"cbXT-q_title-field"};import{jsx as F,jsxs as ei,Fragment as S1}from"preact/jsx-runtime";var Ti=(e=!1)=>ii({message:F(K,{id:"gui.alert.saving",defaultMessage:"Saving project..."})},e),Ni=(e,r=!1)=>ii({id:e,message:r?F(K,{id:"gui.alert.savedComputer",defaultMessage:"Saved to your computer."}):F(K,{id:"gui.alert.saved",defaultMessage:"Saved to local storage."})},2000),Hi=(e,r=!1)=>ii({id:e,mode:"warn",message:r?F(K,{id:"gui.alert.saveAbortError",defaultMessage:"Abort saving."}):F(K,{id:"gui.alert.saveError",defaultMessage:"Failed save."})},r?1000:2000);function zi({onNew:e,onOpen:r,onSave:i,onThumb:t,ExtendedMenu:o}){let{meta:a,key:n,name:u,files:g,assets:c}=I1(),p=xe(async()=>{await W1(0);for(let N in a.value.monitors)if(a.value.monitors[N].deleting)a.value.monitors.splice(N,1);let m=[],f=g.value.map((N)=>{return m.push(N.extensions),Object.fromEntries(Object.entries(N).filter(([x,Ai])=>{if(["xmlDom","script","extensions"].includes(x))return!1;if(!a.value.manualCoding&&x==="content")return!1;return!0}))}),v=c.value?.filter((N)=>!N.uri),L=await i(f,v,a.value);return L.meta=Object.assign(L.meta??{},{editor:a.value.editor,version:a.value.version,monitors:a.value.monitors,extensions:Array.from(new Set(m.flat())).filter(Boolean),manualCoding:a.value.manualCoding,compactBlock:a.value.compactBlock,users:a.value.users}),L.name=u.value,L},[i]),q=xe(async()=>{let m=Ti(),f=await p();f.key=n.value;let v=await F1(f,t);L1(()=>{if(f.key!==v)x1({key:v});P1(R1.Saved)}),Ni(m)},[p]),d=xe(async()=>{let m=Ti(Xi?1000:!1),f=await p(),v=await A1(f);if(Xi)return;if(v.success)Ni(m,!0);else if(v.error==="AbortError")Hi(m,!0);else Hi(m)},[p]),h=xe(async()=>{let m=await $1();await r(m)},[r]);return ei(S1,{children:[F(je,{children:F(Ce,{className:l.menuItem,label:F(K,{id:"gui.menubar.file.newProject",defaultMessage:"New"}),hotkey:[Ke?ie.COMMAND:ie.CONTROL,ie.N],onClick:e})}),ei(je,{children:[F(Ce,{className:l.menuItem,label:F(K,{id:"gui.menubar.file.openProject",defaultMessage:"Open"}),hotkey:[Ke?ie.COMMAND:ie.CONTROL,ie.O],onClick:D1}),F(Ce,{className:l.menuItem,label:F(K,{id:"gui.menubar.file.saveProject",defaultMessage:"Save"}),hotkey:[Ke?ie.COMMAND:ie.CONTROL,ie.S],onClick:q})]}),ei(je,{children:[F(Ce,{className:l.menuItem,label:F(K,{id:"gui.menubar.file.uploadProject",defaultMessage:"Load from your computer"}),onClick:h}),F(Ce,{className:l.menuItem,label:F(K,{id:"gui.menubar.file.downloadProject",defaultMessage:"save to your computer"}),onClick:d})]}),o&&F(o,{className:l.menu,itemClassName:l.menuItem,onOpen:r,onSave:p})]})}import{useCallback as Oi,useEffect as U1}from"preact/hooks";import{batch as X1,useSignal as Gi,useComputed as T1}from"@preact/signals";import{isMac as Vi,setCompactBlock as N1,getCompactBlock as H1}from"@blockcode/utils";import{useProjectContext as z1,Keys as re,setMeta as Ji}from"@blockcode/core";import{Text as ge,MenuSection as Yi,MenuItem as Pe}from"@blockcode/core";import{jsx as z,jsxs as ri,Fragment as O1}from"preact/jsx-runtime";function Ki({enableCoding:e,enableCompactBlock:r,onUndo:i,onRedo:t,onEnableUndo:o,onEnableRedo:a,ExtendedMenu:n}){let{meta:u,key:g,fileId:c,modified:p}=z1(),q=Gi(!0),d=Gi(!0),h=T1(()=>u.value.compactBlock??H1());U1(()=>{X1(()=>{q.value=!o(),d.value=!a()})},[g.value,c.value,p.value]);let m=Oi(()=>{Ji("manualCoding",!u.value.manualCoding)},[]),f=Oi(()=>{let v=!h.value;Ji("compactBlock",v),N1(v)},[]);return ri(O1,{children:[ri(Yi,{children:[z(Pe,{disabled:q.value,className:l.menuItem,label:z(ge,{id:"gui.menubar.edit.undo",defaultMessage:"Undo"}),hotkey:[Vi?re.COMMAND:re.CONTROL,re.Z],onClick:i}),z(Pe,{disabled:d.value,className:l.menuItem,label:z(ge,{id:"gui.menubar.edit.redo",defaultMessage:"Redo"}),hotkey:Vi?[re.SHIFT,re.COMMAND,re.Z]:[re.CONTROL,re.Y],onClick:t})]}),(e||r)&&ri(Yi,{children:[r&&z(Pe,{className:l.menuItem,label:h.value?z(ge,{id:"gui.menubar.edit.closeCompactBlock",defaultMessage:"Turn off Compact Block"}):z(ge,{id:"gui.menubar.edit.openCompactBlock",defaultMessage:"Turn on Compact Block"}),onClick:f}),e&&z(Pe,{className:l.menuItem,label:u.value.manualCoding?z(ge,{id:"gui.menubar.edit.closeManualCoding",defaultMessage:"Turn off Coding Mode"}):z(ge,{id:"gui.menubar.edit.openManualCoding",defaultMessage:"Turn on Coding Mode"}),onClick:m})]}),n&&z(n,{className:l.menu,itemClassName:l.menuItem})]})}import{useEffect as ol,useCallback as nr}from"preact/hooks";import{useComputed as ua,useSignal as ma}from"@preact/signals";import{classNames as Re,getAutoDisplayPanel as ga,setAutoDisplayPanel as pa}from"@blockcode/utils";import{useAppContext as da,useProjectContext as sa,setAppState as ha,Keys as de,Text as Be,MenuSection as lr,MenuItem as Se}from"@blockcode/core";import{useCallback as ai}from"preact/hooks";import{useComputed as aa}from"@preact/signals";import{keyMirror as ta,classNames as ti}from"@blockcode/utils";import{useAppContext as oa,Box as na,Button as oi,Text as ni}from"@blockcode/core";import{useComputed as G1}from"@preact/signals";import{logger as V1,themeColors as ji}from"@blockcode/core";import{Terminal as J1}from"@blockcode/code";import{jsx as Y1}from"preact/jsx-runtime";function er(){let e=G1(()=>V1.logs.join(`\r
`));return Y1(J1,{textValue:e.value,options:{theme:{cursor:"#fff",foreground:ji.ui.text.primary,background:"#fff",selection:ji.ui.text.primary}}})}import{Terminal as K1}from"@blockcode/code";import{jsx as j1}from"preact/jsx-runtime";function ir(){return j1(K1,{compactMode:!0})}C(".hPjAUa_button{--button-height:calc(var(--standard-font-size)*2.4);padding:0 calc(var(--space)*1.5);height:var(--button-height);border-radius:calc(var(--button-height)/2);margin-left:var(--space);border-color:var(--blocks-tertiary);background:var(--blocks-secondary);color:var(--ui-white)}.hPjAUa_button .hPjAUa_icon{filter:brightness(100);width:16px;margin-right:4px}.hPjAUa_button:hover:not(:disabled):not(.hPjAUa_button-actived){background:var(--blocks-tertiary)}.hPjAUa_button-actived{background:var(--ui-white);color:var(--text-primary)}.hPjAUa_button-actived .hPjAUa_icon{filter:unset}");var j={buttonActived:"hPjAUa_button-actived",button:"hPjAUa_button",icon:"hPjAUa_icon"};var rr="./assets/icon-logs-xymnjv7g.svg";var ar="./assets/icon-serial-xw0zbnx8.svg";var tr="./assets/icon-files-c1wm773z.svg";import{jsx as ae,jsxs as ye,Fragment as la}from"preact/jsx-runtime";var W=ta({Logs:null,Serial:null,Files:null});function or({panelId:e,onPanelChange:r,onClose:i}){let{menuItems:t}=oa(),o=aa(()=>t.value?.find((a)=>a.id==="view"));return ye(na,{header:ye(la,{children:[ye(oi,{className:ti(j.button,{[j.buttonActived]:e===W.Logs}),onClick:ai(()=>r(W.Logs),[]),children:[ae("img",{className:j.icon,src:rr}),ae(ni,{id:"gui.panelBox.logs",defaultMessage:"Logs"})]}),ye(oi,{className:ti(j.button,{[j.buttonActived]:e===W.Serial}),onClick:ai(()=>r(W.Serial),[]),children:[ae("img",{className:j.icon,src:ar}),ae(ni,{id:"gui.panelBox.serial",defaultMessage:"Serial"})]}),o.value?.options?.disabledFiles!==!0&&ye(oi,{disabled:!0,className:ti(j.button,{[j.buttonActived]:e===W.Files}),onClick:ai(()=>r(W.Files),[]),children:[ae("img",{className:j.icon,src:tr}),ae(ni,{id:"gui.panelBox.files",defaultMessage:"Files"})]})]}),onClose:i,children:[e===W.Logs&&ae(er,{}),e===W.Serial&&ae(ir,{})]})}var pe="./assets/icon-check-f984n1c2.svg";import{jsx as O,jsxs as Me,Fragment as fa}from"preact/jsx-runtime";function cr({enableFiles:e,ExtendedMenu:r}){let{appState:i}=da(),{meta:t}=sa(),o=ma(ga(t.value.editor)),a=ua(()=>i.value?.panelBoxId),n=nr((g)=>()=>{if(g===a.value)g=null;ha("panelBoxId",g)},[]),u=nr(()=>{o.value=!o.value,pa(t.value.editor,o.value)},[]);return Me(fa,{children:[Me(lr,{children:[Me(Se,{className:l.menuItem,hotkey:[de.CONTROL,de.D1],onClick:n(W.Logs),children:[O("img",{className:Re(l.checkIcon,{[l.checked]:a.value===W.Logs}),src:pe}),O(Be,{id:"gui.menubar.view.log",defaultMessage:"Log Panel"})]}),Me(Se,{className:l.menuItem,hotkey:[de.CONTROL,de.D2],onClick:n(W.Serial),children:[O("img",{className:Re(l.checkIcon,{[l.checked]:a.value===W.Serial}),src:pe}),O(Be,{id:"gui.menubar.view.serial",defaultMessage:"Serial Panel"})]}),e&&Me(Se,{disabled:!0,className:l.menuItem,hotkey:[de.CONTROL,de.D3],onClick:n(W.Files),children:[O("img",{className:Re(l.checkIcon,{[l.checked]:a.value===W.Files}),src:pe}),O(Be,{id:"gui.menubar.view.files",defaultMessage:"Files Panel"})]})]}),r&&O(r,{className:l.menu,itemClassName:l.menuItem}),O(lr,{children:O(Se,{className:Re(l.menuItem,l.blankCheckItem),label:o.value?O(Be,{id:"gui.menubar.view.closeAutoDisplayPanel",defaultMessage:"Turn off auto display panel"}):O(Be,{id:"gui.menubar.view.openAutoDisplayPanel",defaultMessage:"Turn on auto display panel"}),onClick:u})})]})}var ur="./assets/icon-file-egaz1kfx.svg";var mr="./assets/icon-edit-jejnm7yb.svg";var gr="./assets/icon-view-c3skbdpn.svg";import{jsx as se}from"preact/jsx-runtime";function pr(e,r,i){let t=(c)=>i(c,r.editor),o=e.menuItems?.find((c)=>c.id==="file"),a=e.menuItems?.find((c)=>c.id==="edit"),n=e.menuItems?.find((c)=>c.id==="view"),u=wa(r.editor)??n?.autoDisplayPanel===!0;_a(r.editor,u);let g=async()=>{let c=JSON.parse(JSON.stringify(await e.onNew()));if(!c.meta)c.meta=r;if(!c.meta.editor)c.meta.editor=r.editor,c.meta.version=r.version;t(c,r.editor)};return[{id:"file",icon:ur,label:se(li,{id:"gui.menubar.file",defaultMessage:"File"}),Menu:()=>se(zi,{ExtendedMenu:o?.Menu,onNew:g,onOpen:t,onSave:e.onSave,onThumb:e.onThumb}),options:o},{id:"edit",icon:mr,label:se(li,{id:"gui.menubar.edit",defaultMessage:"Edit"}),Menu:()=>se(Ki,{enableCoding:a?.disabledCoding!==!0,enableCompactBlock:a?.disabledCompactBlock!==!0,ExtendedMenu:a?.Menu,onUndo:e.onUndo,onRedo:e.onRedo,onEnableUndo:e.onEnableUndo,onEnableRedo:e.onEnableRedo}),options:a},n?.disabled!==!0&&{id:"view",icon:gr,label:se(li,{id:"gui.menubar.view",defaultMessage:"View"}),Menu:()=>se(cr,{enableFiles:n?.disabledFiles!==!0,ExtendedMenu:n?.Menu}),options:n}].concat(e.menuItems?.filter((c)=>!["file","edit","view"].includes(c.id))??[]).filter(Boolean)}import{Text as we}from"@blockcode/core";import{classNames as ya}from"@blockcode/utils";import{maybeTranslate as Ba,Button as sr}from"@blockcode/core";C(".lkaaPa_alerts-wrapper{width:100%;z-index:var(--z-index-alerts);top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute}.lkaaPa_alert-wrapper{pointer-events:all;background:var(--ui-light);border:1px solid var(--blocks-tertiary);min-width:200px;max-width:548px;min-height:1.5rem;box-shadow:0px 0px 0px 2px var(--ui-light);border-radius:.5rem;flex-direction:row;justify-content:flex-start;align-items:center;margin-bottom:7px;padding:.875rem 1rem;display:flex;overflow:hidden}.lkaaPa_warn{border:1px solid var(--error-primary)}.lkaaPa_icon{min-width:1.25rem;min-height:1.25rem;padding-right:1rem;display:flex}.lkaaPa_message{justify-content:flex-end;align-items:center;padding-right:.5rem;font-size:.8125rem;font-weight:700;line-height:.875rem;display:flex}.lkaaPa_warn .lkaaPa_message{color:var(--error-secondary)}.lkaaPa_success .lkaaPa_message{color:#555}.lkaaPa_buttons-group{align-items:center;display:flex}.lkaaPa_button{color:var(--ui-white);margin-left:var(--space);padding:var(--space)calc(var(--space)*2.5);background:#ff8c1a;border:#ff8c1a}.lkaaPa_close-button{width:1.75rem;height:1.75rem;margin-left:calc(var(--space)*2);background:#ff861433;border:0;border-radius:50%;padding:0;transition:all .15s ease-out;box-shadow:0 0 0 2px #ff861433}.lkaaPa_close-button:hover{transform:scale(1.1);box-shadow:0 0 0 4px #ff861433}.lkaaPa_close-button img{margin:0 auto}");var G={alertWrapper:"lkaaPa_alert-wrapper",buttonsGroup:"lkaaPa_buttons-group",alertsWrapper:"lkaaPa_alerts-wrapper",warn:"lkaaPa_warn",icon:"lkaaPa_icon",message:"lkaaPa_message",success:"lkaaPa_success",button:"lkaaPa_button",closeButton:"lkaaPa_close-button"};var dr="./assets/icon-close-bazpdng8.svg";import{jsx as he,jsxs as hr}from"preact/jsx-runtime";function fr({mode:e,icon:r,message:i,options:t,button:o,onClose:a}){return hr("div",{className:ya(G.alertWrapper,{[G.success]:e==="success",[G.warn]:e==="warn"}),children:[he("div",{className:G.icon,children:typeof r==="string"?he("img",{src:r}):r}),he("div",{className:G.message,children:Ba(i,t)}),hr("div",{className:G.buttonsGroup,children:[o&&he(sr,{className:G.button,onClick:o.onClick,children:o.label}),a&&he(sr,{className:G.closeButton,onClick:a,children:he("img",{src:dr})})]})]})}import{jsx as br}from"preact/jsx-runtime";function vr({items:e}){return br("div",{className:G.alertsWrapper,children:e.map(({id:r,mode:i,icon:t,message:o,button:a,onClose:n,...u})=>br(fr,{mode:i??"success",icon:t,message:o,options:u,button:a,onClose:n},r))})}import{useCallback as qa}from"preact/hooks";import{useSignal as Ea}from"@preact/signals";import{classNames as Ue}from"@blockcode/utils";import{Text as qe,Button as wr,Modal as Za}from"@blockcode/core";C(".Zq10BW_prompt-modal{width:480px}.Zq10BW_prompt-header{background:var(--blocks-primary)}.Zq10BW_prompt-content{background:var(--ui-white)}.Zq10BW_device-list{background:var(--theme-light-transparent);width:100%;height:170px;padding:.5rem;overflow-y:auto}.Zq10BW_device-search{justify-content:center;align-items:center;width:100%;height:100%;display:flex}.Zq10BW_device-search-icon{width:120px;height:120px}@keyframes Zq10BW_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.Zq10BW_device-searching-icon{animation:1.5s linear infinite Zq10BW_spin}.Zq10BW_device-item{background:var(--ui-white);border-radius:calc(var(--space)/2);border:2px solid var(--ui-white);flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:50px;margin-bottom:.5rem;padding:10px;display:flex}.Zq10BW_device-item.Zq10BW_selected{border:2px solid var(--theme-primary)}.Zq10BW_device-name-bar{align-items:center;display:flex}.Zq10BW_device-image{width:40px;margin-right:.5rem}.Zq10BW_device-name-wrapper{flex-direction:column;justify-content:center;align-items:flex-start;display:flex}.Zq10BW_device-name-label{font-size:.625rem;font-weight:700}.Zq10BW_device-name-text{font-size:.875rem}.Zq10BW_button-row{text-align:right;text-align:center;padding:1.5rem 2.25rem;font-weight:bolder}.Zq10BW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.Zq10BW_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var Q={promptHeader:"Zq10BW_prompt-header",deviceSearchingIcon:"Zq10BW_device-searching-icon",deviceNameBar:"Zq10BW_device-name-bar",deviceNameText:"Zq10BW_device-name-text",button:"Zq10BW_button",buttonRow:"Zq10BW_button-row",okButton:"Zq10BW_ok-button",deviceSearchIcon:"Zq10BW_device-search-icon",deviceNameLabel:"Zq10BW_device-name-label",deviceItem:"Zq10BW_device-item",deviceList:"Zq10BW_device-list",promptModal:"Zq10BW_prompt-modal",spin:"Zq10BW_spin",promptContent:"Zq10BW_prompt-content",selected:"Zq10BW_selected",deviceImage:"Zq10BW_device-image",deviceSearch:"Zq10BW_device-search",deviceNameWrapper:"Zq10BW_device-name-wrapper"};var kr="./assets/searching-tt57cegv.png";import{jsx as A,jsxs as Xe}from"preact/jsx-runtime";function _r({title:e,icon:r,devices:i,onClose:t,onSearch:o,onConnect:a}){let n=Ea(""),u=qa(()=>{if(!n.value)return;a(n.value),n.value=""},[a]);return A(Za,{title:e??A(qe,{id:"gui.connection.device",defaultMessage:"Device"}),className:Q.promptModal,headerClassName:Q.header,onClose:t,children:Xe("div",{className:Q.promptContent,children:[A("div",{className:Q.deviceList,children:Array.isArray(i)&&i.length>0?i.map((g)=>Xe("div",{className:Ue(Q.deviceItem,{[Q.selected]:g.id===n.value}),onClick:()=>n.value=g.id,children:[Xe("div",{className:Q.deviceNameBar,children:[r&&A("img",{}),Xe("div",{className:Q.deviceNameWrapper,children:[A("div",{className:Q.deviceNameLabel,children:A(qe,{id:"gui.connection.deviceName",defaultMessage:"Device name"})}),A("div",{className:Q.deviceNameText,children:g.name})]})]}),g.rssi&&A("div",{className:Q.deviceSignalBar})]})):A("div",{className:Q.deviceSearch,children:A("img",{className:Ue(Q.deviceSearchIcon,{[Q.deviceSearchingIcon]:Array.isArray(i)}),src:kr})})}),A("div",{className:Q.buttonRow,children:i===!0?A(wr,{className:Ue(Q.button,Q.okButton),onClick:()=>o(),children:A(qe,{id:"gui.connection.search",defaultMessage:"Start Searching"})}):A(wr,{disabled:!n.value,className:Ue(Q.button,Q.okButton),onClick:u,children:!n.value?A(qe,{id:"gui.connection.searching",defaultMessage:"Searching"}):A(qe,{id:"gui.connection.connect",defaultMessage:"Start Connecting"})})})]})})}import{useEffect as Ga,useCallback as Qe}from"preact/hooks";import{batch as Va,useSignal as Ne,useSignalEffect as Ja}from"@preact/signals";import{classNames as Le,getProjectsThumbs as Ya,getProject as Ka,cloneProject as ja,renameProject as et,delProject as it,openProjectFromURL as rt}from"@blockcode/utils";import{maybeTranslate as di,setAlert as at,delAlert as tt,openPromptModal as si,openUserStorage as ot}from"@blockcode/core";var ci="1.3.1";import{Text as $,ContextMenu as nt,LibraryItem as hi}from"@blockcode/core";import{useEffect as La}from"preact/hooks";import{useSignal as Fa}from"@preact/signals";import{classNames as Cr}from"@blockcode/utils";import{Button as $a}from"@blockcode/core";C(".tyiNqW_cover-wrapper{width:100%;position:relative}.tyiNqW_cover{opacity:1;background-position:50%;background-repeat:no-repeat;background-size:cover;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 2rem;transition:opacity 1s;display:flex;position:absolute;top:0;left:0}.tyiNqW_cover.tyiNqW_hidden{opacity:0;pointer-events:none}.tyiNqW_title{color:#000;padding-right:1.5rem;font-size:2rem;font-weight:600}.tyiNqW_button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-top:calc(2*var(--space));padding:.75rem 1rem;font-size:.85rem;font-weight:600}.tyiNqW_feature{max-height:90%;margin-right:5%}");var ce={button:"tyiNqW_button",cover:"tyiNqW_cover",title:"tyiNqW_title",feature:"tyiNqW_feature",coverWrapper:"tyiNqW_cover-wrapper",hidden:"tyiNqW_hidden"};import{jsx as Te,jsxs as yr}from"preact/jsx-runtime";function Br({pages:e,className:r}){let i=Fa(0);return La(()=>{setInterval(()=>i.value=(i.value+1)%e.length,7000)},[]),Te("div",{className:Cr(ce.coverWrapper,r),children:e.map((t,o)=>yr("div",{className:Cr(ce.cover,{[ce.hidden]:o!==i.value}),style:{backgroundImage:`url(${t.backgroundImage})`},children:[yr("div",{children:[Te("div",{className:ce.title,children:t.title}),Te($a,{className:ce.button,onClick:t.onClick,children:t.buttonText})]}),Te("img",{className:ce.feature,src:t.featureImage})]},o))})}C("._9IQa7q_home-wrapper{background:var(--ui-secondary);top:var(--menu-bar-height);width:100%;height:calc(100% - var(--menu-bar-height));z-index:calc(var(--z-index-alerts) - 10);user-select:none;position:absolute;overflow:hidden auto}._9IQa7q_getting-started{height:240px;margin-bottom:1.5rem}._9IQa7q_link{cursor:pointer;color:var(--theme-primary)}._9IQa7q_view-all{font-weight:400;font-size:var(--standard-font-size);margin-left:1.5rem}._9IQa7q_delete-menu-item:hover{background:var(--error-primary)}._9IQa7q_footer{color:var(--text-primary);font-size:var(--small-font-size);padding:3.5rem 0 var(--space);text-align:center}._9IQa7q_footer-item{padding:0 var(--space)}._9IQa7q_footer-item:not(:first-child){border-left:1px solid var(--ui-black-transparent)}._9IQa7q_library-grid{background:var(--ui-secondary);flex-wrap:wrap;flex-grow:1;place-content:flex-start;align-items:flex-start;height:auto;padding:.5rem;display:flex;overflow-y:auto}._9IQa7q_library-label{color:var(--text-primary);padding:1.5rem calc(.5rem + var(--space)).5rem;font-weight:800}._9IQa7q_about-version-content{width:300px}._9IQa7q_about-version-row{margin:var(--space)0;justify-content:space-between;display:flex}");var B={deleteMenuItem:"_9IQa7q_delete-menu-item",aboutVersionRow:"_9IQa7q_about-version-row",libraryLabel:"_9IQa7q_library-label",homeWrapper:"_9IQa7q_home-wrapper",gettingStarted:"_9IQa7q_getting-started",libraryGrid:"_9IQa7q_library-grid",aboutVersionContent:"_9IQa7q_about-version-content",viewAll:"_9IQa7q_view-all",footerItem:"_9IQa7q_footer-item",footer:"_9IQa7q_footer",link:"_9IQa7q_link"};import{Text as Er}from"@blockcode/core";var Mr="./assets/arcade-rd4cktbf.png";var qr="./assets/arcade-bg-fajmd34e.jpg";import{jsx as Zr}from"preact/jsx-runtime";function ui(e){return{title:Zr(Er,{id:"gui.home.slideshow.arcade.title",defaultMessage:"The Tank War is coming! Join us! NOW!"}),backgroundImage:qr,featureImage:Mr,buttonText:Zr(Er,{id:"gui.home.slideshow.arcade.button",defaultMessage:"Play now"}),onClick:()=>e("@blockcode/gui-arcade")}}import{Text as Fr}from"@blockcode/core";var Qr="./assets/desktop-s3hfwbpz.png";var Lr="./assets/desktop-bg-pqrd17t9.jpg";import{jsx as $r}from"preact/jsx-runtime";var Ar={title:$r(Fr,{id:"gui.home.slideshow.desktop.title",defaultMessage:"The desktop application is here!"}),backgroundImage:Lr,featureImage:Qr,buttonText:$r(Fr,{id:"gui.home.slideshow.desktop.button",defaultMessage:"Download"}),onClick:()=>window.open("//app.blockcode.fun/#/?id=download")};function mi(e,r){return[Ar,ui(e)]}async function gi(e){let r=await fetch("https://hub.blockcode.fun/home.json").then((i)=>i.json());return Promise.all(r.filter((i)=>i.editor?e.find((t)=>t.id===i.editor):!0).map(async(i)=>{let t=e.find((a)=>a.id===i.editor),o=await fetch(`https://hub.blockcode.fun/${i.import}`).then((a)=>a.json());return{name:t?.name,examples:o.filter((a)=>e.find((n)=>n.id===a.editor)).map((a)=>({...a,file:`https://hub.blockcode.fun/${a.file}`,thumb:`https://hub.blockcode.fun/${a.thumb}`}))}}))}function ee(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Wr(e,r){var i="",t=0,o=-1,a=0,n;for(var u=0;u<=e.length;++u){if(u<e.length)n=e.charCodeAt(u);else if(n===47)break;else n=47;if(n===47){if(o===u-1||a===1);else if(o!==u-1&&a===2){if(i.length<2||t!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var g=i.lastIndexOf("/");if(g!==i.length-1){if(g===-1)i="",t=0;else i=i.slice(0,g),t=i.length-1-i.lastIndexOf("/");o=u,a=0;continue}}else if(i.length===2||i.length===1){i="",t=0,o=u,a=0;continue}}if(r){if(i.length>0)i+="/..";else i="..";t=2}}else{if(i.length>0)i+="/"+e.slice(o+1,u);else i=e.slice(o+1,u);t=u-o-1}o=u,a=0}else if(n===46&&a!==-1)++a;else a=-1}return i}function xa(e,r){var i=r.dir||r.root,t=r.base||(r.name||"")+(r.ext||"");if(!i)return t;if(i===r.root)return i+t;return i+e+t}function Ee(){var e="",r=!1,i;for(var t=arguments.length-1;t>=-1&&!r;t--){var o;if(t>=0)o=arguments[t];else{if(i===void 0)i=process.cwd();o=i}if(ee(o),o.length===0)continue;e=o+"/"+e,r=o.charCodeAt(0)===47}if(e=Wr(e,!r),r)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function Ir(e){if(ee(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;if(e=Wr(e,!r),e.length===0&&!r)e=".";if(e.length>0&&i)e+="/";if(r)return"/"+e;return e}function Pa(e){return ee(e),e.length>0&&e.charCodeAt(0)===47}function Ra(){if(arguments.length===0)return".";var e;for(var r=0;r<arguments.length;++r){var i=arguments[r];if(ee(i),i.length>0)if(e===void 0)e=i;else e+="/"+i}if(e===void 0)return".";return Ir(e)}function Sa(e,r){if(ee(e),ee(r),e===r)return"";if(e=Ee(e),r=Ee(r),e===r)return"";var i=1;for(;i<e.length;++i)if(e.charCodeAt(i)!==47)break;var t=e.length,o=t-i,a=1;for(;a<r.length;++a)if(r.charCodeAt(a)!==47)break;var n=r.length,u=n-a,g=o<u?o:u,c=-1,p=0;for(;p<=g;++p){if(p===g){if(u>g){if(r.charCodeAt(a+p)===47)return r.slice(a+p+1);else if(p===0)return r.slice(a+p)}else if(o>g){if(e.charCodeAt(i+p)===47)c=p;else if(p===0)c=0}break}var q=e.charCodeAt(i+p),d=r.charCodeAt(a+p);if(q!==d)break;else if(q===47)c=p}var h="";for(p=i+c+1;p<=t;++p)if(p===t||e.charCodeAt(p)===47)if(h.length===0)h+="..";else h+="/..";if(h.length>0)return h+r.slice(a+c);else{if(a+=c,r.charCodeAt(a)===47)++a;return r.slice(a)}}function Ua(e){return e}function pi(e){if(ee(e),e.length===0)return".";var r=e.charCodeAt(0),i=r===47,t=-1,o=!0;for(var a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!o){t=a;break}}else o=!1;if(t===-1)return i?"/":".";if(i&&t===1)return"//";return e.slice(0,t)}function Xa(e,r){if(r!==void 0&&typeof r!=="string")throw TypeError('"ext" argument must be a string');ee(e);var i=0,t=-1,o=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var n=r.length-1,u=-1;for(a=e.length-1;a>=0;--a){var g=e.charCodeAt(a);if(g===47){if(!o){i=a+1;break}}else{if(u===-1)o=!1,u=a+1;if(n>=0)if(g===r.charCodeAt(n)){if(--n===-1)t=a}else n=-1,t=u}}if(i===t)t=u;else if(t===-1)t=e.length;return e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){i=a+1;break}}else if(t===-1)o=!1,t=a+1;if(t===-1)return"";return e.slice(i,t)}}function Ta(e){ee(e);var r=-1,i=0,t=-1,o=!0,a=0;for(var n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(u===47){if(!o){i=n+1;break}continue}if(t===-1)o=!1,t=n+1;if(u===46){if(r===-1)r=n;else if(a!==1)a=1}else if(r!==-1)a=-1}if(r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1)return"";return e.slice(r,t)}function Na(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return xa("/",e)}function Ha(e){ee(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,o;if(t)r.root="/",o=1;else o=0;var a=-1,n=0,u=-1,g=!0,c=e.length-1,p=0;for(;c>=o;--c){if(i=e.charCodeAt(c),i===47){if(!g){n=c+1;break}continue}if(u===-1)g=!1,u=c+1;if(i===46){if(a===-1)a=c;else if(p!==1)p=1}else if(a!==-1)p=-1}if(a===-1||u===-1||p===0||p===1&&a===u-1&&a===n+1){if(u!==-1)if(n===0&&t)r.base=r.name=e.slice(1,u);else r.base=r.name=e.slice(n,u)}else{if(n===0&&t)r.name=e.slice(1,a),r.base=e.slice(1,u);else r.name=e.slice(n,a),r.base=e.slice(n,u);r.ext=e.slice(a,u)}if(n>0)r.dir=e.slice(0,n-1);else if(t)r.dir="/";return r}var za="/",Oa=":",Ec=((e)=>(e.posix=e,e))({resolve:Ee,normalize:Ir,isAbsolute:Pa,join:Ra,relative:Sa,_makeLong:Ua,dirname:pi,basename:Xa,extname:Ta,format:Na,parse:Ha,sep:za,delimiter:Oa,win32:null,posix:null});function Ze(){let e=window.electron?.getLocalEditors()??[];return Promise.all([].concat(Object.values(e).map(async(r)=>{let{default:i}=await import(r.info);return i.id=r.id,i.image=Ee(pi(r.info),i.image),i}),["@yeqin/gui-tankwar","@blockcode/gui-arcade2","@blockcode/gui-arcade","@blockcode/gui-microbit","@blockcode/gui-esp32","@blockcode/gui-arduino","@blockcode/gui-writer","@blockcode/gui-iotbit","@blockcode/gui-matrix"].map(async(r)=>{let{default:i}=await import(`${r}/info`);return i.id=r,i})))}import{jsx as b,jsxs as S,Fragment as fi}from"preact/jsx-runtime";function Dr({onOpenEditor:e,onOpenProject:r}){let i=Math.floor((document.body.clientWidth-20)/176),t=Math.floor((document.body.clientWidth-20)/236)*2,o=Ne(null),a=Ne(0),n=Ne(null),u=Ne(null),g=Qe(async()=>{let m=await Ya();Va(()=>{a.value=m.length,o.value=m.filter((f,v)=>v<i)})},[]);Ga(g,[]);let c=Qe((m,f)=>{si({title:b($,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:b($,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:di(f??b($,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(v)=>{if(v?.name)await et(m,v.name),g()}})},[]),p=Qe(async(m)=>{await ja(m),g()},[]),q=Qe((m,f)=>{si({title:b($,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:b($,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:di(f||b($,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await it(m),g()}})},[]),d=Qe((m)=>async()=>{let f=await Ka(m);r(f)},[r]),h=()=>{return o.value?.map((m)=>b(nt,{menuItems:[[{label:b($,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>c(m.key,m.name)},{label:b($,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>p(m.key)}],[{label:b($,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:B.deleteMenuItem,onClick:()=>q(m.key,m.name)}]],children:b(hi,{id:m.key,name:m.name||b($,{id:"gui.project.shortname",defaultMessage:"Untitled"}),image:m.thumb,onSelect:d(m.key)})},m.key))};return Ja(async()=>{let m=await Ze();m=m.map((f)=>Object.assign(f,{beta:f.beta||!1,disabled:f.disabled||!1,onSelect:()=>e(f.id)})),m=m.filter((f)=>{if(f.hidden)return!1;return!0}),n.value=m.sort((f,v)=>f.sortIndex-v.sortIndex),u.value=await gi(m)}),S("div",{className:B.homeWrapper,children:[b(Br,{className:B.gettingStarted,pages:mi(e,r)}),o.value?.length>0&&S(fi,{children:[S("div",{className:B.libraryLabel,children:[b("span",{children:b($,{id:"gui.home.my",defaultMessage:"My projects"})}),a.value>i&&b("span",{className:Le(B.viewAll,B.link),onClick:ot,children:b($,{id:"gui.home.allCounts",defaultMessage:"View all ({counts})",counts:a.value})})]}),b("div",{className:B.libraryGrid,children:b(h,{})})]}),n.value?.length>0&&S(fi,{children:[b("div",{className:B.libraryLabel,children:b($,{id:"gui.home.new",defaultMessage:"Create new project"})}),b("div",{className:B.libraryGrid,children:n.value.map((m,f)=>b(hi,{featured:!0,id:f,disabled:m.disabled,beta:m.beta||m.preview,image:m.image,name:m.name,description:m.description,collaborator:m.collaborator,blocksRequired:m.blocksRequired,micropythonRequired:m.micropythonRequired,clangRequired:m.clangRequired,onSelect:m.onSelect},f))})]}),u.value?.map((m)=>m.examples.length>0&&S(fi,{children:[S("div",{className:B.libraryLabel,children:[b("span",{children:b($,{id:"gui.home.examples",defaultMessage:"Wonderful {label} examples",label:di(m.name)})}),m.examples.length>t&&b("span",{className:Le(B.viewAll,B.link),children:b($,{id:"gui.home.all",defaultMessage:"View all"})})]}),b("div",{className:B.libraryGrid,children:m.examples.map((f,v)=>b(hi,{large:!0,id:v,name:f.name,author:f.author,copyright:f.copyright,image:f.thumb,onSelect:async()=>{at("importing",{id:f.name});let L=await rt(f.file);tt(f.name),r(L)}}))})]})),S("div",{className:B.footer,children:[b("span",{className:Le(B.footerItem,B.link),onClick:()=>window.open("https://lab.blockcode.fun/","_blank"),children:"BlockCode Lab"}),b("span",{className:Le(B.footerItem,B.link),onClick:()=>window.open("https://github.com/BlockCodeLab/playgrounds-app","_blank"),children:"GitHub"}),S("span",{className:Le(B.footerItem,B.link),onClick:()=>{si({title:b($,{id:"gui.about.title",defaultMessage:"About..."}),body:S("div",{className:B.aboutVersionContent,children:[S("div",{className:B.aboutVersionRow,children:[b("div",{children:b("b",{children:b($,{id:"gui.about.main",defaultMessage:"Main program"})})}),S("div",{children:["v",ci]})]}),b("div",{className:B.aboutVersionRow}),n.value.filter((m)=>!m.disabled).map((m)=>S("div",{className:B.aboutVersionRow,children:[b("div",{children:b("b",{children:m.name})}),S("div",{children:["v",m.version]})]}))]})})},children:["v",ci]})]})]})}import{useComputed as Or}from"@preact/signals";import{useEffect as Lt}from"preact/hooks";import{classNames as U,isMac as Ft}from"@blockcode/utils";import{useLocalesContext as $t,useAppContext as At,setLanguage as Wt,translate as Gr,setMacosMenuBarStyled as It}from"@blockcode/core";import{Menu as Vr,MenuItem as Dt,Tooltip as Jr}from"@blockcode/core";import{cloneElement as pt}from"preact";import{useMemo as dt}from"preact/hooks";import{flatChildren as st}from"@blockcode/utils";var xr=Object.create(null),bi=document.createElement("div"),Pr=document.createElement("style");document.body.insertBefore(Pr,document.body.firstChild);var lt=(e)=>{return bi.style="",Object.entries(e).forEach(([r,i])=>bi.style[r]=i),bi.style.cssText},ct=()=>{Pr.textContent=Object.entries(xr).map(([e,r])=>`${e}{${lt(r)}}`).join(`
`)};function te(e){Object.assign(xr,e),ct()}import{Menu as ht}from"@blockcode/core";import{useCallback as vi}from"preact/hooks";import{classNames as ut}from"@blockcode/utils";import{jsx as Rr,jsxs as gt,Fragment as mt}from"preact/jsx-runtime";function Fe({id:e,className:r,checked:i,children:t,name:o}){let a=vi((g)=>{let c=()=>{g.target.checked=!1,document.removeEventListener("click",c)};document.addEventListener("click",c)},[]),n=vi((g)=>{let c=g.getBoundingClientRect().left;te({[`#${e}-menu-${o}`]:{left:`${c}px`}})},[e,o]),u=vi((g)=>{if(g.target.classList.contains(l.menuLabel))n(g.target);else n(g.target.parentElement)},[]);return gt(mt,{children:[Rr("input",{checked:i,className:l.menuLabel,id:`${e}-label-${o}`,name:`${e}-menu`,type:"radio",value:o,onChange:a}),Rr("label",{className:ut(l.menuLabel,r),for:`${e}-label-${o}`,onClick:u,children:t})]})}import{jsxs as bt,Fragment as ft}from"preact/jsx-runtime";function Sr({id:e,children:r}){let i=dt(()=>st(r).map((t)=>t&&pt(t,{id:e})),[e,r]);return bt(ft,{children:[i.filter((t)=>t.type===Fe),i.filter((t)=>t.type===ht).map((t)=>{let o=`${e}-label-${t.props.name}`,a=`${e}-menu-${t.props.name}`;return te({[`#${o}:checked~#${a}`]:{display:"block"}}),t})]})}import{classNames as kt}from"@blockcode/utils";import{Text as wt}from"@blockcode/core";var He="./assets/icon-tutorials-bh6n0ck2.svg";import{jsx as ki,jsxs as Ur,Fragment as _t}from"preact/jsx-runtime";function Xr({onClick:e}){return Ur(_t,{children:[ki("div",{className:l.divider}),Ur("div",{className:kt(l.menuBarItem,l.menuLabel,l.hoverable),onClick:e,children:[ki("img",{className:l.tutorialsIcon,src:He}),ki(wt,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]})]})}import{useProjectContext as Ct,BufferedInput as yt,renameProject as Bt}from"@blockcode/core";import{jsx as wi,jsxs as qt,Fragment as Mt}from"preact/jsx-runtime";function Tr({placeholder:e,defaultValue:r}){let{name:i}=Ct();return qt(Mt,{children:[wi("div",{className:l.divider}),wi("div",{className:l.menuBarItem,children:wi(yt,{className:l.titleField,placeholder:e,value:i.value||r,onSubmit:Bt})})]})}var Nr="./assets/icon-language-3wan1389.svg";var Hr="./assets/icon-dropdown-caret-y4j91xc6.svg";var zr="./assets/icon-home-jt8mdkv3.svg";import{jsx as Z,jsxs as oe,Fragment as xt}from"preact/jsx-runtime";function Yr({className:e,showHomeButton:r,onRequestHome:i,onOpenTutorialLibrary:t}){let{language:o,languageNames:a}=$t(),{barItems:n,menuItems:u,tutorials:g,macosMenuBarStyled:c}=At(),p=Or(()=>n.value?.filter((d)=>d.align!=="right")),q=Or(()=>n.value?.filter((d)=>d.align==="right"));return Lt(()=>{window.electron?.onChangeFullscreen((d)=>It(Ft&&!d))},[]),oe("div",{className:U(l.menuBar,e),children:[oe("div",{className:U(l.mainMenu,{[l.electron]:c.value}),children:[oe(Sr,{id:l.mainMenu,children:[oe(Fe,{className:U(l.menuBarItem,l.languageLabel),name:"language-selector",children:[Z("img",{className:l.languageIcon,src:Nr}),Z("img",{src:Hr})]}),Z(Vr,{className:l.menu,name:"language-selector",children:Array.from(a.entries()).map(([d,h])=>oe(Dt,{className:l.menuItem,onClick:()=>Wt(d),children:[Z("img",{className:U(l.checkIcon,{[l.checked]:o.value===d}),src:pe}),h.languageName]},d))}),u.value&&u.value.map(({icon:d,label:h,Menu:m},f)=>oe(xt,{children:[oe(Fe,{className:l.menuBarItem,name:f,children:[typeof d==="string"?Z("img",{src:d}):d,h]},f),Z(Vr,{className:l.menu,name:f,children:Z(m,{className:l.menu,itemClassName:l.menuItem})},f)]}))]}),g.value&&Z(Xr,{onClick:t}),r&&Z(Tr,{placeholder:Gr("gui.menubar.titlePlaceholder","Project title here"),defaultValue:Gr("gui.project.name","BlockCode Project")}),p.value?.length>0&&p.value.map(({Label:d,...h})=>h.tooltip?Z(Jr,{placement:h.tooltipPlacement??"bottom",content:h.tooltip,children:d?Z(d,{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable)}):Z("div",{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable),children:h.label})}):d?Z(d,{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable)}):Z("div",{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable),onClick:h.onClick,children:h.label}))]}),oe("div",{className:l.rightMenu,children:[q.value?.length>0&&q.value.map(({Label:d,...h})=>h.tooltip?Z(Jr,{placement:h.tooltipPlacement??"bottom",content:h.tooltip,children:d?Z(d,{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable)}):Z("div",{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable),children:h.label})}):d?Z(d,{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable)}):Z("div",{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable),onClick:h.onClick,children:h.label})),r&&Z("div",{className:U(l.menuBarItem,l.menuBarIcon,l.hoverable),onClick:i,children:Z("img",{src:zr})})]})]})}import{classNames as Pt}from"@blockcode/utils";C(".fflkNG_pane-wrapper{flex-direction:column;display:flex;position:relative}.fflkNG_pane{display:none}.fflkNG_pane-header{background:var(--ui-white);padding:calc(var(--space)/2);text-align:center;color:var(--text-primary);cursor:pointer;border:1px solid var(--ui-black-transparent);border-radius:var(--space)var(--space)0 0;flex:1;font-size:.85rem}.fflkNG_pane-left .fflkNG_pane-header{border-top-left-radius:0}.fflkNG_pane-right .fflkNG_pane-header{border-top-right-radius:0}.fflkNG_pane-content{border-left:1px solid var(--ui-black-transparent);border-right:1px solid var(--ui-black-transparent);min-height:5.5rem;display:none;position:relative}.fflkNG_pane-left .fflkNG_pane-content{border-left:0}.fflkNG_pane-right .fflkNG_pane-content{border-right:0}.fflkNG_pane:checked~.fflkNG_pane-content{display:flex}");var ue={paneLeft:"fflkNG_pane-left",pane:"fflkNG_pane",paneWrapper:"fflkNG_pane-wrapper",paneRight:"fflkNG_pane-right",paneHeader:"fflkNG_pane-header",paneContent:"fflkNG_pane-content"};import{jsx as _i,jsxs as Rt}from"preact/jsx-runtime";function Kr({className:e,id:r,title:i,left:t,right:o,children:a}){return Rt("div",{className:Pt(ue.paneWrapper,e,{[ue.paneLeft]:t,[ue.paneRight]:o}),children:[_i("input",{id:`${r}-pane`,type:"checkbox",className:ue.pane}),_i("label",{className:ue.paneHeader,for:`${r}-pane`,children:i}),_i("div",{className:ue.paneContent,children:a})]})}import{classNames as jr}from"@blockcode/utils";import{maybeTranslate as St,Text as Ci,Button as yi,Modal as Ut}from"@blockcode/core";C(".ulcaFG_prompt-modal{width:360px}.ulcaFG_prompt-modal.ulcaFG_wide{width:600px}.ulcaFG_prompt-modal.ulcaFG_auto{width:auto;max-width:60vw}.ulcaFG_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.ulcaFG_label{margin:0 0 1.5rem;font-weight:500}.ulcaFG_label.ulcaFG_input-label{margin-bottom:.75rem}.ulcaFG_content{font-size:var(--standard-font-size);color:var(--text-primary);max-height:400px;margin-bottom:1.5rem;overflow:auto}.ulcaFG_content a{color:var(--theme-primary);border-bottom:1px solid;text-decoration-line:none}.ulcaFG_text-input{border:1px solid var(--ui-black-transparent);width:100%;height:3rem;color:var(--text-primary);border-radius:5px;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.ulcaFG_button-row{text-align:right;font-weight:bolder}.ulcaFG_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.ulcaFG_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var M={textInput:"ulcaFG_text-input",content:"ulcaFG_content",promptContent:"ulcaFG_prompt-content",okButton:"ulcaFG_ok-button",inputLabel:"ulcaFG_input-label",promptModal:"ulcaFG_prompt-modal",wide:"ulcaFG_wide",label:"ulcaFG_label",buttonRow:"ulcaFG_button-row",button:"ulcaFG_button",auto:"ulcaFG_auto"};import{useCallback as Xt}from"preact/hooks";import{jsx as V,jsxs as e1,Fragment as Tt}from"preact/jsx-runtime";function i1({title:e,label:r,content:i,redStyle:t,children:o,onClose:a,onSubmit:n}){let u=Xt(()=>{n(),a()},[a,n]);return V(Ut,{title:e,redStyle:t,className:jr(M.promptModal,{[M.wide]:i,[M.auto]:o}),onClose:a,children:e1("div",{className:M.promptContent,children:[r&&V("div",{className:M.label,children:r}),i?V("div",{className:M.content,dangerouslySetInnerHTML:{__html:St(i)}}):V("div",{className:M.content,children:o}),V("div",{className:M.buttonRow,children:n?e1(Tt,{children:[V(yi,{className:M.button,onClick:a,children:V(Ci,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),V(yi,{className:jr(M.button,M.okButton),onClick:u,children:V(Ci,{id:"gui.prompt.ok",defaultMessage:"OK"})})]}):V(yi,{className:M.button,onClick:a,children:V(Ci,{id:"gui.prompt.close",defaultMessage:"Close"})})})]})})}import{useCallback as Bi,useEffect as Nt}from"preact/hooks";import{useSignal as Ht}from"@preact/signals";import{classNames as r1}from"@blockcode/utils";import{maybeTranslate as a1,Text as t1,BufferedInput as zt,Button as o1,Modal as Ot}from"@blockcode/core";import{jsx as ne,jsxs as Mi,Fragment as Gt}from"preact/jsx-runtime";function n1({title:e,inputItems:r,content:i,onClose:t,onSubmit:o}){let a=Ht(Object.fromEntries(r.map(({name:c,defaultValue:p})=>[c,p]))),n=Bi((c)=>{if(c.stopPropagation(),c.key==="Escape")t()},[t]),u=Bi(()=>{o(a.value),t()},[t,o]),g=Bi((c)=>(p)=>{a.value={...a.value,[c]:p}},[]);return Nt(()=>{return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),ne(Ot,{title:e,className:M.promptModal,onClose:t,children:Mi("div",{className:M.promptContent,children:[r.map(({name:c,label:p,placeholder:q,defaultValue:d},h)=>Mi(Gt,{children:[p&&ne("div",{className:r1(M.label,M.inputLabel),children:p}),ne(zt,{autoFocus:h===0,className:M.textInput,placeholder:a1(q),defaultValue:d,onSubmit:g(c)},h)]})),i&&ne("div",{className:M.content,dangerouslySetInnerHTML:{__html:a1(i)}}),Mi("div",{className:M.buttonRow,children:[ne(o1,{className:M.button,onClick:t,children:ne(t1,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),ne(o1,{className:r1(M.button,M.okButton),onClick:u,children:ne(t1,{id:"gui.prompt.ok",defaultMessage:"OK"})})]})]})})}import{classNames as Vt}from"@blockcode/utils";import{Text as qi,Spinner as Jt}from"@blockcode/core";C(".LkfKFW_splash{background:var(--theme-primary);z-index:var(--z-index-modal);flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute;inset:0}.LkfKFW_spinner{margin-bottom:calc(4*var(--space))}.LkfKFW_error{background:var(--error-primary)}.LkfKFW_title{color:var(--ui-white);margin:var(--space);font-size:2rem}.LkfKFW_label{color:var(--ui-white);margin:var(--space)}");var fe={splash:"LkfKFW_splash",title:"LkfKFW_title",error:"LkfKFW_error",label:"LkfKFW_label",spinner:"LkfKFW_spinner"};import{jsx as be,jsxs as Yt}from"preact/jsx-runtime";function l1({error:e}){return Yt("div",{className:Vt(fe.splash,{[fe.error]:e}),children:[!e&&be(Jt,{large:!0,level:"info",className:fe.spinner}),be("div",{className:fe.title,children:e?be(qi,{id:"gui.splash.errorTitle",defaultMessage:"Error Occurred"}):be(qi,{id:"gui.splash.loading",defaultMessage:"Loading project..."})}),be("div",{className:fe.label,children:e&&be(qi,{id:"gui.splash.errorLabel",defaultMessage:"Please refresh the page and reopen it."})})]})}import{cloneElement as ao}from"preact";import{useMemo as to}from"preact/hooks";import{classNames as oo,flatChildren as no}from"@blockcode/utils";import{classNames as Kt}from"@blockcode/utils";C(".M5TDuW_tabs-wrapper{white-space:nowrap;position:relative}.M5TDuW_tab-label{--line-height:calc(var(--tool-bar-height)*.8 - 2px);--margin-top:calc(var(--tool-bar-height)*.2 + 1px);font-weight:500;font-size:var(--standard-font-size);line-height:var(--line-height);border:1px solid var(--ui-black-transparent);background:var(--ui-tertiary);color:var(--text-transparent);margin-top:var(--margin-top);white-space:nowrap;border-radius:1rem 1rem 0 0;justify-content:center;padding:0 1.25rem;display:inline-flex;position:relative}.M5TDuW_tab-label.M5TDuW_disabled{filter:opacity(.5);cursor:default;pointer-events:none}.M5TDuW_tab-label:nth-of-type(n+2){margin-left:calc(-1*var(--space))}.M5TDuW_tab-label:last-of-type{margin-right:var(--space)}.M5TDuW_tab-label:not(.M5TDuW_disabled):hover{cursor:pointer;background:var(--ui-primary)}.M5TDuW_tab-label img{filter:grayscale();width:1.375rem}.M5TDuW_tab{display:none}.M5TDuW_tab:checked+.M5TDuW_tab-label{--scale:var(--space)/2;line-height:calc(var(--line-height) + var(--scale));margin-top:calc(var(--margin-top) - var(--scale));color:var(--theme-primary);background:var(--ui-white)}.M5TDuW_tab:checked+.M5TDuW_tab-label img{filter:none}.M5TDuW_tab-panel{top:var(--tool-bar-height);width:100%;height:calc(100% - var(--tool-bar-height));border:1px solid var(--ui-black-transparent);border-radius:0 var(--space)var(--space)var(--space);flex-direction:column;display:flex;position:absolute;bottom:0;transform:translateY(200%)}");var J={tabsWrapper:"M5TDuW_tabs-wrapper",tab:"M5TDuW_tab",tabPanel:"M5TDuW_tab-panel",disabled:"M5TDuW_disabled",tabLabel:"M5TDuW_tab-label"};import{jsx as c1,jsxs as eo,Fragment as jt}from"preact/jsx-runtime";function ze({id:e,className:r,disabled:i,checked:t,children:o,name:a,onSelect:n}){return eo(jt,{children:[c1("input",{disabled:i,checked:t,className:J.tab,id:`${e}-tab-${a}`,name:`${e}-tab`,type:"radio",value:a}),c1("label",{className:Kt(J.tabLabel,r,{[J.disabled]:i}),for:`${e}-tab-${a}`,onClick:n,children:o})]})}import{classNames as io}from"@blockcode/utils";import{jsx as ro}from"preact/jsx-runtime";function Oe({id:e,className:r,name:i,children:t}){return ro("div",{className:io(J.tabPanel,r),id:`${e}-panel-${i}`,children:t})}import{jsxs as lo}from"preact/jsx-runtime";function u1({id:e,className:r,children:i}){let t=to(()=>no(i).filter((o)=>o).map((o)=>ao(o,{id:e})),[e,i]);return te({[`.${J.tab}:checked+.${J.tabLabel}`]:{zIndex:`${t.length+1}`}}),lo("div",{className:oo(J.tabsWrapper,r),children:[t.filter((o)=>o.type===ze).map((o,a,n)=>{return te({[`.${J.tabLabel}:nth-of-type(${a+1})`]:{zIndex:`${n.length-a}`}}),o}),t.filter((o)=>o.type===Oe).map((o)=>{let a=`${e}-tab-${o.props.name}`,n=`${e}-panel-${o.props.name}`;return te({[`#${a}:checked~#${n}`]:{transform:"none"}}),o})]})}import{useRef as po,useEffect as d1,useCallback as Zi}from"preact/hooks";import{batch as so,useComputed as ho,useSignal as Qi}from"@preact/signals";import{classNames as fo}from"@blockcode/utils";import{useAppContext as bo,Text as ve,Button as vo}from"@blockcode/core";C("._4EOxpW_tutorial-box-wrapper{pointer-events:auto;z-index:var(--z-index-card);min-width:468px;position:absolute;bottom:10%;left:50%;transform:translate(-50%)}._4EOxpW_tutorial-card{border:1px solid var(--ui-tertiary);border-radius:calc(var(--space)*1.8);cursor:move;box-shadow:0px 5px 25px 5px var(--ui-black-transparent);z-index:20;flex-direction:column;align-items:center;display:flex;overflow:hidden}._4EOxpW_card-header{background:var(--blocks-primary);width:100%;font-size:var(--small-font-size);flex-direction:row;justify-content:space-between;align-items:center;font-weight:700;display:flex}._4EOxpW_header-button-group{flex-direction:row;display:flex}._4EOxpW_header-button{cursor:pointer;color:#fff;flex-direction:column;justify-content:center;align-items:center;padding:.75rem;display:flex}._4EOxpW_header-button:hover{background:var(--ui-black-transparent)}._4EOxpW_button-icon{border:0;height:1.25rem}._4EOxpW_step-list{flex-direction:row;justify-content:center;align-items:center;display:flex}._4EOxpW_step-pip{cursor:pointer;background:var(--ui-white-transparent);border-radius:100%;width:.5rem;height:.5rem;margin:0 .25rem}._4EOxpW_step-pip._4EOxpW_actived{background:var(--ui-white);-webkit-box-shadow:0px 0px 0px 2px var(--ui-black-transparent);box-shadow:0px 0px 0px 2px var(--ui-black-transparent)}._4EOxpW_card-body{background:var(--ui-white);border-top:1px solid var(--blocks-tertiary);text-align:center;width:100%;min-height:256px;color:var(--text-primary);flex-direction:column;justify-content:center;align-items:center;display:flex;position:relative}._4EOxpW_title{text-align:center;margin:.9rem;font-size:.9rem;font-weight:700}._4EOxpW_image{object-fit:contain;background:var(--ui-secondary);border-radius:var(--space);max-width:450px;max-height:200px;margin:0 var(--space)var(--space);overflow:hidden}._4EOxpW_text{max-width:450px;height:200px;margin:0 var(--space)2.7rem var(--space);flex-direction:column;justify-content:center;font-size:1rem;display:flex}._4EOxpW_image+._4EOxpW_text{height:auto}._4EOxpW_more{padding:0 .9rem var(--space);flex-direction:row;justify-content:space-around;display:flex}._4EOxpW_more-item{margin:0 var(--space)var(--space);cursor:pointer;border-radius:var(--space);border:1px solid #00000026;flex-direction:column;display:flex;overflow:hidden}._4EOxpW_more-item-image{object-fit:cover;width:200px;height:100px}._4EOxpW_more-item-name{color:var(--theme-primary);margin:calc(var(--space)*1.2)0px;text-align:center;text-align:center;max-width:200px;font-size:.85rem;font-weight:700}._4EOxpW_see-more-button{background:var(--theme-primary);color:var(--ui-white);border:0;margin-bottom:2.7rem}._4EOxpW_left-page,._4EOxpW_right-page{background:var(--ui-white);border:1px solid var(--ui-black-transparent);height:90%;width:calc(var(--space)*1.8);opacity:.9;z-index:10;position:absolute;top:5%;overflow:hidden}._4EOxpW_left-page:after,._4EOxpW_right-page:after{content:\"\";background:var(--blocks-primary);width:100%;height:2.5rem;position:absolute;top:0;left:0}._4EOxpW_left-button,._4EOxpW_right-button{user-select:none;cursor:pointer;background:var(--blocks-primary);box-shadow:0 0 0 4px var(--blocks-transparent);z-index:30;border-radius:100%;justify-content:center;align-items:center;width:44px;height:44px;margin-top:-15px;transition:all .25s;display:flex;position:absolute;top:50%}._4EOxpW_left-button:hover,._4EOxpW_right-button:hover{box-shadow:0 0 0 6px var(--blocks-transparent);transform:scale(1.125)}._4EOxpW_left-button img,._4EOxpW_right-button img{width:1.75rem}._4EOxpW_left-page{border-top-left-radius:calc(var(--space)*1.8);border-bottom-left-radius:calc(var(--space)*1.8);border-right:0;left:0;transform:translate(-100%)}._4EOxpW_left-button{left:-27px}._4EOxpW_right-page{border-top-right-radius:calc(var(--space)*1.8);border-bottom-right-radius:calc(var(--space)*1.8);border-left:0;right:0;transform:translate(100%)}._4EOxpW_right-button{right:-27px}._4EOxpW_right-button img{transform:rotateY(180deg)}");var w={leftPage:"_4EOxpW_left-page",buttonIcon:"_4EOxpW_button-icon",moreItemName:"_4EOxpW_more-item-name",headerButton:"_4EOxpW_header-button",rightButton:"_4EOxpW_right-button",cardHeader:"_4EOxpW_card-header",stepList:"_4EOxpW_step-list",more:"_4EOxpW_more",title:"_4EOxpW_title",headerButtonGroup:"_4EOxpW_header-button-group",tutorialBoxWrapper:"_4EOxpW_tutorial-box-wrapper",actived:"_4EOxpW_actived",cardBody:"_4EOxpW_card-body",image:"_4EOxpW_image",stepPip:"_4EOxpW_step-pip",seeMoreButton:"_4EOxpW_see-more-button",leftButton:"_4EOxpW_left-button",text:"_4EOxpW_text",moreItem:"_4EOxpW_more-item",tutorialCard:"_4EOxpW_tutorial-card",moreItemImage:"_4EOxpW_more-item-image",rightPage:"_4EOxpW_right-page"};var m1="./assets/icon-shrink-8vdqegra.svg";var g1="./assets/icon-expand-67bgdn61.svg";var p1="./assets/icon-close-dy7x7fdb.svg";var Ei="./assets/icon-arrow-ddhj68kd.svg";import{jsx as y,jsxs as X,Fragment as $e}from"preact/jsx-runtime";function s1({tutorialId:e,onOpenTutorial:r,onBack:i,onClose:t}){let o=po(),{tutorials:a}=bo(),n=Qi(null),u=Qi(-1),g=Qi(!0),c=ho(()=>n.value?.[u.value]),p=Zi(()=>{u.value=(u.value+1)%n.value.length},[]),q=Zi(()=>{u.value=(u.value-1)%n.value.length},[]);return d1(()=>{let d=a.value.lessons[e];if(!d){t();return}so(()=>{n.value=[].concat(d.pages,d.next?{next:d.next.filter((h)=>a.value.lessons[h]).map((h)=>({id:h,title:a.value.lessons[h].title,image:a.value.lessons[h].image}))}:[]),u.value=0})},[e]),d1(()=>{if(o.current){let d=o.current.parentElement,h,m,f=(L)=>{let N=h-L.clientX,x=m-L.clientY;h=L.clientX,m=L.clientY,d.style.top=`${d.offsetTop-x}px`,d.style.left=`${d.offsetLeft-N}px`,d.style.bottom="unset"},v=()=>{document.removeEventListener("pointerup",v),document.removeEventListener("pointermove",f)};o.current.addEventListener("pointerdown",(L)=>{h=L.clientX,m=L.clientY,f(L),document.addEventListener("pointerup",v),document.addEventListener("pointermove",f)})}},[]),X("div",{className:w.tutorialBoxWrapper,children:[X("div",{ref:o,className:w.tutorialCard,children:[X("div",{className:w.cardHeader,children:[X("div",{className:w.headerButton,onClick:i,children:[y("img",{className:w.buttonIcon,src:He}),y(ve,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]}),y("div",{className:w.stepList,children:n.value?.map((d,h)=>y("div",{className:fo(w.stepPip,{[w.actived]:h===u.value}),onClick:()=>u.value=h},h))}),X("div",{className:w.headerButtonGroup,children:[y("div",{className:w.headerButton,onClick:Zi(()=>g.value=!g.value,[]),children:g.value?X($e,{children:[y("img",{className:w.buttonIcon,src:m1}),y(ve,{id:"gui.tutorials.shrink",defaultMessage:"Shrink"})]}):X($e,{children:[y("img",{className:w.buttonIcon,src:g1}),y(ve,{id:"gui.tutorials.expand",defaultMessage:"Expand"})]})}),X("div",{className:w.headerButton,onClick:t,children:[y("img",{className:w.buttonIcon,src:p1}),y(ve,{id:"gui.tutorials.close",defaultMessage:"Close"})]})]})]}),g.value&&c.value&&X("div",{className:w.cardBody,children:[(c.value.title||c.value.next)&&y("div",{className:w.title,children:c.value.title||y(ve,{id:"gui.tutorials.moreTry",defaultMessage:"More things to try!"})}),c.value.image&&y("img",{className:w.image,src:c.value.image}),c.value.text&&y("div",{className:w.text,children:c.value.text}),c.value.next&&X($e,{children:[y("div",{className:w.more,children:c.value.next.map((d)=>X("div",{className:w.moreItem,onClick:()=>r(d.id),children:[y("img",{className:w.moreItemImage,src:d.image}),y("div",{className:w.moreItemName,children:d.title})]},d.id))}),y(vo,{className:w.seeMoreButton,onClick:i,children:y(ve,{id:"gui.tutorials.seeMore",defaultMessage:"See more"})})]})]})]}),g.value&&u.value>0&&X($e,{children:[y("div",{className:w.leftPage}),y("div",{className:w.leftButton,onClick:q,children:y("img",{src:Ei})})]}),g.value&&n.value&&u.value<n.value.length-1&&X($e,{children:[y("div",{className:w.rightPage}),y("div",{className:w.rightButton,onClick:p,children:y("img",{src:Ei})})]})]})}import{useComputed as ko}from"@preact/signals";import{useAppContext as wo,Text as _o,Library as Co}from"@blockcode/core";import{jsx as f1}from"preact/jsx-runtime";var yo=f1(_o,{id:"gui.library.tutorials.tutorial",defaultMessage:"Choose a tutorial"});function h1({onOpenTutorial:e,onClose:r}){let{tutorials:i}=wo(),t=ko(()=>{return Object.entries(i.value.lessons).map(([a,n])=>({title:n.title,image:n.image,tags:n.tags,onSelect:()=>e(a)}))});return f1(Co,{featured:!0,items:t.value,title:i.value.title||yo,filterable:i.value.tags,tags:i.value.tags,onClose:r})}import{useCallback as Ae,useEffect as Bo}from"preact/hooks";import{useComputed as Mo,useSignal as qo}from"@preact/signals";import{getProjectsThumbs as Eo,getProject as Zo,cloneProject as Qo,renameProject as Lo,delProject as Fo}from"@blockcode/utils";import{useProjectContext as $o,closeUserStorage as v1,maybeTranslate as Li,openPromptModal as k1}from"@blockcode/core";import{Text as Y,Library as Ao}from"@blockcode/core";C(".mLGZyG_delete-menu-item:hover{background:var(--error-primary)}");var b1={deleteMenuItem:"mLGZyG_delete-menu-item"};import{jsx as H}from"preact/jsx-runtime";var Wo=30;function w1({onOpenProject:e}){let{meta:r}=$o(),i=qo([]),t=Mo(()=>i.value.length),o=Ae((c,p)=>{k1({title:H(Y,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:H(Y,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:Li(p??H(Y,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(q)=>{if(q?.name)await Lo(c,q.name),g()}})},[]),a=Ae(async(c)=>{await Qo(c),g()},[]),n=Ae((c,p)=>{k1({title:H(Y,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:H(Y,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:Li(p||H(Y,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await Fo(c),g()}})},[]),u=Ae((c)=>async()=>{let p=await Zo(c);e(p),v1()},[]),g=Ae(async()=>{let c=await Eo();if(r.value?.editor)c=c.filter((p)=>p.meta.editor===r.value.editor);c=c.sort((p,q)=>q.modifiedDate-p.modifiedDate),i.value=c.map((p)=>({name:Li(p.name??H(Y,{id:"gui.project.shortname",defaultMessage:"Untitled"})),image:p.thumb,onSelect:u(p.key),contextMenu:[[{label:H(Y,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>o(p.key,p.name)},{label:H(Y,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>a(p.key)}],[{label:H(Y,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:b1.deleteMenuItem,onClick:()=>n(p.key,p.name)}]]}))},[u,o,n]);return Bo(()=>g(),[g]),H(Ao,{items:i.value,filterable:t.value>Wo,emptyMessage:H(Y,{id:"gui.library.projects.empty",defaultMessage:"No project!"}),onClose:v1})}C("._3HqakW_gui-wrapper{height:100%}._3HqakW_alerts-container{width:100%;z-index:var(--z-index-alerts);margin-top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;justify-content:center;display:flex;position:absolute}._3HqakW_menu-bar-position{z-index:var(--z-index-menu-bar);position:relative}._3HqakW_body-wrapper{height:calc(100% - var(--menu-bar-height));background:var(--ui-primary)}._3HqakW_body-wrapper *{box-sizing:border-box}._3HqakW_workspace-wrapper{flex-direction:row;height:100%;display:flex;overflow-y:hidden}._3HqakW_sidebar-wrapper{margin:0 var(--space);display:flex;position:relative}._3HqakW_editor-wrapper{flex-direction:column;flex-grow:1;flex-shrink:0;display:flex;position:relative}._3HqakW_tabs-wrapper{flex-grow:1;position:relative}._3HqakW_tab-panel-no-left{border-bottom-left-radius:0}._3HqakW_tab-panel-no-right{border-top-right-radius:0;border-bottom-right-radius:0}._3HqakW_tab-panel-no-bottom{border-bottom-right-radius:0;border-bottom-left-radius:0}._3HqakW_pane-wrapper{margin:var(--space)0 0 0;display:flex;position:relative}");var P={tabPanelNoBottom:"_3HqakW_tab-panel-no-bottom",bodyWrapper:"_3HqakW_body-wrapper",paneWrapper:"_3HqakW_pane-wrapper",menuBarPosition:"_3HqakW_menu-bar-position",alertsContainer:"_3HqakW_alerts-container",sidebarWrapper:"_3HqakW_sidebar-wrapper",guiWrapper:"_3HqakW_gui-wrapper",tabPanelNoRight:"_3HqakW_tab-panel-no-right",workspaceWrapper:"_3HqakW_workspace-wrapper",tabPanelNoLeft:"_3HqakW_tab-panel-no-left",editorWrapper:"_3HqakW_editor-wrapper",tabsWrapper:"_3HqakW_tabs-wrapper"};import{jsx as _,jsxs as Ie,Fragment as M1}from"preact/jsx-runtime";var _e=Po({Bluetooth:null,SerialPort:null});function q1(){let[e]=Io(),{language:r}=Xo(),i=Uo();Fi(()=>{document.title=No("gui.name","BlockCode Playgrounds"),document.title+=" [BETA]"},[r.value]);let t=_1(()=>{let s={};return i.docks.value?.forEach((k)=>{if(k.expand==="bottom")s.paneLabel=k.label,s.PaneContent=k.Content;else if(k.expand==="left")s.LeftDockContent=k.Content;else s.RightDockContent=k.Content}),s}),{LeftDockContent:o,RightDockContent:a,PaneContent:n}=t.value,u=xo({[P.tabPanelNoLeft]:!o,[P.tabPanelNoRight]:!a,[P.tabPanelNoBottom]:!n}),g=Ge(null);Fi(()=>{if($i)window.electron.serial.onScan((s)=>{g.value=s&&{devices:s,type:_e.SerialPort}}),window.electron.bluetooth.onScan((s)=>{g.value=s&&{devices:s,type:_e.Bluetooth}})},[]);let c=()=>{},p=T(()=>{if($i){if(g.value.type===_e.SerialPort)window.electron.serial.cancel();if(g.value.type===_e.Bluetooth)window.electron.bluetooth.cancel();g.value=null}},[]),q=T((s)=>{if($i){if(g.value.type===_e.SerialPort)window.electron.serial.connect(s);if(g.value.type===_e.Bluetooth)window.electron.bluetooth.connect(s)}},[]),d=Ge({});Do(async()=>{let s=await Ze();s=s.map((k)=>[k.id,{name:k.name,version:k.version}]),d.value=Object.fromEntries(s)});let h=T(()=>{ke(()=>{i.appState.value?.device?.disconnect(),We("device",null),Jo(),Go()})},[]),m=T((s)=>{ke(()=>{C1(),Vo(Object.assign(JSON.parse(JSON.stringify(s)),{fileId:s.fileId??s.files?.[0]?.id})),B1(0)})},[]),f=Ge(!1),v=Ge(null),L=T(()=>{ke(()=>{v.value=null,f.value=!0})},[]),N=T((s)=>{let k=i.tutorials.value.lessons[s];ke(async()=>{if(k.project){Yo("importing",{id:s});let R=await Ro(k.project);Ko(s),m(R)}v.value=s,f.value=!1})},[]),{meta:x,key:Ai,modified:Wi}=To(),Ii=_1(()=>!x.value),E1=T(()=>{if(Wi.value)Ve({title:_(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(we,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:h});else h()},[]),Je=T((s,k)=>{if(k!==s.meta.editor){Ve({label:_(we,{id:"gui.library.projects.errorEditor",defaultMessage:'This project is not currently editor creation, please switch to "{editor}" and open it.',editor:Ho(d.value[s.meta.editor]?.name)}),redStyle:!0});return}if(Ai.value===s.key)return;if(Wi.value)Ve({title:_(we,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:_(we,{id:"gui.library.projects.replace",defaultMessage:"Replace contents of the current project?"}),onSubmit:()=>m(s)});else m(s)},[]),Di=T(async(s,k)=>{ke(()=>{h(),C1()});let R=s,Pi=window.electron?.getLocalEditors();if(Pi?.[s]?.main)R=Pi[s].main;let le;try{le=(await import(R)).default}catch(on){Ve({label:_(we,{id:"gui.library.projects.notFoundEditor",defaultMessage:'Not Found the "{editor}" Editor.',editor:s}),redStyle:!0}),zo();return}let Ye={editor:s,version:d.value[s]?.version};if(!k)k=JSON.parse(JSON.stringify(await le.onNew()));if(!k.meta)k.meta=Ye;if(!k.meta.editor)k.meta.editor=s,k.meta.version=Ye.version;let Z1={menuItems:pr(le,Ye,Je),barItems:le.barItems,tabs:le.tabs,docks:le.docks,tutorials:window.electron?.getLocalTutorials(s,r.value)??le.tutorials};ke(()=>{Oo(Z1),Je(k,s)})},[]),xi=T((s)=>{if(x.value?.editor!==s.meta.editor){h(),Di(s.meta.editor,s);return}Je(s,x.value.editor)},[]);return Fi(()=>{if(x.value?.editor){if(So(x.value.editor))We("panelBoxId","Logs")}else We("panelBoxId",null)},[x.value?.editor]),Ie(M1,{children:[(i.splashVisible.value||e)&&_(l1,{error:e}),_(vr,{items:i.alerts.value}),_(Yr,{className:P.menuBarPosition,showHomeButton:!Ii.value,onRequestHome:E1,onOpenTutorialLibrary:L}),_("div",{className:P.bodyWrapper,children:Ie("div",{className:P.workspaceWrapper,children:[o&&_("div",{className:P.sidebarWrapper,children:_(o,{})}),Ie("div",{className:P.editorWrapper,children:[_(u1,{id:P.tabsWrapper,className:P.tabsWrapper,children:i.tabs.value?.map(({Content:s,...k},R)=>Ie(M1,{children:[Ie(ze,{name:R,disabled:k.disabled,checked:R===i.tabIndex.value,onSelect:()=>B1(R),children:[_("img",{src:k.icon}),k.label]},R),_(Oe,{name:R,className:u,children:(R===0||i.tabIndex.value===R)&&s&&_(s,{})},R)]}))}),n&&_(Kr,{id:P.paneWrapper,className:P.paneWrapper,title:t.value.paneLabel,right:!a,left:!o,children:_(n,{})})]}),a&&_("div",{className:P.sidebarWrapper,children:_(a,{})})]})}),i.appState.value?.panelBoxId&&_(or,{panelId:i.appState.value.panelBoxId,onPanelChange:T((s)=>We("panelBoxId",s),[]),onClose:T(()=>We("panelBoxId",null),[])}),g.value&&_(_r,{title:x.value.deviceName,icon:x.value.deviceIcon,devices:g.value.devices,onClose:p,onConnect:q}),v.value&&_(s1,{tutorialId:v.value,onOpenTutorial:N,onBack:L,onClose:()=>v.value=null}),f.value&&_(h1,{onOpenTutorial:N,onClose:T(()=>f.value=!1,[])}),Ii.value&&_(Dr,{onOpenEditor:Di,onOpenProject:xi}),i.userStorageVisible.value&&_(w1,{onOpenProject:xi}),i.prompt.value&&(i.prompt.value.inputItems?_(n1,{title:i.prompt.value.title,content:i.prompt.value.content,inputItems:i.prompt.value.inputItems,onClose:y1,onSubmit:i.prompt.value.onSubmit}):_(i1,{title:i.prompt.value.title,label:i.prompt.value.label,content:i.prompt.value.content,redStyle:i.prompt.value.redStyle,onClose:y1,onSubmit:i.prompt.value.onSubmit,children:i.prompt.value.body}))]})}import{addAlertConfig as I,Text as D,Spinner as me}from"@blockcode/core";import{jsx as E}from"preact/jsx-runtime";I("importing",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.importing",defaultMessage:"Importing..."})});I("downloading",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.downloading",defaultMessage:"Downloading...{progress}%"})});I("downloadCompleted",{icon:null,message:E(D,{id:"gui.alert.downloadCompleted",defaultMessage:"Download completed."})});I("connecting",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.connecting",defaultMessage:"Connecting..."})});I("connected",{icon:null,message:E(D,{id:"gui.alert.connected",defaultMessage:"Connected."})});I("connectionCancel",{icon:null,mode:"warn",message:E(D,{id:"gui.alert.connectionCancel",defaultMessage:"Connection cancel."})});I("connectionError",{icon:null,mode:"warn",message:E(D,{id:"gui.alert.connectionError",defaultMessage:"Connection error or connection was lost."})});I("erasing",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.erasing",defaultMessage:"Erasing..."})});I("restoring",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.restoring",defaultMessage:"Firmware restoring...{progress}%"})});I("recovering",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.recovering",defaultMessage:"Recovering..."})});I("restoreCompleted",{icon:null,message:E(D,{id:"gui.alert.restoreCompleted",defaultMessage:"Firmware resotre completed! Now press RESET key"})});I("compiling",{icon:E(me,{level:"success"}),message:E(D,{id:"gui.alert.compiling",defaultMessage:"Compiling..."})});I("compileCompleted",{icon:null,message:E(D,{id:"gui.alert.compileCompleted",defaultMessage:"Compilation completed."})});I("compileError",{icon:null,mode:"warn",message:E(D,{id:"gui.alert.compileError",defaultMessage:"Compilation error."})});I("reseting",{icon:null,message:E(D,{id:"gui.alert.reseting",defaultMessage:"Reseting..."})});import{jsx as De}from"preact/jsx-runtime";function tn(){return De(en,{children:De(rn,{children:De(an,{children:De(q1,{})})})})}jo(De(tn,{}),document.getElementById("root"));
