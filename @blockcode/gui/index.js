import{addLocalesMessages as Hi}from"@blockcode/core";var O1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"Importing...","gui.alert.importError":"Failed import.","gui.alert.exporting":"Exporting...","gui.alert.exportCompleted":"Export completed.","gui.alert.exportAbortError":"Abort exporting.","gui.alert.exportError":"Failed export.","gui.alert.downloading":"Downloading...{progress}%","gui.alert.downloadCompleted":"Download completed.","gui.alert.downloadError":"Download failed.","gui.alert.connecting":"Connecting...","gui.alert.connected":"Connected.","gui.alert.connectionCancel":"Connection cancel.","gui.alert.connectionError":"Connection error or connection was lost.","gui.alert.connectionBusy":"Device not respond.","gui.alert.erasing":"Erasing...","gui.alert.restoring":"Firmware restoring...{progress}%","gui.alert.recovering":"Recovering...","gui.alert.restoreCompleted":"Firmware resotre completed! Now press RESET key","gui.alert.reseting":"Reseting...","gui.alert.compiling":"Compiling...","gui.alert.compileCompleted":"Compilation completed.","gui.alert.compileError":"Compilation failed.","gui.alert.compileViewError":"View Message.","gui.alert.saving":"Saving project...","gui.alert.saved":"Saved.","gui.alert.savedComputer":"Saved to your computer.","gui.alert.saveAbortError":"Abort saving.","gui.alert.saveError":"Failed save.","gui.alert.logsCopied":"Logs copied to clipboard.","gui.alert.logsCopyFailed":"Failed to copy logs to clipboard.","gui.logs.changeDevice":"Device changed to {device}","gui.logs.connected":"Device connected","gui.logs.connectedType":"Device connected with {type}","gui.logs.disconnected":"Device disconnected","gui.logs.compiling":"Compiling...","gui.logs.compiled":"Compile completed","gui.logs.downloading":"Downloading...","gui.logs.downloaded":"Download completed","gui.logs.downloadError":"Download failed","gui.home.my":"My projects","gui.home.all":"View all","gui.home.allCounts":"View all ({counts})","gui.home.new":"Create new project","gui.home.examples":"Wonderful {label} projects","gui.home.slideshow.desktop.title":"The desktop application is here!","gui.home.slideshow.desktop.button":"Download","gui.home.slideshow.tankwar.title":"The Tank War is coming! Join us!","gui.home.slideshow.tankwar.button":"Join us","gui.home.slideshow.arcade.title":"The next game, create your own!","gui.home.slideshow.arcade.button":"Create now","gui.splash.loading":"Loading project...","gui.splash.errorTitle":"Error occurred","gui.splash.errorLabel":"Please refresh the page and reopen it.","gui.menubar.courses":"Courses","gui.menubar.tutorials":"Tutorials","gui.menubar.titlePlaceholder":"Project title here","gui.menubar.file":"File","gui.menubar.file.newProject":"New","gui.menubar.file.openProject":"Open...","gui.menubar.file.saveProject":"Save","gui.menubar.file.uploadProject":"Load from your computer...","gui.menubar.file.downloadProject":"Save to your computer...","gui.menubar.edit":"Edit","gui.menubar.edit.undo":"Undo","gui.menubar.edit.redo":"Redo","gui.menubar.edit.openManualCoding":"Turn on Coding Mode","gui.menubar.edit.closeManualCoding":"Turn off Coding Mode","gui.menubar.edit.openCompactBlock":"Turn on Compact Block","gui.menubar.edit.closeCompactBlock":"Turn off Compact Block","gui.menubar.edit.blockActual":"Actual Size Blocks","gui.menubar.edit.blockLarger":"Larger Size Blocks","gui.menubar.edit.blockSmaller":"Smaller Size Blocks","gui.menubar.view":"View","gui.menubar.view.log":"Log Panel","gui.menubar.view.serial":"Serial Panel","gui.menubar.view.files":"Files Panel","gui.menubar.view.openAutoDisplayPanel":"Turn on auto display Log Panel","gui.menubar.view.closeAutoDisplayPanel":"Turn off auto display Log Panel","gui.menubar.device":"Device","gui.menubar.device.sync":"Sync program","gui.menubar.device.download":"Download program","gui.menubar.device.reset":"Reset device","gui.menubar.device.connect":"Connect device...","gui.menubar.device.connectUsb":"Connect device with USB...","gui.menubar.device.connectBle":"Connect device with Bluetooth (BLE)...","gui.menubar.device.disconnect":"Disconnect device","gui.menubar.device.firmware":"Restore firmware...","gui.menubar.device.firmwareVersion":"Restore v{version} firmware...","gui.menubar.device.caching":"Caching latest firmware...","gui.panelBox.logs":"Logs","gui.panelBox.logsCopy":"Copy","gui.panelBox.serial":"Serial","gui.panelBox.serialClean":"Clean","gui.panelBox.files":"Files","gui.panelBox.filesAdd":"Add","gui.project.name":"Untitled Project","gui.project.shortname":"Untitled","gui.library.search":"Search","gui.library.projects.empty":"No project!","gui.library.projects.rename":"rename","gui.library.projects.duplicate":"duplicate","gui.library.projects.delete":"delete","gui.library.projects.notSaved":"Not saved","gui.library.projects.close":"Close current project?","gui.library.projects.deleteConfirm":'Do you want to delete the project "{name}"?',"gui.library.projects.replace":"Replace contents of the current project?","gui.library.projects.errorEditor":'This project is not currently editor creation, please switch to "{workspace}" and open it.',"gui.library.projects.notFoundEditor":'Not Found the "{editor}" Editor.',"gui.library.examples.interconnect":"The project requires two devices to work properly.","gui.library.tutorial.course":"Choose a course","gui.library.tutorial.tutorial":"Choose a tutorial","gui.tutorials.shrink":"Shrink","gui.tutorials.expand":"Expand","gui.tutorials.close":"Close","gui.tutorials.moreTry":"More things to try!","gui.tutorials.seeMore":"See more","gui.prompt.ok":"OK","gui.prompt.close":"Close","gui.prompt.cancel":"Cancel","gui.prompt.reconnect":"Reconnect","gui.connection.device":"Device Connection","gui.connection.search":"Start Searching","gui.connection.searching":"Searching...","gui.connection.connect":"Start Connecting","gui.connection.deviceName":"Device name","gui.about.title":"About...","gui.about.main":"Main program","gui.terms.title":"Terms of Use","gui.terms.content":`<b>Terms of Use</b>
`,"gui.privacy.title":"Privacy","gui.privacy.content":`<b>Privacy</b>
`};var G1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"载入中…","gui.alert.importError":"载入失败。","gui.alert.exporting":"导出中…","gui.alert.exportCompleted":"导出完成。","gui.alert.exportAbortError":"取消导出。","gui.alert.exportError":"导出失败。","gui.alert.downloading":"正在下载…{progress}%","gui.alert.downloadCompleted":"下载完成。","gui.alert.downloadError":"下载失败。","gui.alert.connecting":"正在连接…","gui.alert.connected":"已连接。","gui.alert.connectionCancel":"连接取消。","gui.alert.connectionError":"连接发生错误，或已断开。","gui.alert.connectionBusy":"设备未响应。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在恢复固件…{progress}%","gui.alert.recovering":"恢复设备…","gui.alert.restoreCompleted":"恢复固件完成，请按下 RESET 键。","gui.alert.reseting":"正在复位…","gui.alert.compiling":"正在编译…","gui.alert.compileCompleted":"编译完成。","gui.alert.compileError":"编译失败。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存作品…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到电脑。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存作品失败。","gui.alert.logsCopied":"日志已复制。","gui.alert.logsCopyFailed":"日志复制失败。","gui.logs.changeDevice":"设备已更改为 {device}","gui.logs.connected":"设备已连接","gui.logs.connectedType":"设备已连接到 {type}","gui.logs.disconnected":"设备断开连接","gui.logs.compiling":"程序编译中…","gui.logs.compiled":"编译完成","gui.logs.downloading":"下载程序到设备…","gui.logs.downloaded":"下载完成","gui.logs.downloadError":"下载失败","gui.home.my":"我的作品","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"开始新作品","gui.home.examples":"{label} 精彩作品","gui.home.slideshow.desktop.title":"桌面端程序已就绪，快来下载！","gui.home.slideshow.desktop.button":"立即下载","gui.home.slideshow.tankwar.title":"战争一触即发，赶紧来战吧！","gui.home.slideshow.tankwar.button":"加入战斗","gui.home.slideshow.arcade.title":"玩的下一个游戏，就要自己创作！","gui.home.slideshow.arcade.button":"开始创作","gui.splash.loading":"加载作品…","gui.splash.errorTitle":"发生错误","gui.splash.errorLabel":"请刷新页面重新打开。","gui.menubar.courses":"课程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填写作品标题","gui.menubar.file":"文件","gui.menubar.file.newProject":"新作品","gui.menubar.file.openProject":"打开…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"从电脑中打开…","gui.menubar.file.downloadProject":"保存到电脑…","gui.menubar.edit":"编辑","gui.menubar.edit.undo":"撤销","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打开代码编程","gui.menubar.edit.closeManualCoding":"关闭代码编程","gui.menubar.edit.openCompactBlock":"打开紧凑积木样式","gui.menubar.edit.closeCompactBlock":"关闭紧凑积木样式","gui.menubar.edit.blockActual":"原始尺寸积木","gui.menubar.edit.blockLarger":"更大的积木","gui.menubar.edit.blockSmaller":"更小的积木","gui.menubar.view":"查看","gui.menubar.view.log":"日志","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文件管理","gui.menubar.view.openAutoDisplayPanel":"打开自动显示日志","gui.menubar.view.closeAutoDisplayPanel":"关闭自动显示日志","gui.menubar.device":"设备","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下载程序","gui.menubar.device.reset":"复位","gui.menubar.device.connect":"连接…","gui.menubar.device.connectUsb":"通过 USB 连接…","gui.menubar.device.connectBle":"通过蓝牙（BLE）连接…","gui.menubar.device.disconnect":"断开连接","gui.menubar.device.firmware":"恢复固件…","gui.menubar.device.firmwareVersion":"恢复 v{version} 固件…","gui.menubar.device.caching":"正在缓存最新固件…","gui.panelBox.logs":"日志","gui.panelBox.logsCopy":"复制","gui.panelBox.serial":"串口","gui.panelBox.serialClean":"清除","gui.panelBox.files":"文件管理","gui.panelBox.logsAdd":"添加","gui.project.name":"未命名作品","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"没有作品！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"复制","gui.library.projects.delete":"删除","gui.library.projects.notSaved":"未保存作品","gui.library.projects.close":"要关闭当前作品吗？","gui.library.projects.deleteConfirm":"要删除“《{name}》”作品吗？","gui.library.projects.replace":"要创建新作品替换当前作品吗？","gui.library.projects.errorEditor":"这个作品不是当前编辑器创作，请切换至“{editor}”编辑器然后打开。","gui.library.projects.notFoundEditor":"没有发现“{editor}”编辑器。","gui.library.examples.interconnect":"该作品需要两台设备联机才能正常运行。","gui.library.tutorials.course":"选择一个课程","gui.library.tutorials.tutorial":"选择一个教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展开","gui.tutorials.close":"关闭","gui.tutorials.moreTry":"再试试这些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"确认","gui.prompt.close":"关闭","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新连接","gui.connection.device":"硬件连接","gui.connection.search":"开始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"开始连接","gui.connection.deviceName":"硬件名称","gui.about.title":"版本信息","gui.about.main":"主程序","gui.terms.title":"使用条款","gui.terms.content":`<b>使用条款</b>
`,"gui.privacy.title":"隐私","gui.privacy.content":`<b>隐私</b>
`};var V1={"gui.name":"BlockCode Playgrounds","gui.alert.importing":"載入中…","gui.alert.importError":"载入失败。","gui.alert.exporting":"匯出中…","gui.alert.exportCompleted":"匯出完成。","gui.alert.exportAbortError":"取消匯出。","gui.alert.exportError":"匯出失败。","gui.alert.downloading":"正在下載…{progress}%","gui.alert.downloadCompleted":"下載完成。","gui.alert.downloadError":"下載失敗","gui.alert.connecting":"正在連接…","gui.alert.connected":"已連接。","gui.alert.connectionCancel":"連接取消。","gui.alert.connectionError":"連接發生錯誤，或已斷開。","gui.alert.connectionBusy":"設備未響應。","gui.alert.erasing":"正在清除…","gui.alert.restoring":"正在還原固件…{progress}%","gui.alert.recovering":"恢復設備…","gui.alert.restoreCompleted":"還原固件完成，請按下 RESET 鍵。","gui.alert.reseting":"正在重置…","gui.alert.compiling":"正在編譯…","gui.alert.compileCompleted":"編譯完成。","gui.alert.compileError":"編譯失敗。","gui.alert.compileViewError":"查看信息","gui.alert.saving":"正在保存專案…","gui.alert.saved":"已保存。","gui.alert.savedComputer":"已保存到電腦。","gui.alert.saveAbortError":"取消保存。","gui.alert.saveError":"保存專案失敗。","gui.alert.logsCopied":"日誌已複製。","gui.alert.logsCopyFailed":"日誌複製失敗。","gui.logs.changeDevice":"設備已更改為 {device}","gui.logs.connected":"設備已連接","gui.logs.connectedType":"設備已連接到 {type}","gui.logs.disconnected":"設備斷開連接","gui.logs.compiling":"程序編譯中…","gui.logs.compiled":"編譯完成","gui.logs.downloading":"下載程序到設備…","gui.logs.downloaded":"下載完成","gui.logs.downloadError":"下載失敗","gui.home.my":"我的專案","gui.home.all":"查看全部","gui.home.allCounts":"查看全部（{counts}）","gui.home.new":"開始新專案","gui.home.examples":"{label} 精彩專案","gui.home.slideshow.desktop.title":"桌面端程序已就緒，快來下載！","gui.home.slideshow.desktop.button":"立即下載","gui.home.slideshow.tankwar.title":"戰爭一觸即髮，趕緊來戰吧！","gui.home.slideshow.tankwar.button":"加入戰鬥","gui.home.slideshow.arcade.title":"玩的下一個遊戲，就要自己創作！","gui.home.slideshow.arcade.button":"開始創作","gui.splash.loading":"加載專案…","gui.splash.errorTitle":"發生錯誤","gui.splash.errorLabel":"請刷新頁面重新打開。","gui.menubar.courses":"課程","gui.menubar.tutorials":"教程","gui.menubar.titlePlaceholder":"在此填寫專案標題","gui.menubar.file":"文檔","gui.menubar.file.newProject":"新專案","gui.menubar.file.openProject":"打開…","gui.menubar.file.saveProject":"保存","gui.menubar.file.uploadProject":"從電腦中打開…","gui.menubar.file.downloadProject":"保存到電腦…","gui.menubar.edit":"編輯","gui.menubar.edit.undo":"撤銷","gui.menubar.edit.redo":"重做","gui.menubar.edit.openManualCoding":"打開代碼編程","gui.menubar.edit.closeManualCoding":"關閉代碼編程","gui.menubar.edit.openCompactBlock":"打開緊湊積木樣式","gui.menubar.edit.closeCompactBlock":"關閉緊湊積木樣式","gui.menubar.edit.blockActual":"原始尺寸積木","gui.menubar.edit.blockLarger":"更大的積木","gui.menubar.edit.blockSmaller":"更小的積木","gui.menubar.view":"查看","gui.menubar.view.log":"日誌","gui.menubar.view.serial":"串口","gui.menubar.view.files":"文檔管理","gui.menubar.view.openAutoDisplayPanel":"打開自動顯示日誌","gui.menubar.view.closeAutoDisplayPanel":"關閉自動顯示日誌","gui.menubar.device":"設備","gui.menubar.device.sync":"同步程序","gui.menubar.device.download":"下載程序","gui.menubar.device.reset":"重置","gui.menubar.device.connect":"連接…","gui.menubar.device.connectUsb":"通過 USB 連接…","gui.menubar.device.connectBle":"通過藍牙（BLE）連接…","gui.menubar.device.disconnect":"斷開連接","gui.menubar.device.firmware":"還原固件…","gui.menubar.device.firmwareVersion":"還原 v{version} 固件…","gui.menubar.device.caching":"正在緩存最新固件…","gui.panelBox.logs":"日誌","gui.panelBox.logsCopy":"複製","gui.panelBox.serial":"串口","gui.panelBox.serialClean":"清除","gui.panelBox.files":"文檔管理","gui.panelBox.logsAdd":"添加","gui.project.name":"未命名專案","gui.project.shortname":"未命名","gui.library.search":"搜索","gui.library.projects.empty":"沒有專案！","gui.library.projects.rename":"重命名","gui.library.projects.duplicate":"複製","gui.library.projects.delete":"刪除","gui.library.projects.notSaved":"未保存專案","gui.library.projects.close":"要關閉當前專案嗎？","gui.library.projects.deleteConfirm":"要刪除“《{name}》”專案嗎？","gui.library.projects.replace":"要創建新專案替換當前專案嗎？","gui.library.projects.errorEditor":"這個專案不是當前編輯器創作，請切換至“{editor}”編輯器然後打開。","gui.library.projects.notFoundEditor":"沒有發現「{editor}」編輯器。","gui.library.examples.interconnect":"該專案需要兩枱設備聯機纔能正常運行。","gui.library.tutorials.course":"選擇一個課程","gui.library.tutorials.tutorial":"選擇一個教程","gui.tutorials.shrink":"收起","gui.tutorials.expand":"展開","gui.tutorials.close":"關閉","gui.tutorials.moreTry":"再試試這些！","gui.tutorials.seeMore":"更多技巧","gui.prompt.ok":"確認","gui.prompt.close":"關閉","gui.prompt.cancel":"取消","gui.prompt.reconnect":"重新連接","gui.connection.device":"硬件連接","gui.connection.search":"開始搜索","gui.connection.searching":"正在搜索…","gui.connection.connect":"開始連接","gui.connection.deviceName":"硬件名稱","gui.about.title":"版本信息","gui.about.main":"主程式","gui.terms.title":"使用條款","gui.terms.content":`<b>使用條款</b>
`,"gui.privacy.title":"隱私","gui.privacy.content":`<b>隱私</b>
`};Hi({en:O1,"zh-Hans":G1,"zh-Hant":V1});import{render as Ln}from"preact";import{LocalesProvider as Zn,AppProvider as Qn,ProjectProvider as Fn}from"@blockcode/core";import{useCallback as X,useEffect as a1,useErrorBoundary as mn}from"preact/hooks";import{batch as be,useComputed as T1,useSignal as t1,useSignalEffect as gn}from"@preact/signals";import{isElectron as X1,classNames as pn,keyMirror as dn,openProjectFromURL as sn,getAutoDisplayPanel as hn}from"@blockcode/utils";import{useAppContext as fn,useLocalesContext as bn,useProjectContext as vn,translate as kn,maybeTranslate as Cn,showSplash as xi,hideSplash as wn,openPromptModal as Re,closePromptModal as Ii,openLayout as _n,closeLayout as yn,openTab as Si,openProject as Mn,closeProject as Bn,setAlert as qn,delAlert as En,setAppState as ze}from"@blockcode/core";import{getAutoDisplayPanel as Xa,setAutoDisplayPanel as Na}from"@blockcode/utils";import{Text as k1}from"@blockcode/core";import{useCallback as Ne}from"preact/hooks";import{batch as Oi}from"@preact/signals";import{isElectron as J1,isMac as u1,putProject as Gi,openProjectFromComputer as Vi,saveProjectToComputer as Ji,sleepMs as Yi}from"@blockcode/utils";import{useProjectContext as Ki,setAlert as p1,openUserStorage as ji,setFile as ea,setModified as ra,ModifyTypes as ia,Keys as oe}from"@blockcode/core";import{loadedExtensions as aa}from"@blockcode/blocks";import{Text as re,MenuSection as m1,MenuItem as Ee}from"@blockcode/core";function y(e){let i=globalThis.document,r=i.createElement("style");r.appendChild(i.createTextNode(e)),i.head.append(r)}y(".cbXT-q_menu-bar{box-sizing:border-box;height:var(--menu-bar-height);font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:var(--menu-bar-standard-font-size);background-color:var(--theme-primary);color:var(--ui-white);-webkit-user-select:none;-webkit-app-region:drag;flex-flow:row;justify-content:space-between;font-weight:700;display:flex;box-shadow:0 0 3px #00000040}.cbXT-q_menu-bar-item{color:var(--ui-white);user-select:none;white-space:nowrap;height:var(--menu-bar-height);align-self:center;align-items:center;padding:0 .25rem;text-decoration:none;display:flex;position:relative}.cbXT-q_menu-bar-item.cbXT-q_growable{max-width:var(--menu-bar-item-max-width);flex:1}.cbXT-q_menu-bar-item[disabled]{opacity:.5;pointer-events:none}.cbXT-q_main-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_main-menu.cbXT-q_electron{margin-left:72px}.cbXT-q_right-menu{-webkit-app-region:no-drag;flex-flow:row;justify-content:flex-start;align-items:center;gap:.25rem;display:flex}.cbXT-q_menu-label{padding:0 .75rem}.cbXT-q_menu-label img:not(:only-child){margin-right:.25rem}.cbXT-q_language-label{width:var(--language-selector-width);padding:0 .5rem}input.cbXT-q_menu-label{display:none}input.cbXT-q_menu-label+.cbXT-q_menu-bar-item:hover{cursor:pointer;background:var(--ui-black-transparent)}input.cbXT-q_menu-label:checked+.cbXT-q_menu-bar-item{background:var(--ui-black-transparent)}.cbXT-q_main-menu>.cbXT-q_menu{border-radius:0 0 var(--space) var(--space)}.cbXT-q_menu{top:var(--menu-bar-height);z-index:var(--z-index-menu-bar);border-radius:var(--space);color:var(--ui-white);background:var(--theme-primary);min-width:186px;display:none}.cbXT-q_menu-item{font-weight:700}.cbXT-q_menu-item:hover{background:var(--ui-black-transparent)}.cbXT-q_language-icon{vertical-align:middle;height:1.5rem}.cbXT-q_check-icon{margin-right:calc(var(--space) / 2);visibility:hidden;width:14px}.cbXT-q_check-icon.cbXT-q_checked{visibility:visible}.cbXT-q_divider{border-right:1px dashed var(--ui-black-transparent);height:34px;margin:0 .7rem}.cbXT-q_hoverable:not([disabled]):hover{cursor:pointer;background:var(--ui-black-transparent)}.cbXT-q_tutorials-icon{margin-right:.35rem}.cbXT-q_title-field{border:1px dashed var(--ui-black-transparent);border-radius:var(--form-radius);-webkit-border-radius:var(--form-radius);-moz-border-radius:var(--form-radius);background-color:var(--ui-white-transparent);height:auto;color:var(--ui-white);-webkit-background-clip:padding-box;background-clip:padding-box;padding:.5rem;font-size:.8rem;font-weight:700}.cbXT-q_title-field::placeholder{color:var(--ui-white);font-size:.8rem;font-style:italic;font-weight:400}.cbXT-q_title-field:hover{background-color:#ffffff80}.cbXT-q_title-field:focus{border:1px solid var(--ui-transparent);-webkit-box-shadow:0 0 0 calc(var(--space) * .5) var(--ui-white-transparent);box-shadow:0 0 0 calc(var(--space) * .5) var(--ui-white-transparent);background-color:var(--ui-white);color:var(--text-primary);outline:none}.cbXT-q_blank-check-item>div{padding-left:calc(14px + var(--space) / 2)}");var l={checked:"cbXT-q_checked",titleField:"cbXT-q_title-field",rightMenu:"cbXT-q_right-menu",blankCheckItem:"cbXT-q_blank-check-item",menu:"cbXT-q_menu",menuItem:"cbXT-q_menu-item",languageIcon:"cbXT-q_language-icon",languageLabel:"cbXT-q_language-label",checkIcon:"cbXT-q_check-icon",tutorialsIcon:"cbXT-q_tutorials-icon",growable:"cbXT-q_growable",electron:"cbXT-q_electron",menuBarItem:"cbXT-q_menu-bar-item",menuLabel:"cbXT-q_menu-label",mainMenu:"cbXT-q_main-menu",menuBar:"cbXT-q_menu-bar",divider:"cbXT-q_divider",hoverable:"cbXT-q_hoverable"};import{jsx as $,jsxs as g1,Fragment as ta}from"preact/jsx-runtime";var Y1=(e=!1)=>p1({message:$(re,{id:"gui.alert.saving",defaultMessage:"Saving project..."})},e),K1=(e,i=!1)=>p1({id:e,message:i?$(re,{id:"gui.alert.savedComputer",defaultMessage:"Saved to your computer."}):$(re,{id:"gui.alert.saved",defaultMessage:"Saved to local storage."})},2000),j1=(e,i=!1)=>p1({id:e,mode:"warn",message:i?$(re,{id:"gui.alert.saveAbortError",defaultMessage:"Abort saving."}):$(re,{id:"gui.alert.saveError",defaultMessage:"Failed save."})},i?1000:2000);function er({onNew:e,onOpen:i,onSave:r,onThumb:t,ExtendedMenu:o}){let{meta:a,key:n,name:u,files:p,assets:c}=Ki(),g=Ne(async()=>{await Yi(0);for(let P in a.value.monitors)if(a.value.monitors[P].deleting)a.value.monitors.splice(P,1);let m=[],s=p.value.map((P)=>{return m.push(P.extensions),Object.fromEntries(Object.entries(P).filter(([j,N])=>{if(["xmlDom","script","extensions"].includes(j))return!1;if(!a.value.manualCoding&&j==="content")return!1;return!0}))});if(a.value.manualCoding)m.push(Array.from(aa.keys()));let _=c.value?.filter((P)=>!P.uri),B=await r(s,_,a.value);return B.meta=Object.assign(B.meta??{},{editor:a.value.editor,version:a.value.version,monitors:a.value.monitors,extensions:Array.from(new Set(m.flat())).filter(Boolean),manualCoding:a.value.manualCoding,compactBlock:a.value.compactBlock,users:a.value.users}),B.name=u.value,B},[r]),L=Ne(async()=>{let m=Y1(),s=await g();s.key=n.value;let _=await Gi(s,t);Oi(()=>{if(s.key!==_)ea({key:_});ra(ia.Saved)}),K1(m)},[g]),h=Ne(async()=>{let m=Y1(J1?1000:!1),s=await g(),_=await Ji(s);if(J1)return;if(_.success)K1(m,!0);else if(_.error==="AbortError")j1(m,!0);else j1(m)},[g]),f=Ne(async()=>{let m=await Vi();await i(m)},[i]);return g1(ta,{children:[$(m1,{children:$(Ee,{className:l.menuItem,label:$(re,{id:"gui.menubar.file.newProject",defaultMessage:"New"}),hotkey:[u1?oe.COMMAND:oe.CONTROL,oe.N],onClick:e})}),g1(m1,{children:[$(Ee,{className:l.menuItem,label:$(re,{id:"gui.menubar.file.openProject",defaultMessage:"Open"}),hotkey:[u1?oe.COMMAND:oe.CONTROL,oe.O],onClick:ji}),$(Ee,{className:l.menuItem,label:$(re,{id:"gui.menubar.file.saveProject",defaultMessage:"Save"}),hotkey:[u1?oe.COMMAND:oe.CONTROL,oe.S],onClick:L})]}),g1(m1,{children:[$(Ee,{className:l.menuItem,label:$(re,{id:"gui.menubar.file.uploadProject",defaultMessage:"Load from your computer"}),onClick:f}),$(Ee,{className:l.menuItem,label:$(re,{id:"gui.menubar.file.downloadProject",defaultMessage:"save to your computer"}),onClick:h})]}),o&&$(o,{className:l.menu,itemClassName:l.menuItem,onOpen:i,onSave:g})]})}import{useCallback as Le,useEffect as oa}from"preact/hooks";import{batch as na,useSignal as rr,useComputed as ir}from"@preact/signals";import{isMac as ar,MathUtils as Oe,setCompactBlock as la,getCompactBlock as ca,getBlockSize as ua,setBlockSize as d1}from"@blockcode/utils";import{useAppContext as ma,useProjectContext as ga,Keys as le,setAppState as s1,setMeta as tr}from"@blockcode/core";import{BlocksDefaultOptions as pa}from"@blockcode/blocks";import{Text as ne,MenuSection as h1,MenuItem as de}from"@blockcode/core";import{jsx as D,jsxs as He,Fragment as da}from"preact/jsx-runtime";var Ze=pa.zoom.startScale,or=Oe.round(Ze+0.2,1),nr=Oe.round(Ze-0.2,1);function lr({enableCoding:e,enableBlockStyle:i,onUndo:r,onRedo:t,onEnableUndo:o,onEnableRedo:a,ExtendedMenu:n}){let{appState:u}=ma(),{meta:p,key:c,fileId:g,modified:L}=ga(),h=rr(!0),f=rr(!0),m=ir(()=>p.value.compactBlock??ca()),s=ir(()=>u.value?.blockSize??ua()??Ze);oa(()=>{na(()=>{h.value=!o(),f.value=!a()})},[c.value,g.value,L.value]);let _=Le(()=>{tr("manualCoding",!p.value.manualCoding)},[]),B=Le(()=>{let ee=!m.value;tr("compactBlock",ee),la(ee)},[]),P=Le(()=>{s1("blockSize",Ze),d1(s.value)},[]),j=Le(()=>{if(s.value<or){let ee=Oe.round(s.value+0.1,1);s1("blockSize",ee),d1(ee)}},[]),N=Le(()=>{if(s.value>nr){let ee=Oe.round(s.value-0.1,1);s1("blockSize",ee),d1(ee)}},[]);return He(da,{children:[He(h1,{children:[D(de,{disabled:h.value,className:l.menuItem,label:D(ne,{id:"gui.menubar.edit.undo",defaultMessage:"Undo"}),hotkey:[ar?le.COMMAND:le.CONTROL,le.Z],onClick:r}),D(de,{disabled:f.value,className:l.menuItem,label:D(ne,{id:"gui.menubar.edit.redo",defaultMessage:"Redo"}),hotkey:ar?[le.SHIFT,le.COMMAND,le.Z]:[le.CONTROL,le.Y],onClick:t})]}),i&&He(h1,{children:[D(de,{disabled:s.value===Ze,className:l.menuItem,label:D(ne,{id:"gui.menubar.edit.blockActual",defaultMessage:"Actual Size Blocks"}),onClick:P}),D(de,{disabled:s.value>=or,className:l.menuItem,label:D(ne,{id:"gui.menubar.edit.blockLarger",defaultMessage:"Larger Size Blocks"}),onClick:j}),D(de,{disabled:s.value<=nr,className:l.menuItem,label:D(ne,{id:"gui.menubar.edit.blockSmaller",defaultMessage:"Smaller Size Blocks"}),onClick:N})]}),(e||i)&&He(h1,{children:[i&&D(de,{className:l.menuItem,label:m.value!==!1?D(ne,{id:"gui.menubar.edit.closeCompactBlock",defaultMessage:"Turn off Compact Block"}):D(ne,{id:"gui.menubar.edit.openCompactBlock",defaultMessage:"Turn on Compact Block"}),onClick:B}),e&&D(de,{className:l.menuItem,label:p.value.manualCoding?D(ne,{id:"gui.menubar.edit.closeManualCoding",defaultMessage:"Turn off Coding Mode"}):D(ne,{id:"gui.menubar.edit.openManualCoding",defaultMessage:"Turn on Coding Mode"}),onClick:_})]}),n&&D(n,{className:l.menu,itemClassName:l.menuItem})]})}import{useEffect as Pl,useCallback as vr}from"preact/hooks";import{useComputed as $a,useSignal as Da}from"@preact/signals";import{classNames as Ge,getAutoDisplayPanel as Wa,setAutoDisplayPanel as xa}from"@blockcode/utils";import{useAppContext as Ia,useProjectContext as Sa,setAppState as Pa,Keys as ke,Text as Fe,MenuSection as kr,MenuItem as Ve}from"@blockcode/core";import{useCallback as f1}from"preact/hooks";import{useComputed as Ba}from"@preact/signals";import{keyMirror as qa,classNames as b1}from"@blockcode/utils";import{useAppContext as Ea,setAppState as La,setAlert as fr,logger as Za,Box as Qa,Button as v1,Text as se}from"@blockcode/core";import{useComputed as sa}from"@preact/signals";import{logger as ha,themeColors as cr}from"@blockcode/core";import{Terminal as fa}from"@blockcode/code";import{jsx as ba}from"preact/jsx-runtime";function ur(){let e=sa(()=>ha.logs.join(`\r
`));return ba(fa,{textValue:e.value,options:{theme:{cursor:"#fff",foreground:cr.ui.text.primary,background:"#fff",selection:cr.ui.text.primary}}})}import{Terminal as va}from"@blockcode/code";import{jsx as ka}from"preact/jsx-runtime";function mr(){return ka(va,{compactMode:!0})}y(".hPjAUa_button{--button-height:calc(var(--standard-font-size) * 2.4);padding:0 calc(var(--space) * 1.5);height:var(--button-height);border-radius:calc(var(--button-height) / 2);margin-left:var(--space);border-color:var(--blocks-tertiary);background:var(--blocks-secondary);color:var(--ui-white)}.hPjAUa_button .hPjAUa_icon{filter:brightness(100);width:16px;margin-right:4px}.hPjAUa_button:hover:not(:disabled):not(.hPjAUa_button-actived){background:var(--blocks-tertiary)}.hPjAUa_button-actived{background:var(--ui-white);color:var(--text-primary)}.hPjAUa_button-actived .hPjAUa_icon{filter:unset}");var ie={icon:"hPjAUa_icon",buttonActived:"hPjAUa_button-actived",button:"hPjAUa_button"};var gr="./assets/icon-logs-xymnjv7g.svg";var pr="./assets/icon-serial-xw0zbnx8.svg";var dr="./assets/icon-files-c1wm773z.svg";var sr="./assets/icon-copy-r0kx9k44.svg";var hr="./assets/icon-clean-vv72f5q7.svg";import{jsx as H,jsxs as Qe,Fragment as Fa}from"preact/jsx-runtime";var W=qa({Logs:null,Serial:null,Files:null});function br({panelId:e,onPanelChange:i,onClose:r}){let{menuItems:t}=Ea(),o=Ba(()=>t.value?.find((a)=>a.id==="view"));return Qe(Qa,{header:Qe(Fa,{children:[Qe(v1,{className:b1(ie.button,{[ie.buttonActived]:e===W.Logs}),onClick:f1(()=>i(W.Logs),[]),children:[H("img",{className:ie.icon,src:gr}),H(se,{id:"gui.panelBox.logs",defaultMessage:"Logs"})]}),Qe(v1,{className:b1(ie.button,{[ie.buttonActived]:e===W.Serial}),onClick:f1(()=>i(W.Serial),[]),children:[H("img",{className:ie.icon,src:pr}),H(se,{id:"gui.panelBox.serial",defaultMessage:"Serial"})]}),o.value?.options?.disabledFiles!==!0&&Qe(v1,{disabled:!0,className:b1(ie.button,{[ie.buttonActived]:e===W.Files}),onClick:f1(()=>i(W.Files),[]),children:[H("img",{className:ie.icon,src:dr}),H(se,{id:"gui.panelBox.files",defaultMessage:"Files"})]})]}),buttons:[e===W.Logs&&{icon:sr,label:H(se,{id:"gui.panelBox.logsCopy",defaultMessage:"Copy"}),async onClick(){let a=Za.logs.join(`\r
`);try{a=a.replace(/\x1B\[[0-?]*[ -/]*[@-~]/g,""),await navigator.clipboard.writeText(a),fr({type:"success",message:H(se,{id:"gui.alert.logsCopied",defaultMessage:"Logs copied to clipboard"})},2000)}catch(n){fr({type:"warn",message:H(se,{id:"gui.alert.logsCopyFailed",defaultMessage:"Failed to copy logs to clipboard"})},2000)}}},e===W.Serial&&{icon:hr,label:H(se,{id:"gui.panelBox.serialClean",defaultMessage:"Clean"}),onClick(){La("terminalCache",null)}}].filter(Boolean),onClose:r,children:[e===W.Logs&&H(ur,{}),e===W.Serial&&H(mr,{})]})}var ve="./assets/icon-check-f984n1c2.svg";import{jsx as G,jsxs as Ae,Fragment as Ua}from"preact/jsx-runtime";function Cr({enableFiles:e,ExtendedMenu:i}){let{appState:r}=Ia(),{meta:t}=Sa(),o=Da(Wa(t.value.editor)),a=$a(()=>r.value?.panelBoxId),n=vr((p)=>()=>{if(p===a.value)p=null;Pa("panelBoxId",p)},[]),u=vr(()=>{o.value=!o.value,xa(t.value.editor,o.value)},[]);return Ae(Ua,{children:[Ae(kr,{children:[Ae(Ve,{className:l.menuItem,hotkey:[ke.CONTROL,ke.D1],onClick:n(W.Logs),children:[G("img",{className:Ge(l.checkIcon,{[l.checked]:a.value===W.Logs}),src:ve}),G(Fe,{id:"gui.menubar.view.log",defaultMessage:"Log Panel"})]}),Ae(Ve,{className:l.menuItem,hotkey:[ke.CONTROL,ke.D2],onClick:n(W.Serial),children:[G("img",{className:Ge(l.checkIcon,{[l.checked]:a.value===W.Serial}),src:ve}),G(Fe,{id:"gui.menubar.view.serial",defaultMessage:"Serial Panel"})]}),e&&Ae(Ve,{disabled:!0,className:l.menuItem,hotkey:[ke.CONTROL,ke.D3],onClick:n(W.Files),children:[G("img",{className:Ge(l.checkIcon,{[l.checked]:a.value===W.Files}),src:ve}),G(Fe,{id:"gui.menubar.view.files",defaultMessage:"Files Panel"})]})]}),i&&G(i,{className:l.menu,itemClassName:l.menuItem}),G(kr,{children:G(Ve,{className:Ge(l.menuItem,l.blankCheckItem),label:o.value?G(Fe,{id:"gui.menubar.view.closeAutoDisplayPanel",defaultMessage:"Turn off auto display panel"}):G(Fe,{id:"gui.menubar.view.openAutoDisplayPanel",defaultMessage:"Turn on auto display panel"}),onClick:u})})]})}var wr="./assets/icon-file-egaz1kfx.svg";var _r="./assets/icon-edit-jejnm7yb.svg";var yr="./assets/icon-view-c3skbdpn.svg";import{jsx as Ce}from"preact/jsx-runtime";function Mr(e,i,r){let t=(c)=>r(c,i.editor),o=e.menuItems?.find((c)=>c.id==="file"),a=e.menuItems?.find((c)=>c.id==="edit"),n=e.menuItems?.find((c)=>c.id==="view"),u=Xa(i.editor)??n?.autoDisplayPanel===!0;Na(i.editor,u);let p=async()=>{let c=JSON.parse(JSON.stringify(await e.onNew()));if(!c.meta)c.meta=i;if(!c.meta.editor)c.meta.editor=i.editor,c.meta.version=i.version;t(c,i.editor)};return[{id:"file",icon:wr,label:Ce(k1,{id:"gui.menubar.file",defaultMessage:"File"}),Menu:()=>Ce(er,{ExtendedMenu:o?.Menu,onNew:p,onOpen:t,onSave:e.onSave,onThumb:e.onThumb}),options:o},{id:"edit",icon:_r,label:Ce(k1,{id:"gui.menubar.edit",defaultMessage:"Edit"}),Menu:()=>Ce(lr,{enableCoding:a?.disabledCoding!==!0,enableBlockStyle:a?.disabledBlockStyle!==!0,ExtendedMenu:a?.Menu,onUndo:e.onUndo,onRedo:e.onRedo,onEnableUndo:e.onEnableUndo,onEnableRedo:e.onEnableRedo}),options:a},n?.disabled!==!0&&{id:"view",icon:yr,label:Ce(k1,{id:"gui.menubar.view",defaultMessage:"View"}),Menu:()=>Ce(Cr,{enableFiles:n?.disabledFiles!==!0,ExtendedMenu:n?.Menu}),options:n}].concat(e.menuItems?.filter((c)=>!["file","edit","view"].includes(c.id))??[]).filter(Boolean)}import{Text as ge}from"@blockcode/core";import{classNames as Oa}from"@blockcode/utils";import{maybeTranslate as Ga,Button as qr}from"@blockcode/core";y(".lkaaPa_alerts-wrapper{width:100%;z-index:var(--z-index-alerts);top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute}.lkaaPa_alert-wrapper{pointer-events:all;background:var(--ui-light);border:1px solid var(--blocks-tertiary);min-width:200px;max-width:548px;min-height:1.5rem;box-shadow:0px 0px 0px 2px var(--ui-light);border-radius:.5rem;flex-direction:row;justify-content:flex-start;align-items:center;margin-bottom:7px;padding:.875rem 1rem;display:flex;overflow:hidden}.lkaaPa_warn{border:1px solid var(--error-primary)}.lkaaPa_icon{min-width:1.25rem;min-height:1.25rem;padding-right:1rem;display:flex}.lkaaPa_message{justify-content:flex-end;align-items:center;padding-right:.5rem;font-size:.8125rem;font-weight:700;line-height:.875rem;display:flex}.lkaaPa_warn .lkaaPa_message{color:var(--error-secondary)}.lkaaPa_success .lkaaPa_message{color:#555}.lkaaPa_buttons-group{align-items:center;display:flex}.lkaaPa_button{color:var(--ui-white);margin-left:var(--space);padding:var(--space) calc(var(--space) * 2.5);background:#ff8c1a;border:#ff8c1a}.lkaaPa_close-button{width:1.75rem;height:1.75rem;margin-left:calc(var(--space) * 2);background:#ff861433;border:0;border-radius:50%;padding:0;transition:all .15s ease-out;box-shadow:0 0 0 2px #ff861433}.lkaaPa_close-button:hover{transform:scale(1.1);box-shadow:0 0 0 4px #ff861433}.lkaaPa_close-button img{margin:0 auto}");var V={warn:"lkaaPa_warn",alertWrapper:"lkaaPa_alert-wrapper",icon:"lkaaPa_icon",alertsWrapper:"lkaaPa_alerts-wrapper",buttonsGroup:"lkaaPa_buttons-group",success:"lkaaPa_success",message:"lkaaPa_message",closeButton:"lkaaPa_close-button",button:"lkaaPa_button"};var Br="./assets/icon-close-bazpdng8.svg";import{jsx as we,jsxs as Er}from"preact/jsx-runtime";function Lr({mode:e,icon:i,message:r,options:t,button:o,onClose:a}){return Er("div",{className:Oa(V.alertWrapper,{[V.success]:e==="success",[V.warn]:e==="warn"}),children:[we("div",{className:V.icon,children:typeof i==="string"?we("img",{src:i}):i}),we("div",{className:V.message,children:Ga(r,t)}),Er("div",{className:V.buttonsGroup,children:[o&&we(qr,{className:V.button,onClick:o.onClick,children:o.label}),a&&we(qr,{className:V.closeButton,onClick:a,children:we("img",{src:Br})})]})]})}import{jsx as Zr}from"preact/jsx-runtime";function Qr({items:e}){return Zr("div",{className:V.alertsWrapper,children:e.map(({id:i,mode:r,icon:t,message:o,button:a,onClose:n,...u})=>Zr(Lr,{mode:r??"success",icon:t,message:o,options:u,button:a,onClose:n},i))})}import{useCallback as Ja}from"preact/hooks";import{useSignal as Ya}from"@preact/signals";import{classNames as Je}from"@blockcode/utils";import{Text as $e,Button as Ar,Modal as Ka}from"@blockcode/core";y(".Zq10BW_prompt-modal{width:480px}.Zq10BW_prompt-header{background:var(--blocks-primary)}.Zq10BW_prompt-content{background:var(--ui-white)}.Zq10BW_device-list{background:var(--theme-light-transparent);width:100%;height:170px;padding:.5rem;overflow-y:auto}.Zq10BW_device-search{justify-content:center;align-items:center;width:100%;height:100%;display:flex}.Zq10BW_device-search-icon{width:120px;height:120px}@keyframes Zq10BW_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.Zq10BW_device-searching-icon{animation:1.5s linear infinite Zq10BW_spin}.Zq10BW_device-item{background:var(--ui-white);border-radius:calc(var(--space) / 2);border:2px solid var(--ui-white);flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:50px;margin-bottom:.5rem;padding:10px;display:flex}.Zq10BW_device-item.Zq10BW_selected{border:2px solid var(--theme-primary)}.Zq10BW_device-name-bar{align-items:center;display:flex}.Zq10BW_device-image{width:40px;margin-right:.5rem}.Zq10BW_device-name-wrapper{flex-direction:column;justify-content:center;align-items:flex-start;display:flex}.Zq10BW_device-name-label{font-size:.625rem;font-weight:700}.Zq10BW_device-name-text{font-size:.875rem}.Zq10BW_button-row{text-align:right;text-align:center;padding:1.5rem 2.25rem;font-weight:bolder}.Zq10BW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.Zq10BW_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var A={okButton:"Zq10BW_ok-button",deviceSearchIcon:"Zq10BW_device-search-icon",deviceNameBar:"Zq10BW_device-name-bar",promptModal:"Zq10BW_prompt-modal",promptHeader:"Zq10BW_prompt-header",deviceImage:"Zq10BW_device-image",button:"Zq10BW_button",deviceSearch:"Zq10BW_device-search",selected:"Zq10BW_selected",buttonRow:"Zq10BW_button-row",spin:"Zq10BW_spin",deviceNameWrapper:"Zq10BW_device-name-wrapper",promptContent:"Zq10BW_prompt-content",deviceNameLabel:"Zq10BW_device-name-label",deviceList:"Zq10BW_device-list",deviceItem:"Zq10BW_device-item",deviceNameText:"Zq10BW_device-name-text",deviceSearchingIcon:"Zq10BW_device-searching-icon"};var Fr="./assets/searching-tt57cegv.png";import{jsx as I,jsxs as Ye}from"preact/jsx-runtime";function $r({title:e,icon:i,devices:r,onClose:t,onSearch:o,onConnect:a}){let n=Ya(""),u=Ja(()=>{if(!n.value)return;a(n.value),n.value=""},[a]);return I(Ka,{title:e??I($e,{id:"gui.connection.device",defaultMessage:"Device"}),className:A.promptModal,headerClassName:A.header,onClose:t,children:Ye("div",{className:A.promptContent,children:[I("div",{className:A.deviceList,children:Array.isArray(r)&&r.length>0?r.map((p)=>Ye("div",{className:Je(A.deviceItem,{[A.selected]:p.id===n.value}),onClick:()=>n.value=p.id,children:[Ye("div",{className:A.deviceNameBar,children:[i&&I("img",{}),Ye("div",{className:A.deviceNameWrapper,children:[I("div",{className:A.deviceNameLabel,children:I($e,{id:"gui.connection.deviceName",defaultMessage:"Device name"})}),I("div",{className:A.deviceNameText,children:p.name})]})]}),p.rssi&&I("div",{className:A.deviceSignalBar})]})):I("div",{className:A.deviceSearch,children:I("img",{className:Je(A.deviceSearchIcon,{[A.deviceSearchingIcon]:Array.isArray(r)}),src:Fr})})}),I("div",{className:A.buttonRow,children:r===!0?I(Ar,{className:Je(A.button,A.okButton),onClick:()=>o(),children:I($e,{id:"gui.connection.search",defaultMessage:"Start Searching"})}):I(Ar,{disabled:!n.value,className:Je(A.button,A.okButton),onClick:u,children:!n.value?I($e,{id:"gui.connection.searching",defaultMessage:"Searching"}):I($e,{id:"gui.connection.connect",defaultMessage:"Start Connecting"})})})]})})}import{useEffect as Jr,useCallback as xe}from"preact/hooks";import{batch as _t,useSignal as je,useSignalEffect as yt}from"@preact/signals";import{classNames as Ie,getProjectsThumbs as Mt,getProject as Bt,cloneProject as qt,renameProject as Et,delProject as Lt,openProjectFromURL as Zt,isElectron as Qt}from"@blockcode/utils";import{maybeTranslate as B1,setAlert as Ft,delAlert as At,openPromptModal as q1,openUserStorage as $t}from"@blockcode/core";import{balloons as ja,textBalloons as et,setUserConfig as rt,getUserConfig as it}from"@blockcode/utils";var Dr=["#FFEC37EE","#F89640EE","#3BC0F0EE","#B0CB47EE","#CF85B8EE","#DBF505EE","#1754D8EE","#FA4616EE","#06D718EE","#FF008DEE"];function Wr(){let e=new Date("2026-2-16 18:00:00 GMT+0800").getTime(),i=new Date("2026-2-23 23:59:59 GMT+0800").getTime(),r=new Date().getTime();if(r<e||r>i)return;if(it("EeggTriggered")||!1)return;rt("EeggTriggered",!0),ja(),et(["Happy","Chinese","New","Year!"].map((o)=>{let a=Math.floor(Math.random()*Dr.length);return{fontSize:140,text:o.toUpperCase(),color:Dr[a]}}))}var C1="1.3.6";import{Text as x,ContextMenu as Dt,LibraryItem as E1}from"@blockcode/core";import{useEffect as tt}from"preact/hooks";import{useSignal as ot}from"@preact/signals";import{classNames as xr}from"@blockcode/utils";import{Button as nt}from"@blockcode/core";y(".tyiNqW_cover-wrapper{width:100%;position:relative}.tyiNqW_cover{opacity:1;background-position:50%;background-repeat:no-repeat;background-size:cover;flex-direction:row;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 2rem;transition:opacity 1s;display:flex;position:absolute;top:0;left:0}.tyiNqW_cover.tyiNqW_hidden{opacity:0;pointer-events:none}.tyiNqW_title{color:#000;padding-right:1.5rem;font-size:2rem;font-weight:600}.tyiNqW_button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-top:calc(2 * var(--space));padding:.75rem 1rem;font-size:.85rem;font-weight:600}.tyiNqW_feature{max-height:90%;margin-right:5%}");var he={cover:"tyiNqW_cover",title:"tyiNqW_title",button:"tyiNqW_button",feature:"tyiNqW_feature",coverWrapper:"tyiNqW_cover-wrapper",hidden:"tyiNqW_hidden"};import{jsx as Ke,jsxs as Ir}from"preact/jsx-runtime";function Sr({pages:e,className:i}){let r=ot(0);return tt(()=>{setInterval(()=>r.value=(r.value+1)%e.length,7000)},[]),Ke("div",{className:xr(he.coverWrapper,i),children:e.map((t,o)=>Ir("div",{className:xr(he.cover,{[he.hidden]:o!==r.value}),style:{backgroundImage:`url(${t.backgroundImage})`},children:[Ir("div",{children:[Ke("div",{className:he.title,children:t.title}),Ke(nt,{className:he.button,onClick:t.onClick,children:t.buttonText})]}),Ke("img",{className:he.feature,src:t.featureImage})]},o))})}y("._9IQa7q_home-wrapper{background:var(--ui-secondary);top:var(--menu-bar-height);width:100%;height:calc(100% - var(--menu-bar-height));z-index:calc(var(--z-index-alerts) - 10);user-select:none;position:absolute;overflow:hidden auto}._9IQa7q_getting-started{height:240px;margin-bottom:1.5rem}._9IQa7q_link{cursor:pointer;color:var(--theme-primary)}._9IQa7q_view-all{font-weight:400;font-size:var(--standard-font-size);margin-left:1.5rem}._9IQa7q_delete-menu-item:hover{background:var(--error-primary)}._9IQa7q_footer{color:var(--text-primary);font-size:var(--small-font-size);padding:3.5rem 0 var(--space);text-align:center}._9IQa7q_footer-item{padding:0 var(--space)}._9IQa7q_footer-item:not(:first-child){border-left:1px solid var(--ui-black-transparent)}._9IQa7q_library-grid{background:var(--ui-secondary);flex-wrap:wrap;flex-grow:1;place-content:flex-start;align-items:flex-start;height:auto;padding:.5rem;display:flex;overflow-y:auto}._9IQa7q_library-label{color:var(--text-primary);padding:1.5rem calc(.5rem + var(--space)) .5rem;font-weight:800}._9IQa7q_about-version-content{width:300px}._9IQa7q_about-version-row{margin:var(--space) 0;justify-content:space-between;display:flex}");var q={link:"_9IQa7q_link",footerItem:"_9IQa7q_footer-item",homeWrapper:"_9IQa7q_home-wrapper",libraryGrid:"_9IQa7q_library-grid",gettingStarted:"_9IQa7q_getting-started",deleteMenuItem:"_9IQa7q_delete-menu-item",footer:"_9IQa7q_footer",libraryLabel:"_9IQa7q_library-label",viewAll:"_9IQa7q_view-all",aboutVersionContent:"_9IQa7q_about-version-content",aboutVersionRow:"_9IQa7q_about-version-row"};import{Text as Rr}from"@blockcode/core";var Pr="./assets/arcade-rd4cktbf.png";var Ur="./assets/arcade-bg-fajmd34e.jpg";import{jsx as zr}from"preact/jsx-runtime";function w1(e){return{title:zr(Rr,{id:"gui.home.slideshow.arcade.title",defaultMessage:"The Tank War is coming! Join us! NOW!"}),backgroundImage:Ur,featureImage:Pr,buttonText:zr(Rr,{id:"gui.home.slideshow.arcade.button",defaultMessage:"Play now"}),onClick:()=>e("@blockcode/gui-arcade")}}import{Text as Nr}from"@blockcode/core";var Tr="./assets/desktop-s3hfwbpz.png";var Xr="./assets/desktop-bg-pqrd17t9.jpg";import{jsx as Hr}from"preact/jsx-runtime";var Or={title:Hr(Nr,{id:"gui.home.slideshow.desktop.title",defaultMessage:"The desktop application is here!"}),backgroundImage:Xr,featureImage:Tr,buttonText:Hr(Nr,{id:"gui.home.slideshow.desktop.button",defaultMessage:"Download"}),onClick:()=>window.open("//app.blockcode.fun/#/?id=download")};function _1(e,i){return[Or,w1(e)]}async function y1(e){let i=await fetch("https://hub.blockcode.fun/home.json").then((r)=>r.json());return Promise.all(i.filter((r)=>r.editor?e.find((t)=>t.id===r.editor):!0).map(async(r)=>{let t=e.find((a)=>a.id===r.editor),o=await fetch(`https://hub.blockcode.fun/${r.import}`).then((a)=>a.json());return{name:t?.name,examples:o.filter((a)=>e.find((n)=>n.id===a.editor)).map((a)=>({...a,file:`https://hub.blockcode.fun/${a.file}`,thumb:`https://hub.blockcode.fun/${a.thumb}`}))}}))}function ae(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Gr(e,i){var r="",t=0,o=-1,a=0,n;for(var u=0;u<=e.length;++u){if(u<e.length)n=e.charCodeAt(u);else if(n===47)break;else n=47;if(n===47){if(o===u-1||a===1);else if(o!==u-1&&a===2){if(r.length<2||t!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var p=r.lastIndexOf("/");if(p!==r.length-1){if(p===-1)r="",t=0;else r=r.slice(0,p),t=r.length-1-r.lastIndexOf("/");o=u,a=0;continue}}else if(r.length===2||r.length===1){r="",t=0,o=u,a=0;continue}}if(i){if(r.length>0)r+="/..";else r="..";t=2}}else{if(r.length>0)r+="/"+e.slice(o+1,u);else r=e.slice(o+1,u);t=u-o-1}o=u,a=0}else if(n===46&&a!==-1)++a;else a=-1}return r}function gt(e,i){var r=i.dir||i.root,t=i.base||(i.name||"")+(i.ext||"");if(!r)return t;if(r===i.root)return r+t;return r+e+t}function De(){var e="",i=!1,r;for(var t=arguments.length-1;t>=-1&&!i;t--){var o;if(t>=0)o=arguments[t];else{if(r===void 0)r=process.cwd();o=r}if(ae(o),o.length===0)continue;e=o+"/"+e,i=o.charCodeAt(0)===47}if(e=Gr(e,!i),i)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function Vr(e){if(ae(e),e.length===0)return".";var i=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;if(e=Gr(e,!i),e.length===0&&!i)e=".";if(e.length>0&&r)e+="/";if(i)return"/"+e;return e}function pt(e){return ae(e),e.length>0&&e.charCodeAt(0)===47}function dt(){if(arguments.length===0)return".";var e;for(var i=0;i<arguments.length;++i){var r=arguments[i];if(ae(r),r.length>0)if(e===void 0)e=r;else e+="/"+r}if(e===void 0)return".";return Vr(e)}function st(e,i){if(ae(e),ae(i),e===i)return"";if(e=De(e),i=De(i),e===i)return"";var r=1;for(;r<e.length;++r)if(e.charCodeAt(r)!==47)break;var t=e.length,o=t-r,a=1;for(;a<i.length;++a)if(i.charCodeAt(a)!==47)break;var n=i.length,u=n-a,p=o<u?o:u,c=-1,g=0;for(;g<=p;++g){if(g===p){if(u>p){if(i.charCodeAt(a+g)===47)return i.slice(a+g+1);else if(g===0)return i.slice(a+g)}else if(o>p){if(e.charCodeAt(r+g)===47)c=g;else if(g===0)c=0}break}var L=e.charCodeAt(r+g),h=i.charCodeAt(a+g);if(L!==h)break;else if(L===47)c=g}var f="";for(g=r+c+1;g<=t;++g)if(g===t||e.charCodeAt(g)===47)if(f.length===0)f+="..";else f+="/..";if(f.length>0)return f+i.slice(a+c);else{if(a+=c,i.charCodeAt(a)===47)++a;return i.slice(a)}}function ht(e){return e}function M1(e){if(ae(e),e.length===0)return".";var i=e.charCodeAt(0),r=i===47,t=-1,o=!0;for(var a=e.length-1;a>=1;--a)if(i=e.charCodeAt(a),i===47){if(!o){t=a;break}}else o=!1;if(t===-1)return r?"/":".";if(r&&t===1)return"//";return e.slice(0,t)}function ft(e,i){if(i!==void 0&&typeof i!=="string")throw TypeError('"ext" argument must be a string');ae(e);var r=0,t=-1,o=!0,a;if(i!==void 0&&i.length>0&&i.length<=e.length){if(i.length===e.length&&i===e)return"";var n=i.length-1,u=-1;for(a=e.length-1;a>=0;--a){var p=e.charCodeAt(a);if(p===47){if(!o){r=a+1;break}}else{if(u===-1)o=!1,u=a+1;if(n>=0)if(p===i.charCodeAt(n)){if(--n===-1)t=a}else n=-1,t=u}}if(r===t)t=u;else if(t===-1)t=e.length;return e.slice(r,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!o){r=a+1;break}}else if(t===-1)o=!1,t=a+1;if(t===-1)return"";return e.slice(r,t)}}function bt(e){ae(e);var i=-1,r=0,t=-1,o=!0,a=0;for(var n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(u===47){if(!o){r=n+1;break}continue}if(t===-1)o=!1,t=n+1;if(u===46){if(i===-1)i=n;else if(a!==1)a=1}else if(i!==-1)a=-1}if(i===-1||t===-1||a===0||a===1&&i===t-1&&i===r+1)return"";return e.slice(i,t)}function vt(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return gt("/",e)}function kt(e){ae(e);var i={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return i;var r=e.charCodeAt(0),t=r===47,o;if(t)i.root="/",o=1;else o=0;var a=-1,n=0,u=-1,p=!0,c=e.length-1,g=0;for(;c>=o;--c){if(r=e.charCodeAt(c),r===47){if(!p){n=c+1;break}continue}if(u===-1)p=!1,u=c+1;if(r===46){if(a===-1)a=c;else if(g!==1)g=1}else if(a!==-1)g=-1}if(a===-1||u===-1||g===0||g===1&&a===u-1&&a===n+1){if(u!==-1)if(n===0&&t)i.base=i.name=e.slice(1,u);else i.base=i.name=e.slice(n,u)}else{if(n===0&&t)i.name=e.slice(1,a),i.base=e.slice(1,u);else i.name=e.slice(n,a),i.base=e.slice(n,u);i.ext=e.slice(a,u)}if(n>0)i.dir=e.slice(0,n-1);else if(t)i.dir="/";return i}var Ct="/",wt=":",u2=((e)=>(e.posix=e,e))({resolve:De,normalize:Vr,isAbsolute:pt,join:dt,relative:st,_makeLong:ht,dirname:M1,basename:ft,extname:bt,format:vt,parse:kt,sep:Ct,delimiter:wt,win32:null,posix:null});function We(){let e=window.electron?.getLocalEditors()??[];return Promise.all([].concat(Object.values(e).map(async(i)=>{let{default:r}=await import(i.info);return r.id=i.id,r.image=De(M1(i.info),r.image),r}),["@yeqin/gui-tankwar","@blockcode/gui-arcade2","@blockcode/gui-arcade","@microbit/gui-microbit","@blockcode/gui-esp32","@blockcode/gui-arduino","@blockcode/gui-writer","@emakefun/gui-iotbit","@blockcode/gui-matrix"].map(async(i)=>{let{default:r}=await import(`${i}/info`);return r.id=i,r})))}import{jsx as b,jsxs as R,Fragment as L1}from"preact/jsx-runtime";function Yr({onOpenEditor:e,onOpenProject:i}){let r=Math.floor((document.body.clientWidth-20)/176),t=Math.floor((document.body.clientWidth-20)/236)*2,o=je(null),a=je(0),n=je(null),u=je(null),p=xe(async()=>{let m=await Mt();_t(()=>{a.value=m.length,o.value=m.filter((s,_)=>_<r)})},[]);Jr(p,[]);let c=xe((m,s)=>{q1({title:b(x,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:b(x,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:B1(s??b(x,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(_)=>{if(_?.name)await Et(m,_.name),p()}})},[]),g=xe(async(m)=>{await qt(m),p()},[]),L=xe((m,s)=>{q1({title:b(x,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:b(x,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:B1(s||b(x,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await Lt(m),p()}})},[]),h=xe((m)=>async()=>{let s=await Bt(m);i(s)},[i]),f=()=>{return o.value?.map((m)=>b(Dt,{menuItems:[[{label:b(x,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>c(m.key,m.name)},{label:b(x,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>g(m.key)}],[{label:b(x,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:q.deleteMenuItem,onClick:()=>L(m.key,m.name)}]],children:b(E1,{id:m.key,name:m.name||b(x,{id:"gui.project.shortname",defaultMessage:"Untitled"}),image:m.thumb,onSelect:h(m.key)})},m.key))};return yt(async()=>{let m=await We();m=m.map((s)=>Object.assign(s,{beta:s.beta||!1,disabled:s.disabled||!1,onSelect:()=>e(s.id)})),m=m.filter((s)=>{if(s.hidden)return!1;return!0}),n.value=m.sort((s,_)=>s.sortIndex-_.sortIndex),u.value=await y1(m)}),Jr(Wr,[]),R("div",{className:q.homeWrapper,children:[!Qt&&b(Sr,{className:q.gettingStarted,pages:_1(e,i)}),o.value?.length>0&&R(L1,{children:[R("div",{className:q.libraryLabel,children:[b("span",{children:b(x,{id:"gui.home.my",defaultMessage:"My projects"})}),a.value>r&&b("span",{className:Ie(q.viewAll,q.link),onClick:$t,children:b(x,{id:"gui.home.allCounts",defaultMessage:"View all ({counts})",counts:a.value})})]}),b("div",{className:q.libraryGrid,children:b(f,{})})]}),n.value?.length>0&&R(L1,{children:[b("div",{className:q.libraryLabel,children:b(x,{id:"gui.home.new",defaultMessage:"Create new project"})}),b("div",{className:q.libraryGrid,children:n.value.map((m,s)=>b(E1,{featured:!0,id:s,disabled:m.disabled,beta:m.beta||m.preview,image:m.image,name:m.name,description:m.description,collaborator:m.collaborator,blocksRequired:m.blocksRequired,micropythonRequired:m.micropythonRequired,clangRequired:m.clangRequired,onSelect:m.onSelect},s))})]}),u.value?.map((m)=>m.examples.length>0&&R(L1,{children:[R("div",{className:q.libraryLabel,children:[b("span",{children:b(x,{id:"gui.home.examples",defaultMessage:"Wonderful {label} examples",label:B1(m.name)})}),m.examples.length>t&&b("span",{className:Ie(q.viewAll,q.link),children:b(x,{id:"gui.home.all",defaultMessage:"View all"})})]}),b("div",{className:q.libraryGrid,children:m.examples.map((s,_)=>b(E1,{large:!0,id:_,name:s.name,author:s.author,copyright:s.copyright,image:s.thumb,onSelect:async()=>{Ft("importing",{id:s.name});let B=await Zt(s.file);At(s.name),i(B)}}))})]})),R("div",{className:q.footer,children:[b("span",{className:Ie(q.footerItem,q.link),onClick:()=>window.open("https://lab.blockcode.fun/","_blank"),children:"BlockCode Lab"}),b("span",{className:Ie(q.footerItem,q.link),onClick:()=>window.open("https://github.com/BlockCodeLab/playgrounds-app","_blank"),children:"GitHub"}),R("span",{className:Ie(q.footerItem,q.link),onClick:()=>{q1({title:b(x,{id:"gui.about.title",defaultMessage:"About..."}),body:R("div",{className:q.aboutVersionContent,children:[R("div",{className:q.aboutVersionRow,children:[b("div",{children:b("b",{children:b(x,{id:"gui.about.main",defaultMessage:"Main program"})})}),R("div",{children:["v",C1]})]}),b("div",{className:q.aboutVersionRow}),n.value.filter((m)=>!m.disabled).map((m)=>R("div",{className:q.aboutVersionRow,children:[b("div",{children:b("b",{children:m.name})}),R("div",{children:["v",m.version]})]}))]})})},children:["v",C1]})]})]})}import{useComputed as ci}from"@preact/signals";import{useEffect as to}from"preact/hooks";import{classNames as z,isMac as oo}from"@blockcode/utils";import{useLocalesContext as no,useAppContext as lo,setLanguage as co,translate as ui,setMacosMenuBarStyled as uo}from"@blockcode/core";import{Menu as mi,MenuItem as mo,Tooltip as gi}from"@blockcode/core";import{cloneElement as Ut}from"preact";import{useMemo as Rt}from"preact/hooks";import{flatChildren as zt}from"@blockcode/utils";var Kr=Object.create(null),Z1=document.createElement("div"),jr=document.createElement("style");document.body.insertBefore(jr,document.body.firstChild);var Wt=(e)=>{return Z1.style="",Object.entries(e).forEach(([i,r])=>Z1.style[i]=r),Z1.style.cssText},xt=()=>{jr.textContent=Object.entries(Kr).map(([e,i])=>`${e}{${Wt(i)}}`).join(`
`)};function ce(e){Object.assign(Kr,e),xt()}import{Menu as Tt}from"@blockcode/core";import{useCallback as Q1}from"preact/hooks";import{classNames as It}from"@blockcode/utils";import{jsx as ei,jsxs as Pt,Fragment as St}from"preact/jsx-runtime";function Se({id:e,className:i,checked:r,children:t,name:o}){let a=Q1((p)=>{let c=()=>{p.target.checked=!1,document.removeEventListener("click",c)};document.addEventListener("click",c)},[]),n=Q1((p)=>{let c=p.getBoundingClientRect().left;ce({[`#${e}-menu-${o}`]:{left:`${c}px`}})},[e,o]),u=Q1((p)=>{if(p.target.classList.contains(l.menuLabel))n(p.target);else n(p.target.parentElement)},[]);return Pt(St,{children:[ei("input",{checked:r,className:l.menuLabel,id:`${e}-label-${o}`,name:`${e}-menu`,type:"radio",value:o,onChange:a}),ei("label",{className:It(l.menuLabel,i),for:`${e}-label-${o}`,onClick:u,children:t})]})}import{jsxs as Nt,Fragment as Xt}from"preact/jsx-runtime";function ri({id:e,children:i}){let r=Rt(()=>zt(i).map((t)=>t&&Ut(t,{id:e})),[e,i]);return Nt(Xt,{children:[r.filter((t)=>t.type===Se),r.filter((t)=>t.type===Tt).map((t)=>{let o=`${e}-label-${t.props.name}`,a=`${e}-menu-${t.props.name}`;return ce({[`#${o}:checked~#${a}`]:{display:"block"}}),t})]})}import{classNames as Ot}from"@blockcode/utils";import{Text as Gt}from"@blockcode/core";var e1="./assets/icon-tutorials-bh6n0ck2.svg";import{jsx as F1,jsxs as ii,Fragment as Vt}from"preact/jsx-runtime";function ai({onClick:e}){return ii(Vt,{children:[F1("div",{className:l.divider}),ii("div",{className:Ot(l.menuBarItem,l.menuLabel,l.hoverable),onClick:e,children:[F1("img",{className:l.tutorialsIcon,src:e1}),F1(Gt,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]})]})}import{useProjectContext as Jt,BufferedInput as Yt,renameProject as Kt}from"@blockcode/core";import{jsx as A1,jsxs as eo,Fragment as jt}from"preact/jsx-runtime";function ti({placeholder:e,defaultValue:i}){let{name:r}=Jt();return eo(jt,{children:[A1("div",{className:l.divider}),A1("div",{className:l.menuBarItem,children:A1(Yt,{className:l.titleField,placeholder:e,value:r.value||i,onSubmit:Kt})})]})}var oi="./assets/icon-language-3wan1389.svg";var ni="./assets/icon-dropdown-caret-y4j91xc6.svg";var li="./assets/icon-home-jt8mdkv3.svg";import{jsx as Z,jsxs as ue,Fragment as go}from"preact/jsx-runtime";function pi({className:e,showHomeButton:i,onRequestHome:r,onOpenTutorialLibrary:t}){let{language:o,languageNames:a}=no(),{barItems:n,menuItems:u,tutorials:p,macosMenuBarStyled:c}=lo(),g=ci(()=>n.value?.filter((h)=>h.align!=="right")),L=ci(()=>n.value?.filter((h)=>h.align==="right"));return to(()=>{window.electron?.onChangeFullscreen((h)=>uo(oo&&!h))},[]),ue("div",{className:z(l.menuBar,e),children:[ue("div",{className:z(l.mainMenu,{[l.electron]:c.value}),children:[ue(ri,{id:l.mainMenu,children:[ue(Se,{className:z(l.menuBarItem,l.languageLabel),name:"language-selector",children:[Z("img",{className:l.languageIcon,src:oi}),Z("img",{src:ni})]}),Z(mi,{className:l.menu,name:"language-selector",children:Array.from(a.entries()).map(([h,f])=>ue(mo,{className:l.menuItem,onClick:()=>co(h),children:[Z("img",{className:z(l.checkIcon,{[l.checked]:o.value===h}),src:ve}),f.languageName]},h))}),u.value&&u.value.map(({icon:h,label:f,Menu:m},s)=>ue(go,{children:[ue(Se,{className:l.menuBarItem,name:s,children:[typeof h==="string"?Z("img",{src:h}):h,Z("span",{children:f})]},s),Z(mi,{className:l.menu,name:s,children:Z(m,{className:l.menu,itemClassName:l.menuItem})},s)]}))]}),p.value&&Z(ai,{onClick:t}),i&&Z(ti,{placeholder:ui("gui.menubar.titlePlaceholder","Project title here"),defaultValue:ui("gui.project.name","BlockCode Project")}),g.value?.length>0&&g.value.map(({Label:h,...f})=>f.tooltip?Z(gi,{placement:f.tooltipPlacement??"bottom",content:f.tooltip,children:h?Z(h,{className:z(l.menuBarItem,l.menuLabel,l.hoverable)}):Z("label",{className:z(l.menuBarItem,l.menuLabel,l.hoverable),children:f.label})}):h?Z(h,{className:z(l.menuBarItem,l.menuLabel,l.hoverable)}):Z("label",{className:z(l.menuBarItem,l.menuLabel,l.hoverable),onClick:f.onClick,children:f.label}))]}),ue("div",{className:l.rightMenu,children:[L.value?.length>0&&L.value.map(({Label:h,...f})=>f.tooltip?Z(gi,{placement:f.tooltipPlacement??"bottom",content:f.tooltip,children:h?Z(h,{className:z(l.menuBarItem,l.menuLabel,l.hoverable)}):Z("label",{className:z(l.menuBarItem,l.menuLabel,l.hoverable),children:f.label})}):h?Z(h,{className:z(l.menuBarItem,l.menuLabel,l.hoverable)}):Z("label",{className:z(l.menuBarItem,l.menuLabel,l.hoverable),onClick:f.onClick,children:f.label})),i&&Z("label",{className:z(l.menuBarItem,l.menuLabel,l.hoverable),onClick:r,children:Z("img",{src:li})})]})]})}import{classNames as po}from"@blockcode/utils";y(".fflkNG_pane-wrapper{flex-direction:column;display:flex;position:relative}.fflkNG_pane{display:none}.fflkNG_pane-header{background:var(--ui-white);padding:calc(var(--space) / 2);text-align:center;color:var(--text-primary);cursor:pointer;border:1px solid var(--ui-black-transparent);border-radius:var(--space) var(--space) 0 0;flex:1;font-size:.85rem}.fflkNG_pane-left .fflkNG_pane-header{border-top-left-radius:0}.fflkNG_pane-right .fflkNG_pane-header{border-top-right-radius:0}.fflkNG_pane-content{border-left:1px solid var(--ui-black-transparent);border-right:1px solid var(--ui-black-transparent);min-height:5.5rem;display:none;position:relative}.fflkNG_pane-left .fflkNG_pane-content{border-left:0}.fflkNG_pane-right .fflkNG_pane-content{border-right:0}.fflkNG_pane:checked~.fflkNG_pane-content{display:flex}");var fe={pane:"fflkNG_pane",paneHeader:"fflkNG_pane-header",paneContent:"fflkNG_pane-content",paneWrapper:"fflkNG_pane-wrapper",paneLeft:"fflkNG_pane-left",paneRight:"fflkNG_pane-right"};import{jsx as $1,jsxs as so}from"preact/jsx-runtime";function di({className:e,id:i,title:r,left:t,right:o,children:a}){return so("div",{className:po(fe.paneWrapper,e,{[fe.paneLeft]:t,[fe.paneRight]:o}),children:[$1("input",{id:`${i}-pane`,type:"checkbox",className:fe.pane}),$1("label",{className:fe.paneHeader,for:`${i}-pane`,children:r}),$1("div",{className:fe.paneContent,children:a})]})}import{classNames as si}from"@blockcode/utils";import{maybeTranslate as ho,Text as D1,Button as W1,Modal as fo}from"@blockcode/core";y(".ulcaFG_prompt-modal{width:360px}.ulcaFG_prompt-modal.ulcaFG_wide{width:600px}.ulcaFG_prompt-modal.ulcaFG_auto{width:auto;max-width:60vw}.ulcaFG_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.ulcaFG_label{margin:0 0 1.5rem;font-weight:500}.ulcaFG_label.ulcaFG_input-label{margin-bottom:.75rem}.ulcaFG_content{font-size:var(--standard-font-size);color:var(--text-primary);max-height:400px;margin-bottom:1.5rem;overflow:auto}.ulcaFG_content a{color:var(--theme-primary);border-bottom:1px solid;text-decoration-line:none}.ulcaFG_text-input{border:1px solid var(--ui-black-transparent);width:100%;height:3rem;color:var(--text-primary);border-radius:5px;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.ulcaFG_button-row{text-align:right;font-weight:bolder}.ulcaFG_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.ulcaFG_ok-button{background:var(--theme-primary);border:var(--theme-primary);color:var(--ui-white);margin-left:var(--space)}");var E={wide:"ulcaFG_wide",promptModal:"ulcaFG_prompt-modal",okButton:"ulcaFG_ok-button",label:"ulcaFG_label",content:"ulcaFG_content",promptContent:"ulcaFG_prompt-content",auto:"ulcaFG_auto",inputLabel:"ulcaFG_input-label",button:"ulcaFG_button",textInput:"ulcaFG_text-input",buttonRow:"ulcaFG_button-row"};import{useCallback as bo}from"preact/hooks";import{jsx as J,jsxs as hi,Fragment as vo}from"preact/jsx-runtime";function fi({title:e,label:i,content:r,redStyle:t,children:o,onClose:a,onSubmit:n}){let u=bo(()=>{n(),a()},[a,n]);return J(fo,{title:e,redStyle:t,className:si(E.promptModal,{[E.wide]:r,[E.auto]:o}),onClose:a,children:hi("div",{className:E.promptContent,children:[i&&J("div",{className:E.label,children:i}),r?J("div",{className:E.content,dangerouslySetInnerHTML:{__html:ho(r)}}):J("div",{className:E.content,children:o}),J("div",{className:E.buttonRow,children:n?hi(vo,{children:[J(W1,{className:E.button,onClick:a,children:J(D1,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),J(W1,{className:si(E.button,E.okButton),onClick:u,children:J(D1,{id:"gui.prompt.ok",defaultMessage:"OK"})})]}):J(W1,{className:E.button,onClick:a,children:J(D1,{id:"gui.prompt.close",defaultMessage:"Close"})})})]})})}import{useCallback as x1,useEffect as ko}from"preact/hooks";import{useSignal as Co}from"@preact/signals";import{classNames as bi}from"@blockcode/utils";import{maybeTranslate as vi,Text as ki,BufferedInput as wo,Button as Ci,Modal as _o}from"@blockcode/core";import{jsx as me,jsxs as I1,Fragment as yo}from"preact/jsx-runtime";function wi({title:e,inputItems:i,content:r,onClose:t,onSubmit:o}){let a=Co(Object.fromEntries(i.map(({name:c,defaultValue:g})=>[c,g]))),n=x1((c)=>{if(c.stopPropagation(),c.key==="Escape")t()},[t]),u=x1(()=>{o(a.value),t()},[t,o]),p=x1((c)=>(g)=>{a.value={...a.value,[c]:g}},[]);return ko(()=>{return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),me(_o,{title:e,className:E.promptModal,onClose:t,children:I1("div",{className:E.promptContent,children:[i.map(({name:c,label:g,placeholder:L,defaultValue:h},f)=>I1(yo,{children:[g&&me("div",{className:bi(E.label,E.inputLabel),children:g}),me(wo,{autoFocus:f===0,className:E.textInput,placeholder:vi(L),defaultValue:h,onSubmit:p(c)},f)]})),r&&me("div",{className:E.content,dangerouslySetInnerHTML:{__html:vi(r)}}),I1("div",{className:E.buttonRow,children:[me(Ci,{className:E.button,onClick:t,children:me(ki,{id:"gui.prompt.cancel",defaultMessage:"Cancel"})}),me(Ci,{className:bi(E.button,E.okButton),onClick:u,children:me(ki,{id:"gui.prompt.ok",defaultMessage:"OK"})})]})]})})}import{classNames as Mo}from"@blockcode/utils";import{Text as S1,Spinner as Bo}from"@blockcode/core";y(".LkfKFW_splash{background:var(--theme-primary);z-index:var(--z-index-modal);flex-direction:column;justify-content:center;align-items:center;display:flex;position:absolute;inset:0}.LkfKFW_spinner{margin-bottom:calc(4 * var(--space))}.LkfKFW_error{background:var(--error-primary)}.LkfKFW_title{color:var(--ui-white);margin:var(--space);font-size:2rem}.LkfKFW_label{color:var(--ui-white);margin:var(--space)}");var _e={title:"LkfKFW_title",splash:"LkfKFW_splash",label:"LkfKFW_label",error:"LkfKFW_error",spinner:"LkfKFW_spinner"};import{jsx as ye,jsxs as qo}from"preact/jsx-runtime";function _i({error:e}){return qo("div",{className:Mo(_e.splash,{[_e.error]:e}),children:[!e&&ye(Bo,{large:!0,level:"info",className:_e.spinner}),ye("div",{className:_e.title,children:e?ye(S1,{id:"gui.splash.errorTitle",defaultMessage:"Error Occurred"}):ye(S1,{id:"gui.splash.loading",defaultMessage:"Loading project..."})}),ye("div",{className:_e.label,children:e&&ye(S1,{id:"gui.splash.errorLabel",defaultMessage:"Please refresh the page and reopen it."})})]})}import{cloneElement as Ao}from"preact";import{useMemo as $o}from"preact/hooks";import{classNames as Do,flatChildren as Wo}from"@blockcode/utils";import{classNames as Eo}from"@blockcode/utils";y(".M5TDuW_tabs-wrapper{white-space:nowrap;position:relative}.M5TDuW_tab-label{--line-height:calc(var(--tool-bar-height) * .8 - 2px);--margin-top:calc(var(--tool-bar-height) * .2 + 1px);font-weight:500;font-size:var(--standard-font-size);line-height:var(--line-height);border:1px solid var(--ui-black-transparent);background:var(--ui-tertiary);color:var(--text-transparent);margin-top:var(--margin-top);white-space:nowrap;border-radius:1rem 1rem 0 0;justify-content:center;padding:0 1.25rem;display:inline-flex;position:relative}.M5TDuW_tab-label.M5TDuW_disabled{filter:opacity(.5);cursor:default;pointer-events:none}.M5TDuW_tab-label:nth-of-type(n+2){margin-left:calc(-1 * var(--space))}.M5TDuW_tab-label:last-of-type{margin-right:var(--space)}.M5TDuW_tab-label:not(.M5TDuW_disabled):hover{cursor:pointer;background:var(--ui-primary)}.M5TDuW_tab-label img{filter:grayscale();width:1.375rem}.M5TDuW_tab{display:none}.M5TDuW_tab:checked+.M5TDuW_tab-label{--scale:var(--space) / 2;line-height:calc(var(--line-height) + var(--scale));margin-top:calc(var(--margin-top) - var(--scale));color:var(--theme-primary);background:var(--ui-white)}.M5TDuW_tab:checked+.M5TDuW_tab-label img{filter:none}.M5TDuW_tab-panel{top:var(--tool-bar-height);width:100%;height:calc(100% - var(--tool-bar-height));border:1px solid var(--ui-black-transparent);border-radius:0 var(--space) var(--space) var(--space);flex-direction:column;display:flex;position:absolute;bottom:0;transform:translateY(200%)}");var Y={tabsWrapper:"M5TDuW_tabs-wrapper",tabLabel:"M5TDuW_tab-label",tab:"M5TDuW_tab",tabPanel:"M5TDuW_tab-panel",disabled:"M5TDuW_disabled"};import{jsx as yi,jsxs as Zo,Fragment as Lo}from"preact/jsx-runtime";function r1({id:e,className:i,disabled:r,checked:t,children:o,name:a,onSelect:n}){return Zo(Lo,{children:[yi("input",{disabled:r,checked:t,className:Y.tab,id:`${e}-tab-${a}`,name:`${e}-tab`,type:"radio",value:a}),yi("label",{className:Eo(Y.tabLabel,i,{[Y.disabled]:r}),for:`${e}-tab-${a}`,onClick:n,children:o})]})}import{classNames as Qo}from"@blockcode/utils";import{jsx as Fo}from"preact/jsx-runtime";function i1({id:e,className:i,name:r,children:t}){return Fo("div",{className:Qo(Y.tabPanel,i),id:`${e}-panel-${r}`,children:t})}import{jsxs as xo}from"preact/jsx-runtime";function Mi({id:e,className:i,children:r}){let t=$o(()=>Wo(r).filter((o)=>o).map((o)=>Ao(o,{id:e})),[e,r]);return ce({[`.${Y.tab}:checked+.${Y.tabLabel}`]:{zIndex:`${t.length+1}`}}),xo("div",{className:Do(Y.tabsWrapper,i),children:[t.filter((o)=>o.type===r1).map((o,a,n)=>{return ce({[`.${Y.tabLabel}:nth-of-type(${a+1})`]:{zIndex:`${n.length-a}`}}),o}),t.filter((o)=>o.type===i1).map((o)=>{let a=`${e}-tab-${o.props.name}`,n=`${e}-panel-${o.props.name}`;return ce({[`#${a}:checked~#${n}`]:{transform:"none"}}),o})]})}import{useRef as Ro,useEffect as Li,useCallback as U1}from"preact/hooks";import{batch as zo,useComputed as To,useSignal as R1}from"@preact/signals";import{classNames as Xo}from"@blockcode/utils";import{useAppContext as No,Text as Me,Button as Ho}from"@blockcode/core";y("._4EOxpW_tutorial-box-wrapper{pointer-events:auto;z-index:var(--z-index-card);min-width:468px;position:absolute;bottom:10%;left:50%;transform:translate(-50%)}._4EOxpW_tutorial-card{border:1px solid var(--ui-tertiary);border-radius:calc(var(--space) * 1.8);cursor:move;box-shadow:0px 5px 25px 5px var(--ui-black-transparent);z-index:20;flex-direction:column;align-items:center;display:flex;overflow:hidden}._4EOxpW_card-header{background:var(--blocks-primary);width:100%;font-size:var(--small-font-size);flex-direction:row;justify-content:space-between;align-items:center;font-weight:700;display:flex}._4EOxpW_header-button-group{flex-direction:row;display:flex}._4EOxpW_header-button{cursor:pointer;color:#fff;flex-direction:column;justify-content:center;align-items:center;padding:.75rem;display:flex}._4EOxpW_header-button:hover{background:var(--ui-black-transparent)}._4EOxpW_button-icon{border:0;height:1.25rem}._4EOxpW_step-list{flex-direction:row;justify-content:center;align-items:center;display:flex}._4EOxpW_step-pip{cursor:pointer;background:var(--ui-white-transparent);border-radius:100%;width:.5rem;height:.5rem;margin:0 .25rem}._4EOxpW_step-pip._4EOxpW_actived{background:var(--ui-white);-webkit-box-shadow:0px 0px 0px 2px var(--ui-black-transparent);box-shadow:0px 0px 0px 2px var(--ui-black-transparent)}._4EOxpW_card-body{background:var(--ui-white);border-top:1px solid var(--blocks-tertiary);text-align:center;width:100%;min-height:256px;color:var(--text-primary);flex-direction:column;justify-content:center;align-items:center;display:flex;position:relative}._4EOxpW_title{text-align:center;margin:.9rem;font-size:1rem;font-weight:700}._4EOxpW_image{object-fit:contain;background:var(--ui-secondary);border:1px solid var(--ui-black-transparent);border-radius:var(--space);max-width:450px;max-height:200px;margin:0 var(--space) var(--space);pointer-events:none;overflow:hidden}._4EOxpW_text{max-width:450px;height:200px;margin:0 var(--space) 2.7rem var(--space);flex-direction:column;justify-content:center;font-size:.9rem;display:flex}._4EOxpW_image+._4EOxpW_text{height:auto}._4EOxpW_more{padding:0 .9rem var(--space);flex-direction:row;justify-content:space-around;display:flex}._4EOxpW_more-item{margin:0 var(--space) var(--space);cursor:pointer;border-radius:var(--space);border:1px solid #00000026;flex-direction:column;display:flex;overflow:hidden}._4EOxpW_more-item-image{object-fit:cover;pointer-events:none;width:200px;height:100px}._4EOxpW_more-item-name{color:var(--theme-primary);margin:calc(var(--space) * 1.2) 0px;text-align:center;text-align:center;max-width:200px;font-size:.85rem;font-weight:700}._4EOxpW_see-more-button{background:var(--theme-primary);color:var(--ui-white);border:0;margin-bottom:2.7rem}._4EOxpW_left-page,._4EOxpW_right-page{background:var(--ui-white);border:1px solid var(--ui-black-transparent);height:90%;width:calc(var(--space) * 1.8);opacity:.9;z-index:10;position:absolute;top:5%;overflow:hidden}._4EOxpW_left-page:after,._4EOxpW_right-page:after{content:\"\";background:var(--blocks-primary);width:100%;height:2.5rem;position:absolute;top:0;left:0}._4EOxpW_left-button,._4EOxpW_right-button{user-select:none;cursor:pointer;background:var(--blocks-primary);box-shadow:0 0 0 4px var(--blocks-transparent);z-index:30;border-radius:100%;justify-content:center;align-items:center;width:44px;height:44px;margin-top:-15px;transition:all .25s;display:flex;position:absolute;top:50%}._4EOxpW_left-button:hover,._4EOxpW_right-button:hover{box-shadow:0 0 0 6px var(--blocks-transparent);transform:scale(1.125)}._4EOxpW_left-button img,._4EOxpW_right-button img{width:1.75rem}._4EOxpW_left-page{border-top-left-radius:calc(var(--space) * 1.8);border-bottom-left-radius:calc(var(--space) * 1.8);border-right:0;left:0;transform:translate(-100%)}._4EOxpW_left-button{left:-27px}._4EOxpW_right-page{border-top-right-radius:calc(var(--space) * 1.8);border-bottom-right-radius:calc(var(--space) * 1.8);border-left:0;right:0;transform:translate(100%)}._4EOxpW_right-button{right:-27px}._4EOxpW_right-button img{transform:rotateY(180deg)}");var w={moreItem:"_4EOxpW_more-item",leftPage:"_4EOxpW_left-page",seeMoreButton:"_4EOxpW_see-more-button",headerButtonGroup:"_4EOxpW_header-button-group",title:"_4EOxpW_title",stepList:"_4EOxpW_step-list",moreItemName:"_4EOxpW_more-item-name",rightPage:"_4EOxpW_right-page",buttonIcon:"_4EOxpW_button-icon",cardBody:"_4EOxpW_card-body",headerButton:"_4EOxpW_header-button",image:"_4EOxpW_image",tutorialBoxWrapper:"_4EOxpW_tutorial-box-wrapper",cardHeader:"_4EOxpW_card-header",tutorialCard:"_4EOxpW_tutorial-card",text:"_4EOxpW_text",rightButton:"_4EOxpW_right-button",actived:"_4EOxpW_actived",moreItemImage:"_4EOxpW_more-item-image",leftButton:"_4EOxpW_left-button",stepPip:"_4EOxpW_step-pip",more:"_4EOxpW_more"};var Bi="./assets/icon-shrink-8vdqegra.svg";var qi="./assets/icon-expand-67bgdn61.svg";var Ei="./assets/icon-close-dy7x7fdb.svg";var P1="./assets/icon-arrow-ddhj68kd.svg";import{jsx as M,jsxs as T,Fragment as Pe}from"preact/jsx-runtime";function Zi({tutorialId:e,onOpenTutorial:i,onBack:r,onClose:t}){let o=Ro(),{tutorials:a}=No(),n=R1(null),u=R1(-1),p=R1(!0),c=To(()=>n.value?.[u.value]),g=U1(()=>{u.value=(u.value+1)%n.value.length},[]),L=U1(()=>{u.value=(u.value-1)%n.value.length},[]);return Li(()=>{let h=a.value.lessons[e];if(!h){t();return}zo(()=>{n.value=[].concat(h.pages,h.next?{next:h.next.filter((f)=>a.value.lessons[f]).map((f)=>({id:f,title:a.value.lessons[f].title,image:a.value.lessons[f].image}))}:[]),u.value=0})},[e]),Li(()=>{if(o.current){let h=o.current.parentElement,f,m,s=(B)=>{let P=f-B.clientX,j=m-B.clientY;f=B.clientX,m=B.clientY,h.style.top=`${h.offsetTop-j}px`,h.style.left=`${h.offsetLeft-P}px`,h.style.bottom="unset"},_=()=>{document.removeEventListener("pointerup",_),document.removeEventListener("pointermove",s)};o.current.addEventListener("pointerdown",(B)=>{f=B.clientX,m=B.clientY,s(B),document.addEventListener("pointerup",_),document.addEventListener("pointermove",s)})}},[]),T("div",{className:w.tutorialBoxWrapper,children:[T("div",{ref:o,className:w.tutorialCard,children:[T("div",{className:w.cardHeader,children:[T("div",{className:w.headerButton,onClick:r,children:[M("img",{className:w.buttonIcon,src:e1}),M(Me,{id:"gui.menubar.tutorials",defaultMessage:"Tutorials"})]}),M("div",{className:w.stepList,children:n.value?.map((h,f)=>M("div",{className:Xo(w.stepPip,{[w.actived]:f===u.value}),onClick:()=>u.value=f},f))}),T("div",{className:w.headerButtonGroup,children:[M("div",{className:w.headerButton,onClick:U1(()=>p.value=!p.value,[]),children:p.value?T(Pe,{children:[M("img",{className:w.buttonIcon,src:Bi}),M(Me,{id:"gui.tutorials.shrink",defaultMessage:"Shrink"})]}):T(Pe,{children:[M("img",{className:w.buttonIcon,src:qi}),M(Me,{id:"gui.tutorials.expand",defaultMessage:"Expand"})]})}),T("div",{className:w.headerButton,onClick:t,children:[M("img",{className:w.buttonIcon,src:Ei}),M(Me,{id:"gui.tutorials.close",defaultMessage:"Close"})]})]})]}),p.value&&c.value&&T("div",{className:w.cardBody,children:[(c.value.title||c.value.next)&&M("div",{className:w.title,children:c.value.title||M(Me,{id:"gui.tutorials.moreTry",defaultMessage:"More things to try!"})}),c.value.image&&M("img",{className:w.image,src:c.value.image}),c.value.text&&M("div",{className:w.text,children:c.value.text}),c.value.next&&T(Pe,{children:[M("div",{className:w.more,children:c.value.next.map((h)=>T("div",{className:w.moreItem,onClick:()=>i(h.id),children:[M("img",{className:w.moreItemImage,src:h.image}),M("div",{className:w.moreItemName,children:h.title})]},h.id))}),M(Ho,{className:w.seeMoreButton,onClick:r,children:M(Me,{id:"gui.tutorials.seeMore",defaultMessage:"See more"})})]})]})]}),p.value&&u.value>0&&T(Pe,{children:[M("div",{className:w.leftPage}),M("div",{className:w.leftButton,onClick:L,children:M("img",{src:P1})})]}),p.value&&n.value&&u.value<n.value.length-1&&T(Pe,{children:[M("div",{className:w.rightPage}),M("div",{className:w.rightButton,onClick:g,children:M("img",{src:P1})})]})]})}import{useComputed as Oo}from"@preact/signals";import{useAppContext as Go,Text as Vo,Library as Jo}from"@blockcode/core";import{jsx as Fi}from"preact/jsx-runtime";var Yo=Fi(Vo,{id:"gui.library.tutorials.tutorial",defaultMessage:"Choose a tutorial"});function Qi({onOpenTutorial:e,onClose:i}){let{tutorials:r}=Go(),t=Oo(()=>{return Object.entries(r.value.lessons).map(([a,n])=>({title:n.title,image:n.image,tags:n.tags,onSelect:()=>e(a)}))});return Fi(Jo,{featured:!0,items:t.value,title:r.value.title||Yo,filterable:r.value.tags,tags:r.value.tags,onClose:i})}import{useCallback as Ue,useEffect as Ko}from"preact/hooks";import{useComputed as jo,useSignal as en}from"@preact/signals";import{getProjectsThumbs as rn,getProject as an,cloneProject as tn,renameProject as on,delProject as nn}from"@blockcode/utils";import{useProjectContext as ln,closeUserStorage as $i,maybeTranslate as z1,openPromptModal as Di}from"@blockcode/core";import{Text as K,Library as cn}from"@blockcode/core";y(".mLGZyG_delete-menu-item:hover{background:var(--error-primary)}");var Ai={deleteMenuItem:"mLGZyG_delete-menu-item"};import{jsx as O}from"preact/jsx-runtime";var un=30;function Wi({onOpenProject:e}){let{meta:i}=ln(),r=en([]),t=jo(()=>r.value.length),o=Ue((c,g)=>{Di({title:O(K,{id:"gui.library.projects.rename",defaultMessage:"rename"}),inputItems:[{key:"name",label:O(K,{id:"gui.menubar.titlePlaceholder",defaultMessage:"Project title here"}),defaultValue:z1(g??O(K,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}],onSubmit:async(L)=>{if(L?.name)await on(c,L.name),p()}})},[]),a=Ue(async(c)=>{await tn(c),p()},[]),n=Ue((c,g)=>{Di({title:O(K,{id:"gui.library.projects.delete",defaultMessage:"delete"}),label:O(K,{id:"gui.library.projects.deleteConfirm",defaultMessage:'Delect "{name}" project?',name:z1(g||O(K,{id:"gui.project.shortname",defaultMessage:"Untitled"}))}),onSubmit:async()=>{await nn(c),p()}})},[]),u=Ue((c)=>async()=>{let g=await an(c);e(g),$i()},[]),p=Ue(async()=>{let c=await rn();if(i.value?.editor)c=c.filter((g)=>g.meta.editor===i.value.editor);c=c.sort((g,L)=>L.modifiedDate-g.modifiedDate),r.value=c.map((g)=>({name:z1(g.name??O(K,{id:"gui.project.shortname",defaultMessage:"Untitled"})),image:g.thumb,onSelect:u(g.key),contextMenu:[[{label:O(K,{id:"gui.library.projects.rename",defaultMessage:"rename"}),onClick:()=>o(g.key,g.name)},{label:O(K,{id:"gui.library.projects.duplicate",defaultMessage:"duplicate"}),onClick:()=>a(g.key)}],[{label:O(K,{id:"gui.library.projects.delete",defaultMessage:"delete"}),className:Ai.deleteMenuItem,onClick:()=>n(g.key,g.name)}]]}))},[u,o,n]);return Ko(()=>p(),[p]),O(cn,{items:r.value,filterable:t.value>un,emptyMessage:O(K,{id:"gui.library.projects.empty",defaultMessage:"No project!"}),onClose:$i})}y("._3HqakW_gui-wrapper{height:100%}._3HqakW_alerts-container{width:100%;z-index:var(--z-index-alerts);margin-top:calc(var(--menu-bar-height) + var(--space));pointer-events:none;justify-content:center;display:flex;position:absolute}._3HqakW_menu-bar-position{z-index:var(--z-index-menu-bar);position:relative}._3HqakW_body-wrapper{height:calc(100% - var(--menu-bar-height));background:var(--ui-primary)}._3HqakW_body-wrapper *{box-sizing:border-box}._3HqakW_workspace-wrapper{flex-direction:row;height:100%;display:flex;overflow-y:hidden}._3HqakW_sidebar-wrapper{margin:0 var(--space);display:flex;position:relative}._3HqakW_editor-wrapper{flex-direction:column;flex-grow:1;flex-shrink:0;display:flex;position:relative}._3HqakW_tabs-wrapper{flex-grow:1;position:relative}._3HqakW_tab-panel-no-left{border-bottom-left-radius:0}._3HqakW_tab-panel-no-right{border-top-right-radius:0;border-bottom-right-radius:0}._3HqakW_tab-panel-no-bottom{border-bottom-right-radius:0;border-bottom-left-radius:0}._3HqakW_pane-wrapper{margin:var(--space) 0 0 0;display:flex;position:relative}");var U={editorWrapper:"_3HqakW_editor-wrapper",tabsWrapper:"_3HqakW_tabs-wrapper",sidebarWrapper:"_3HqakW_sidebar-wrapper",tabPanelNoBottom:"_3HqakW_tab-panel-no-bottom",bodyWrapper:"_3HqakW_body-wrapper",workspaceWrapper:"_3HqakW_workspace-wrapper",menuBarPosition:"_3HqakW_menu-bar-position",tabPanelNoLeft:"_3HqakW_tab-panel-no-left",alertsContainer:"_3HqakW_alerts-container",guiWrapper:"_3HqakW_gui-wrapper",tabPanelNoRight:"_3HqakW_tab-panel-no-right",paneWrapper:"_3HqakW_pane-wrapper"};import{jsx as k,jsxs as Te,Fragment as Pi}from"preact/jsx-runtime";var Be=dn({Bluetooth:null,SerialPort:null});function Ui(){let[e]=mn(),{language:i}=bn(),r=fn();a1(()=>{document.title=kn("gui.name","BlockCode Playgrounds"),document.title+=" [BETA]"},[i.value]);let t=T1(()=>{return{editorId:window.location.hash.replace(/^#\//,"").split("?")[0]}}),o=T1(()=>{let d={};return r.docks.value?.forEach((v)=>{if(v.expand==="bottom")d.paneLabel=v.label,d.PaneContent=v.Content;else if(v.expand==="left")d.LeftDockContent=v.Content;else d.RightDockContent=v.Content}),d}),{LeftDockContent:a,RightDockContent:n,PaneContent:u}=o.value,p=pn({[U.tabPanelNoLeft]:!a,[U.tabPanelNoRight]:!n,[U.tabPanelNoBottom]:!u}),c=t1(null);a1(()=>{if(X1)window.electron.serial.onScan((d)=>{c.value=d&&{devices:d,type:Be.SerialPort}}),window.electron.bluetooth.onScan((d)=>{c.value=d&&{devices:d,type:Be.Bluetooth}})},[]);let g=()=>{},L=X(()=>{if(X1){if(c.value.type===Be.SerialPort)window.electron.serial.cancel();if(c.value.type===Be.Bluetooth)window.electron.bluetooth.cancel();c.value=null}},[]),h=X((d)=>{if(X1){if(c.value.type===Be.SerialPort)window.electron.serial.connect(d);if(c.value.type===Be.Bluetooth)window.electron.bluetooth.connect(d)}},[]),f=t1({});gn(async()=>{let d=await We();d=d.map((v)=>[v.id,{name:v.name,version:v.version}]),f.value=Object.fromEntries(d)});let m=X(()=>{be(()=>{r.appState.value?.device?.disconnect(),ze("device",null),Bn(),yn()})},[]),s=X((d)=>{be(()=>{xi(),Mn(Object.assign(JSON.parse(JSON.stringify(d)),{fileId:d.fileId??d.files?.[0]?.id})),Si(0)})},[]),_=t1(!1),B=t1(null),P=X(()=>{be(()=>{B.value=null,_.value=!0})},[]),j=X((d)=>{let v=r.tutorials.value.lessons[d];if(!v)return;let S=typeof v.project==="function"?v.project(N.value):v.project;if(S){let qe=async()=>{qn("importing",{id:d});let te=await sn(S);En(d),s(te),be(()=>{B.value=d,_.value=!1})};if(o1.value)Re({title:k(ge,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:k(ge,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:qe});else qe()}else be(()=>{B.value=d,_.value=!1})},[]),{meta:N,key:ee,modified:o1}=vn(),N1=T1(()=>!N.value),Ri=X(()=>{if(B.value=null,o1.value)Re({title:k(ge,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:k(ge,{id:"gui.library.projects.close",defaultMessage:"Close current project?"}),onSubmit:m});else m()},[]),n1=X((d,v)=>{if(v!==d.meta.editor){Re({label:k(ge,{id:"gui.library.projects.errorEditor",defaultMessage:'This project is not currently editor creation, please switch to "{editor}" and open it.',editor:Cn(f.value[d.meta.editor]?.name)}),redStyle:!0});return}if(ee.value===d.key)return;if(o1.value)Re({title:k(ge,{id:"gui.library.projects.notSaved",defaultMessage:"Not saved"}),label:k(ge,{id:"gui.library.projects.replace",defaultMessage:"Replace contents of the current project?"}),onSubmit:()=>s(d)});else s(d)},[]),l1=X(async(d,v)=>{be(()=>{m(),xi()});let S=d,qe=window.electron?.getLocalEditors();if(qe?.[d]?.main)S=qe[d].main;let te;try{if(d!==t.value.editorId)window.location.hash="";te=(await import(S)).default}catch($n){Re({label:k(ge,{id:"gui.library.projects.notFoundEditor",defaultMessage:'Not Found the "{editor}" Editor.',editor:d}),redStyle:!0}),wn();return}let c1={editor:d,version:f.value[d]?.version};if(!v)v=JSON.parse(JSON.stringify(await te.onNew()));if(!v.meta)v.meta=c1;if(!v.meta.editor)v.meta.editor=d,v.meta.version=c1.version;let zi={menuItems:Mr(te,c1,n1),barItems:te.barItems,tabs:te.tabs,docks:te.docks,tutorials:window.electron?.getLocalTutorials(d,i.value)??te.tutorials};be(()=>{_n(zi),n1(v,d)})},[]),H1=X((d)=>{if(N.value?.editor!==d.meta.editor){m(),l1(d.meta.editor,d);return}n1(d,N.value.editor)},[]);return a1(()=>{if(N.value?.editor){if(hn(N.value.editor))ze("panelBoxId","Logs")}else ze("panelBoxId",null)},[N.value?.editor]),a1(()=>{if(t.value.editorId)l1(t.value.editorId)},[]),Te(Pi,{children:[(r.splashVisible.value||e)&&k(_i,{error:e}),k(Qr,{items:r.alerts.value}),k(pi,{className:U.menuBarPosition,showHomeButton:!N1.value,onRequestHome:Ri,onOpenTutorialLibrary:P}),k("div",{className:U.bodyWrapper,children:Te("div",{className:U.workspaceWrapper,children:[a&&k("div",{className:U.sidebarWrapper,children:k(a,{})}),Te("div",{className:U.editorWrapper,children:[k(Mi,{id:U.tabsWrapper,className:U.tabsWrapper,children:r.tabs.value?.map(({Content:d,...v},S)=>Te(Pi,{children:[Te(r1,{name:S,disabled:v.disabled,checked:S===r.tabIndex.value,onSelect:()=>Si(S),children:[k("img",{src:v.icon}),v.label]},S),k(i1,{name:S,className:p,children:(S===0||r.tabIndex.value===S)&&d&&k(d,{})},S)]}))}),u&&k(di,{id:U.paneWrapper,className:U.paneWrapper,title:o.value.paneLabel,right:!n,left:!a,children:k(u,{})})]}),n&&k("div",{className:U.sidebarWrapper,children:k(n,{})})]})}),r.appState.value?.panelBoxId&&k(br,{panelId:r.appState.value.panelBoxId,onPanelChange:X((d)=>ze("panelBoxId",d),[]),onClose:X(()=>ze("panelBoxId",null),[])}),c.value&&k($r,{title:N.value.deviceName,icon:N.value.deviceIcon,devices:c.value.devices,onClose:L,onConnect:h}),B.value&&k(Zi,{tutorialId:B.value,onOpenTutorial:j,onBack:P,onClose:()=>B.value=null}),_.value&&k(Qi,{onOpenTutorial:j,onClose:X(()=>_.value=!1,[])}),N1.value&&k(Yr,{onOpenEditor:l1,onOpenProject:H1}),r.userStorageVisible.value&&k(Wi,{onOpenProject:H1}),r.prompt.value&&(r.prompt.value.inputItems?k(wi,{title:r.prompt.value.title,content:r.prompt.value.content,inputItems:r.prompt.value.inputItems,onClose:Ii,onSubmit:r.prompt.value.onSubmit}):k(fi,{title:r.prompt.value.title,label:r.prompt.value.label,content:r.prompt.value.content,redStyle:r.prompt.value.redStyle,onClose:Ii,onSubmit:r.prompt.value.onSubmit,children:r.prompt.value.body}))]})}import{addAlertConfig as Q,Text as F,Spinner as pe}from"@blockcode/core";import{jsx as C}from"preact/jsx-runtime";Q("importing",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.importing",defaultMessage:"Importing..."})});Q("importError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.importError",defaultMessage:"Failed import."})});Q("exporting",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.exporting",defaultMessage:"Exporting..."})});Q("exportCompleted",{icon:null,message:C(F,{id:"gui.alert.exportCompleted",defaultMessage:"Export completed."})});Q("exportAbortError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.exportAbortError",defaultMessage:"Abort exporting."})});Q("exportError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.exportError",defaultMessage:"Failed export."})});Q("downloading",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.downloading",defaultMessage:"Downloading...{progress}%"})});Q("downloadCompleted",{icon:null,message:C(F,{id:"gui.alert.downloadCompleted",defaultMessage:"Download completed."})});Q("downloadError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.downloadError",defaultMessage:"Download failed."})});Q("connecting",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.connecting",defaultMessage:"Connecting..."})});Q("connected",{icon:null,message:C(F,{id:"gui.alert.connected",defaultMessage:"Connected."})});Q("connectionCancel",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.connectionCancel",defaultMessage:"Connection cancel."})});Q("connectionBusy",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.connectionBusy",defaultMessage:"Device not respond."})});Q("connectionError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.connectionError",defaultMessage:"Connection error or connection was lost."})});Q("erasing",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.erasing",defaultMessage:"Erasing..."})});Q("restoring",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.restoring",defaultMessage:"Firmware restoring...{progress}%"})});Q("recovering",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.recovering",defaultMessage:"Recovering..."})});Q("restoreCompleted",{icon:null,message:C(F,{id:"gui.alert.restoreCompleted",defaultMessage:"Firmware resotre completed! Now press RESET key"})});Q("compiling",{icon:C(pe,{level:"success"}),message:C(F,{id:"gui.alert.compiling",defaultMessage:"Compiling..."})});Q("compileCompleted",{icon:null,message:C(F,{id:"gui.alert.compileCompleted",defaultMessage:"Compilation completed."})});Q("compileError",{icon:null,mode:"warn",message:C(F,{id:"gui.alert.compileError",defaultMessage:"Compilation error."})});Q("reseting",{icon:null,message:C(F,{id:"gui.alert.reseting",defaultMessage:"Reseting..."})});import{jsx as Xe}from"preact/jsx-runtime";function An(){return Xe(Zn,{children:Xe(Qn,{children:Xe(Fn,{children:Xe(Ui,{})})})})}Ln(Xe(An,{}),document.getElementById("root"));
