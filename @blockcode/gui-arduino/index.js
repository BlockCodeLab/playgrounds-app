import{addLocalesMessages as Vt}from"@blockcode/core";var j={"arduino.menubar.device":"Arduino","arduino.menubar.device.uno":"Arduino Uno","arduino.menubar.device.unoR4":"Arduino Uno R4","arduino.menubar.device.nano":"Arduino Nano","arduino.menubar.device.bleuno":"BLE-UNO/NANO","arduino.menubar.device.download":"Download program via USB","arduino.menubar.device.downloadBle":"Download program via Bluetooth","arduino.menubar.edit.classicEventsOpen":"Turn on Classic Event Blocks","arduino.menubar.edit.classicEventsClose":"Turn off Classic Event Blocks","arduino.extension.tags.controllers":"Controllers","arduino.extension.tags.sensors":"Sensors","arduino.extension.tags.actuators":"Actuators","arduino.extension.tags.displays":"Displays","arduino.extension.tags.modules":"Modules","arduino.extension.tags.kits":"Kits","arduino.blocks.classicEventsLabel":"Classic events turned on from Edit.","arduino.blocks.displayMatrix":"display %1","arduino.blocks.clearDisplay":"clear display","arduino.blocks.wait":"wait %1 milliseconds","arduino.blocks.break":"break","arduino.blocks.continue":"continue","arduino.blocks.elseif":"else if %1 then","arduino.blocks.else":"else","arduino.blocks.runtime":"run time %1","arduino.blocks.runtimeMilliseconds":"milliseconds","arduino.blocks.runtimeSeconds":"seconds","arduino.blocks.dataConvert":"convert %1 to %2","arduino.blocks.dataLengthOf":"length of %1","arduino.blocks.dataConstrain":"constrain %1 between %2 to %3","arduino.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","arduino.blocks.whensetup":"when Arduino setup","arduino.blocks.whenloop":"when Arduino loop","arduino.blocks.whentimer":"when timer per %1 milliseconds","arduino.blocks.timeron":"start timer","arduino.blocks.timeroff":"stop timer","arduino.blocks.operatorLarger":"larger of %1 and %2","arduino.blocks.operatorSmaller":"smaller of %1 and %2","arduino.blocks.pin":"Pins","arduino.blocks.setmode":"set pin %1 mode to %2","arduino.blocks.inputMode":"input","arduino.blocks.ouputMode":"output","arduino.blocks.inputPullUpMode":"input pull-up","arduino.blocks.setdigital":"set digital pin %1 to %2","arduino.blocks.digitalHigh":"high","arduino.blocks.digitalLow":"low","arduino.blocks.setanalog":"set pwm pin %1 to %2","arduino.blocks.isDigitalHigh":"digital pin %1 is high?","arduino.blocks.analogValue":"analog pin %1","arduino.blocks.attachinterrupt":"attach pin %1 interrupt to %2","arduino.blocks.interruptRising":"rising","arduino.blocks.interruptFalling":"falling","arduino.blocks.interruptChange":"change","arduino.blocks.interruptHigh":"high","arduino.blocks.interruptLow":"low","arduino.blocks.detachinterrupt":"detach pin %1 interrupt","arduino.blocks.protocols":"Protocols","arduino.blocks.serial":"Serial","arduino.blocks.serialBaudrate":"set baudrate to %1","arduino.blocks.serialTimeout":"set timeout to %1 milliseconds","arduino.blocks.serialPrint":"print %1 with %2","arduino.blocks.serialPrintWarp":"warp","arduino.blocks.serialPrintNoWarp":"no-warp","arduino.blocks.serialPrintHEX":"hex","arduino.blocks.serialPrintNumber":"print %1","arduino.blocks.serialAvailable":"available data?","arduino.blocks.serialAvailableLength":"available data length","arduino.blocks.serialReadString":"read a string","arduino.blocks.serialReadStringUntil":"read a string until %1","arduino.blocks.serialReadParse":"read a %1 number","arduino.blocks.serialReadParseInteger":"int","arduino.blocks.serialReadParseFloat":"float","arduino.blocks.serialRead":"read a byte","arduino.blocks.serialReadBytes":"read %1 bytes","arduino.blocks.text":"Text","arduino.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","arduino.blocks.textRemove":"remove letters from %1 to %2 of %3","arduino.blocks.textReplace":"replace %1 of %2 with %3","arduino.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","arduino.blocks.textSubstring":"substring of %1 from %2 to %3","arduino.blocks.textWith":"%1 %2 with %3?","arduino.blocks.textStartsWith":"starts","arduino.blocks.textEndsWith":"ends","arduino.blocks.textCase":"get %1 of %2","arduino.blocks.textLowerCase":"lower-case","arduino.blocks.textUpperCase":"upper-case","arduino.blocks.textTrim":"remove %1 leading and trailing whitespace","arduino.blocks.textConvert":"convert %1 to %2","arduino.blocks.textConvertFrom":"convert %1 to String"};var tt={"arduino.menubar.device":"Arduino","arduino.menubar.device.uno":"Arduino Uno","arduino.menubar.device.unoR4":"Arduino Uno R4","arduino.menubar.device.nano":"Arduino Nano","arduino.menubar.device.bleuno":"BLE-UNO/NANO","arduino.menubar.device.download":"通过 USB 下载程序","arduino.menubar.device.downloadBle":"通过蓝牙下载程序","arduino.menubar.edit.classicEventsOpen":"打开经典事件积木","arduino.menubar.edit.classicEventsClose":"关闭经典事件积木","arduino.extension.tags.controllers":"控制器","arduino.extension.tags.sensors":"传感器","arduino.extension.tags.actuators":"执行器","arduino.extension.tags.displays":"显示器","arduino.extension.tags.modules":"智能模块","arduino.extension.tags.kits":"套件","arduino.blocks.classicEventsLabel":"经典事件积木请从“编辑”菜单开启。","arduino.blocks.displayMatrix":"显示 %1","arduino.blocks.clearDisplay":"清除显示","arduino.blocks.wait":"等待 %1 毫秒","arduino.blocks.break":"跳出重复执行","arduino.blocks.continue":"跳到下一次执行","arduino.blocks.elseif":"否则，如果 %1 那么","arduino.blocks.else":"否则","arduino.blocks.runtime":"运行时长 %1","arduino.blocks.runtimeMilliseconds":"毫秒","arduino.blocks.runtimeSeconds":"秒","arduino.blocks.dataConvert":"将 %1 类型转为 %2","arduino.blocks.dataLengthOf":"%1 长度","arduino.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","arduino.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","arduino.blocks.whensetup":"当 Arduino 启动","arduino.blocks.whenloop":"当 Arduino 循环运行","arduino.blocks.whentimer":"当定时器每间隔 %1 毫秒","arduino.blocks.timeron":"开启定时器","arduino.blocks.timeroff":"关闭定时器","arduino.blocks.operatorLarger":"%1 和 %2 之中最大","arduino.blocks.operatorSmaller":"%1 和 %2 之中最小","arduino.blocks.pin":"引脚","arduino.blocks.setmode":"将引脚 %1 设为 %2 模式","arduino.blocks.inputMode":"输入","arduino.blocks.ouputMode":"输出","arduino.blocks.inputPullUpMode":"上拉输入","arduino.blocks.setdigital":"将数字引脚 %1 设为 %2","arduino.blocks.digitalHigh":"高电平","arduino.blocks.digitalLow":"低电平","arduino.blocks.setanalog":"将 PWM 引脚 %1 设为 %2","arduino.blocks.isDigitalHigh":"数字引脚 %1 是高电平？","arduino.blocks.analogValue":"模拟引脚 %1","arduino.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","arduino.blocks.interruptRising":"电平上升","arduino.blocks.interruptFalling":"电平下降","arduino.blocks.interruptChange":"电平改变","arduino.blocks.interruptHigh":"高电平","arduino.blocks.interruptLow":"低电平","arduino.blocks.detachinterrupt":"取消引脚 %1 中断","arduino.blocks.protocols":"数据协议","arduino.blocks.serial":"串口","arduino.blocks.serialBaudrate":"将波特率设为 %1","arduino.blocks.serialTimeout":"将超时设为 %1 毫秒","arduino.blocks.serialPrint":"用 %2 模式打印 %1","arduino.blocks.serialPrintWarp":"换行","arduino.blocks.serialPrintNoWarp":"不换行","arduino.blocks.serialPrintHEX":"16进制","arduino.blocks.serialPrintNumber":"打印 %1","arduino.blocks.serialAvailable":"存在可读取数据?","arduino.blocks.serialAvailableLength":"可读取数据长度","arduino.blocks.serialReadString":"读取文本","arduino.blocks.serialReadStringUntil":"读取文本直到 %1","arduino.blocks.serialReadParse":"读取 %1","arduino.blocks.serialReadParseInteger":"整数","arduino.blocks.serialReadParseFloat":"浮点数","arduino.blocks.serialRead":"读取 1 个字节","arduino.blocks.serialReadBytes":"读取 %1 个字节","arduino.blocks.text":"文本","arduino.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","arduino.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","arduino.blocks.textReplace":"将 %2 中的 %1 替换为 %3","arduino.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","arduino.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","arduino.blocks.textWith":"%1 %2 %3?","arduino.blocks.textStartsWith":"开始于","arduino.blocks.textEndsWith":"结束于","arduino.blocks.textCase":"将 %2 字母转为 %1","arduino.blocks.textLowerCase":"小写","arduino.blocks.textUpperCase":"大写","arduino.blocks.textTrim":"清除 %1 前后空白字符","arduino.blocks.textConvert":"将 %1 转为 %2","arduino.blocks.textConvertFrom":"将 %1 转为文本"};var et={"arduino.menubar.device":"Arduino","arduino.menubar.device.uno":"Arduino Uno","arduino.menubar.device.unoR4":"Arduino Uno R4","arduino.menubar.device.nano":"Arduino Nano","arduino.menubar.device.bleuno":"BLE-UNO/NANO","arduino.menubar.device.download":"通過 USB 下載程式","arduino.menubar.device.downloadBle":"通過藍牙下載程式","arduino.menubar.edit.classicEventsOpen":"開啟舊樣式事件積木","arduino.menubar.edit.classicEventsClose":"關閉舊樣式事件積木","arduino.extension.tags.controllers":"控制器","arduino.extension.tags.sensors":"傳感器","arduino.extension.tags.actuators":"執行器","arduino.extension.tags.displays":"顯示器","arduino.extension.tags.modules":"智能模組","arduino.extension.tags.kits":"套件","arduino.blocks.classicEventsLabel":"经典事件積木請從「編輯」菜單開啟。","arduino.blocks.displayMatrix":"顯示圖示 %1","arduino.blocks.clearDisplay":"清空畫面","arduino.blocks.wait":"等待 %1 毫秒","arduino.blocks.break":"跳出重複","arduino.blocks.continue":"跳到下一次","arduino.blocks.elseif":"否則，如果 %1 那麼","arduino.blocks.else":"否則","arduino.blocks.runtime":"運行時長 %1","arduino.blocks.runtimeMilliseconds":"毫秒","arduino.blocks.runtimeSeconds":"秒","arduino.blocks.dataConvert":"將 %1 類型轉為 %2","arduino.blocks.dataLengthOf":"%1 長度","arduino.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","arduino.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","arduino.blocks.whensetup":"當 Arduino 啟動","arduino.blocks.whenloop":"當 Arduino 循環運行","arduino.blocks.whentimer":"當定時器每間隔 %1 毫秒","arduino.blocks.timeron":"開啟定時器","arduino.blocks.timeroff":"關閉定時器","arduino.blocks.operatorLarger":"%1 和 %2 之中最大","arduino.blocks.operatorSmaller":"%1 和 %2 之中最小","arduino.blocks.pin":"引腳","arduino.blocks.setmode":"將引腳 %1 設為 %2 模式","arduino.blocks.inputMode":"輸入","arduino.blocks.ouputMode":"輸出","arduino.blocks.inputPullUpMode":"上拉輸入","arduino.blocks.setdigital":"將數字引腳 %1 設為 %2","arduino.blocks.digitalHigh":"高電平","arduino.blocks.digitalLow":"低電平","arduino.blocks.setanalog":"將 PWM 引腳 %1 設為 %2","arduino.blocks.isDigitalHigh":"數字引腳 %1 是高電平？","arduino.blocks.analogValue":"模擬引腳 %1","arduino.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","arduino.blocks.interruptRising":"電平上升","arduino.blocks.interruptFalling":"電平下降","arduino.blocks.interruptChange":"電平改變","arduino.blocks.interruptHigh":"高電平","arduino.blocks.interruptLow":"低電平","arduino.blocks.detachinterrupt":"取消引腳 %1 中斷","arduino.blocks.protocol":"數據協議","arduino.blocks.serial":"串口","arduino.blocks.serialBaudrate":"將波特率設為 %1","arduino.blocks.serialTimeout":"將超時設為 %1 毫秒","arduino.blocks.serialPrint":"用 %2 模式打印 %1","arduino.blocks.serialPrintWarp":"換行","arduino.blocks.serialPrintNoWarp":"不換行","arduino.blocks.serialPrintHEX":"16進制","arduino.blocks.serialPrintNumber":"打印 %1","arduino.blocks.serialAvailable":"存在可讀取數據?","arduino.blocks.serialAvailableLength":"可讀取數據長度","arduino.blocks.serialReadString":"讀取文本","arduino.blocks.serialReadStringUntil":"讀取文本直到 %1","arduino.blocks.serialReadParse":"讀取 %1","arduino.blocks.serialReadParseInteger":"整數","arduino.blocks.serialReadParseFloat":"浮點數","arduino.blocks.serialRead":"讀取 1 個字節","arduino.blocks.serialReadBytes":"讀取 %1 個字節","arduino.blocks.text":"文本","arduino.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","arduino.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","arduino.blocks.textReplace":"將 %2 中的 %1 替換為 %3","arduino.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","arduino.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","arduino.blocks.textWith":"%1 %2 %3?","arduino.blocks.textStartsWith":"開始於","arduino.blocks.textEndsWith":"結束於","arduino.blocks.textCase":"將 %2 字母轉為 %1","arduino.blocks.textLowerCase":"小寫","arduino.blocks.textUpperCase":"大寫","arduino.blocks.textTrim":"清除 %1 前後空白字符","arduino.blocks.textConvert":"將 %1 轉為 %2","arduino.blocks.textConvertFrom":"將 %1 轉為文本"};Vt({en:j,"zh-Hans":tt,"zh-Hant":et});import{svgAsDataUri as ve}from"@blockcode/utils";import{ScratchBlocks as S,blocksTab as Ce,CodeReview as ke}from"@blockcode/blocks";import{codeTab as fe,terminalTab as De}from"@blockcode/code";import{monaco as yt}from"@blockcode/code";var ye=yt.languages.CompletionItemKind,it=()=>["void","unsignedchar","byte","char","int","word","long","float","string","array","double","volatile","const","min","max","abs","constrain","map","pow","sqrt","ceil","exp","fabs","floor","fma","fmax","fmin","fmod","ldexp","log","log10","round","signbit","sq","square","trunc","sin","cos","tan","atan2","cosh","degrees","hypot","radians","sinh","tanh","randomSeed","random","pinMode","digitalWrite","digitalRead","analogReference","analogRead","analogWrite","tone","noTone","shifOut","shiftln","pulseln","delay","millis","micros","lowByte","highBye","bitRead","bitWrite","bitSet","bitClear","bit","attachlnterrupt","detachlnterrupt","interrupts","nolnterrupts","Serial","available","begin","end","find","findUntil","flush","parseFloat","parselnt","read","readBytes","readBytesUntil","setTimeout","write","SerialEvent","Stream","Mouse","Keyboard","include"];import{useCallback as Xt}from"preact/hooks";import{useAppContext as Kt,useProjectContext as zt}from"@blockcode/core";import{BlocksEditor as qt}from"@blockcode/blocks";import{translate as l,themeColors as V}from"@blockcode/core";import{keyMirror as Ut}from"@blockcode/utils";var a=Ut({BLEUNO:null,ArduinoUno:null,ArduinoUnoR4:null,ArduinoNano:null});var ot=(t)=>({id:"pin",name:l("arduino.blocks.pin","Pins"),themeColor:V.blocks.motion.primary,inputColor:V.blocks.motion.secondary,otherColor:V.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:l("arduino.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_PINS":"UNO_PINS"},MODE:{menu:[[l("arduino.blocks.inputMode","input"),"INPUT"],[l("arduino.blocks.ouputMode","output"),"OUTPUT"],[l("arduino.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"]]}},ino(e){let i=e.getFieldValue("PIN")||0,o=e.getFieldValue("MODE")||"INPUT";return`pinMode(${i}, ${o});
`}},"---",{id:"setdigital",text:l("arduino.blocks.setdigital","set digital pin %1 to %2"),inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_PINS":"UNO_PINS"},VALUE:{inputMode:!0,type:"number",defaultValue:"1",menu:[[l("arduino.blocks.digitalHigh","high"),"1"],[l("arduino.blocks.digitalLow","low"),"0"]]}},ino(e){let i=e.getFieldValue("PIN")||0,o=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`digitalWrite(${i}, ${o});
`}},{id:"setanalog",text:l("arduino.blocks.setanalog","set pwm pin %1 to %2"),inputs:{PIN:{menu:t===a.ArduinoUnoR4?"R4_PWM_PINS":"PWM_PINS"},VALUE:{shadow:"slider255"}},ino(e){let i=e.getFieldValue("PIN")||0,o=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`analogWrite(${i}, ${o});
`}},{id:"slider255",inline:!0,output:"number",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},ino(e){return[e.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},{id:"digital",text:l("arduino.blocks.isDigitalHigh","digital pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_PINS":"UNO_PINS"}},ino(e){return[`digitalRead(${e.getFieldValue("PIN")||0}) == HIGH`,this.ORDER_ATOMIC]}},{id:"analog",text:l("arduino.blocks.analogValue","analog pin %1"),output:"number",inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_ANALOG_PINS":"UNO_ANALOG_PINS"}},ino(e){return[`analogRead(${e.getFieldValue("PIN")||0})`,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:l("arduino.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_PINS":"UNO_PINS"},INTERRUPT:{menu:[[l("arduino.blocks.interruptRising","rising"),"RISING"],[l("arduino.blocks.interruptFalling","falling"),"FALLING"],[l("arduino.blocks.interruptChange","change"),"CHANGE"],[l("arduino.blocks.interruptLow","low"),"LOW"]]}},ino(e){let i=e.getFieldValue("PIN")||0,o=e.getFieldValue("INTERRUPT")||"RISING",n=`interrupt_${i}_${o}`,r=this.statementToCode(e,"SUBSTACK")||"";return this.definitions_[`declare_${n}`]=`void ${n}();`,this.definitions_[n]=`void ${n}() {
${r}}`,`attachInterrupt(digitalPinToInterrupt(${i}), ${n}, ${o});
`}},{id:"detachinterrupt",text:l("arduino.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:[a.ArduinoNano,a.BLEUNO].includes(t)?"NANO_PINS":"UNO_PINS"}},ino(e){return`detachInterrupt(digitalPinToInterrupt(${e.getFieldValue("PIN")||0}));
`}},"---",{id:"setMatrix",hidden:t!==a.ArduinoUnoR4,text:l("arduino.blocks.displayMatrix","display [MATRIX]"),inputs:{MATRIX:{shadow:"matrixR4"}},ino(e){if(this.definitions_.include_Arduino_LED_Matrix='#include "Arduino_LED_Matrix.h"',this.definitions_.variable_matrix="ArduinoLEDMatrix _matrix;",this.definitions_.variable_matrix_frame="uint32_t _MATRIX_FRAME_[] = {0x0,0x0,0x0};",!this.setup_.includes("_matrix.begin();"))this.setup_+=this.INDENT+`_matrix.begin();
`;let i=this.valueToCode(e,"MATRIX",this.ORDER_NONE).split(","),o="";return o+=`_MATRIX_FRAME_[0] = 0x${i[0]};
`,o+=`_MATRIX_FRAME_[1] = 0x${i[1]};
`,o+=`_MATRIX_FRAME_[2] = 0x${i[2]};
`,o+=`_matrix.loadFrame(_MATRIX_FRAME_);
`,o}},{id:"clearMatrix",hidden:t!==a.ArduinoUnoR4,text:l("arduino.blocks.clearDisplay","clear display"),ino(e){if(this.definitions_.include_Arduino_LED_Matrix='#include "Arduino_LED_Matrix.h"',this.definitions_.variable_matrix="ArduinoLEDMatrix _matrix;",this.definitions_.variable_matrix_frame="uint32_t _MATRIX_FRAME_[] = {0x0,0x0,0x0}",!this.setup_.includes(`_matrix.begin();
`))this.setup_+=this.INDENT+`_matrix.begin();
`;let i="";return i+=`_MATRIX_FRAME_[0] = 0x0;
`,i+=`_MATRIX_FRAME_[1] = 0x0;
`,i+=`_MATRIX_FRAME_[2] = 0x0;
`,i+=`_matrix.loadFrame(_MATRIX_FRAME_);
`,i}},{id:"matrixR4",inline:!0,output:"string",inputs:{MATRIX:{type:"matrix",width:12,height:8}},ino(e){let i=e.getFieldValue("MATRIX"),o=[];for(let n=0;n<3;n++){let r=i.slice(n*32,(n+1)*32),s=parseInt(r,2).toString(16);o.push(s)}return[o.join(","),this.ORDER_ATOMIC]}}],menus:{UNO_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]]},NANO_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"],["A6","A6"],["A7","A7"]]},PWM_PINS:{items:[["3","3"],["5","5"],["6","6"],["9","9"],["10","10"],["11","11"]]},R4_PWM_PINS:{items:[["3","3"],["5","5"],["6","6"],["9","9"],["10","10"],["11","11"],["A0","A0"]]},UNO_ANALOG_PINS:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]]},NANO_ANALOG_PINS:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"],["A6","A6"],["A7","A7"]]}}});import{translate as O,themeColors as y}from"@blockcode/core";import{ScratchBlocks as A}from"@blockcode/blocks";var nt=()=>({id:"text",name:O("arduino.blocks.text","Text"),themeColor:y.blocks.looks.primary,inputColor:y.blocks.looks.secondary,otherColor:y.blocks.looks.tertiary,order:1,blocks:[{id:"join",text:A.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"arduino"}},ino(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),i=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`(${e} + ${i})`,this.ORDER_ADDITION]}},{id:"letter_of",text:A.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"arduino"}},ino(t){let e=this.getAdjusted(t,"LETTER");return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.charAt(${e})`,this.ORDER_FUNCTION_CALL]}},{id:"length",text:A.Msg.OPERATORS_LENGTH,output:"number",inputs:{STRING:{type:"string",defaultValue:"arduino"}},ino(t){let e=this.valueToCode(t,"STRING",this.ORDER_NONE);return code+=`${e}.length()`,[code,this.ORDER_FUNCTION_CALL]}},{id:"contains",text:A.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"arduino"},STRING2:{type:"string",defaultValue:"ino"}},ino(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),i=this.valueToCode(t,"STRING2",this.ORDER_NONE);return code+=`(${e}.indexOf(${i}) != -1)`,[code,this.ORDER_EQUALITY]}},{id:"equals",text:O("arduino.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"arduino"},STRING2:{type:"string",defaultValue:"Arduino"}},ino(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),i=this.valueToCode(t,"STRING2",this.ORDER_NONE);return code+=`${e}.equalsIgnoreCase(${i})
`,[code,this.ORDER_EQUALITY]}},"---",{id:"remove",text:O("arduino.blocks.textRemove","remove letters from %1 to %2 of %3"),inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:2},STRING:{type:"string",defaultValue:"arduino"}},ino(t){let e=this.getAdjusted(t,"FROM"),i=this.valueToCode(t,"TO",this.ORDER_NONE);return`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.remove(${e}, (${i} - ${e}));
`}},{id:"replace",text:O("arduino.blocks.textReplace","replace %1 of %2 with %3"),inputs:{STRING1:{type:"string",defaultValue:"a"},STRING2:{type:"string",defaultValue:"arduino"},STRING3:{type:"string",defaultValue:"The A"}},ino(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),i=this.valueToCode(t,"STRING2",this.ORDER_NONE),o=this.valueToCode(t,"STRING3",this.ORDER_NONE);return`${i}.replace(${e}, ${o});
`}},{id:"replace_letter",text:O("arduino.blocks.textReplaceLetter","replace letter %1 of %2 with %3"),inputs:{INDEX:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"arduino"},LETTER:{type:"string",defaultValue:"A"}},ino(t){let e=this.getAdjusted(t,"INDEX",this.ORDER_NONE),i=this.valueToCode(t,"STRING",this.ORDER_NONE),o=this.valueToCode(t,"LETTER",this.ORDER_NONE);return`${i}.setCharAt(${e}, ${o})
`}},{id:"substring",text:O("arduino.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"arduino"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},ino(t){let e=this.getAdjusted(t,"FROM",this.ORDER_NONE),i=this.valueToCode(t,"TO",this.ORDER_NONE);return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.substring(${e}, ${i})`,this.ORDER_FUNCTION_CALL]}},{id:"with",text:O("arduino.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"arduino"},WITH:{type:"string",menu:[[O("arduino.blocks.textStartsWith","starts"),"START"],[O("arduino.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},ino(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),i=this.valueToCode(t,"STRING2",this.ORDER_NONE),o=t.getFieldValue("WITH")||"START";return[`${e}.${o.toLowerCase()}sWith(${i})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"case",text:O("arduino.blocks.textCase","get %1 case of %2"),inputs:{WITH:{menu:[[O("arduino.blocks.textLowerCase","lower"),"LOWER"],[O("arduino.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"Arduino"}},ino(t){let e=t.getFieldValue("WITH")||"LOWER";return`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.${e.toLowerCase()}Case();
`}},{id:"trim",text:O("arduino.blocks.textTrim","remove %1 leading and trailing whitespace"),inputs:{STRING:{type:"string",defaultValue:"arduino"}},ino(t){return`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.trim();
`}},"---",{id:"convert",text:O("arduino.blocks.textConvert","convert %1 to %2"),output:!0,inputs:{STRING:{type:"string",defaultValue:"a"},TYPE:{menu:["int","float","char array","byte array"]}},ino(t){let e=this.valueToCode(t,"STRING",this.ORDER_NONE),i=t.getFieldValue("TYPE")||"int",o=`String(${e})`;if(i==="int")o+=".toInt()";else if(i==="float")o+=".toFloat()";else if(i==="char array")o+=".toCharArray()";else if(i==="byte array")o+=".getBytes()";return[o,this.ORDER_FUNCTION_CALL]}},{id:"convert_from",text:O("arduino.blocks.textConvertFrom","convert %1 to String"),output:!0,inputs:{NUM:{type:"number",defaultValue:1}},ino(t){return[`String(${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}}]});import{translate as d,themeColors as U}from"@blockcode/core";import{ScratchBlocks as ze}from"@blockcode/blocks";var rt=()=>({id:"serial",name:d("arduino.blocks.serial","Serial"),themeColor:U.blocks.sounds.primary,inputColor:U.blocks.sounds.secondary,otherColor:U.blocks.sounds.tertiary,order:2,blocks:[{id:"baudrate",text:d("arduino.blocks.serialBaudrate","set baudrate to %1"),inputs:{BAUDRATE:{menu:{inputMode:!0,defaultValue:"115200",items:["4800","9600","38400","57600","115200"]}}},ino(t){return`Serial.begin(${this.valueToCode(t,"BAUDRATE",this.ORDER_NONE)});
`}},{id:"timeout",text:d("arduino.blocks.serialTimeout","set timeout to %1 milliseconds"),inputs:{TIMEOUT:{type:"integer",defaultValue:1000}},ino(t){return`Serial.setTimeout(${this.valueToCode(t,"TIMEOUT",this.ORDER_NONE)});
`}},"---",{id:"print",text:d("arduino.blocks.serialPrint","print %1 with %2"),inputs:{STRING:{type:"string",defaultValue:"hello"},MODE:{menu:[[d("arduino.blocks.serialPrintWarp","warp"),"WARP"],[d("arduino.blocks.serialPrintNoWarp","no-warp"),"NOWARP"],[d("arduino.blocks.serialPrintHEX","hex"),"HEX"]]}},ino(t){let e=this.valueToCode(t,"STRING",this.ORDER_NONE),i=t.getFieldValue("MODE")||"WARP",o="Serial";if(i==="WARP")o+=`.println(${e});
`;else if(i==="NOWARP")o+=`.print(${e});
`;else if(i==="HEX")o+=`.print(${e}, HEX);
`;return o}},{id:"print_number",text:d("arduino.blocks.serialPrintNumber","print %1"),inputs:{NUM:{type:"number",defaultValue:0}},ino(t){return`Serial.println(${this.valueToCode(t,"NUM",this.ORDER_NONE)});
`}},"---",{id:"available",text:d("arduino.blocks.serialAvailable","available data?"),output:"boolean",ino(t){return["(Serial.available() > 0)",this.ORDER_RELATIONAL]}},{id:"available_length",text:d("arduino.blocks.serialAvailableLength","available data length"),output:"number",ino(t){return["Serial.available()",this.ORDER_FUNCTION_CALL]}},"---",{id:"read_string",text:d("arduino.blocks.serialReadString","read a string"),output:"string",ino(t){return["Serial.readString()",this.ORDER_FUNCTION_CALL]}},{id:"read_string_until",text:d("arduino.blocks.serialReadStringUntil","read a string until %1"),output:"string",inputs:{CHAR:{type:"string",defaultValue:"a"}},ino(t){return[`Serial.readStringUntil(${this.valueToCode(t,"CHAR",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"read_parse",text:d("arduino.blocks.serialReadParse","read a %1 number"),output:"number",inputs:{TYPE:{menu:[[d("arduino.blocks.serialReadParseInteger","int"),"INT"],[d("arduino.blocks.serialReadParseFloat","float"),"FLOAT"]]}},ino(t){let e=t.getFieldValue("TYPE")||"INT",i="Serial";if(e==="INT")i+=`.parseInt()
`;else if(e==="FLOAT")i+=`.parseFloat()
`;return[i,this.ORDER_FUNCTION_CALL]}},"---",{id:"read",text:d("arduino.blocks.serialRead","read a byte"),output:!0,ino(t){return["Serial.readBytes(1)",this.ORDER_FUNCTION_CALL]}},{id:"read_bytes",text:d("arduino.blocks.serialReadBytes","read %1 bytes"),output:!0,inputs:{LEN:{type:"integer",defaultValue:2}},ino(t){return[`Serial.readBytes(${this.valueToCode(t,"LEN",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}}]});import{translate as g,themeColors as $}from"@blockcode/core";import{ScratchBlocks as at}from"@blockcode/blocks";var st=(t)=>{return at.Blocks.event_whensetuploop={init(){this.jsonInit({message0:g("arduino.blocks.whensetup","when Arduino setup"),message1:"%1",message2:at.Msg.CONTROL_FOREVER,message3:"%1",message4:"%1",lastDummyAlign4:"RIGHT",args1:[{type:"input_statement",name:"SUBSTACK1"}],args3:[{type:"input_statement",name:"SUBSTACK2"}],args4:[{type:"field_image",src:"./assets/blocks-media/repeat.svg",width:24,height:24,alt:"*",flip_rtl:!0}],category:"event",extensions:["colours_event"]}),this.setPreviousStatement(!1),this.setNextStatement(!1)}},{id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:$.blocks.events.primary,inputColor:$.blocks.events.secondary,otherColor:$.blocks.events.tertiary,blocks:[{label:g("arduino.blocks.classicEventsLabel","Classic events turned on from Edit."),hidden:t},{id:"whensetuploop",custom:!0,hidden:!t,ino(e){let i=this.statementToCode(e,"SUBSTACK1")||"";this.setup_+=i;let o=this.statementToCode(e,"SUBSTACK2")||"";this.loop_+=o}},"---",{id:"whensetup",text:g("arduino.blocks.whensetup","when Arduino setup"),hat:!0,ino(e){let i=this.statementToCode(e)||"";this.setup_+=i}},{id:"whenloop",text:g("arduino.blocks.whenloop","when Arduino loop"),hat:!0,ino(e){let i=this.statementToCode(e)||"";this.loop_+=i}},"---",{id:"whentimer",text:g("arduino.blocks.whentimer","when timer per %1 milliseconds"),hat:!0,inputs:{TIME:{type:"integer",defaultValue:500}},ino(e){this.definitions_.include_mstimer2="#include <MsTimer2.h>";let i=this.valueToCode(e,"TIME",this.ORDER_NONE)||500,o=`msTimer_${i}`,n=this.statementToCode(e)||"";this.definitions_[`declare_${o}`]=`void ${o}();`,this.definitions_[o]=`void ${o}() {
${n}}`;let r=this.INDENT+`MsTimer2::set(${i}, ${o});
`;this.setup_=r+this.setup_}},{id:"timeron",text:g("arduino.blocks.timeron","start timer"),ino(e){return this.definitions_.include_mstimer2="#include <MsTimer2.h>",`MsTimer2::start();
`}},{id:"timeroff",text:g("arduino.blocks.timeroff","stop timer"),ino(e){return this.definitions_.include_mstimer2="#include <MsTimer2.h>",`MsTimer2::stop();
`}}]}};import{translate as E,themeColors as F}from"@blockcode/core";import{ScratchBlocks as C}from"@blockcode/blocks";var ut=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:F.blocks.control.primary,inputColor:F.blocks.control.secondary,otherColor:F.blocks.control.tertiary,blocks:[{id:"wait",text:E("arduino.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:500}},ino(t){return`delay(${this.valueToCode(t,"MS",this.ORDER_NONE)});
`}},"---",{id:"repeat",text:C.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}},ino(t){let e=this.valueToCode(t,"TIMES",this.ORDER_NONE),i=this.statementToCode(t,"SUBSTACK");i=this.addLoopTrap(i,t.id);let o="";return o+=`for (int i = 0; i < ${e}; i++) {
`,o+=i,o+=`}
`,o}},{id:"forever",text:C.Msg.CONTROL_FOREVER,repeat:!0,end:!0,ino(t){let e=this.statementToCode(t,"SUBSTACK");e=this.addLoopTrap(e,t.id);let i="";return i+=`while (true) {
`,i+=e,i+=`}
`,i}},"---",{id:"if",text:C.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"false",i=this.statementToCode(t,"SUBSTACK"),o="";return o+=`if (${e}) {
`,o+=i,o+=`}
`,o}},{id:"elseif",text:E("arduino.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"false",i=this.statementToCode(t,"SUBSTACK"),o="";return o+=`else if (${e}) {
`,o+=i,o+=`}
`,o}},{id:"else",text:E("arduino.blocks.else","else"),substack:!0,ino(t){let e=this.statementToCode(t,"SUBSTACK"),i="";return i+=`else {
`,i+=e,i+=`}
`,i}},"---",{id:"repeat_until",text:C.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"true",i=this.statementToCode(t,"SUBSTACK");i=this.addLoopTrap(i,t.id);let o="";return o+=`while (!(${e})) {
`,o+=i,o+=`}
`,o}},{id:"while",text:C.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"true",i=this.statementToCode(t,"SUBSTACK");i=this.addLoopTrap(i,t.id);let o="";return o+=`while ((${e})) {
`,o+=i,o+=`}
`,o}},{id:"continue",text:E("arduino.blocks.continue","continue"),end:!0,ino(t){let e="";return e+=`continue;
`,e}},{id:"break",text:E("arduino.blocks.break","break"),end:!0,ino(t){let e="";return e+=`break;
`,e}},"---",{id:"runtime",text:E("arduino.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[E("arduino.blocks.runtimeMilliseconds","milliseconds"),"MS"],[E("arduino.blocks.runtimeSeconds","seconds"),"SEC"]]}},ino(t){return`(millis()${t.getFieldValue("UNIT")==="SEC"?"/1000":""})`}}]});import{translate as $t,themeColors as G}from"@blockcode/core";import{ScratchBlocks as ni}from"@blockcode/blocks";var lt=()=>({id:"protocol",name:$t("arduino.blocks.protocols","Protocols"),themeColor:G.blocks.sensing.primary,inputColor:G.blocks.sensing.secondary,otherColor:G.blocks.sensing.tertiary,order:5,blocks:[]});import{translate as m,themeColors as w}from"@blockcode/core";import{ScratchBlocks as u}from"@blockcode/blocks";var dt=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:w.blocks.operators.primary,inputColor:w.blocks.operators.secondary,otherColor:w.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"+",n={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${e} ${o} ${i})`,n[o]]}},"---",{id:"random",text:u.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},ino(t){let e=this.valueToCode(t,"FROM",this.ORDER_NONE),i=this.valueToCode(t,"TO",this.ORDER_NONE);return[`random(${e}, ${i})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||">",n={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${e} ${o} ${i})`,n[o]]}},"---",{id:"and",text:u.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),i=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${e} && ${i})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:u.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},ino(t){let e=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),i=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${e} || ${i})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:u.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},ino(t){return[`(!${this.valueToCode(t,"OPERAND",this.ORDER_NONE)})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"&",n={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${e} ${o} ${i})`,n[o]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},ino(t){return[`(~${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:m("arduino.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`max(${e}, ${i})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:m("arduino.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`min(${e}, ${i})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:u.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},ino(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),i=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`(${e} % ${i})`,this.ORDER_MODULUS]}},{id:"round",text:u.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},ino(t){return[`round(${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:u.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[u.Msg.OPERATORS_MATHOP_ABS,"abs"],[u.Msg.OPERATORS_MATHOP_FLOOR,"floor"],[u.Msg.OPERATORS_MATHOP_CEILING,"ceiling"],[u.Msg.OPERATORS_MATHOP_SQRT,"sqrt"],[u.Msg.OPERATORS_MATHOP_SIN,"sin"],[u.Msg.OPERATORS_MATHOP_COS,"cos"],[u.Msg.OPERATORS_MATHOP_TAN,"tan"],[u.Msg.OPERATORS_MATHOP_ASIN,"asin"],[u.Msg.OPERATORS_MATHOP_ACOS,"acos"],[u.Msg.OPERATORS_MATHOP_ATAN,"atan"],[u.Msg.OPERATORS_MATHOP_LN,"log"],[u.Msg.OPERATORS_MATHOP_LOG,"log10"],[u.Msg.OPERATORS_MATHOP_EEXP,"exp"],[u.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},ino(t){let e=t.getFieldValue("OPERATOR")||"abs",i=this.valueToCode(t,"NUM",this.ORDER_NONE),o="";if(e==="pow10")o+=`pow(10, ${i})`;else o+=`${e}(${i})`;return[o,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:m("arduino.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:["int","float","String"]}},ino(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),i=t.getFieldValue("TYPE")||"int",o=`String(${e})`;switch(i){case"int":o+=".toInt()";break;case"float":o+=".toFloat()";break;case"String":break}return[o,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:m("arduino.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"arduino"}},ino(t){return[`strlen(${this.valueToCode(t,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"constrain",text:m("arduino.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},ino(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),i=this.valueToCode(t,"FROM",this.ORDER_NONE),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`constrain(${e}, ${i}, ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:m("arduino.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},ino(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),i=this.valueToCode(t,"FROMLOW",this.ORDER_NONE),o=this.valueToCode(t,"FROMHIGH",this.ORDER_NONE),n=this.valueToCode(t,"TOLOW",this.ORDER_NONE),r=this.valueToCode(t,"TOHIGHT",this.ORDER_NONE);return[`map(${e}, ${i}, ${o}, ${n}, ${r})`,this.ORDER_FUNCTION_CALL]}}]});var H=["int","float","boolean","char","byte","String"],Rt=()=>({id:"data",skipXML:!0,blocks:[{id:"setvariableto",ino(t){let e=t.getFieldValue("TYPE")||"int",i=this.getVariableName(t.getFieldValue("VARIABLE")),o=`${e} ${i};`;if(t.getRootBlock().type==="event_whensetup")return this.definitions_[`variable_${i}`]=o,"";return o+`
`}},{id:"changevariableby",ino(t){let e=this.getVariableName(t.getFieldValue("VARIABLE")),i=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${e} = ${i};
`}},{id:"variable",ino(t){return[this.getVariableName(t.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"insertatlist",ino(t){let e=t.getFieldValue("TYPE")||"int",i="arr"+this.getVariableName(t.getFieldValue("LIST")),o=this.valueToCode(t,"INDEX",this.ORDER_NONE),n=`${e} ${i}[${o}];`;if(t.getRootBlock().type==="event_whensetup")return this.definitions_[`variable_${i}`]=n,"";return n+`
`}},{id:"replaceitemoflist",ino(t){let e="arr"+this.getVariableName(t.getFieldValue("LIST")),i=this.valueToCode(t,"ITEM",this.ORDER_NONE),o=this.valueToCode(t,"INDEX",this.ORDER_NONE);return`${e}[${o}] = ${i};
`}},{id:"listcontents",ino(t){return["arr"+this.getVariableName(t.getFieldValue("LIST")),this.ORDER_ATOMIC]}},{id:"itemoflist",ino(t){let e="arr"+this.getVariableName(t.getFieldValue("LIST")),i=this.valueToCode(t,"INDEX",this.ORDER_NONE);return[`${e}[${i}]`,this.ORDER_MEMBER]}},{id:"lengthoflist",ino(t){let e="arr"+this.getVariableName(t.getFieldValue("LIST"));return[`(sizeof(${e}) / sizeof(${e}[0]))`,this.ORDER_DIVIDE]}}]});import{ScratchBlocks as Ri}from"@blockcode/blocks";var Ft={argument_reporter_string_number:"String",argument_reporter_boolean:"bool",argument_reporter_number:"float"},Ot=0,Gt=1,wt=2,Ht=3,Wt={[Ot]:"void",[Gt]:"bool",[wt]:"float",[Ht]:"String"},ct=()=>({id:"procedures",skipXML:!0,blocks:[{id:"definition",ino(t){let e=t.childBlocks_[0],i=this.getFunctionName(e.getProcCode()),o=this.statementToCode(t),n=e.childBlocks_.map((b)=>`${Ft[b.type]} ${this.getVariableName(b.getFieldValue("VALUE"))}`),r=Wt[e.return_??Ot];this.definitions_[`declare_${i}`]=`${r} ${i}();`;let s="";s+=`${i}(${n.join(", ")}) {
`,s+=o,s+="}",this.definitions_[i]=`${r} ${s}`}},{id:"call",ino(t){let e=this.getFunctionName(t.getProcCode()),i=t.argumentIds_.map((n)=>this.valueToCode(t,n,this.ORDER_NONE)||"false"),o=`${e}(${i.join(", ")})`;if(t.return_)return[o,this.ORDER_FUNCTION_CALL];return o+`;
`}},{id:"return",ino(t){return`return ${this.valueToCode(t,"VALUE",this.ORDER_NONE)};
`}},{id:"return_string",ino(t){return`return String(${this.valueToCode(t,"STR",this.ORDER_NONE)});
`}}]});import{ClangGenerator as Bt}from"@blockcode/blocks";var Yt=`/* Generate by BlockCode */
`;class L extends Bt{constructor(){super("INO")}init(t){super.init(t),this.definitions_.include_arduino="#include <Arduino.h>",this.setup_="",this.loop_="",this.onDefinitions?.()}finish(t){let e=[],i=[],o=[],n=[],r=[];for(let N in this.definitions_){let h=this.definitions_[N];if(N.match("include"))e.push(h);else if(N.match("declare"))i.push(h);else if(N.match("define"))o.push(h);else if(N.match("variable"))n.push(h);else r.push(h)}let s="";if(e.length>0)s+=e.join(`
`)+`

`;if(i.length>0)s+=i.join(`
`)+`

`;if(o.length>0)s+=o.join(`
`)+`

`;if(n.length>0)s+=n.join(`
`)+`

`;let b=`void setup() {
${this.setup_}}

void loop() {
${this.loop_}}

`+r.join(`

`);return delete this.definitions_,delete this.functionNames_,delete this.setup_,delete this.loop_,this.variableDB_.reset(),Yt+s.replace(/\n\n+/g,`

`)+t+b.replace(/\n\n+/g,`

`)}}function pt(t,e){let i=ot(t),o=nt(),n=rt(),r=st(e),s=ut(),b=lt(),N=dt(),h=Rt(),Pt=ct();return[i,o,n,r,s,b,N,h,Pt]}import{Text as _}from"@blockcode/core";import{jsx as v}from"preact/jsx-runtime";var Et=[{tag:"controller",label:v(_,{id:"arduino.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:v(_,{id:"arduino.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:v(_,{id:"arduino.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:v(_,{id:"arduino.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:v(_,{id:"arduino.extension.tags.modules",defaultMessage:"Modules"})},{tag:"kit",label:v(_,{id:"arduino.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as Zt}from"preact/jsx-runtime";var Qt=new L,Jt=()=>["arduino"];function Nt(){let{tabIndex:t}=Kt(),{meta:e}=zt(),i=Xt(()=>{return pt(e.value.boardType,e.value.classicEvents)},[e.value.boardType,e.value.classicEvents]);return Zt(qt,{enableCodePreview:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,extensionTags:Et,disableGenerateCode:t.value!==0,variableTypes:H,generator:Qt,onBuildinExtensions:i,onExtensionsFilter:Jt})}function W(t){let e=globalThis.document,i=e.createElement("style");i.appendChild(e.createTextNode(t)),e.head.append(i)}W(".CNbKOG_device-icon{width:20px;height:20px}.CNbKOG_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}.CNbKOG_check-icon.CNbKOG_checked{visibility:visible}.CNbKOG_blank-check-item>div{padding-left:calc(14px + var(--space)/2)}");var c={checkIcon:"CNbKOG_check-icon",blankCheckItem:"CNbKOG_blank-check-item",deviceIcon:"CNbKOG_device-icon",checked:"CNbKOG_checked"};var B="./assets/icon-device-sma7ahy6.png";import{jsx as te}from"preact/jsx-runtime";function ht(){return te("img",{className:c.deviceIcon,src:B})}import{useProjectContext as ee,Text as x}from"@blockcode/core";import{jsx as M}from"preact/jsx-runtime";function gt(){let{meta:t}=ee();if(t.value.boardType===a.BLEUNO)return M(x,{id:"arduino.menubar.device.bleuno",defaultMessage:"BLE-UNO/NANO"});if(t.value.boardType===a.ArduinoUnoR4)return M(x,{id:"arduino.menubar.device.unoR4",defaultMessage:"Arduino Uno R4"});if(t.value.boardType===a.ArduinoNano)return M(x,{id:"arduino.menubar.device.nano",defaultMessage:"Arduino Nano"});return M(x,{id:"arduino.menubar.device.uno",defaultMessage:"Arduino Uno"})}import{useCallback as vt}from"preact/hooks";import{nanoid as Q,classNames as Ct,sleepMs as le}from"@blockcode/utils";import{useProjectContext as de,setAlert as f,delAlert as Re,openPromptModal as Oe}from"@blockcode/core";import{ArduinoUtils as z}from"@blockcode/board";import{xmlEscape as ie}from"@blockcode/utils";var oe=window.electron?.compileOffline?"http://localhost:18125/compile":"https://maker.huiwancode.com/api_v1/getarduinocompile/";async function Tt(t,e="arduino:avr:uno"){let i={fqbn:e,sketch:window.electron?.compileOffline?btoa(t):t,resultType:"json"},o=JSON.stringify({json:JSON.stringify(i)}),r=await(await fetch(oe,{method:"POST",headers:{"Content-Type":"application/json"},body:o})).json();if(r?.success&&r?.hex)return atob(r.hex);else if(r?.status?.success&&r?.data?.hex)return atob(r.data.hex);else{let s=r?.message??r?.data?.details??"";throw s=ie(s),Error(s.trim())}}import{Spinner as ce,Text as D,MenuSection as pe,MenuItem as kt}from"@blockcode/core";import{useEffect as re,useCallback as ae}from"preact/hooks";import{classNames as Y}from"@blockcode/utils";import{useProjectContext as se,setMeta as bt,Text as X,MenuSection as mt,MenuItem as K}from"@blockcode/core";var I="./assets/icon-check-5hn8sb1h.svg";import{jsx as T,jsxs as k,Fragment as ue}from"preact/jsx-runtime";function _t({itemClassName:t}){let{meta:e}=se();re(()=>{if(!e.value.boardType)bt("boardType",a.ArduinoUno)},[]);let i=ae((o)=>()=>{bt({boardType:o})},[]);return k(ue,{children:[k(mt,{children:[k(K,{className:t,onClick:i(a.ArduinoUno),children:[T("img",{className:Y(c.checkIcon,{[c.checked]:e.value.boardType===a.ArduinoUno}),src:I}),T(X,{id:"arduino.menubar.device.uno",defaultMessage:"Arduino Uno"})]}),k(K,{className:t,onClick:i(a.ArduinoNano),children:[T("img",{className:Y(c.checkIcon,{[c.checked]:e.value.boardType===a.ArduinoNano}),src:I}),T(X,{id:"arduino.menubar.device.nano",defaultMessage:"Arduino Nano"})]})]}),T(mt,{children:k(K,{className:t,onClick:i(a.BLEUNO),children:[T("img",{className:Y(c.checkIcon,{[c.checked]:e.value.boardType===a.BLEUNO}),src:I}),T(X,{id:"arduino.menubar.device.bleuno",defaultMessage:"BLE-UNO/NANO"})]})})]})}import{jsx as p,jsxs as St,Fragment as he}from"preact/jsx-runtime";var R=null,J=()=>{Re(R),R=null},Ee=()=>{if(!R)R=Q();f("compiling",{id:R})},Ne=(t)=>{if(!R)R=Q();f("compileError",{id:R,icon:null,button:{label:p(D,{id:"gui.alert.compileViewError",defaultMessage:"View Message"}),onClick(){Oe({title:p(D,{id:"gui.alert.compileError",defaultMessage:"Compilation Error"}),content:`<pre>${t}</pre>`})}},onClose:J})},ft=(t)=>{if(!R)R=Q();if(t<100)f({id:R,icon:p(ce,{level:"success"}),message:p(D,{id:"gui.alert.downloadingProgress",defaultMessage:"Downloading...{progress}%",progress:t})});else f("downloadCompleted",{id:R}),setTimeout(J,2000)},q=(t)=>{if(t==="NotFoundError")return;f("connectionError",1000)},Dt=async(t,e)=>{Ee();let i;try{i=await Tt(e)}catch(o){Ne(o.message)}if(!i){t.disconnect();return}ft(0);try{await z.write(t,i,ft),await le(500)}catch(o){console.log(o),q(o.name),J()}finally{t.disconnect()}};function At({itemClassName:t}){let{meta:e,file:i}=de(),o=vt(async()=>{if(R)return;let r;try{r=await z.connect({baudRate:115200})}catch(s){q(s.name)}if(!r)return;await Dt(r,i.value.content)},[]),n=vt(async()=>{if(R)return;let r;try{r=await z.connectBLE()}catch(s){q(s.name)}if(!r)return;await Dt(r,i.value.content)},[]);return St(he,{children:[St(pe,{children:[e.value.boardType===a.BLEUNO&&p(kt,{disabled:R,className:Ct(t,c.blankCheckItem),label:p(D,{id:"arduino.menubar.device.downloadBle",defaultMessage:"Download program via Bluetooth (BLE)"}),onClick:n}),p(kt,{disabled:R,className:Ct(t,c.blankCheckItem),label:p(D,{id:"arduino.menubar.device.download",defaultMessage:"Download program via Serial Port"}),onClick:o})]}),p(_t,{itemClassName:t})]})}import{useEffect as ge,useCallback as Te}from"preact/hooks";import{useProjectContext as be,setMeta as Lt,Text as xt,MenuSection as me,MenuItem as _e}from"@blockcode/core";import{jsx as P}from"preact/jsx-runtime";function Mt({itemClassName:t}){let{meta:e}=be();ge(()=>{if(!e.value.classicEvents)Lt("classicEvents",!1)},[]);let i=Te(()=>{let o=!e.value.classicEvents;Lt({classicEvents:o})},[]);return P(me,{children:P(_e,{className:t,onClick:i,children:e.value.classicEvents?P(xt,{id:"arduino.menubar.edit.classicEventsClose",defaultMessage:"Turn off Old-style Event Blocks"}):P(xt,{id:"arduino.menubar.edit.classicEventsOpen",defaultMessage:"Turn on Old-style Event Blocks"})})})}var It={files:[{id:"main",type:"text/x-c"}]};import{jsx as Z}from"preact/jsx-runtime";var yo={onNew(){return It},onSave(t,e,i){let o=[];return t=t.map((n)=>{return o.push(n.extensions),{id:n.id,type:n.type,xml:n.xml}}),{files:t,assets:e,meta:{extensions:Array.from(new Set(o.flat())),boardType:i.boardType??a.ArduinoUno,classicEvents:i.classicEvents??!1}}},async onThumb(){let t=S.getMainWorkspace();if(t){let e=t.getCanvas();if(e)return await ve(e,{})}},onUndo(t){if(t instanceof MouseEvent)S.getMainWorkspace()?.undo(!1)},onRedo(t){if(t instanceof MouseEvent)S.getMainWorkspace()?.undo(!0)},onEnableUndo(){let t=S.getMainWorkspace();return t?.undoStack_&&t.undoStack_.length!==0},onEnableRedo(){let t=S.getMainWorkspace();return t?.redoStack_&&t.redoStack_.length!==0},menuItems:[{id:"edit",Menu:Mt},{icon:Z(ht,{}),label:Z(gt,{}),Menu:At}],tabs:[{...Ce,Content:Nt},{...fe,Content:()=>Z(ke,{onRegisterCompletionItems:it})},{...De,disabled:!0}]};export{yo as default};
