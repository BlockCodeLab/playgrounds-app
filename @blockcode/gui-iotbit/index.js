import{addLocalesMessages as Q2}from"@blockcode/core";var d2={"iotbit.menubar.device":"iot:bit","iotbit.extension.tags.controllers":"Controllers","iotbit.extension.tags.sensors":"Sensors","iotbit.extension.tags.actuators":"Actuators","iotbit.extension.tags.displays":"Displays","iotbit.extension.tags.modules":"Modules","iotbit.extension.tags.communication":"Communication","iotbit.extension.tags.data":"Data","iotbit.extension.tags.kits":"Kits","iotbit.emu.greenFlag":"Go","iotbit.emu.stop":"Stop","iotbit.emu.smallStage":"Switch to small stage","iotbit.emu.largeStage":"Switch to large stage","iotbit.blocks.wait":"wait %1 milliseconds","iotbit.blocks.break":"break","iotbit.blocks.continue":"continue","iotbit.blocks.elseif":"else if %1 then","iotbit.blocks.else":"else","iotbit.blocks.runtime":"run time %1","iotbit.blocks.runtimeMilliseconds":"milliseconds","iotbit.blocks.runtimeSeconds":"seconds","iotbit.blocks.dataConvert":"convert %1 to %2","iotbit.blocks.dataConvert.int":"int","iotbit.blocks.dataConvert.float":"float","iotbit.blocks.dataConvert.string":"str","iotbit.blocks.dataConvert.list":"list","iotbit.blocks.dataLengthOf":"length of %1","iotbit.blocks.dataConstrain":"constrain %1 between %2 to %3","iotbit.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","iotbit.blocks.whenstart":"when iot:bit start","iotbit.blocks.timerset":"set timer # %1 per %2 milliseconds","iotbit.blocks.timeroff":"stop timer # %1","iotbit.blocks.operatorLarger":"larger of %1 and %2","iotbit.blocks.operatorSmaller":"smaller of %1 and %2","iotbit.blocks.pin":"Pins","iotbit.blocks.setmode":"set pin %1 mode to %2","iotbit.blocks.inputMode":"input","iotbit.blocks.ouputMode":"output","iotbit.blocks.inputPullUpMode":"input pull-up","iotbit.blocks.inputPullDownMode":"input pull-down","iotbit.blocks.setdigital":"set pin %1 to %2","iotbit.blocks.digitalHigh":"high","iotbit.blocks.digitalLow":"low","iotbit.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","iotbit.blocks.setpwm":"set pin %1 pwm to %2","iotbit.blocks.setanalog":"set pin %1 analog to %2","iotbit.blocks.isDigitalHigh":"pin %1 is high?","iotbit.blocks.analogValue":"pin %1 analog value","iotbit.blocks.attachinterrupt":"attach pin %1 interrupt to %2","iotbit.blocks.interruptRising":"rising","iotbit.blocks.interruptFalling":"falling","iotbit.blocks.interruptChange":"change","iotbit.blocks.interruptHigh":"high","iotbit.blocks.interruptLow":"low","iotbit.blocks.detachinterrupt":"detach pin %1 interrupt","iotbit.blocks.network":"Network","iotbit.blocks.display":"Display","iotbit.blocks.text":"Text","iotbit.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","iotbit.blocks.textRemove":"remove letters from %1 to %2 of %3","iotbit.blocks.textReplace":"replace %1 of %2 with %3","iotbit.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","iotbit.blocks.textSubstring":"substring of %1 from %2 to %3","iotbit.blocks.textFind":"find %1 of %2 place","iotbit.blocks.textWith":"%1 %2 with %3?","iotbit.blocks.textStartsWith":"starts","iotbit.blocks.textEndsWith":"ends","iotbit.blocks.textCase":"get %1 of %2","iotbit.blocks.textLowerCase":"lower-case","iotbit.blocks.textUpperCase":"upper-case","iotbit.blocks.textTrim":"remove %1 leading and trailing whitespace","iotbit.blocks.textConvert":"convert %1 to %2","iotbit.blocks.textConvertFrom":"convert %1 to String","iotbit.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","iotbit.blocks.disconnectWifi":"disconnect wi-fi","iotbit.blocks.isWifiConnected":"wi-fi is connected?","iotbit.blocks.wifiScan":"start scan wi-fi","iotbit.blocks.wifiItem":"%2 of item %1 of available wi-fi","iotbit.blocks.wifiItemSsid":"ssid","iotbit.blocks.wifiItemMac":"mac","iotbit.blocks.wifiItemRssi":"rssi","iotbit.blocks.wifiItemSecurity":"security","iotbit.blocks.wifiCounts":"available wi-fi counts","iotbit.blocks.startap":"start ap ssid: %1","iotbit.blocks.stopap":"stop ap","iotbit.blocks.espnowBroadcast":"broadcast %1 via esp-now","iotbit.blocks.espnowSend":"send %1 to %2 via esp-now","iotbit.blocks.espnowRecv":"wait for esp-now incoming","iotbit.blocks.espnowMsg":"%1 of incoming","iotbit.blocks.espnowMsgText":"message","iotbit.blocks.espnowMsgMac":"mac address","iotbit.blocks.espnowRepeat":"repeat wait for esp-now incoming","iotbit.blocks.espnowWhen":"when esp-now receive %1","iotbit.blocks.spiInit":"initialize SPI %1 freq:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 write %2","iotbit.blocks.spiRead":"SPI %1 read %2 bytes","iotbit.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","iotbit.blocks.i2cScan":"I2C scan devices","iotbit.blocks.i2cWrite":"I2C write to %1:%2","iotbit.blocks.i2cRead":"I2C read from %1 :%2 bytes","iotbit.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","iotbit.blocks.i2sPlay":"I2S play %1","iotbit.blocks.playNote":"play note %1 for %2 beats","iotbit.blocks.playMusic":"start sound %1","iotbit.blocks.playMusicDone":"play sound %1 until done","iotbit.blocks.stopMusic":"stop music","iotbit.blocks.musicDadadadum":"dadadadum","iotbit.blocks.musicEntertainer":"entertainer","iotbit.blocks.musicPrelude":"prelude","iotbit.blocks.musicOde":"ode","iotbit.blocks.musicNyan":"nyan","iotbit.blocks.musicRingtone":"ringtone","iotbit.blocks.musicFunk":"funk","iotbit.blocks.musicBlues":"blues","iotbit.blocks.musicBirthday":"birthday","iotbit.blocks.musicWedding":"wedding","iotbit.blocks.musicFuneral":"funeral","iotbit.blocks.musicPunchline":"punchline","iotbit.blocks.musicPython":"python","iotbit.blocks.musicBaddy":"baddy","iotbit.blocks.musicChase":"chase","iotbit.blocks.musicBaDing":"ba ding","iotbit.blocks.musicWawawawaa":"wawawawaa","iotbit.blocks.musicJumpUp":"jump up","iotbit.blocks.musicJumpDown":"jump down","iotbit.blocks.musicPowerUp":"power up","iotbit.blocks.musicPowerDown":"power down","iotbit.blocks.magneticForce":"magnetic force %1","iotbit.blocks.strength":"strength","iotbit.blocks.compassHeading":"compass heading","iotbit.blocks.calibrateCompass":"calibrate compass","iotbit.blocks.acceleration":"acceleration %1","iotbit.blocks.accelerometerRange":"set accelerometer range %1","iotbit.blocks.gyroscope":"gyroscope %1","iotbit.blocks.rotation":"rotation %1","iotbit.blocks.rotationPitch":"pitch","iotbit.blocks.rotationRoll":"roll","iotbit.blocks.rotationYaw":"yaw","iotbit.blocks.gesture":"is %1 gesture?","iotbit.blocks.gestureShake":"shake","iotbit.blocks.gestureLedsUp":"leds up","iotbit.blocks.gestureLedsDown":"leds down","iotbit.blocks.gestureScreenUp":"screen up","iotbit.blocks.gestureScreenDown":"screen down","iotbit.blocks.gestureTiltLeft":"tilt left","iotbit.blocks.gestureTiltRight":"tilt right","iotbit.blocks.gestureFreeFall":"free fall","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"brightness","iotbit.blocks.loudness":"loudness","iotbit.blocks.temperature":"temperature","iotbit.blocks.setLeds":"set led %1 %2 brightness %3","iotbit.blocks.closeLeds":"close leds","iotbit.blocks.displayText":"display text %1 at x:%2 y:%3","iotbit.blocks.displayTextLine":"display text %1 at line %2","iotbit.blocks.displayImage":"display %1","iotbit.blocks.displayClear":"clear display","iotbit.blocks.displayPixel":"pixel x1:%1 y1:%2","iotbit.blocks.displayLine":"line from x1:%1 y1:%2 to x2:%3 y2%4","iotbit.blocks.displayEllipse":"ellipse with x-radius:%1 and y-radius:%2 at x:%3 y:%4","iotbit.blocks.displayRect":"rect with width:%1 height:%2 at x:%3 y:%4","iotbit.blocks.displayFill":"fill with width:%1 height:%2 at x:%3 y:%4","iotbit.blocks.terminal":"Terminal","iotbit.blocks.terminalPrint":"print %1","iotbit.blocks.terminalEval":"eval %1"};var b2={"iotbit.menubar.device":"物联板","iotbit.extension.tags.controllers":"输入模块","iotbit.extension.tags.sensors":"传感器","iotbit.extension.tags.actuators":"执行器","iotbit.extension.tags.displays":"显示模块","iotbit.extension.tags.modules":"智能模块","iotbit.extension.tags.communication":"通讯","iotbit.extension.tags.data":"数据","iotbit.extension.tags.kits":"套件","iotbit.emu.greenFlag":"运行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"缩小舞台","iotbit.emu.largeStage":"放大舞台","iotbit.blocks.wait":"等待 %1 毫秒","iotbit.blocks.break":"跳出重复执行","iotbit.blocks.continue":"跳到下一次执行","iotbit.blocks.elseif":"否则，如果 %1 那么","iotbit.blocks.else":"否则","iotbit.blocks.runtime":"运行时长 %1","iotbit.blocks.runtimeMilliseconds":"毫秒","iotbit.blocks.runtimeSeconds":"秒","iotbit.blocks.dataConvert":"将 %1 转为 %2","iotbit.blocks.dataConvert.int":"整数","iotbit.blocks.dataConvert.float":"浮点数","iotbit.blocks.dataConvert.string":"字符串","iotbit.blocks.dataConvert.list":"列表","iotbit.blocks.dataLengthOf":"%1 长度","iotbit.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","iotbit.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","iotbit.blocks.whenstart":"当 iot:bit 启动","iotbit.blocks.timerset":"将定时器 # %1 间隔设为每 %2 毫秒","iotbit.blocks.timeroff":"关闭定时器 # %1","iotbit.blocks.operatorLarger":"%1 和 %2 之中最大","iotbit.blocks.operatorSmaller":"%1 和 %2 之中最小","iotbit.blocks.pin":"引脚","iotbit.blocks.setmode":"将引脚 %1 设为 %2 模式","iotbit.blocks.inputMode":"输入","iotbit.blocks.ouputMode":"输出","iotbit.blocks.inputPullUpMode":"上拉输入","iotbit.blocks.inputPullDownMode":"下拉输入","iotbit.blocks.setdigital":"将引脚 %1 设为 %2","iotbit.blocks.digitalHigh":"高电平","iotbit.blocks.digitalLow":"低电平","iotbit.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","iotbit.blocks.setpwm":"将引脚 %1 PWM 设为 %2","iotbit.blocks.setanalog":"将引脚 %1 模拟值设为 %2","iotbit.blocks.isDigitalHigh":"引脚 %1 是高电平？","iotbit.blocks.analogValue":"引脚 %1 模拟值","iotbit.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","iotbit.blocks.interruptRising":"电平上升","iotbit.blocks.interruptFalling":"电平下降","iotbit.blocks.interruptChange":"电平改变","iotbit.blocks.interruptHigh":"高电平","iotbit.blocks.interruptLow":"低电平","iotbit.blocks.detachinterrupt":"取消引脚 %1 中断","iotbit.blocks.network":"网络","iotbit.blocks.sensing":"侦测","iotbit.blocks.display":"显示","iotbit.blocks.sound":"声音","iotbit.blocks.text":"文本","iotbit.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","iotbit.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","iotbit.blocks.textReplace":"将 %2 中的 %1 替换为 %3","iotbit.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","iotbit.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","iotbit.blocks.textFind":"在 %2 中查找 %1 的位置","iotbit.blocks.textWith":"%1 %2 %3?","iotbit.blocks.textStartsWith":"开始于","iotbit.blocks.textEndsWith":"结束于","iotbit.blocks.textCase":"将 %2 字母转为 %1","iotbit.blocks.textLowerCase":"小写","iotbit.blocks.textUpperCase":"大写","iotbit.blocks.textTrim":"清除 %1 前后空白字符","iotbit.blocks.textConvert":"将 %1 转为 %2","iotbit.blocks.textConvertFrom":"将 %1 转为文本","iotbit.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","iotbit.blocks.disconnectWifi":"断开 Wi-Fi 网络","iotbit.blocks.isWifiConnected":"Wi-Fi 网络已连接？","iotbit.blocks.wifiScan":"开始扫描 Wi-Fi","iotbit.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","iotbit.blocks.wifiItemSsid":"SSID","iotbit.blocks.wifiItemMac":"MAC","iotbit.blocks.wifiItemRssi":"RSSI","iotbit.blocks.wifiItemSecurity":"加密类型","iotbit.blocks.wifiCounts":"可用 Wi-Fi 数量","iotbit.blocks.startap":"开启热点 SSID: %1","iotbit.blocks.stopap":"关闭热点","iotbit.blocks.espnowBroadcast":"ESP-Now 广播 %1","iotbit.blocks.espnowSend":"ESP-Now 发送 %1 给 %2","iotbit.blocks.espnowRecv":"等待 ESP-Now 接收消息","iotbit.blocks.espnowMsg":"收到的 %1","iotbit.blocks.espnowMsgText":"消息","iotbit.blocks.espnowMsgMac":"MAC 地址","iotbit.blocks.espnowRepeat":"等待 ESP-Now 收到消息","iotbit.blocks.espnowWhen":"当 ESP-Now 收到 %1","iotbit.blocks.spiInit":"初始化SPI %1 频率:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 写入 %2","iotbit.blocks.spiRead":"SPI %1 读取 %2 字节","iotbit.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","iotbit.blocks.i2cScan":"I2C扫描设备","iotbit.blocks.i2cWrite":"I2C写入到 %1:%2","iotbit.blocks.i2cRead":"I2C从 %1 读取 %2 字节","iotbit.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","iotbit.blocks.i2sPlay":"I2S播放 %1","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.playMusicDone":"播放 %1 等待播完","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"开场","iotbit.blocks.musicEntertainer":"娱乐","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"颂歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"铃声","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"蓝调","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚礼","iotbit.blocks.musicFuneral":"葬礼","iotbit.blocks.musicPunchline":"笑点","iotbit.blocks.musicPython":"贪吃蛇","iotbit.blocks.musicBaddy":"坏人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"奖励","iotbit.blocks.musicWawawawaa":"退场","iotbit.blocks.musicJumpUp":"跳起来","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打开电源","iotbit.blocks.musicPowerDown":"关闭电源","iotbit.blocks.magneticForce":"磁力%1","iotbit.blocks.strength":"强度","iotbit.blocks.compassHeading":"指南针朝向","iotbit.blocks.calibrateCompass":"校准指南针","iotbit.blocks.acceleration":"加速度%1","iotbit.blocks.accelerometerRange":"将加速计范围设为%1","iotbit.blocks.gyroscope":"陀螺仪%1","iotbit.blocks.rotation":"旋转%1","iotbit.blocks.rotationPitch":"俯仰","iotbit.blocks.rotationRoll":"横滚","iotbit.blocks.rotationYaw":"偏航","iotbit.blocks.gesture":"%1 手势？","iotbit.blocks.gestureShake":"震动","iotbit.blocks.gestureLedsUp":"LED 朝上","iotbit.blocks.gestureLedsDown":"LED 朝下","iotbit.blocks.gestureScreenUp":"屏幕朝上","iotbit.blocks.gestureScreenDown":"屏幕朝下","iotbit.blocks.gestureTiltLeft":"向左倾斜","iotbit.blocks.gestureTiltRight":"向右倾斜","iotbit.blocks.gestureFreeFall":"自由落体","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"光线强度","iotbit.blocks.loudness":"声音响度","iotbit.blocks.temperature":"温度","iotbit.blocks.setLeds":"将第 %1 个灯设为 %2 亮度 %3","iotbit.blocks.closeLeds":"关闭所有灯","iotbit.blocks.displayText":"在 x:%2 y:%3 显示 %1","iotbit.blocks.displayTextLine":"在第%2行显示%1","iotbit.blocks.displayImage":"显示%1","iotbit.blocks.displayClear":"清除屏幕","iotbit.blocks.displayPixel":"在 x1:%1 y1:%2 画点","iotbit.blocks.displayLine":"从 x1:%1 y1:%2 到 x2:%3 y2%4 的画线","iotbit.blocks.displayEllipse":"在 x:%3 y:%4 画横半径%1 纵半径%2 的椭圆","iotbit.blocks.displayRect":"在 x:%3 y:%4 画宽%1 高%2 的矩形","iotbit.blocks.displayFill":"在 x:%3 y:%4 填充宽%1 高%2 的矩形","iotbit.blocks.terminal":"终端","iotbit.blocks.terminalPrint":"打印 %1","iotbit.blocks.terminalEval":"执行 %1"};var u2={"iotbit.menubar.device":"iot:bit","iotbit.extension.tags.controllers":"輸入模組","iotbit.extension.tags.sensors":"傳感器","iotbit.extension.tags.actuators":"執行器","iotbit.extension.tags.displays":"顯示模組","iotbit.extension.tags.modules":"智能模組","iotbit.extension.tags.communication":"通訊","iotbit.extension.tags.data":"數據","iotbit.extension.tags.kits":"套件","iotbit.emu.greenFlag":"運行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"縮小舞臺","iotbit.emu.largeStage":"放大舞臺","iotbit.blocks.wait":"等待 %1 毫秒","iotbit.blocks.break":"跳出重複","iotbit.blocks.continue":"跳到下一次","iotbit.blocks.elseif":"否則，如果 %1 那麼","iotbit.blocks.else":"否則","iotbit.blocks.runtime":"運行時長 %1","iotbit.blocks.runtimeMilliseconds":"毫秒","iotbit.blocks.runtimeSeconds":"秒","iotbit.blocks.dataConvert":"將 %1 轉為 %2","iotbit.blocks.dataConvert.int":"整數","iotbit.blocks.dataConvert.float":"浮點數","iotbit.blocks.dataConvert.string":"字符串","iotbit.blocks.dataConvert.list":"列表","iotbit.blocks.dataLengthOf":"%1 長度","iotbit.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","iotbit.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","iotbit.blocks.whenstart":"當 iot:bit 開始","iotbit.blocks.timerset":"將定時器 # %1 間隔設為每 %2 毫秒","iotbit.blocks.timeroff":"關閉定時器 # %1","iotbit.blocks.operatorLarger":"%1 和 %2 之中最大","iotbit.blocks.operatorSmaller":"%1 和 %2 之中最小","iotbit.blocks.pin":"引腳","iotbit.blocks.setmode":"將引腳 %1 設為 %2 模式","iotbit.blocks.inputMode":"輸入","iotbit.blocks.ouputMode":"輸出","iotbit.blocks.inputPullUpMode":"上拉輸入","iotbit.blocks.inputPullDownMode":"下拉輸入","iotbit.blocks.setdigital":"將引腳 %1 設為 %2","iotbit.blocks.digitalHigh":"高電平","iotbit.blocks.digitalLow":"低電平","iotbit.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","iotbit.blocks.setpwm":"將引腳 %1 PWM 設為 %2","iotbit.blocks.setanalog":"將引腳 %1 模擬值設為 %2","iotbit.blocks.isDigitalHigh":"引腳 %1 是高電平？","iotbit.blocks.analogValue":"引腳 %1 模擬值","iotbit.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","iotbit.blocks.interruptRising":"電平上升","iotbit.blocks.interruptFalling":"電平下降","iotbit.blocks.interruptChange":"電平改變","iotbit.blocks.interruptHigh":"高電平","iotbit.blocks.interruptLow":"低電平","iotbit.blocks.detachinterrupt":"取消引腳 %1 中斷","iotbit.blocks.network":"網絡","iotbit.blocks.sensing":"偵測","iotbit.blocks.display":"顯示","iotbit.blocks.sound":"聲音","iotbit.blocks.text":"文本","iotbit.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","iotbit.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","iotbit.blocks.textReplace":"將 %2 中的 %1 替換為 %3","iotbit.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","iotbit.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","iotbit.blocks.textFind":"在 %2 中查找 %1 的位置","iotbit.blocks.textWith":"%1 %2 %3?","iotbit.blocks.textStartsWith":"開始於","iotbit.blocks.textEndsWith":"結束於","iotbit.blocks.textCase":"將 %2 字母轉為 %1","iotbit.blocks.textLowerCase":"小寫","iotbit.blocks.textUpperCase":"大寫","iotbit.blocks.textTrim":"清除 %1 前後空白字符","iotbit.blocks.textConvert":"將 %1 轉為 %2","iotbit.blocks.textConvertFrom":"將 %1 轉為文本","iotbit.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","iotbit.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","iotbit.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","iotbit.blocks.wifiScan":"開始掃描 Wi-Fi","iotbit.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","iotbit.blocks.wifiItemSsid":"SSID","iotbit.blocks.wifiItemMac":"MAC","iotbit.blocks.wifiItemRssi":"RSSI","iotbit.blocks.wifiItemSecurity":"加密類型","iotbit.blocks.wifiCounts":"可用 Wi-Fi 數量","iotbit.blocks.startap":"開啟 AP SSID: %1","iotbit.blocks.stopap":"關閉 AP","iotbit.blocks.espnowBroadcast":"ESP-Now 廣播 %1","iotbit.blocks.espnowSend":"ESP-Now 發送 %1 給 %2","iotbit.blocks.espnowRecv":"等待 ESP-Now 接收消息","iotbit.blocks.espnowMsg":"收到的 %1","iotbit.blocks.espnowMsgText":"消息","iotbit.blocks.espnowMsgMac":"MAC 地址","iotbit.blocks.espnowRepeat":"等待 ESP-Now 收到消息","iotbit.blocks.espnowWhen":"當 ESP-Now 收到 %1","iotbit.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 寫入 %2","iotbit.blocks.spiRead":"SPI %1 讀取 %2 位元組","iotbit.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","iotbit.blocks.i2cScan":"I2C掃描設備","iotbit.blocks.i2cWrite":"I2C寫入到 %1:%2","iotbit.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","iotbit.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","iotbit.blocks.i2sPlay":"I2S播放 %1","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.playMusicDone":"播放 %1 直到結束","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"開場","iotbit.blocks.musicEntertainer":"娛樂","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"頌歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"鈴聲","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"藍調","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚禮","iotbit.blocks.musicFuneral":"葬禮","iotbit.blocks.musicPunchline":"笑點","iotbit.blocks.musicPython":"貪吃蛇","iotbit.blocks.musicBaddy":"壞人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"獎勵","iotbit.blocks.musicWawawawaa":"退場","iotbit.blocks.musicJumpUp":"跳起來","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打開電源","iotbit.blocks.musicPowerDown":"關閉電源","iotbit.blocks.magneticForce":"磁力%1","iotbit.blocks.strength":"強度","iotbit.blocks.compassHeading":"指南針朝向","iotbit.blocks.calibrateCompass":"校準指南針","iotbit.blocks.acceleration":"加速度%1","iotbit.blocks.accelerometerRange":"將加速計範圍設為%1","iotbit.blocks.gyroscope":"陀螺儀%1","iotbit.blocks.rotation":"旋轉%1","iotbit.blocks.rotationPitch":"俯仰","iotbit.blocks.rotationRoll":"橫滾","iotbit.blocks.rotationYaw":"偏航","iotbit.blocks.gesture":"%1 手勢？","iotbit.blocks.gestureShake":"震動","iotbit.blocks.gestureLedsUp":"LED 朝上","iotbit.blocks.gestureLedsDown":"LED 朝下","iotbit.blocks.gestureScreenUp":"屏幕朝上","iotbit.blocks.gestureScreenDown":"屏幕朝下","iotbit.blocks.gestureTiltLeft":"向左傾斜","iotbit.blocks.gestureTiltRight":"向右傾斜","iotbit.blocks.gestureFreeFall":"自由落體","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"光線強度","iotbit.blocks.loudness":"聲音響度","iotbit.blocks.temperature":"温度","iotbit.blocks.setLeds":"將第 %1 個燈設為 %2 亮度 %3","iotbit.blocks.closeLeds":"關閉所有燈","iotbit.blocks.displayText":"在 x:%2 y:%3 顯示 %1","iotbit.blocks.displayTextLine":"在第%2行顯示%1","iotbit.blocks.displayImage":"顯示%1","iotbit.blocks.displayClear":"清除屏幕","iotbit.blocks.displayPixel":"在 x1:%1 y1:%2 畫點","iotbit.blocks.displayLine":"從 x1:%1 y1:%2 到 x2:%3 y2%4 的畫線","iotbit.blocks.displayEllipse":"在 x:%3 y:%4 畫橫半徑%1 縱半徑%2 的橢圓","iotbit.blocks.displayRect":"在 x:%3 y:%4 畫寬%1 高%2 的矩形","iotbit.blocks.displayFill":"在 x:%3 y:%4 填充寬%1 高%2 的矩形","iotbit.blocks.terminal":"終端","iotbit.blocks.terminalPrint":"打印 %1","iotbit.blocks.terminalEval":"執行 %1"};Q2({en:d2,"zh-Hans":b2,"zh-Hant":u2});import{svgAsDataUri as Ut}from"@blockcode/utils";import{ScratchBlocks as V,blocksTab as Gt,codeReviewTab as Ht,CodeReview as v4}from"@blockcode/blocks";import{terminalTab as Yt}from"@blockcode/code";import{Text as Xt}from"@blockcode/core";function R(t){if(typeof t!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(t))}function p2(t,i){var e="",o=0,s=-1,l=0,n;for(var a=0;a<=t.length;++a){if(a<t.length)n=t.charCodeAt(a);else if(n===47)break;else n=47;if(n===47){if(s===a-1||l===1);else if(s!==a-1&&l===2){if(e.length<2||o!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var c=e.lastIndexOf("/");if(c!==e.length-1){if(c===-1)e="",o=0;else e=e.slice(0,c),o=e.length-1-e.lastIndexOf("/");s=a,l=0;continue}}else if(e.length===2||e.length===1){e="",o=0,s=a,l=0;continue}}if(i){if(e.length>0)e+="/..";else e="..";o=2}}else{if(e.length>0)e+="/"+t.slice(s+1,a);else e=t.slice(s+1,a);o=a-s-1}s=a,l=0}else if(n===46&&l!==-1)++l;else l=-1}return e}function j2(t,i){var e=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");if(!e)return o;if(e===i.root)return e+o;return e+t+o}function H(){var t="",i=!1,e;for(var o=arguments.length-1;o>=-1&&!i;o--){var s;if(o>=0)s=arguments[o];else{if(e===void 0)e=process.cwd();s=e}if(R(s),s.length===0)continue;t=s+"/"+t,i=s.charCodeAt(0)===47}if(t=p2(t,!i),i)if(t.length>0)return"/"+t;else return"/";else if(t.length>0)return t;else return"."}function h2(t){if(R(t),t.length===0)return".";var i=t.charCodeAt(0)===47,e=t.charCodeAt(t.length-1)===47;if(t=p2(t,!i),t.length===0&&!i)t=".";if(t.length>0&&e)t+="/";if(i)return"/"+t;return t}function tt(t){return R(t),t.length>0&&t.charCodeAt(0)===47}function it(){if(arguments.length===0)return".";var t;for(var i=0;i<arguments.length;++i){var e=arguments[i];if(R(e),e.length>0)if(t===void 0)t=e;else t+="/"+e}if(t===void 0)return".";return h2(t)}function et(t,i){if(R(t),R(i),t===i)return"";if(t=H(t),i=H(i),t===i)return"";var e=1;for(;e<t.length;++e)if(t.charCodeAt(e)!==47)break;var o=t.length,s=o-e,l=1;for(;l<i.length;++l)if(i.charCodeAt(l)!==47)break;var n=i.length,a=n-l,c=s<a?s:a,b=-1,r=0;for(;r<=c;++r){if(r===c){if(a>c){if(i.charCodeAt(l+r)===47)return i.slice(l+r+1);else if(r===0)return i.slice(l+r)}else if(s>c){if(t.charCodeAt(e+r)===47)b=r;else if(r===0)b=0}break}var N=t.charCodeAt(e+r),B=i.charCodeAt(l+r);if(N!==B)break;else if(N===47)b=r}var x="";for(r=e+b+1;r<=o;++r)if(r===o||t.charCodeAt(r)===47)if(x.length===0)x+="..";else x+="/..";if(x.length>0)return x+i.slice(l+b);else{if(l+=b,i.charCodeAt(l)===47)++l;return i.slice(l)}}function ot(t){return t}function st(t){if(R(t),t.length===0)return".";var i=t.charCodeAt(0),e=i===47,o=-1,s=!0;for(var l=t.length-1;l>=1;--l)if(i=t.charCodeAt(l),i===47){if(!s){o=l;break}}else s=!1;if(o===-1)return e?"/":".";if(e&&o===1)return"//";return t.slice(0,o)}function Y(t,i){if(i!==void 0&&typeof i!=="string")throw TypeError('"ext" argument must be a string');R(t);var e=0,o=-1,s=!0,l;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var n=i.length-1,a=-1;for(l=t.length-1;l>=0;--l){var c=t.charCodeAt(l);if(c===47){if(!s){e=l+1;break}}else{if(a===-1)s=!1,a=l+1;if(n>=0)if(c===i.charCodeAt(n)){if(--n===-1)o=l}else n=-1,o=a}}if(e===o)o=a;else if(o===-1)o=t.length;return t.slice(e,o)}else{for(l=t.length-1;l>=0;--l)if(t.charCodeAt(l)===47){if(!s){e=l+1;break}}else if(o===-1)s=!1,o=l+1;if(o===-1)return"";return t.slice(e,o)}}function X(t){R(t);var i=-1,e=0,o=-1,s=!0,l=0;for(var n=t.length-1;n>=0;--n){var a=t.charCodeAt(n);if(a===47){if(!s){e=n+1;break}continue}if(o===-1)s=!1,o=n+1;if(a===46){if(i===-1)i=n;else if(l!==1)l=1}else if(i!==-1)l=-1}if(i===-1||o===-1||l===0||l===1&&i===o-1&&i===e+1)return"";return t.slice(i,o)}function lt(t){if(t===null||typeof t!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return j2("/",t)}function nt(t){R(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var e=t.charCodeAt(0),o=e===47,s;if(o)i.root="/",s=1;else s=0;var l=-1,n=0,a=-1,c=!0,b=t.length-1,r=0;for(;b>=s;--b){if(e=t.charCodeAt(b),e===47){if(!c){n=b+1;break}continue}if(a===-1)c=!1,a=b+1;if(e===46){if(l===-1)l=b;else if(r!==1)r=1}else if(l!==-1)r=-1}if(l===-1||a===-1||r===0||r===1&&l===a-1&&l===n+1){if(a!==-1)if(n===0&&o)i.base=i.name=t.slice(1,a);else i.base=i.name=t.slice(n,a)}else{if(n===0&&o)i.name=t.slice(1,l),i.base=t.slice(1,a);else i.name=t.slice(n,l),i.base=t.slice(n,a);i.ext=t.slice(l,a)}if(n>0)i.dir=t.slice(0,n-1);else if(o)i.dir="/";return i}var at="/",rt=":",i1=((t)=>(t.posix=t,t))({resolve:H,normalize:h2,isAbsolute:tt,join:it,relative:et,_makeLong:ot,dirname:st,basename:Y,extname:X,format:lt,parse:nt,sep:at,delimiter:rt,win32:null,posix:null});import{useCallback as pt}from"preact/hooks";import{useAppContext as ht,useProjectContext as ft}from"@blockcode/core";import{MicroPythonGenerator as gt,BlocksEditor as Ct}from"@blockcode/blocks";import{translate as u,themeColors as z}from"@blockcode/core";var f2=()=>({id:"pin",name:u("iotbit.blocks.pin","Pins"),themeColor:z.blocks.motion.primary,inputColor:z.blocks.motion.secondary,otherColor:z.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:u("iotbit.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:"PINS"},MODE:{menu:[[u("iotbit.blocks.ouputMode","output"),"OUTPUT"],[u("iotbit.blocks.inputMode","input"),"INPUT"],[u("iotbit.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[u("iotbit.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=t.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let s="";if(o==="INPUT")s=`${e} = Pin(${i}, Pin.IN)`;else if(o==="INPUT_PULLUP")s=`${e} = Pin(${i}, Pin.IN, Pin.PULL_UP)`;else if(o==="INPUT_PULLDOWN")s=`${e} = Pin(${i}, Pin.IN, Pin.PULL_DOWN)`;else s=`${e} = Pin(${i}, Pin.OUT)`;return this.definitions_[e]=s,""}},"---",{id:"setdigital",text:u("iotbit.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:"OUT_PINS"},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[u("iotbit.blocks.digitalHigh","high"),"1"],[u("iotbit.blocks.digitalLow","low"),"0"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[e]=this.definitions_[e]??`${e} = Pin(${i}, Pin.OUT)`,`${e}.value(${o})
`}},{id:"setDAC",text:u("iotbit.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:"DAC_PINS"},VALUE:{shadow:"slider255"}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[e]=`${e} = DAC(Pin(${i}))`,`${e}.write(${o})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(t){return[t.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},{id:"digital",text:u("iotbit.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:"PINS"}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[e]=`${e} = Pin(${i}, Pin.IN)`,[`(${e}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:u("iotbit.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:"ADC_PINS"}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[e]=`${e} = ADC(Pin(${i}))`,this.definitions_[`${e}_atten`]=`${e}.atten(ADC.ATTN_11DB)`,this.definitions_[`${e}_width`]=`${e}.width(ADC.WIDTH_10BIT)`,[`${e}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:u("iotbit.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:"OUT_PINS"},FREQ:{type:"integer",defaultValue:"1000"}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=this.valueToCode(t,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[e]=`${e} = PWM(Pin(${i}), freq=1000)`,`${e}.freq(${o})
`}},{id:"setPWM",text:u("iotbit.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:"OUT_PINS"},VALUE:{shadow:"slider1023"}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[e]=`${e} = PWM(Pin(${i}), freq=1000)`,`${e}.duty(${o})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(t){return[t.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:u("iotbit.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:"PINS"},INTERRUPT:{menu:[[u("iotbit.blocks.interruptRising","rising"),"RISING"],[u("iotbit.blocks.interruptFalling","falling"),"FALLING"],[u("iotbit.blocks.interruptChange","change"),"CHANGE"],[u("iotbit.blocks.interruptHigh","high"),"HIGH"],[u("iotbit.blocks.interruptLow","low"),"LOW"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,e=`pin_${i}`,o=`interrupt_${i}_flag`,s=t.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[e]=this.definitions_[e]??`${e} = Pin(${i}, Pin.IN)`,this.definitions_[o]=`${o} = asyncio.ThreadSafeFlag()`;let l=this.statementToCode(t,"SUBSTACK")||this.PASS,n="";n+=`while True:
`,n+=`${this.INDENT}await ${o}.wait()
`,n+=l,l=this.prefixLines(n,this.INDENT),l=this.addEventTrap(l,t.id),n=`@_tasks__.append
`,n+=l,this.definitions_[`interrupt_${i}`]=n;let c={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[s]||"Pin.IRQ_RISING";return`${e}.irq(trigger=${c}, handler=lambda _: ${o}.set())
`}},{id:"detachinterrupt",text:u("iotbit.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:"PINS"}},mpy(t){return`pin_${t.getFieldValue("PIN")||0}.irq(handler=None)
`}}],menus:{PINS:{items:[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P6","16"],["P7","17"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P13","18"],["P14","19"],["P15","21"],["P16","5"],["P19","22"],["P20","23"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]]},OUT_PINS:{items:[["P0","33"],["P1","32"],["P5","0"],["P6","16"],["P7","17"],["P8","26"],["P9","25"],["P11","2"],["P13","18"],["P14","19"],["P15","21"],["P16","5"],["P19","22"],["P20","23"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]]},ADC_PINS:{items:[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]]},DAC_PINS:{items:[["P8","26"],["P9","25"]]}}});import{translate as L,themeColors as q}from"@blockcode/core";var g2=()=>({id:"display",name:L("iotbit.blocks.display","Display"),themeColor:q.blocks.looks.primary,inputColor:q.blocks.looks.secondary,otherColor:q.blocks.looks.tertiary,order:1,blocks:[{id:"setLeds",text:L("iotbit.blocks.setLeds","set led %1 %2 brightness %3"),inputs:{POS:{type:"positive_integer",defaultValue:1},COLOR:{type:"color"},BRIGHTNESS:{shadow:"brightnessSlider",defaultValue:10}},mpy(t){let i=this.getAdjusted(t,"POS"),e=this.valueToCode(t,"COLOR",this.ORDER_NONE),o=this.valueToCode(t,"BRIGHTNESS",this.ORDER_NONE),s="";if(s+=`pixels.set_led(${i}, ${o}, ${e})
`,t.getNextBlock()?.type.endsWith("_setLeds"))return s;return s+=`pixels.write()
`,s}},{id:"brightnessSlider",shadow:!0,output:"number",inputs:{BRIGHTNESS:{type:"slider",defaultValue:0,min:0,max:10}},mpy(t){return[t.getFieldValue("BRIGHTNESS")||0,this.ORDER_NONE]}},{id:"closeLeds",text:L("iotbit.blocks.closeLeds","close leds"),mpy(t){return`pixels.clear()
`}},"---",{id:"displayText",text:L("iotbit.blocks.displayText","display text %1 at x: %2 y: %3"),inputs:{TEXT:{type:"string",defaultValue:"hello"},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"TEXT",this.ORDER_NONE),e=this.valueToCode(t,"X",this.ORDER_NONE),o=this.valueToCode(t,"Y",this.ORDER_NONE),s=`display.write(f"{${i}}", ${e}, ${o})
`,l=t.getNextBlock();if(l&&l.type.search(/_display[\w]+$/)!==-1)return s;return s+=`display.show()
`,s}},{id:"displayTextLine",text:L("iotbit.blocks.displayTextLine","display text %1 at line %2"),inputs:{TEXT:{type:"string",defaultValue:"hello world"},LINE:{menu:[1,2,3,4,5]}},mpy(t){let i=this.valueToCode(t,"TEXT",this.ORDER_NONE),e=parseInt(t.getFieldValue("LINE"))-1,o=`display.write(f"{${i}}", 2, ${e*13}, wrap=True)
`,s=t.getNextBlock();if(s&&s.type.search(/_display[\w]+$/)!==-1)return o;return o+=`display.show()
`,o}},{id:"displayClear",text:L("iotbit.blocks.displayClear","clear display"),mpy(t){let i=`display.fill(0)
`,e=t.getNextBlock();if(e&&e.type.search(/_display[\w]+$/)!==-1)return i;return i+=`display.show()
`,i}},"---",{id:"displayPixel",text:L("iotbit.blocks.displayPixel","pixel x:%1 y:%2"),inputs:{X:{type:"integer",defaultValue:10},Y:{type:"integer",defaultValue:10}},mpy(t){let i=this.valueToCode(t,"X",this.ORDER_NONE),e=this.valueToCode(t,"Y",this.ORDER_NONE),o=`display.pixel(${i}, ${e}, 1)
`,s=t.getNextBlock();if(s&&s.type.search(/_display[\w]+$/)!==-1)return o;return o+=`display.show()
`,o}},{id:"displayLine",text:L("iotbit.blocks.displayLine","line from x1:%1 y1:%2 to x2:%3 y2%4"),inputs:{X1:{type:"integer",defaultValue:0},Y1:{type:"integer",defaultValue:0},X2:{type:"integer",defaultValue:20},Y2:{type:"integer",defaultValue:20}},mpy(t){let i=this.valueToCode(t,"X1",this.ORDER_NONE),e=this.valueToCode(t,"Y1",this.ORDER_NONE),o=this.valueToCode(t,"X2",this.ORDER_NONE),s=this.valueToCode(t,"Y2",this.ORDER_NONE),l=`display.line(${i}, ${e}, ${o}, ${s})
`,n=t.getNextBlock();if(n&&n.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l}},{id:"displayEllipse",text:L("iotbit.blocks.displayEllipse","ellipse with x-radius:%1 and y-radius:%2 at x:%3 y:%4"),inputs:{RX:{type:"positive_integer",defaultValue:20},RY:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"RX",this.ORDER_NONE),e=this.valueToCode(t,"RY",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),s=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.ellipse(${o}, ${s}, ${i}, ${e})
`,n=t.getNextBlock();if(n&&n.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l}},{id:"displayRect",text:L("iotbit.blocks.displayRect","rect with width:%1 height:%2 at x:%3 y:%4"),inputs:{WIDTH:{type:"positive_integer",defaultValue:20},HEIGHT:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"WIDTH",this.ORDER_NONE),e=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),s=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.rect(${o}, ${s}, ${i}, ${e})
`,n=t.getNextBlock();if(n&&n.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l}},{id:"displayFill",text:L("iotbit.blocks.displayFill","fill with width:%1 height:%2 at x:%3 y:%4"),inputs:{WIDTH:{type:"positive_integer",defaultValue:20},HEIGHT:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"WIDTH",this.ORDER_NONE),e=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),s=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.fill_rect(${o}, ${s}, ${i}, ${e})
`,n=t.getNextBlock();if(n&&n.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l}}]});import{translate as d,themeColors as K}from"@blockcode/core";var C2=()=>({id:"sound",name:"%{BKY_CATEGORY_SOUND}",themeColor:K.blocks.sounds.primary,inputColor:K.blocks.sounds.secondary,otherColor:K.blocks.sounds.tertiary,order:2,blocks:[{id:"playnote",text:d("iotbit.blocks.playNote","play note %1 for %2 beats"),inputs:{NOTE:{type:"note",defaultValue:"60"},BEAT:{type:"integer",defaultValue:"1"}},mpy(t){let i=this.valueToCode(t,"NOTE",this.ORDER_NONE),e=this.valueToCode(t,"BEAT",this.ORDER_NONE);return`audio.play(${i}":${e}")
`}},"---",{id:"playmusicawait",text:d("iotbit.blocks.playMusicDone","play sound %1 until done"),inputs:{MUSIC:{menu:"MUSIC"}},mpy(t){return`await audio.aplay(Music.${t.getFieldValue("MUSIC").toUpperCase()})
`}},{id:"playmusic",text:d("iotbit.blocks.playMusic","start sound %1"),inputs:{MUSIC:{menu:"MUSIC"}},mpy(t){return`asyncio.create_task(audio.aplay(Music.${t.getFieldValue("MUSIC").toUpperCase()}))
`}},{id:"stopmusic",text:d("iotbit.blocks.stopMusic","stop music"),mpy(t){return`audio.stop()
`}}],menus:{MUSIC:{type:"string",defaultValue:"dadadadum",items:[[d("iotbit.blocks.musicDadadadum","dadadadum"),"dadadadum"],[d("iotbit.blocks.musicEntertainer","entertainer"),"entertainer"],[d("iotbit.blocks.musicPrelude","prelude"),"prelude"],[d("iotbit.blocks.musicOde","ode"),"ode"],[d("iotbit.blocks.musicNyan","nyan"),"nyan"],[d("iotbit.blocks.musicRingtone","ringtone"),"ringtone"],[d("iotbit.blocks.musicFunk","funk"),"funk"],[d("iotbit.blocks.musicBlues","blues"),"blues"],[d("iotbit.blocks.musicBirthday","birthday"),"birthday"],[d("iotbit.blocks.musicWedding","wedding"),"wedding"],[d("iotbit.blocks.musicFuneral","funeral"),"funeral"],[d("iotbit.blocks.musicPunchline","punchline"),"punchline"],[d("iotbit.blocks.musicPython","python"),"python"],[d("iotbit.blocks.musicBaddy","baddy"),"baddy"],[d("iotbit.blocks.musicChase","chase"),"chase"],[d("iotbit.blocks.musicBaDing","ba ding"),"ba ding"],[d("iotbit.blocks.musicWawawawaa","wawawawaa"),"wawawawaa"],[d("iotbit.blocks.musicJumpUp","jump up"),"jump up"],[d("iotbit.blocks.musicJumpDown","jump down"),"jump down"],[d("iotbit.blocks.musicPowerUp","power up"),"power up"],[d("iotbit.blocks.musicPowerDown","power down"),"power down"]]}}});import{translate as J,themeColors as Q}from"@blockcode/core";import{ScratchBlocks as ct}from"@blockcode/blocks";var m2=["1","2","3","4"],k2=()=>({id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:Q.blocks.events.primary,inputColor:Q.blocks.events.secondary,otherColor:Q.blocks.events.tertiary,blocks:[{id:"whenstart",text:J("iotbit.blocks.whenstart","when iot:bit start"),hat:!0,mpy(t){let i=this.statementToCode(t)||this.PASS;i=this.addEventTrap(i,t.id);let e="";return e+=`@_tasks__.append
`,e+=i,e}},"---",{id:"whenkeypressed",text:ct.Msg.EVENT_WHENKEYPRESSED,hat:!0,inputs:{KEY_OPTION:{type:"string",defaultValue:"a",menu:[["a","a"],["b","b"],["a+b","ab"]]}},mpy(t){let i=t.getFieldValue("KEY_OPTION"),e=`${this.getFunctionName(t.id)}_flag`;this.definitions_[e]=`${e} = asyncio.ThreadSafeFlag()
`,this.definitions_[e]+=`button_${i}.on_pressed(lambda _: ${e}.set())`;let o=this.statementToCode(t)||this.PASS,s="";return s+=`while True:
`,s+=`  await ${e}.wait()
`,s+=o,o=this.prefixLines(s,this.INDENT),o=this.addEventTrap(o,t.id),s=`@_tasks__.append
`,s+=o,s}},"---",{id:"timerset",text:J("iotbit.blocks.timerset","set timer # %1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:m2},PERIOD:{type:"integer",defaultValue:500}},mpy(t){let i=this.valueToCode(t,"PERIOD",this.ORDER_NONE)||500,e=parseInt(t.getFieldValue("ID")||"1",10)-1;if(e<0)e=0;let o=`timer_${e}`,s=`period_${e}_flag`;this.definitions_.import_timer="from machine import Timer",this.definitions_[o]=`${o} = Timer(${e})`,this.definitions_[s]=`${s} = asyncio.ThreadSafeFlag()`;let l=this.statementToCode(t,"SUBSTACK")||this.PASS,n="";return n+=`while True:
`,n+=`${this.INDENT}await ${s}.wait()
`,n+=l,l=this.prefixLines(n,this.INDENT),l=this.addEventTrap(l,t.id),n=`@_tasks__.append
`,n+=l,this.definitions_[`period_${e}`]=n,`${o}.init(mode=Timer.PERIODIC, period=${i}, callback=lambda _: ${s}.set())
`}},{id:"timeroff",text:J("iotbit.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:m2}},mpy(t){let i=parseInt(t.getFieldValue("ID")||"1",10)-1;if(i<0)i=0;return`timer_${i}.deinit()
`}}]});import{translate as S,themeColors as j}from"@blockcode/core";import{ScratchBlocks as D}from"@blockcode/blocks";var L2=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:j.blocks.control.primary,inputColor:j.blocks.control.secondary,otherColor:j.blocks.control.tertiary,blocks:[{id:"wait",text:S("iotbit.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(t){return`await asyncio.sleep_ms(${this.valueToCode(t,"MS",this.ORDER_NONE)})
`}},{id:"forever",text:D.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:D.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:D.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:S("iotbit.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"False",e=this.statementToCode(t,"SUBSTACK")||this.PASS,o="";return o+=`elif ${i}:
`,o+=e,o}},{id:"else",text:S("iotbit.blocks.else","else"),substack:!0,mpy(t){let i=this.statementToCode(t,"SUBSTACK")||this.PASS,e="";return e+=`else:
`,e+=i,e}},"---",{id:"repeat_until",text:D.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:D.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:S("iotbit.blocks.continue","continue"),end:!0,mpy(t){return`continue
`}},{id:"break",text:S("iotbit.blocks.break","break"),end:!0,mpy(t){return`break
`}}]});import{translate as p,themeColors as g1}from"@blockcode/core";var h="";h+=`async def espnow_asend(msg, mac="ff:ff:ff:ff:ff:ff"):
`;h+=`  chuck_size = 250
`;h+=`  msg_data = msg if type(msg) is bytes else str(msg).encode()
`;h+=`  size = len(msg_data)
`;h+=`  if size > chuck_size:
`;h+=`    chucks_count = 1 + size // chuck_size
`;h+=`    for i in range(chucks_count):
`;h+=`      n = i * chuck_size
`;h+=`      m = (i + 1) * chuck_size
`;h+=`      data = msg_data[n:m] if m <= size else msg_data[n:]
`;h+=`      await espnow_asend(data, mac)
`;h+=`    return
`;h+=`  mac_addr = bytes.fromhex(mac.replace(":", "")) if type(mac) is str else mac
`;h+=`  try:
`;h+=`    await espnow.asend(mac_addr, msg_data)
`;h+=`  except OSError as err:
`;h+=`    if len(err.args) > 1 and err.args[1] == "ESP_ERR_ESPNOW_NOT_FOUND":
`;h+=`      espnow.add_peer(mac_addr)
`;h+=`      await espnow.asend(mac_addr, msg_data)
`;var R2=()=>({id:"network",name:p("iotbit.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:5,blocks:[{id:"connectwifi",text:p("iotbit.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"iotbit"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let i=this.valueToCode(t,"SSID",this.ORDER_NONE),e=this.valueToCode(t,"PASSWORD",this.ORDER_NONE);i=isNaN(i)?i:this.quote_(i),e=isNaN(e)?e:this.quote_(e);let o="";return o+="if not wlan.isconnected(): threading.start_new_thread(",o+=`lambda: wlan.connect(${i}, ${e}), ())
`,o+="while wlan.active() and not wlan.isconnected(): ",o+=`await asyncio.sleep_ms(500)
`,o}},{id:"disconnect",text:p("iotbit.blocks.disconnectWifi","disconnect wifi"),mpy(t){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let i="";return i+=`wlan.disconnect()
`,i+=`wlan.active(False)
`,i}},{id:"isconnected",text:p("iotbit.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"wifiscan",text:p("iotbit.blocks.wifiScan","start scan wifi"),mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let i="";return i+="threading.start_new_thread(",i+=`lambda: wifi_list.extend(wlan.scan()), ())
`,i}},{id:"wifiitem",text:p("iotbit.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[p("iotbit.blocks.wifiItemSsid","ssid"),"SSID"],[p("iotbit.blocks.wifiItemMac","mac"),"MAC"],[p("iotbit.blocks.wifiItemRssi","rssi"),"RSSI"],[p("iotbit.blocks.wifiItemSecurity","security"),"SECURITY"]]}},mpy(t){let i=this.getAdjusted(t,"INDEX")||0,e=t.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let o=`wifi_list[${i}]`;switch(e){case"MAC":o+="[1]";break;case"RSSI":o+="[3]";break;case"SECURITY":o+="[4]";break;default:o+="[0]";break}return[o,this.ORDER_ATOMIC]}},{id:"wificounts",text:p("iotbit.blocks.wifiCounts","available wifi counts"),output:"number",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},"---",{id:"startap",text:p("iotbit.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(t){let i=this.valueToCode(t,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let e="";return e+=`ap.config(ssid=${i})
`,e+=`ap.active(True)
`,e}},{id:"stopap",text:p("iotbit.blocks.stopap","stop ap"),mpy(t){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:p("iotbit.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(t){let i=this.valueToCode(t,"MESSAGE",this.ORDER_NONE),e=this.valueToCode(t,"MAC",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=h,`await espnow_asend(${i}, ${e})
`}},{id:"espnowbroadcast",text:p("iotbit.blocks.espnowBroadcast","broadcast %1 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"}},mpy(t){let i=this.valueToCode(t,"MESSAGE",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=h,`await espnow_asend(${i})
`}},{id:"espnowmsg",text:p("iotbit.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[p("iotbit.blocks.espnowMsgText","message"),"MESSAGE"],[p("iotbit.blocks.espnowMsgMac","mac address"),"MAC"]]}},mpy(t){let i=t.getFieldValue("TYPE")||"MESSAGE";return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",[i==="MAC"?'peer.hex(":")':"msg.decode()",this.ORDER_FUNCTION_CALL]}},"---",{id:"espnowwhen",text:p("iotbit.blocks.espnowWhen","when esp-now receive %1"),hat:!0,inputs:{MESSAGE:{type:"string",defaultValue:p("iotbit.blocks.espnowMsgText","message")}},mpy(t){let i=this.valueToCode(t,"MSG",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let e=`${this.getFunctionName(t.id)}_flag`;if(this.definitions_[e]=`${e} = asyncio.ThreadSafeFlag()`,!this.definitions_.espnowwhen){let l="";l+=`@_tasks__.append
`,l+=`async def espnow_when():
`,l+=`  async for peer, msg in espnow:
`,this.definitions_.espnowwhen=l}this.definitions_.espnowwhen+=`    if msg.decode() == ${i}: ${e}.set()
`;let o=this.statementToCode(t)||this.PASS,s="";return s+=`while True:
`,s+=`  await ${e}.wait()
`,s+=o,o=this.prefixLines(s,this.INDENT),o=this.addEventTrap(o,t.id),s=`@_tasks__.append
`,s+=o,s}},{id:"espnowrepeat",text:p("iotbit.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(t){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let i=this.statementToCode(t,"SUBSTACK")||this.PASS;i=this.addLoopTrap(i,t.id);let e="";return e+=`async for peer, msg in espnow:
`,e+=i,e}}]});import{themeColors as t2,translate as g}from"@blockcode/core";import{ScratchBlocks as dt}from"@blockcode/blocks";var y2=()=>({id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:t2.blocks.sensing.primary,inputColor:t2.blocks.sensing.secondary,otherColor:t2.blocks.sensing.tertiary,blocks:[{id:"keypressed",text:dt.Msg.SENSING_KEYPRESSED,output:"boolean",inputs:{KEY_OPTION:{menu:[["a","a"],["b","b"],["a+b","ab"]]}},mpy(t){return[`button_${t.getFieldValue("KEY_OPTION")}.is_pressed()`,this.ORDER_FUNCTION_CALL]}},"---",{id:"magneticForce",text:g("iotbit.blocks.magneticForce","magnetic force %1"),output:"number",inputs:{MAGNETIC_OPTION:{menu:"xyz"}},mpy(t){let i=t.getFieldValue("MAGNETIC_OPTION");return this.definitions_.compass_calibrate="if not compass.is_calibrated(): compass.calibrate(display)",[`compass.get_${i}()`,this.ORDER_FUNCTION_CALL]}},{id:"compassHeading",text:g("iotbit.blocks.compassHeading","compass heading"),output:"number",mpy(t){return this.definitions_.compass_calibrate="if not compass.is_calibrated(): compass.calibrate(display)",["compass.get_heading()",this.ORDER_FUNCTION_CALL]}},{id:"calibrateCompass",text:g("iotbit.blocks.calibrateCompass","calibrate compass"),mpy(t){return`compass.calibrate(display)
`}},"---",{id:"acceleration",text:g("iotbit.blocks.acceleration","acceleration %1"),output:"number",inputs:{XYZ_OPTION:{menu:"xyz"}},mpy(t){return[`accelerometer.get_${t.getFieldValue("XYZ_OPTION")}()`,this.ORDER_FUNCTION_CALL]}},{id:"accelerometerRange",text:g("iotbit.blocks.accelerometerRange","set accelerometer range %1"),inputs:{RANGE_OPTION:{menu:[["2g","0"],["4g","1"],["8g","2"]]}},mpy(t){return`accelerometer.set_range(${t.getFieldValue("RANGE_OPTION")})
`}},"---",{id:"rotation",text:g("iotbit.blocks.rotation","rotation %1"),output:"number",inputs:{ROTATE_OPTION:{menu:[[g("iotbit.blocks.rotationPitch","pitch"),"pitch"],[g("iotbit.blocks.rotationRoll","roll"),"roll"],[g("iotbit.blocks.rotationYaw","yaw"),"yaw"]]}},mpy(t){return[`gyroscope.get_${t.getFieldValue("ROTATE_OPTION")}()`,this.ORDER_FUNCTION_CALL]}},"---",{id:"brightness",text:g("iotbit.blocks.brightness","brightness"),output:"number",mpy(t){return["light.get_brightness()",this.ORDER_FUNCTION_CALL]}},{id:"loudness",text:g("iotbit.blocks.loudness","loudness"),output:"number",mpy(t){return["microphone.get_loudness()",this.ORDER_FUNCTION_CALL]}},{id:"temperature",text:g("iotbit.blocks.temperature","temperature"),output:"number",mpy(t){return this.definitions_.import_esp32="import esp32",["round((esp32.raw_temperature() - 32) * 5 / 9, 3)",this.ORDER_FUNCTION_CALL]}},"---",{id:"runtime",text:g("iotbit.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[g("iotbit.blocks.runtimeMilliseconds","milliseconds"),"MS"],[g("iotbit.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(t){let i=t.getFieldValue("UNIT"),e="time.ticks_diff(time.ticks_ms(), _times__)";if(i==="SEC")e=`(${e} / 1000)`;return[e,this.ORDER_ATOMIC]}}],menus:{xyz:{items:[["x","x"],["y","y"],["z","z"],[g("iotbit.blocks.strength","strength"),"strength"]]}}});import{translate as y,themeColors as i2}from"@blockcode/core";import{ScratchBlocks as f}from"@blockcode/blocks";var O2=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:i2.blocks.operators.primary,inputColor:i2.blocks.operators.secondary,otherColor:i2.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"+",s={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${i} ${o} ${e})`,s[o]]}},"---",{id:"random",text:f.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(t){this.definitions_.import_random="import random";let i=this.valueToCode(t,"FROM",this.ORDER_NONE),e=this.valueToCode(t,"TO",this.ORDER_NONE);return[`random.randint(${i}, ${e})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||">",s={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${i} ${o} ${e})`,s[o]]}},"---",{id:"and",text:f.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),e=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${i} and ${e})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:f.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),e=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${i} or ${e})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:f.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(t){return[`(not ${this.valueToCode(t,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"&",s={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${i} ${o} ${e})`,s[o]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(t){return[`(~${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:y("iotbit.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`max(${i}, ${e})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:y("iotbit.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`min(${i}, ${e})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:f.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),e=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`(${i} % ${e})`,this.ORDER_MODULUS]}},{id:"round",text:f.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(t){return this.definitions_.import_math="import math",[`round(${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:f.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[f.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[f.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[f.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[f.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[f.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[f.Msg.OPERATORS_MATHOP_COS,"math.cos"],[f.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[f.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[f.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[f.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[f.Msg.OPERATORS_MATHOP_LN,"math.log"],[f.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[f.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[f.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(t){this.definitions_.import_math="import math";let i=t.getFieldValue("OPERATOR")||"abs",e=this.valueToCode(t,"NUM",this.ORDER_NONE),o="";if(i==="pow10")o+=`math.pow(10, ${e})`;else o+=`${i}(${e})`;return[o,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:y("iotbit.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE),e=this.valueToCode(t,"FROM",this.ORDER_NONE),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`min(max(${i}, ${e}), ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:y("iotbit.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE),e=this.valueToCode(t,"FROMLOW",this.ORDER_NONE),o=this.valueToCode(t,"FROMHIGH",this.ORDER_NONE),s=this.valueToCode(t,"TOLOW",this.ORDER_NONE),l=this.valueToCode(t,"TOHIGHT",this.ORDER_NONE);return[`(${i} - ${e}) * (${l} - ${s}) // (${o} - ${e}) + ${s}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:y("iotbit.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(t){return[`len(${this.valueToCode(t,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:y("iotbit.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[y("iotbit.blocks.dataConvert.int","int"),"int"],[y("iotbit.blocks.dataConvert.float","float"),"float"],[y("iotbit.blocks.dataConvert.string","str"),"str"],[y("iotbit.blocks.dataConvert.list","list"),"list"]]}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE);return[`${t.getFieldValue("TYPE")||"int"}(${i})`,this.ORDER_FUNCTION_CALL]}}]});var E2=()=>({id:"data",skipXML:!0,blocks:[{id:"variable",mpy(t){return[this.getVariableName(t.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"setvariableto",mpy(t){let i=this.getVariableName(t.getFieldValue("VARIABLE")),e=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${i} = ${e}
`}},{id:"changevariableby",mpy(t){let i=this.getVariableName(t.getFieldValue("VARIABLE")),e=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${i} += ${e}
`}},{id:"listcontents",mpy(t){return[this.getVariableName(t.getFieldValue("LIST"))+"_ls",this.ORDER_ATOMIC]}},{id:"addtolist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.valueToCode(t,"ITEM",this.ORDER_NONE);return`${i}.append(${e})
`}},{id:"deleteoflist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.getAdjusted(t,"INDEX");return`${i}.pop(${e})
`}},{id:"deletealloflist",mpy(t){return`${this.getVariableName(t.getFieldValue("LIST"))+"_ls"} = []
`}},{id:"insertatlist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.getAdjusted(t,"INDEX"),o=this.valueToCode(t,"ITEM",this.ORDER_NONE);return`${i}.insert(${e}, ${o})
`}},{id:"replaceitemoflist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.valueToCode(t,"ITEM",this.ORDER_NONE),o=this.getAdjusted(t,"INDEX");return`${i}[${o}] = ${e}
`}},{id:"itemoflist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.getAdjusted(t,"INDEX");return[`${i}[${e}]`,this.ORDER_MEMBER]}},{id:"itemnumoflist",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.valueToCode(t,"ITEM",this.ORDER_NONE);return[`${i}.index(${e})`,this.ORDER_FUNCTION_CALL]}},{id:"lengthoflist",mpy(t){return[`len(${this.getVariableName(t.getFieldValue("LIST"))+"_ls"})`,this.ORDER_FUNCTION_CALL]}},{id:"listcontainsitem",mpy(t){let i=this.getVariableName(t.getFieldValue("LIST"))+"_ls",e=this.valueToCode(t,"ITEM",this.ORDER_NONE);return[`(${i}.count(${e}) > 0)`,this.ORDER_FUNCTION_CALL]}}]});var v2=()=>({id:"procedures",skipXML:!0,blocks:[{id:"definition",mpy(t){let i=t.childBlocks_[0],e=this.getFunctionName(i.getProcCode()),o=this.statementToCode(t)||this.PASS,s=i.childBlocks_.map((n)=>`${this.getVariableName(n.getFieldValue("VALUE"))}`),l="";l+=`async def ${e}(${s.join(", ")}):
`,l+=o,this.definitions_[e]=l}},{id:"call",mpy(t){let i=this.getFunctionName(t.getProcCode()),e=t.argumentIds_.map((s)=>this.valueToCode(t,s,this.ORDER_NONE)||"False"),o=`await ${i}(${e.join(", ")})`;if(t.return_)return[o,this.ORDER_FUNCTION_CALL];return o+`
`}},{id:"return",mpy(t){return`return ${this.valueToCode(t,"VALUE",this.ORDER_NONE)}
`}}]});import{translate as T2,themeColors as e2}from"@blockcode/core";var w2=()=>({id:"terminal",name:T2("iotbit.blocks.terminal","Terminal"),themeColor:e2.blocks.debug.primary,inputColor:e2.blocks.debug.secondary,otherColor:e2.blocks.debug.tertiary,order:9,blocks:[{id:"print",text:T2("iotbit.blocks.terminalPrint","print %1"),inputs:{STRING:{type:"string",defaultValue:"hello"}},mpy(t){return`print(str(${this.valueToCode(t,"STRING",this.ORDER_NONE)}))
`}}]});import{translate as k,themeColors as o2}from"@blockcode/core";import{ScratchBlocks as s2}from"@blockcode/blocks";var N2=()=>({id:"text",name:k("iotbit.blocks.text","Text"),themeColor:o2.blocks.text.primary,inputColor:o2.blocks.text.secondary,otherColor:o2.blocks.text.tertiary,order:8,blocks:[{id:"join",text:s2.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),e=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`(${i} + ${e})`,this.ORDER_ADDITION]}},{id:"letter_of",text:s2.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){let i=this.getAdjusted(t,"LETTER");return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${i}]`,this.ORDER_FUNCTION_CALL]}},{id:"replace",text:k("iotbit.blocks.textReplace","replace %1 of %2 with %3"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"iotbit"},STRING3:{type:"string",defaultValue:"The E"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),e=this.valueToCode(t,"STRING2",this.ORDER_NONE),o=this.valueToCode(t,"STRING3",this.ORDER_NONE);return[`${e}.replace(${i}, ${o})
`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:k("iotbit.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"iotbit"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(t){let i=this.getAdjusted(t,"FROM"),e=this.valueToCode(t,"TO",this.ORDER_NONE);return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${i}:${e}]`,this.ORDER_FUNCTION_CALL]}},{id:"find",text:k("iotbit.blocks.textFind","find %1 of %2 place"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)}.find(${i}) + 1)
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:s2.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},STRING2:{type:"string",defaultValue:"e"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)} in ${i})`,this.ORDER_EQUALITY]}},{id:"with",text:k("iotbit.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},WITH:{type:"string",menu:[[k("iotbit.blocks.textStartsWith","starts"),"START"],[k("iotbit.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),e=this.valueToCode(t,"STRING2",this.ORDER_NONE),s=(t.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${i}.${s}(${e})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:k("iotbit.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),e=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`${i}.lower() == ${e}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:k("iotbit.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[k("iotbit.blocks.textLowerCase","lower"),"LOWER"],[k("iotbit.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){let i=t.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.${i==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:k("iotbit.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}}]});import{MicroPythonGenerator as bt}from"@blockcode/blocks";var ut=`# Generate by BlockCode
`;class F extends bt{finish(t){return ut+`from iotbit import *
`+super.finish(t)}}function x2(){let t=f2(),i=g2(),e=C2(),o=k2(),s=L2(),l=R2(),n=y2(),a=O2(),c=N2(),b=w2(),r=E2(),N=v2();return[t,i,e,o,s,l,n,a,c,b,r,N]}import{Text as T}from"@blockcode/core";import{jsx as w}from"preact/jsx-runtime";var _2=[{tag:"controller",label:w(T,{id:"iotbit.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:w(T,{id:"iotbit.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:w(T,{id:"iotbit.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:w(T,{id:"iotbit.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:w(T,{id:"iotbit.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:w(T,{id:"iotbit.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:w(T,{id:"iotbit.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:w(T,{id:"iotbit.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as Lt}from"preact/jsx-runtime";var mt=(t)=>t.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),M2=new F,kt=()=>[["device","!scratch"],"data"];function S2(){let{tabIndex:t}=ht(),{meta:i}=ft(),e=pt((o,s,l,n)=>{gt.prototype.onDefinitions.call(M2);for(let a in l)for(let c of l[a])if(!c.common){let b=Y(c.name,X(c.name));s(`import_${a}_${b}`,`from ${mt(a)} import ${b}`)}},[]);return Lt(Ct,{enableProcedureExecute:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:t.value!==0,extensionTags:_2,generator:M2,onBuildinExtensions:x2,onDefinitions:e,onExtensionsFilter:kt})}import{useAppContext as yt}from"@blockcode/core";function v(t){let i=globalThis.document,e=i.createElement("style");e.appendChild(i.createTextNode(t)),i.head.append(e)}v(".LuJSkq_device-icon{width:20px;height:20px}.LuJSkq_blank-check-item>div{padding-left:calc(var(--space)/2 + 14px)}.LuJSkq_section-title{padding-left:calc(var(--space)*1.5 + 2px + 14px)}");var O={blankCheckItem:"LuJSkq_blank-check-item",sectionTitle:"LuJSkq_section-title",deviceIcon:"LuJSkq_device-icon"};var D2="./assets/icon-device-qx17f37n.svg";import{jsx as Ot}from"preact/jsx-runtime";function I2(){let{appState:t}=yt();return Ot("img",{className:O.deviceIcon,src:D2})}import{useCallback as M}from"preact/hooks";import{nanoid as Zt,classNames as A,sleepMs as $t}from"@blockcode/utils";import{useAppContext as Vt,useProjectContext as Bt,setAlert as $,delAlert as Ft,setAppState as H2}from"@blockcode/core";import{MPYUtils as r2}from"@blockcode/board";var W=[{usbVendorId:12346},{usbVendorId:6790}];import{Spinner as Di,Text as P,MenuSection as Y2,MenuItem as Z}from"@blockcode/core";import{useEffect as Z2,useCallback as Et}from"preact/hooks";import{useSignal as $2}from"@preact/signals";import{nanoid as vt,classNames as Tt,sleep as wt,Base64Utils as Nt,getBinaryCache as F2,setBinaryCache as xt}from"@blockcode/utils";import{useAppContext as _t,setAlert as I,delAlert as Mt}from"@blockcode/core";import{ESPTool as l2}from"@blockcode/board";var fi="0.1.1";var P2={download:"https://firmware.blockcode.fun/iotbit"};import{Text as V2,MenuSection as St,MenuItem as Dt}from"@blockcode/core";import{jsx as U}from"preact/jsx-runtime";var E=null,It=(t)=>{if(t<100)I("restoring",{id:E,progress:t});else I("recovering",{id:E})},B2=()=>{Mt(E),E=null},W2=(t)=>{if(t==="NotFoundError")return;I("connectionError",1000)},U2=async(t)=>{try{return await fetch(t,{method:"GET"})}catch(i){return await wt(1),U2(t)}},_=async(t,i,e,o,s)=>{if(s.value)return;let l=await F2(t);if(l?.hash===e&&l?.binaryString){s.value=!0,delete _.downloading;return}if(_.downloading)return;_.downloading=!0;let a=await(await U2(i)).arrayBuffer();delete _.downloading;let c=await crypto.subtle.digest("SHA-256",a);if(Array.from(new Uint8Array(c)).map((r)=>r.toString(16).padStart(2,"0")).join("")!==e){_(t,i,e,o,s);return}await xt(t,{version:o,hash:e,binaryString:Nt.arrayBufferToBinaryString(a)}),s.value=!0},At=async(t,i)=>{E=vt(),I("erasing",{id:E});try{await l2.writeFlash(t,i,!0,(e)=>It(e)),I("restoreCompleted",{id:E,onClose:B2})}catch(e){W2(e.name),B2()}await l2.disconnect(t)},Pt=async(t)=>{if(E)return;let i;try{i=await l2.connect(W,460800)}catch(o){W2(o.name)}if(!i)return;let e=await F2(t);if(e)At(i,[{data:e.binaryString,address:4096}])};function G2({disabled:t,itemClassName:i}){let{appState:e}=_t(),o=$2(!1),s=$2(null);return Z2(()=>E=null,[]),Z2(async()=>{o.value=!1;let l=P2.download;if(!s.value)s.value=await fetch(`${l}/version.json`).then((c)=>c.json());let n=`${l}/${s.value.download}`.replaceAll("{version}",s.value.version),a=s.value.hash;_("iotbitFirmware",n,a,s.value.version,o)},[]),U(St,{children:U(Dt,{disabled:t||E||e.value?.device||!o.value,className:Tt(i,O.blankCheckItem),onClick:Et(()=>Pt("iotbitFirmware"),[]),children:o.value?U(V2,{id:"gui.menubar.device.firmwareVersion",defaultMessage:"Restore v{version} firmware...",version:s.value.version}):U(V2,{id:"gui.menubar.device.caching",defaultMessage:"Caching latest firmware..."})})})}import{jsx as m,jsxs as a2,Fragment as n2}from"preact/jsx-runtime";var C=null,X2=()=>{Ft(C),C=null},z2=(t)=>{if(!C)C=Zt();$("downloading",{id:C,progress:t})},G=(t)=>{if(t==="NotFoundError")return;$("connectionError",1000)},Wt=async(t,i,e)=>{z2(0);try{let o=[].concat(i,e).map((s)=>({...s,filename:s.id}));await r2.write(t,o,z2),t.reset(),$("downloadCompleted",{id:C}),setTimeout(X2,2000)}catch(o){G(o.name),X2()}};function q2({itemClassName:t}){let{appState:i}=Vt(),{file:e,assets:o}=Bt(),s=M(async(r)=>{await i.value?.device?.disconnect(),await $t(500);let N=()=>s(r),B=(x)=>{if(x)G();H2("device",null),r.off("connect",N),r.off("disconnect",B)};r.on("connect",N),r.on("disconnect",B),$("connected",1000),H2("device",r)},[]),l=M(async()=>{if(C)return;try{let r=await r2.connect(W,{baudRate:115200});s(r)}catch(r){G(r.name)}},[]),n=M(async()=>{if(C)return;try{let r=await r2.connectBLE();s(r)}catch(r){G(r.name)}},[]),a=M(()=>{if(C)return;if(!i.value?.device)return;Wt(i.value.device,e.value,o.value)},[]),c=M(()=>{if(C)return;$("reseting",1000),i.value?.device?.reset()},[]),b=M(()=>{if(C)return;i.value?.device?.disconnect()});return a2(n2,{children:[m(Y2,{disabled:C||!i.value?.device,children:m(Z,{className:A(t,O.blankCheckItem),label:m(P,{id:"gui.menubar.device.download",defaultMessage:"Download program"}),onClick:a})}),m(Y2,{disabled:C,children:i.value?.device?a2(n2,{children:[m(Z,{className:A(t,O.blankCheckItem),label:m(P,{id:"gui.menubar.device.disconnect",defaultMessage:"Disconnect device"}),onClick:b}),m(Z,{className:A(t,O.blankCheckItem),label:m(P,{id:"gui.menubar.device.reset",defaultMessage:"Reset device"}),onClick:c})]}):a2(n2,{children:[m(Z,{className:A(t,O.blankCheckItem),label:m(P,{id:"gui.menubar.device.connectUsb",defaultMessage:"Connect device with USB..."}),onClick:l}),m(Z,{disabled:!0,className:A(t,O.blankCheckItem),label:m(P,{id:"gui.menubar.device.connectBle",defaultMessage:"Connect device with Bluetooth (BLE)..."}),onClick:n})]})}),m(G2,{disabled:C,itemClassName:t})]})}import{useCallback as s4,useEffect as l4}from"preact/hooks";import{useSignal as a4}from"@preact/signals";import{classNames as c4}from"@blockcode/utils";import{useAppContext as b4,setAppState as u4}from"@blockcode/core";import{classNames as Wo}from"@blockcode/utils";import{useAppContext as Go}from"@blockcode/core";import{useCallback as Ne,useEffect as xe}from"preact/hooks";import{MathUtils as Me,KonvaUtils as Se}from"@blockcode/utils";import{useAppContext as Ie,useProjectContext as Ae}from"@blockcode/core";import{Emulator as Ze}from"@blockcode/blocks";import{MathUtils as Bi,KonvaUtils as Fi}from"@blockcode/utils";import{Keys as Ui}from"@blockcode/core";import{Runtime as Hi}from"@blockcode/blocks";import{jsx as Qe}from"preact/jsx-runtime";import{useCallback as Co}from"preact/hooks";import{classNames as ko}from"@blockcode/utils";import{useAppContext as Ro,translate as yo,setAppState as Oo}from"@blockcode/core";import{ToggleButtons as To}from"@blockcode/core";v(".hZ1onW_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}.hZ1onW_green-flag,.hZ1onW_stop{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}.hZ1onW_green-flag:hover,.hZ1onW_stop:hover{background:var(--theme-light-transparent)}.hZ1onW_green-flag.hZ1onW_actived{background:var(--theme-transparent)}.hZ1onW_stop{opacity:.5}.hZ1onW_stop.hZ1onW_actived{opacity:1}.hZ1onW_green-flag.hZ1onW_disabled,.hZ1onW_stop.hZ1onW_disabled{opacity:.5}.hZ1onW_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.hZ1onW_space{margin-left:.2rem}.hZ1onW_toolbar-buttons-group{display:flex}.hZ1onW_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.hZ1onW_group-button{border-left:none;border-radius:0}.hZ1onW_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.hZ1onW_group-button-toggled-off{filter:saturate(0)}");import{jsx as Do,jsxs as Io}from"preact/jsx-runtime";v(".K-thSq_stage-wrapper{position:relative}.K-thSq_stage{z-index:10;width:362px;height:302px;position:relative;overflow:hidden}.K-thSq_small-stage{width:290px;height:242px}");import{jsx as Ko,jsxs as Jo}from"preact/jsx-runtime";v(".-\\33 i13a_sidedock-wrapper{flex-direction:column;height:100%;display:flex}.-\\33 i13a_stage-wrapper{display:flex}.-\\33 i13a_selector-wrapper{margin-top:var(--space);flex-direction:row;flex-grow:1;width:362px;display:flex}.-\\33 i13a_selector-wrapper.-\\33 i13a_small{width:290px}");import{jsx as C4,jsxs as m4}from"preact/jsx-runtime";var K2={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as J2}from"preact/jsx-runtime";var D4={onNew(){return K2},onSave(t,i){return{files:t,assets:i}},async onThumb(){let t=V.getMainWorkspace();if(t){let i=t.getCanvas();if(i)return await Ut(i,{})}},onUndo(t){if(t instanceof MouseEvent)V.getMainWorkspace()?.undo(!1)},onRedo(t){if(t instanceof MouseEvent)V.getMainWorkspace()?.undo(!0)},onEnableUndo(){let t=V.getMainWorkspace();return t?.undoStack_&&t.undoStack_.length!==0},onEnableRedo(){let t=V.getMainWorkspace();return t?.redoStack_&&t.redoStack_.length!==0},menuItems:[{icon:J2(I2,{}),label:J2(Xt,{id:"iotbit.menubar.device",defaultMessage:"iot:bit"}),Menu:q2}],tabs:[{...Gt,Content:S2},{...Ht},!1,{...Yt}].filter(Boolean),docks:[]};export{D4 as default};
