import{addLocalesMessages as E1}from"@blockcode/core";var g2={"iotbit.menubar.device":"iot:bit","iotbit.menubar.device.sync":"Sync program","iotbit.menubar.device.download":"Download program via USB","iotbit.menubar.device.downloadBle":"Download program via Bluetooth","iotbit.menubar.device.iotboardFirmware":"Restore IOT Board firmware","iotbit.menubar.device.firmware":"Restore firmware","iotbit.menubar.device.erasing":"Erasing...","iotbit.menubar.device.restoring":"Firmware restoring...{progress}%","iotbit.menubar.device.recovering":"Recovering...","iotbit.menubar.device.restoreDone":"Firmware resotre completed! Now press RESET key","iotbit.menubar.device.caching":"Caching latest firmware...","iotbit.extension.tags.controllers":"Controllers","iotbit.extension.tags.sensors":"Sensors","iotbit.extension.tags.actuators":"Actuators","iotbit.extension.tags.displays":"Displays","iotbit.extension.tags.modules":"Modules","iotbit.extension.tags.communication":"Communication","iotbit.extension.tags.data":"Data","iotbit.extension.tags.kits":"Kits","iotbit.emu.greenFlag":"Go","iotbit.emu.stop":"Stop","iotbit.emu.smallStage":"Switch to small stage","iotbit.emu.largeStage":"Switch to large stage","iotbit.blocks.wait":"wait %1 milliseconds","iotbit.blocks.break":"break","iotbit.blocks.continue":"continue","iotbit.blocks.elseif":"else if %1 then","iotbit.blocks.else":"else","iotbit.blocks.runtime":"run time %1","iotbit.blocks.runtimeMilliseconds":"milliseconds","iotbit.blocks.runtimeSeconds":"seconds","iotbit.blocks.dataConvert":"convert %1 to %2","iotbit.blocks.dataConvert.int":"int","iotbit.blocks.dataConvert.float":"float","iotbit.blocks.dataConvert.string":"str","iotbit.blocks.dataConvert.list":"list","iotbit.blocks.dataLengthOf":"length of %1","iotbit.blocks.dataConstrain":"constrain %1 between %2 to %3","iotbit.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","iotbit.blocks.whenstart":"when iot:bit start","iotbit.blocks.timerset":"set timer # %1 per %2 milliseconds","iotbit.blocks.timeroff":"stop timer # %1","iotbit.blocks.operatorLarger":"larger of %1 and %2","iotbit.blocks.operatorSmaller":"smaller of %1 and %2","iotbit.blocks.pin":"Pins","iotbit.blocks.setmode":"set pin %1 mode to %2","iotbit.blocks.inputMode":"input","iotbit.blocks.ouputMode":"output","iotbit.blocks.inputPullUpMode":"input pull-up","iotbit.blocks.inputPullDownMode":"input pull-down","iotbit.blocks.setdigital":"set pin %1 to %2","iotbit.blocks.digitalHigh":"high","iotbit.blocks.digitalLow":"low","iotbit.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","iotbit.blocks.setpwm":"set pin %1 pwm to %2","iotbit.blocks.setanalog":"set pin %1 analog to %2","iotbit.blocks.isDigitalHigh":"pin %1 is high?","iotbit.blocks.analogValue":"pin %1 analog value","iotbit.blocks.attachinterrupt":"attach pin %1 interrupt to %2","iotbit.blocks.interruptRising":"rising","iotbit.blocks.interruptFalling":"falling","iotbit.blocks.interruptChange":"change","iotbit.blocks.interruptHigh":"high","iotbit.blocks.interruptLow":"low","iotbit.blocks.detachinterrupt":"detach pin %1 interrupt","iotbit.blocks.network":"Network","iotbit.blocks.display":"Display","iotbit.blocks.text":"Text","iotbit.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","iotbit.blocks.textRemove":"remove letters from %1 to %2 of %3","iotbit.blocks.textReplace":"replace %1 of %2 with %3","iotbit.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","iotbit.blocks.textSubstring":"substring of %1 from %2 to %3","iotbit.blocks.textWith":"%1 %2 with %3?","iotbit.blocks.textStartsWith":"starts","iotbit.blocks.textEndsWith":"ends","iotbit.blocks.textCase":"get %1 of %2","iotbit.blocks.textLowerCase":"lower-case","iotbit.blocks.textUpperCase":"upper-case","iotbit.blocks.textTrim":"remove %1 leading and trailing whitespace","iotbit.blocks.textConvert":"convert %1 to %2","iotbit.blocks.textConvertFrom":"convert %1 to String","iotbit.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","iotbit.blocks.disconnectWifi":"disconnect wi-fi","iotbit.blocks.isWifiConnected":"wi-fi is connected?","iotbit.blocks.wifiScan":"start scan wi-fi","iotbit.blocks.wifiItem":"%2 of item %1 of available wi-fi","iotbit.blocks.wifiItemSsid":"ssid","iotbit.blocks.wifiItemMac":"mac","iotbit.blocks.wifiItemRssi":"rssi","iotbit.blocks.wifiItemSecurity":"security","iotbit.blocks.wifiCounts":"available wi-fi counts","iotbit.blocks.startap":"start ap ssid: %1","iotbit.blocks.stopap":"stop ap","iotbit.blocks.espnowSend":"send %1 to %2 via esp-now","iotbit.blocks.espnowRecv":"wait for esp-now incoming","iotbit.blocks.espnowMsg":"%1 of incoming","iotbit.blocks.espnowMsgText":"message","iotbit.blocks.espnowMsgMac":"mac","iotbit.blocks.espnowRepeat":"repeat wait for esp-now incoming","iotbit.blocks.espnowWhen":"when esp-now %1 incoming","iotbit.blocks.spiInit":"initialize SPI %1 freq:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 write %2","iotbit.blocks.spiRead":"SPI %1 read %2 bytes","iotbit.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","iotbit.blocks.i2cScan":"I2C scan devices","iotbit.blocks.i2cWrite":"I2C write to %1:%2","iotbit.blocks.i2cRead":"I2C read from %1 :%2 bytes","iotbit.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","iotbit.blocks.i2sPlay":"I2S play %1","iotbit.blocks.playNote":"play note %1 for %2 beats","iotbit.blocks.playMusic":"play %1","iotbit.blocks.stopMusic":"stop music","iotbit.blocks.musicDadadadum":"dadadadum","iotbit.blocks.musicEntertainer":"entertainer","iotbit.blocks.musicPrelude":"prelude","iotbit.blocks.musicOde":"ode","iotbit.blocks.musicNyan":"nyan","iotbit.blocks.musicRingtone":"ringtone","iotbit.blocks.musicFunk":"funk","iotbit.blocks.musicBlues":"blues","iotbit.blocks.musicBirthday":"birthday","iotbit.blocks.musicWedding":"wedding","iotbit.blocks.musicFuneral":"funeral","iotbit.blocks.musicPunchline":"punchline","iotbit.blocks.musicPython":"python","iotbit.blocks.musicBaddy":"baddy","iotbit.blocks.musicChase":"chase","iotbit.blocks.musicBaDing":"ba ding","iotbit.blocks.musicWawawawaa":"wawawawaa","iotbit.blocks.musicJumpUp":"jump up","iotbit.blocks.musicJumpDown":"jump down","iotbit.blocks.musicPowerUp":"power up","iotbit.blocks.musicPowerDown":"power down"};var C2={"iotbit.menubar.device":"物联板","iotbit.menubar.device.sync":"同步程序","iotbit.menubar.device.download":"通过 USB 下载程序","iotbit.menubar.device.downloadBle":"通过蓝牙下载程序","iotbit.menubar.device.iotboardFirmware":"还原 IOT Borad 出厂固件","iotbit.menubar.device.firmware":"还原固件","iotbit.menubar.device.erasing":"正在清除…","iotbit.menubar.device.restoring":"正在还原固件…{progress}%","iotbit.menubar.device.recovering":"恢复设备…","iotbit.menubar.device.restoreDone":"还原固件完成，请按下 RESET 键。","iotbit.menubar.device.caching":"正在缓存最新固件…","iotbit.extension.tags.controllers":"输入模块","iotbit.extension.tags.sensors":"传感器","iotbit.extension.tags.actuators":"执行器","iotbit.extension.tags.displays":"显示模块","iotbit.extension.tags.modules":"智能模块","iotbit.extension.tags.communication":"通讯","iotbit.extension.tags.data":"数据","iotbit.extension.tags.kits":"套件","iotbit.emu.greenFlag":"运行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"缩小舞台","iotbit.emu.largeStage":"放大舞台","iotbit.blocks.wait":"等待 %1 毫秒","iotbit.blocks.break":"跳出重复执行","iotbit.blocks.continue":"跳到下一次执行","iotbit.blocks.elseif":"否则，如果 %1 那么","iotbit.blocks.else":"否则","iotbit.blocks.runtime":"运行时长 %1","iotbit.blocks.runtimeMilliseconds":"毫秒","iotbit.blocks.runtimeSeconds":"秒","iotbit.blocks.dataConvert":"将 %1 转为 %2","iotbit.blocks.dataConvert.int":"整数","iotbit.blocks.dataConvert.float":"浮点数","iotbit.blocks.dataConvert.string":"字符串","iotbit.blocks.dataConvert.list":"列表","iotbit.blocks.dataLengthOf":"%1 长度","iotbit.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","iotbit.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","iotbit.blocks.whenstart":"当 iot:bit 启动","iotbit.blocks.timerset":"将定时器 # %1 间隔设为每 %2 毫秒","iotbit.blocks.timeroff":"关闭定时器 # %1","iotbit.blocks.operatorLarger":"%1 和 %2 之中最大","iotbit.blocks.operatorSmaller":"%1 和 %2 之中最小","iotbit.blocks.pin":"引脚","iotbit.blocks.setmode":"将引脚 %1 设为 %2 模式","iotbit.blocks.inputMode":"输入","iotbit.blocks.ouputMode":"输出","iotbit.blocks.inputPullUpMode":"上拉输入","iotbit.blocks.inputPullDownMode":"下拉输入","iotbit.blocks.setdigital":"将引脚 %1 设为 %2","iotbit.blocks.digitalHigh":"高电平","iotbit.blocks.digitalLow":"低电平","iotbit.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","iotbit.blocks.setpwm":"将引脚 %1 PWM 设为 %2","iotbit.blocks.setanalog":"将引脚 %1 模拟值设为 %2","iotbit.blocks.isDigitalHigh":"引脚 %1 是高电平？","iotbit.blocks.analogValue":"引脚 %1 模拟值","iotbit.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","iotbit.blocks.interruptRising":"电平上升","iotbit.blocks.interruptFalling":"电平下降","iotbit.blocks.interruptChange":"电平改变","iotbit.blocks.interruptHigh":"高电平","iotbit.blocks.interruptLow":"低电平","iotbit.blocks.detachinterrupt":"取消引脚 %1 中断","iotbit.blocks.network":"网络通讯","iotbit.blocks.sensing":"侦测","iotbit.blocks.display":"显示","iotbit.blocks.sound":"声音","iotbit.blocks.text":"文本","iotbit.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","iotbit.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","iotbit.blocks.textReplace":"将 %2 中的 %1 替换为 %3","iotbit.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","iotbit.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","iotbit.blocks.textWith":"%1 %2 %3?","iotbit.blocks.textStartsWith":"开始于","iotbit.blocks.textEndsWith":"结束于","iotbit.blocks.textCase":"将 %2 字母转为 %1","iotbit.blocks.textLowerCase":"小写","iotbit.blocks.textUpperCase":"大写","iotbit.blocks.textTrim":"清除 %1 前后空白字符","iotbit.blocks.textConvert":"将 %1 转为 %2","iotbit.blocks.textConvertFrom":"将 %1 转为文本","iotbit.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","iotbit.blocks.disconnectWifi":"断开 Wi-Fi 网络","iotbit.blocks.isWifiConnected":"Wi-Fi 网络已连接？","iotbit.blocks.wifiScan":"开始扫描 Wi-Fi","iotbit.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","iotbit.blocks.wifiItemSsid":"SSID","iotbit.blocks.wifiItemMac":"MAC","iotbit.blocks.wifiItemRssi":"RSSI","iotbit.blocks.wifiItemSecurity":"加密类型","iotbit.blocks.wifiCounts":"可用 Wi-Fi 数量","iotbit.blocks.startap":"开启热点 SSID: %1","iotbit.blocks.stopap":"关闭热点","iotbit.blocks.espnowSend":"发送 ESP-Now %1 到 %2","iotbit.blocks.espnowRecv":"等待 ESP-Now 接收消息","iotbit.blocks.espnowMsg":"接受到 %1","iotbit.blocks.espnowMsgText":"消息","iotbit.blocks.espnowMsgMac":"MAC","iotbit.blocks.espnowRepeat":"重复等待 ESP-Now 接收消息","iotbit.blocks.espnowWhen":"当 ESP-Now 收到 %1","iotbit.blocks.spiInit":"初始化SPI %1 频率:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 写入 %2","iotbit.blocks.spiRead":"SPI %1 读取 %2 字节","iotbit.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","iotbit.blocks.i2cScan":"I2C扫描设备","iotbit.blocks.i2cWrite":"I2C写入到 %1:%2","iotbit.blocks.i2cRead":"I2C从 %1 读取 %2 字节","iotbit.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","iotbit.blocks.i2sPlay":"I2S播放 %1","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"开场","iotbit.blocks.musicEntertainer":"娱乐","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"颂歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"铃声","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"蓝调","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚礼","iotbit.blocks.musicFuneral":"葬礼","iotbit.blocks.musicPunchline":"笑点","iotbit.blocks.musicPython":"贪吃蛇","iotbit.blocks.musicBaddy":"坏人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"奖励","iotbit.blocks.musicWawawawaa":"退场","iotbit.blocks.musicJumpUp":"跳起来","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打开电源","iotbit.blocks.musicPowerDown":"关闭电源"};var k2={"iotbit.menubar.device":"iot:bit","iotbit.menubar.device.sync":"同步程式","iotbit.menubar.device.download":"通過 USB 下載程式","iotbit.menubar.device.downloadBle":"通過藍牙下載程式","iotbit.menubar.device.iotboardFirmware":"還原 IOT Borad 出廠固件","iotbit.menubar.device.firmware":"還原固件","iotbit.menubar.device.erasing":"正在清除…","iotbit.menubar.device.restoring":"正在還原固件…{progress}%","iotbit.menubar.device.recovering":"恢復設備…","iotbit.menubar.device.restoreDone":"還原固件完成，請按下 RESET 鍵。","iotbit.menubar.device.caching":"正在緩存最新固件…","iotbit.extension.tags.controllers":"輸入模組","iotbit.extension.tags.sensors":"傳感器","iotbit.extension.tags.actuators":"執行器","iotbit.extension.tags.displays":"顯示模組","iotbit.extension.tags.modules":"智能模組","iotbit.extension.tags.communication":"通訊","iotbit.extension.tags.data":"數據","iotbit.extension.tags.kits":"套件","iotbit.emu.greenFlag":"運行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"縮小舞臺","iotbit.emu.largeStage":"放大舞臺","iotbit.blocks.wait":"等待 %1 毫秒","iotbit.blocks.break":"跳出重複","iotbit.blocks.continue":"跳到下一次","iotbit.blocks.elseif":"否則，如果 %1 那麼","iotbit.blocks.else":"否則","iotbit.blocks.runtime":"運行時長 %1","iotbit.blocks.runtimeMilliseconds":"毫秒","iotbit.blocks.runtimeSeconds":"秒","iotbit.blocks.dataConvert":"將 %1 轉為 %2","iotbit.blocks.dataConvert.int":"整數","iotbit.blocks.dataConvert.float":"浮點數","iotbit.blocks.dataConvert.string":"字符串","iotbit.blocks.dataConvert.list":"列表","iotbit.blocks.dataLengthOf":"%1 長度","iotbit.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","iotbit.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","iotbit.blocks.whenstart":"當 iot:bit 開始","iotbit.blocks.timerset":"將定時器 # %1 間隔設為每 %2 毫秒","iotbit.blocks.timeroff":"關閉定時器 # %1","iotbit.blocks.operatorLarger":"%1 和 %2 之中最大","iotbit.blocks.operatorSmaller":"%1 和 %2 之中最小","iotbit.blocks.pin":"引腳","iotbit.blocks.setmode":"將引腳 %1 設為 %2 模式","iotbit.blocks.inputMode":"輸入","iotbit.blocks.ouputMode":"輸出","iotbit.blocks.inputPullUpMode":"上拉輸入","iotbit.blocks.inputPullDownMode":"下拉輸入","iotbit.blocks.setdigital":"將引腳 %1 設為 %2","iotbit.blocks.digitalHigh":"高電平","iotbit.blocks.digitalLow":"低電平","iotbit.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","iotbit.blocks.setpwm":"將引腳 %1 PWM 設為 %2","iotbit.blocks.setanalog":"將引腳 %1 模擬值設為 %2","iotbit.blocks.isDigitalHigh":"引腳 %1 是高電平？","iotbit.blocks.analogValue":"引腳 %1 模擬值","iotbit.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","iotbit.blocks.interruptRising":"電平上升","iotbit.blocks.interruptFalling":"電平下降","iotbit.blocks.interruptChange":"電平改變","iotbit.blocks.interruptHigh":"高電平","iotbit.blocks.interruptLow":"低電平","iotbit.blocks.detachinterrupt":"取消引腳 %1 中斷","iotbit.blocks.network":"網絡通訊","iotbit.blocks.sensing":"偵測","iotbit.blocks.display":"顯示","iotbit.blocks.sound":"聲音","iotbit.blocks.text":"文本","iotbit.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","iotbit.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","iotbit.blocks.textReplace":"將 %2 中的 %1 替換為 %3","iotbit.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","iotbit.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","iotbit.blocks.textWith":"%1 %2 %3?","iotbit.blocks.textStartsWith":"開始於","iotbit.blocks.textEndsWith":"結束於","iotbit.blocks.textCase":"將 %2 字母轉為 %1","iotbit.blocks.textLowerCase":"小寫","iotbit.blocks.textUpperCase":"大寫","iotbit.blocks.textTrim":"清除 %1 前後空白字符","iotbit.blocks.textConvert":"將 %1 轉為 %2","iotbit.blocks.textConvertFrom":"將 %1 轉為文本","iotbit.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","iotbit.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","iotbit.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","iotbit.blocks.wifiScan":"開始掃描 Wi-Fi","iotbit.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","iotbit.blocks.wifiItemSsid":"SSID","iotbit.blocks.wifiItemMac":"MAC","iotbit.blocks.wifiItemRssi":"RSSI","iotbit.blocks.wifiItemSecurity":"加密類型","iotbit.blocks.wifiCounts":"可用 Wi-Fi 數量","iotbit.blocks.startap":"開啟 AP SSID: %1","iotbit.blocks.stopap":"關閉 AP","iotbit.blocks.espnowSend":"發送 ESP-Now %1 到 %2","iotbit.blocks.espnowRecv":"等待 ESP-Now 接收消息","iotbit.blocks.espnowMsg":"接受到 %1","iotbit.blocks.espnowMsgText":"消息","iotbit.blocks.espnowMsgMac":"MAC","iotbit.blocks.espnowRepeat":"重複等待 ESP-Now 接收消息","iotbit.blocks.espnowWhen":"當 ESP-Now 收到 %1","iotbit.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","iotbit.blocks.spiHSPI":"HSPI","iotbit.blocks.spiVSPI":"VSPI","iotbit.blocks.spiWrite":"SPI %1 寫入 %2","iotbit.blocks.spiRead":"SPI %1 讀取 %2 位元組","iotbit.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","iotbit.blocks.i2cScan":"I2C掃描設備","iotbit.blocks.i2cWrite":"I2C寫入到 %1:%2","iotbit.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","iotbit.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","iotbit.blocks.i2sPlay":"I2S播放 %1","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"開場","iotbit.blocks.musicEntertainer":"娛樂","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"頌歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"鈴聲","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"藍調","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚禮","iotbit.blocks.musicFuneral":"葬禮","iotbit.blocks.musicPunchline":"笑點","iotbit.blocks.musicPython":"貪吃蛇","iotbit.blocks.musicBaddy":"壞人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"獎勵","iotbit.blocks.musicWawawawaa":"退場","iotbit.blocks.musicJumpUp":"跳起來","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打開電源","iotbit.blocks.musicPowerDown":"關閉電源"};E1({en:g2,"zh-Hans":C2,"zh-Hant":k2});import{svgAsDataUri as Ht}from"@blockcode/utils";import{ScratchBlocks as W,blocksTab as Yt,CodeReview as zt}from"@blockcode/blocks";import{codeTab as Kt,terminalTab as qt}from"@blockcode/code";import{Text as Xt}from"@blockcode/core";function w(t){if(typeof t!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(t))}function L2(t,i){var o="",e=0,n=-1,s=0,r;for(var a=0;a<=t.length;++a){if(a<t.length)r=t.charCodeAt(a);else if(r===47)break;else r=47;if(r===47){if(n===a-1||s===1);else if(n!==a-1&&s===2){if(o.length<2||e!==2||o.charCodeAt(o.length-1)!==46||o.charCodeAt(o.length-2)!==46){if(o.length>2){var c=o.lastIndexOf("/");if(c!==o.length-1){if(c===-1)o="",e=0;else o=o.slice(0,c),e=o.length-1-o.lastIndexOf("/");n=a,s=0;continue}}else if(o.length===2||o.length===1){o="",e=0,n=a,s=0;continue}}if(i){if(o.length>0)o+="/..";else o="..";e=2}}else{if(o.length>0)o+="/"+t.slice(n+1,a);else o=t.slice(n+1,a);e=a-n-1}n=a,s=0}else if(r===46&&s!==-1)++s;else s=-1}return o}function N1(t,i){var o=i.dir||i.root,e=i.base||(i.name||"")+(i.ext||"");if(!o)return e;if(o===i.root)return o+e;return o+t+e}function z(){var t="",i=!1,o;for(var e=arguments.length-1;e>=-1&&!i;e--){var n;if(e>=0)n=arguments[e];else{if(o===void 0)o=process.cwd();n=o}if(w(n),n.length===0)continue;t=n+"/"+t,i=n.charCodeAt(0)===47}if(t=L2(t,!i),i)if(t.length>0)return"/"+t;else return"/";else if(t.length>0)return t;else return"."}function w2(t){if(w(t),t.length===0)return".";var i=t.charCodeAt(0)===47,o=t.charCodeAt(t.length-1)===47;if(t=L2(t,!i),t.length===0&&!i)t=".";if(t.length>0&&o)t+="/";if(i)return"/"+t;return t}function T1(t){return w(t),t.length>0&&t.charCodeAt(0)===47}function M1(){if(arguments.length===0)return".";var t;for(var i=0;i<arguments.length;++i){var o=arguments[i];if(w(o),o.length>0)if(t===void 0)t=o;else t+="/"+o}if(t===void 0)return".";return w2(t)}function S1(t,i){if(w(t),w(i),t===i)return"";if(t=z(t),i=z(i),t===i)return"";var o=1;for(;o<t.length;++o)if(t.charCodeAt(o)!==47)break;var e=t.length,n=e-o,s=1;for(;s<i.length;++s)if(i.charCodeAt(s)!==47)break;var r=i.length,a=r-s,c=n<a?n:a,d=-1,l=0;for(;l<=c;++l){if(l===c){if(a>c){if(i.charCodeAt(s+l)===47)return i.slice(s+l+1);else if(l===0)return i.slice(s+l)}else if(n>c){if(t.charCodeAt(o+l)===47)d=l;else if(l===0)d=0}break}var N=t.charCodeAt(o+l),L=i.charCodeAt(s+l);if(N!==L)break;else if(N===47)d=l}var b="";for(l=o+d+1;l<=e;++l)if(l===e||t.charCodeAt(l)===47)if(b.length===0)b+="..";else b+="/..";if(b.length>0)return b+i.slice(s+d);else{if(s+=d,i.charCodeAt(s)===47)++s;return i.slice(s)}}function y1(t){return t}function I1(t){if(w(t),t.length===0)return".";var i=t.charCodeAt(0),o=i===47,e=-1,n=!0;for(var s=t.length-1;s>=1;--s)if(i=t.charCodeAt(s),i===47){if(!n){e=s;break}}else n=!1;if(e===-1)return o?"/":".";if(o&&e===1)return"//";return t.slice(0,e)}function K(t,i){if(i!==void 0&&typeof i!=="string")throw TypeError('"ext" argument must be a string');w(t);var o=0,e=-1,n=!0,s;if(i!==void 0&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var r=i.length-1,a=-1;for(s=t.length-1;s>=0;--s){var c=t.charCodeAt(s);if(c===47){if(!n){o=s+1;break}}else{if(a===-1)n=!1,a=s+1;if(r>=0)if(c===i.charCodeAt(r)){if(--r===-1)e=s}else r=-1,e=a}}if(o===e)e=a;else if(e===-1)e=t.length;return t.slice(o,e)}else{for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!n){o=s+1;break}}else if(e===-1)n=!1,e=s+1;if(e===-1)return"";return t.slice(o,e)}}function q(t){w(t);var i=-1,o=0,e=-1,n=!0,s=0;for(var r=t.length-1;r>=0;--r){var a=t.charCodeAt(r);if(a===47){if(!n){o=r+1;break}continue}if(e===-1)n=!1,e=r+1;if(a===46){if(i===-1)i=r;else if(s!==1)s=1}else if(i!==-1)s=-1}if(i===-1||e===-1||s===0||s===1&&i===e-1&&i===o+1)return"";return t.slice(i,e)}function D1(t){if(t===null||typeof t!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return N1("/",t)}function x1(t){w(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return i;var o=t.charCodeAt(0),e=o===47,n;if(e)i.root="/",n=1;else n=0;var s=-1,r=0,a=-1,c=!0,d=t.length-1,l=0;for(;d>=n;--d){if(o=t.charCodeAt(d),o===47){if(!c){r=d+1;break}continue}if(a===-1)c=!1,a=d+1;if(o===46){if(s===-1)s=d;else if(l!==1)l=1}else if(s!==-1)l=-1}if(s===-1||a===-1||l===0||l===1&&s===a-1&&s===r+1){if(a!==-1)if(r===0&&e)i.base=i.name=t.slice(1,a);else i.base=i.name=t.slice(r,a)}else{if(r===0&&e)i.name=t.slice(1,s),i.base=t.slice(1,a);else i.name=t.slice(r,s),i.base=t.slice(r,a);i.ext=t.slice(s,a)}if(r>0)i.dir=t.slice(0,r-1);else if(e)i.dir="/";return i}var A1="/",P1=":",si=((t)=>(t.posix=t,t))({resolve:z,normalize:w2,isAbsolute:T1,join:M1,relative:S1,_makeLong:y1,dirname:I1,basename:K,extname:q,format:D1,parse:x1,sep:A1,delimiter:P1,win32:null,posix:null});import{useCallback as F1}from"preact/hooks";import{useAppContext as V1,useProjectContext as U1}from"@blockcode/core";import{MicroPythonGenerator as G1,BlocksEditor as H1}from"@blockcode/blocks";import{translate as f,themeColors as X}from"@blockcode/core";var R2=()=>({id:"pin",name:f("iotbit.blocks.pin","Pins"),themeColor:X.blocks.motion.primary,inputColor:X.blocks.motion.secondary,otherColor:X.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:f("iotbit.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:"ESP32_PINS"},MODE:{menu:[[f("iotbit.blocks.ouputMode","output"),"OUTPUT"],[f("iotbit.blocks.inputMode","input"),"INPUT"],[f("iotbit.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[f("iotbit.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=t.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let n="";if(e==="INPUT")n=`${o} = Pin(${i}, Pin.IN)`;else if(e==="INPUT_PULLUP")n=`${o} = Pin(${i}, Pin.IN, Pin.PULL_UP)`;else if(e==="INPUT_PULLDOWN")n=`${o} = Pin(${i}, Pin.IN, Pin.PULL_DOWN)`;else n=`${o} = Pin(${i}, Pin.OUT)`;return this.definitions_[o]=n,""}},"---",{id:"setdigital",text:f("iotbit.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:"ESP32_PINS"},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[f("iotbit.blocks.digitalHigh","high"),"1"],[f("iotbit.blocks.digitalLow","low"),"0"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=this.definitions_[o]??`${o} = Pin(${i}, Pin.OUT)`,`${o}.value(${e})
`}},{id:"setDAC",text:f("iotbit.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:"ESP32_DAC_PINS"},VALUE:{shadow:"slider255"}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[o]=`${o} = DAC(Pin(${i}))`,`${o}.write(${e})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(t){return[t.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},{id:"digital",text:f("iotbit.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:"ESP32_PINS"}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=`${o} = Pin(${i}, Pin.IN)`,[`(${o}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:f("iotbit.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:"ESP32_ADC_PINS"}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[o]=`${o} = ADC(Pin(${i}))`,this.definitions_[`${o}_atten`]=`${o}.atten(ADC.ATTN_11DB)`,this.definitions_[`${o}_width`]=`${o}.width(ADC.WIDTH_10BIT)`,[`${o}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:f("iotbit.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:"ESP32_PWM_PINS"},FREQ:{type:"integer",defaultValue:"1000"}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=this.valueToCode(t,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${i}), freq=1000)`,`${o}.freq(${e})
`}},{id:"setPWM",text:f("iotbit.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:"ESP32_PWM_PINS"},VALUE:{shadow:"slider1023"}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=this.valueToCode(t,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${i}), freq=1000)`,`${o}.duty(${e})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(t){return[t.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:f("iotbit.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:"ESP32_PINS"},INTERRUPT:{menu:[[f("iotbit.blocks.interruptRising","rising"),"RISING"],[f("iotbit.blocks.interruptFalling","falling"),"FALLING"],[f("iotbit.blocks.interruptChange","change"),"CHANGE"],[f("iotbit.blocks.interruptHigh","high"),"HIGH"],[f("iotbit.blocks.interruptLow","low"),"LOW"]]}},mpy(t){let i=t.getFieldValue("PIN")||0,o=`pin_${i}`,e=`interrupt_${i}_flag`,n=t.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=this.definitions_[o]??`${o} = Pin(${i}, Pin.IN)`,this.definitions_[e]=`${e} = asyncio.ThreadSafeFlag()`;let s=this.statementToCode(t,"SUBSTACK")||this.PASS,r="";r+=`while True:
`,r+=`${this.INDENT}await ${e}.wait()
`,r+=s,s=this.prefixLines(r,this.INDENT),s=this.addEventTrap(s,t.id),r=`@_tasks__.append
`,r+=s,this.definitions_[`interrupt_${i}`]=r;let c={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[n]||"Pin.IRQ_RISING";return`${o}.irq(trigger=${c}, handler=lambda _: ${e}.set())
`}},{id:"detachinterrupt",text:f("iotbit.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:"ESP32_PINS"}},mpy(t){return`pin_${t.getFieldValue("PIN")||0}.irq(handler=None)
`}}],menus:{ESP32_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["39","39"]]},ESP32_PWM_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"]]},ESP32_ADC_PINS:{items:[["0","0"],["2","2"],["4","4"],["12","12"],["13","13"],["14","14"],["15","15"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"]]},ESP32_DAC_PINS:{items:[["17","17"],["18","18"]]}}});import{translate as Z1,themeColors as J}from"@blockcode/core";var _2=()=>({id:"display",name:Z1("iotbit.blocks.display","Display"),themeColor:J.blocks.looks.primary,inputColor:J.blocks.looks.secondary,otherColor:J.blocks.looks.tertiary,order:1,blocks:[]});import{translate as h,themeColors as Q}from"@blockcode/core";var v2=()=>({id:"sound",name:"%{BKY_CATEGORY_SOUND}",themeColor:Q.blocks.sounds.primary,inputColor:Q.blocks.sounds.secondary,otherColor:Q.blocks.sounds.tertiary,order:2,blocks:[],menus:{MUSIC:{type:"string",defaultValue:"dadadadum",items:[[h("iotbit.blocks.musicDadadadum","dadadadum"),"dadadadum"],[h("iotbit.blocks.musicEntertainer","entertainer"),"entertainer"],[h("iotbit.blocks.musicPrelude","prelude"),"prelude"],[h("iotbit.blocks.musicOde","ode"),"ode"],[h("iotbit.blocks.musicNyan","nyan"),"nyan"],[h("iotbit.blocks.musicRingtone","ringtone"),"ringtone"],[h("iotbit.blocks.musicFunk","funk"),"funk"],[h("iotbit.blocks.musicBlues","blues"),"blues"],[h("iotbit.blocks.musicBirthday","birthday"),"birthday"],[h("iotbit.blocks.musicWedding","wedding"),"wedding"],[h("iotbit.blocks.musicFuneral","funeral"),"funeral"],[h("iotbit.blocks.musicPunchline","punchline"),"punchline"],[h("iotbit.blocks.musicPython","python"),"python"],[h("iotbit.blocks.musicBaddy","baddy"),"baddy"],[h("iotbit.blocks.musicChase","chase"),"chase"],[h("iotbit.blocks.musicBaDing","ba ding"),"ba ding"],[h("iotbit.blocks.musicWawawawaa","wawawawaa"),"wawawawaa"],[h("iotbit.blocks.musicJumpUp","jump up"),"jump up"],[h("iotbit.blocks.musicJumpDown","jump down"),"jump down"],[h("iotbit.blocks.musicPowerUp","power up"),"power up"],[h("iotbit.blocks.musicPowerDown","power down"),"power down"]]}}});import{translate as j,themeColors as t2}from"@blockcode/core";import{ScratchBlocks as W1}from"@blockcode/blocks";var O2=["1","2","3","4"],E2=()=>({id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:t2.blocks.events.primary,inputColor:t2.blocks.events.secondary,otherColor:t2.blocks.events.tertiary,blocks:[{id:"whenstart",text:j("iotbit.blocks.whenstart","when iot:bit start"),hat:!0,mpy(t){let i=this.statementToCode(t)||this.PASS;i=this.addEventTrap(i,t.id);let o="";return o+=`@_tasks__.append
`,o+=i,o}},"---",{id:"whenkeypressed",text:W1.Msg.EVENT_WHENKEYPRESSED,hat:!0,inputs:{KEY_OPTION:{type:"string",defaultValue:"a",menu:[["a","a"],["b","b"],["a+b","a+b"]]}},emu(t){let i=t.getFieldValue("KEY_OPTION"),o=this.statementToCode(t);return o=this.addEventTrap(o,t.id),o=o.replace(`(done) => {
`,`(target, done) => {
`),`runtime.when('keypressed:${i}', ${o}, target);
`},mpy(t){let i=t.getFieldValue("KEY_OPTION"),o=this.statementToCode(t);o=this.addEventTrap(o,t.id),o=o.replace(`():
`,`(target):
`);let e="";return e+=o,e}},"---",{id:"timerset",text:j("iotbit.blocks.timerset","set timer # %1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:O2},PERIOD:{type:"integer",defaultValue:500}},mpy(t){let i=this.valueToCode(t,"PERIOD",this.ORDER_NONE)||500,o=parseInt(t.getFieldValue("ID")||"1",10)-1;if(o<0)o=0;let e=`timer_${o}`,n=`period_${o}_flag`;this.definitions_.import_timer="from machine import Timer",this.definitions_[e]=`${e} = Timer(${o})`,this.definitions_[n]=`${n} = asyncio.ThreadSafeFlag()`;let s=this.statementToCode(t,"SUBSTACK")||this.PASS,r="";return r+=`while True:
`,r+=`${this.INDENT}await ${n}.wait()
`,r+=s,s=this.prefixLines(r,this.INDENT),s=this.addEventTrap(s,t.id),r=`@_tasks__.append
`,r+=s,this.definitions_[`period_${o}`]=r,`${e}.init(mode=Timer.PERIODIC, period=${i}, callback=lambda _: ${n}.set())
`}},{id:"timeroff",text:j("iotbit.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:O2}},mpy(t){let i=parseInt(t.getFieldValue("ID")||"1",10)-1;if(i<0)i=0;return`timer_${i}.deinit()
`}}]});import{translate as x,themeColors as i2}from"@blockcode/core";import{ScratchBlocks as A}from"@blockcode/blocks";var N2=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:i2.blocks.control.primary,inputColor:i2.blocks.control.secondary,otherColor:i2.blocks.control.tertiary,blocks:[{id:"wait",text:x("iotbit.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(t){return`await asyncio.sleep_ms(${this.valueToCode(t,"MS",this.ORDER_NONE)})
`}},{id:"forever",text:A.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:A.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:A.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:x("iotbit.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"False",o=this.statementToCode(t,"SUBSTACK")||this.PASS,e="";return e+=`elif ${i}:
`,e+=o,e}},{id:"else",text:x("iotbit.blocks.else","else"),substack:!0,mpy(t){let i=this.statementToCode(t,"SUBSTACK")||this.PASS,o="";return o+=`else:
`,o+=i,o}},"---",{id:"repeat_until",text:A.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:A.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:x("iotbit.blocks.continue","continue"),end:!0,mpy(t){return`continue
`}},{id:"break",text:x("iotbit.blocks.break","break"),end:!0,mpy(t){return`break
`}}]});import{translate as p,themeColors as ki}from"@blockcode/core";var T2=()=>({id:"network",name:p("iotbit.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:6,blocks:[{id:"connectwifi",text:p("iotbit.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"esp32"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let i=this.valueToCode(t,"SSID",this.ORDER_NONE),o=this.valueToCode(t,"PASSWORD",this.ORDER_NONE);i=isNaN(i)?i:this.quote_(i),o=isNaN(o)?o:this.quote_(o);let e="";return e+="if not wlan.isconnected(): threading.start_new_thread(",e+=`lambda: wlan.connect(${i}, ${o}), ())
`,e+="while wlan.active() and not wlan.isconnected(): ",e+=`await asyncio.sleep_ms(500)
`,e}},{id:"disconnect",text:p("iotbit.blocks.disconnectWifi","disconnect wifi"),mpy(t){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let i="";return i+=`wlan.disconnect()
`,i+=`wlan.active(False)
`,i}},{id:"isconnected",text:p("iotbit.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"wifiscan",text:p("iotbit.blocks.wifiScan","start scan wifi"),mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let i="";return i+="threading.start_new_thread(",i+=`lambda: wifi_list.extend(wlan.scan()), ())
`,i}},{id:"wifiitem",text:p("iotbit.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[p("iotbit.blocks.wifiItemSsid","ssid"),"SSID"],[p("iotbit.blocks.wifiItemMac","mac"),"MAC"],[p("iotbit.blocks.wifiItemRssi","rssi"),"RSSI"],[p("iotbit.blocks.wifiItemSecurity","security"),"SECURITY"]]}},mpy(t){let i=this.getAdjusted(t,"INDEX")||0,o=t.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let e=`wifi_list[${i}]`;switch(o){case"MAC":e+="[1]";break;case"RSSI":e+="[3]";break;case"SECURITY":e+="[4]";break;default:e+="[0]";break}return[e,this.ORDER_ATOMIC]}},{id:"wificounts",text:p("iotbit.blocks.wifiCounts","available wifi counts"),output:"number",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},"---",{id:"startap",text:p("iotbit.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(t){let i=this.valueToCode(t,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let o="";return o+=`ap.config(ssid=${i})
`,o+=`ap.active(True)
`,o}},{id:"stopap",text:p("iotbit.blocks.stopap","stop ap"),mpy(t){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:p("iotbit.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:p("iotbit.blocks.espnowMsgText","message")},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(t){let i=this.valueToCode(t,"MESSAGE",this.ORDER_NONE),o=this.valueToCode(t,"MAC",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let e="";return e+=`async def espnow_asend(mac, msg):
`,e+=`${this.INDENT}mac_addr = bytes.fromhex(mac.replace(':', ''))
`,e+=`${this.INDENT}try:
`,e+=`${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,e+=`${this.INDENT}except OSError as err:
`,e+=`${this.INDENT}${this.INDENT}if len(err.args) > 1 and err.args[1] == 'ESP_ERR_ESPNOW_NOT_FOUND':
`,e+=`${this.INDENT}${this.INDENT}${this.INDENT}espnow.add_peer(mac_addr)
`,e+=`${this.INDENT}${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,this.definitions_.espnow_asend=e,`await espnow_asend(${o}, ${i})
`}},{id:"espnowrecv",text:p("iotbit.blocks.espnowRecv","wait for esp-now incoming"),mpy(t){return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",`peer, msg = await espnow.arecv()
`}},{id:"espnowmsg",text:p("iotbit.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[p("iotbit.blocks.espnowMsgText","message"),"MESSAGE"],[p("iotbit.blocks.espnowMsgMac","mac"),"MAC"]]}},mpy(t){let i=t.getFieldValue("TYPE")||"MESSAGE";return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",[i==="MAC"?"peer":"msg",this.ORDER_ATOMIC]}},"---",{id:"espnowwhen",text:p("iotbit.blocks.espnowWhen","when esp-now %1 incoming"),hat:!0,inputs:{MESSAGE:{type:"string",defaultValue:p("iotbit.blocks.espnowMsgText","message")}},mpy(t){let i=this.valueToCode(t,"MESSAGE",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)"}},"---",{id:"espnowrepeat",text:p("iotbit.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(t){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let i=this.statementToCode(t,"SUBSTACK");i=this.addLoopTrap(i,t.id);let o="";return o+=`async for peer, msg in espnow:
`,o+=i,o}}]});import{themeColors as o2,translate as e2}from"@blockcode/core";import{ScratchBlocks as $}from"@blockcode/blocks";$.Blocks["#sensing_keyoptions"]=$.Blocks.sensing_keyoptions;var M2=()=>{return $.Blocks.sensing_keyoptions={init(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"KEY_OPTION",options:[["a","a"],["b","b"],["a+b","a+b"]]}],extensions:["colours_sensing","output_string"]})}},{id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:o2.blocks.sensing.primary,inputColor:o2.blocks.sensing.secondary,otherColor:o2.blocks.sensing.tertiary,blocks:[{id:"keypressed",text:$.Msg.SENSING_KEYPRESSED,output:"boolean",inputs:{KEY_OPTION:{shadowType:"sensing_keyoptions",defaultValue:"a"}},emu(t){let i=this.valueToCode(t,"KEY_OPTION",this.ORDER_NONE);return this.renderLoopTrap(),["",this.ORDER_FUNCTION_CALL]},mpy(t){let i=this.valueToCode(t,"KEY_OPTION",this.ORDER_NONE),o="";return["",this.ORDER_FUNCTION_CALL]}},"---",{id:"runtime",text:e2("iotbit.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[e2("iotbit.blocks.runtimeMilliseconds","milliseconds"),"MS"],[e2("iotbit.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(t){return[`(_times__${t.getFieldValue("UNIT")==="SEC"?"/1000":""})`,this.ORDER_ATOMIC]}}]}};import{translate as m,themeColors as s2}from"@blockcode/core";import{ScratchBlocks as u}from"@blockcode/blocks";var S2=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:s2.blocks.operators.primary,inputColor:s2.blocks.operators.secondary,otherColor:s2.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE),e=t.getFieldValue("SYMBOL")||"+",n={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${i} ${e} ${o})`,n[e]]}},"---",{id:"random",text:u.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(t){this.definitions_.import_random="import random";let i=this.valueToCode(t,"FROM",this.ORDER_NONE),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`random.randint(${i}, ${o})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE),e=t.getFieldValue("SYMBOL")||">",n={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${i} ${e} ${o})`,n[e]]}},"---",{id:"and",text:u.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),o=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${i} and ${o})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:u.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let i=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),o=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${i} or ${o})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:u.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(t){return[`(not ${this.valueToCode(t,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE),e=t.getFieldValue("SYMBOL")||"&",n={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${i} ${e} ${o})`,n[e]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(t){return[`(~${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:m("iotbit.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`max(${i}, ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:m("iotbit.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`min(${i}, ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:u.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(t){let i=this.valueToCode(t,"NUM1",this.ORDER_NONE),o=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`(${i} % ${o})`,this.ORDER_MODULUS]}},{id:"round",text:u.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(t){return this.definitions_.import_math="import math",[`round(${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:u.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[u.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[u.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[u.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[u.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[u.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[u.Msg.OPERATORS_MATHOP_COS,"math.cos"],[u.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[u.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[u.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[u.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[u.Msg.OPERATORS_MATHOP_LN,"math.log"],[u.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[u.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[u.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(t){this.definitions_.import_math="import math";let i=t.getFieldValue("OPERATOR")||"abs",o=this.valueToCode(t,"NUM",this.ORDER_NONE),e="";if(i==="pow10")e+=`math.pow(10, ${o})`;else e+=`${i}(${o})`;return[e,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:m("iotbit.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE),o=this.valueToCode(t,"FROM",this.ORDER_NONE),e=this.valueToCode(t,"TO",this.ORDER_NONE);return[`min(max(${i}, ${o}), ${e})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:m("iotbit.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE),o=this.valueToCode(t,"FROMLOW",this.ORDER_NONE),e=this.valueToCode(t,"FROMHIGH",this.ORDER_NONE),n=this.valueToCode(t,"TOLOW",this.ORDER_NONE),s=this.valueToCode(t,"TOHIGHT",this.ORDER_NONE);return[`(${i} - ${o}) * (${s} - ${n}) // (${e} - ${o}) + ${n}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:m("iotbit.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(t){return[`len(${this.valueToCode(t,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"join",text:u.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`(${i} + ${o})`,this.ORDER_ADDITION]}},{id:"letter_of",text:u.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"esp32"}},mpy(t){let i=this.getAdjusted(t,"LETTER");return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${i}]`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:m("iotbit.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(t){let i=this.getAdjusted(t,"FROM"),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${i}:${o}]`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:u.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"e"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)} in ${i})`,this.ORDER_EQUALITY]}},{id:"with",text:m("iotbit.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},WITH:{type:"string",menu:[[m("iotbit.blocks.textStartsWith","starts"),"START"],[m("iotbit.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE),n=(t.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${i}.${n}(${o})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:m("iotbit.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"ESP32"}},mpy(t){let i=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`${i}.lower() == ${o}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:m("iotbit.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[m("iotbit.blocks.textLowerCase","lower"),"LOWER"],[m("iotbit.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"ESP32"}},mpy(t){let i=t.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.${i==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:m("iotbit.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"}},mpy(t){return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:m("iotbit.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[m("iotbit.blocks.dataConvert.int","int"),"int"],[m("iotbit.blocks.dataConvert.float","float"),"float"],[m("iotbit.blocks.dataConvert.string","str"),"str"],[m("iotbit.blocks.dataConvert.list","list"),"list"]]}},mpy(t){let i=this.valueToCode(t,"DATA",this.ORDER_NONE);return[`${t.getFieldValue("TYPE")||"int"}(${i})`,this.ORDER_FUNCTION_CALL]}}]});var y2=()=>({id:"data",skipXML:!0,blocks:[{id:"setvariableto",mpy(t){let i=this.getVariableName(t.getFieldValue("VARIABLE")),o=this.valueToCode(t,"VALUE",this.ORDER_NONE),e=`${i} = ${o}`;if(t.getRootBlock().type==="event_whensetup")return this.definitions_[`variable_${i}`]=e,"";return e+`
`}},{id:"changevariableby",mpy(t){let i=this.getVariableName(t.getFieldValue("VARIABLE")),o=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${i} = ${o}
`}},{id:"variable",mpy(t){return[this.getVariableName(t.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"insertatlist",mpy(t){let i="arr"+this.getVariableName(t.getFieldValue("LIST")),o=this.valueToCode(t,"INDEX",this.ORDER_NONE),e=`${i} = [None] * int(${o})`;if(t.getRootBlock().type==="event_whensetup")return this.definitions_[`variable_${i}`]=e,"";return e+`
`}},{id:"replaceitemoflist",mpy(t){let i="arr"+this.getVariableName(t.getFieldValue("LIST")),o=this.valueToCode(t,"ITEM",this.ORDER_NONE),e=this.valueToCode(t,"INDEX",this.ORDER_NONE);return`${i}[int(${e})] = ${o}
`}},{id:"listcontents",mpy(t){return["arr"+this.getVariableName(t.getFieldValue("LIST")),this.ORDER_ATOMIC]}},{id:"itemoflist",mpy(t){let i="arr"+this.getVariableName(t.getFieldValue("LIST")),o=this.valueToCode(t,"INDEX",this.ORDER_NONE);return[`${i}[int(${o})]`,this.ORDER_MEMBER]}},{id:"lengthoflist",mpy(t){return[`len(${"arr"+this.getVariableName(t.getFieldValue("LIST"))})`,this.ORDER_FUNCTION_CALL]}}]});var I2=()=>({id:"procedures",skipXML:!0,blocks:[{id:"definition",mpy(t){let i=t.childBlocks_[0],o=this.getFunctionName(i.getProcCode()),e=this.statementToCode(t)||this.PASS,n=i.childBlocks_.map((r)=>`${this.getVariableName(r.getFieldValue("VALUE"))}`),s="";s+=`async def ${o}(${n.join(", ")}):
`,s+=e,this.definitions_[o]=s}},{id:"call",mpy(t){let i=this.getFunctionName(t.getProcCode()),o=t.argumentIds_.map((n)=>this.valueToCode(t,n,this.ORDER_NONE)||"False"),e=`await ${i}(${o.join(", ")})`;if(t.return_)return[e,this.ORDER_FUNCTION_CALL];return e+`
`}},{id:"return",mpy(t){return`return ${this.valueToCode(t,"VALUE",this.ORDER_NONE)}
`}}]});import{MicroPythonGenerator as $1}from"@blockcode/blocks";var B1=`# Generate by BlockCode
`;class B extends $1{finish(t){return B1+super.finish(t)}}function D2(){let t=R2(),i=_2(),o=v2(),e=E2(),n=N2(),s=T2(),r=M2(),a=S2(),c=y2(),d=I2();return[t,i,o,e,n,s,r,a,c,d]}import{Text as O}from"@blockcode/core";import{jsx as E}from"preact/jsx-runtime";var x2=[{tag:"controller",label:E(O,{id:"iotbit.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:E(O,{id:"iotbit.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:E(O,{id:"iotbit.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:E(O,{id:"iotbit.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:E(O,{id:"iotbit.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:E(O,{id:"iotbit.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:E(O,{id:"iotbit.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:E(O,{id:"iotbit.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as K1}from"preact/jsx-runtime";var Y1=(t)=>t.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),A2=new B,z1=()=>[["device","!scratch"],"data"];function P2(){let{tabIndex:t}=V1(),{meta:i}=U1(),o=F1((e,n,s,r)=>{G1.prototype.onDefinitions.call(A2);for(let a in s)for(let c of s[a])if(!c.common){let d=K(c.name,q(c.name));n(`import_${a}_${d}`,`from ${Y1(a)} import ${d}`)}},[]);return K1(H1,{enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:t.value!==0,extensionTags:x2,generator:A2,onBuildinExtensions:D2,onDefinitions:o,onExtensionsFilter:z1})}import{useAppContext as X1}from"@blockcode/core";function R(t){let i=globalThis.document,o=i.createElement("style");o.appendChild(i.createTextNode(t)),i.head.append(o)}R(".LuJSkq_device-icon{width:20px;height:20px}.LuJSkq_blank-check-item>div{padding-left:calc(var(--space)/2 + 14px)}");var T={blankCheckItem:"LuJSkq_blank-check-item",deviceIcon:"LuJSkq_device-icon"};var Z2="./assets/icon-device-qx17f37n.svg";import{jsx as J1}from"preact/jsx-runtime";function W2(){let{appState:t}=X1();return J1("img",{className:T.deviceIcon,src:Z2})}import{useCallback as q2}from"preact/hooks";import{nanoid as lt,classNames as X2}from"@blockcode/utils";import{useProjectContext as rt,setAlert as a2,delAlert as at}from"@blockcode/core";import{MPYUtils as V}from"@blockcode/board";import{sleepMs as J2}from"@blockcode/utils";var F=[{usbVendorId:12346},{usbVendorId:6790}];import{Spinner as dt,Text as d2,MenuSection as ct,MenuItem as Q2}from"@blockcode/core";import{useEffect as F2}from"preact/hooks";import{useSignal as V2}from"@preact/signals";import{nanoid as G2,classNames as Q1,sleep as j1,arrayBufferToBinaryString as H2,getBinaryCache as Y2,setBinaryCache as tt}from"@blockcode/utils";import{setAlert as P,delAlert as it,openPromptModal as m4}from"@blockcode/core";import{ESPTool as y}from"@blockcode/board";var b4="0.1.0";var B2={download:"https://firmware.blockcode.fun/iotbit"};import{Text as I,Spinner as l2,MenuSection as ot,MenuItem as et}from"@blockcode/core";import{jsx as k}from"preact/jsx-runtime";var C=null,st=(t)=>{if(!C)C=G2();if(t<100)P({id:C,icon:k(l2,{level:"success"}),message:k(I,{id:"iotbit.menubar.device.restoring",defaultMessage:"Firmware restoring...{progress}%",progress:t})});else P({id:C,icon:k(l2,{level:"success"}),message:k(I,{id:"iotbit.menubar.device.recovering",defaultMessage:"Recovering..."})})},n2=()=>{it(C),C=null},r2=(t)=>{if(t==="NotFoundError")return;P("connectionError",1000)},z2=async(t)=>{try{return await fetch(t,{method:"GET"})}catch(i){return await j1(1),z2(t)}},S=async(t,i,o,e,n)=>{if(n.value)return;let s=await Y2(t);if(s?.hash===o&&s?.binaryString){n.value=!0,delete S.downloading;return}if(S.downloading)return;S.downloading=!0;let a=await(await z2(i)).arrayBuffer();delete S.downloading;let c=await crypto.subtle.digest("SHA-256",a);if(Array.from(new Uint8Array(c)).map((l)=>l.toString(16).padStart(2,"0")).join("")!==o){S(t,i,o,e,n);return}await tt(t,{version:e,hash:o,binaryString:H2(a)}),n.value=!0},U2=async(t,i)=>{if(!C)C=G2();P({id:C,icon:k(l2,{level:"success"}),message:k(I,{id:"iotbit.menubar.device.erasing",defaultMessage:"Erasing..."})});let o=y.check(t).catch(()=>{r2(),n2(),y.disconnect(t)});try{await t.main(),await y.writeFlash(t,i,!0,(e)=>st(e)),P({id:C,icon:null,message:k(I,{id:"iotbit.menubar.device.restoreDone",defaultMessage:"Firmware resotre completed!"}),onClose:n2})}catch(e){r2(e.name),n2()}finally{o.cancel()}await y.disconnect(t)},nt=async(t)=>{if(C)return;let i;try{i=await y.connect(F,460800)}catch(n){r2(n.name)}if(!i)return;let o=await Y2(t);if(o)U2(i,[{data:o.binaryString,address:0}]);let e=document.createElement("input");e.type="file",e.accept=".bin",e.multiple=!1,e.click(),e.addEventListener("cancel",()=>y.disconnect(i)),e.addEventListener("change",async(n)=>{let s=new FileReader;s.readAsArrayBuffer(n.target.files[0]),s.addEventListener("load",(r)=>U2(i,[{data:H2(r.target.result),address:0}]))})};function K2({itemClassName:t}){let i=V2(!1),o=V2(null);return F2(()=>C=null,[]),F2(async()=>{i.value=!1;let e=B2.download;if(!o.value)o.value=await fetch(`${e}/version.json`).then((r)=>r.json());let n=`${e}/${o.value.download}`.replaceAll("{version}",o.value.version),s=o.value.hash;S("iotbitFirmware",n,s,o.value.version,i)},[]),k(ot,{children:k(et,{disabled:C||!i.value,className:Q1(t,T.blankCheckItem),onClick:()=>nt("iotbitFirmware"),children:i.value?k(I,{id:"iotbit.menubar.device.iotbitFirmware",defaultMessage:"Restore iot:bit firmware"}):k(I,{id:"iotbit.menubar.device.caching",defaultMessage:"Caching latest firmware..."})})})}import{jsx as M,jsxs as i1,Fragment as bt}from"preact/jsx-runtime";var _=null,c2=()=>{at(_),_=null},j2=(t)=>{if(!_)_=lt();if(t<100)a2({id:_,icon:M(dt,{level:"success"}),message:M(d2,{id:"gui.alert.downloadingProgress",defaultMessage:"Downloading...{progress}%",progress:t})});else a2("downloadCompleted",{id:_}),setTimeout(c2,2000)},U=(t)=>{if(t==="NotFoundError")return;a2("connectionError",1000)},t1=async(t,i,o)=>{let e=V.check(t).catch(()=>{U(),c2()}),n=[].concat(i,o).map((s)=>({...s,filename:s.id}));j2(0);try{await V.write(t,n,j2),t.exitRawRepl(),await J2(1000),t.reset(),await J2(1000)}catch(s){console.log(s),U(s),c2()}finally{t.disconnect()}e.cancel()};function o1({itemClassName:t}){let{meta:i,file:o,assets:e}=rt(),n=q2(async()=>{if(_)return;let r;try{r=await V.connect(F,{baudRate:115200})}catch(a){console.log(a),U(a.name)}if(!r)return;t1(r,o.value,e.value)},[]),s=q2(async()=>{if(_)return;let r;try{r=await V.connectBLE()}catch(a){console.log(a),U(a.name)}if(!r)return;t1(r,o.value,e.value)},[]);return i1(bt,{children:[i1(ct,{children:[M(Q2,{disabled:!0,className:X2(t,T.blankCheckItem),label:M(d2,{id:"iotbit.menubar.device.downloadBle",defaultMessage:"Download program via Bluetooth (BLE)"}),onClick:s}),M(Q2,{disabled:_,className:X2(t,T.blankCheckItem),label:M(d2,{id:"iotbit.menubar.device.download",defaultMessage:"Download program via Serial Port"}),onClick:n})]}),M(K2,{itemClassName:t})]})}import{useCallback as Wt,useEffect as $t}from"preact/hooks";import{useSignal as Bt}from"@preact/signals";import{classNames as Ft}from"@blockcode/utils";import{useAppContext as Vt,setAppState as Ut}from"@blockcode/core";var g={Width:360,Height:300,Small:"small",Large:"large"};import{classNames as At}from"@blockcode/utils";import{useAppContext as Pt}from"@blockcode/core";import{useCallback as vt,useEffect as u2}from"preact/hooks";import{MathUtils as oo,KonvaUtils as eo}from"@blockcode/utils";import{useAppContext as Ot,useProjectContext as Et}from"@blockcode/core";import{Emulator as Nt}from"@blockcode/blocks";import{MathUtils as Z4,KonvaUtils as W4}from"@blockcode/utils";import{Keys as B4}from"@blockcode/core";import{Runtime as ut}from"@blockcode/blocks";class b2 extends ut{loadImage(t){return new Promise((i,o)=>{let e=new Image;e.onload=()=>i(e),e.onerror=o,e.src=t})}}var e1="./assets/iotbit-276k5w57.svg";var s1="./assets/display-68hm5r84.svg";var n1="./assets/button-sbv3mknj.svg";var l1="./assets/button-click-bfqpcpaa.svg";var r1="./assets/pin-m6ajdypb.svg";var a1="./assets/pin-click-xvmsgf4q.svg";var d1="./assets/pin-0-375ttq8p.svg";var c1="./assets/pin-0-click-k2meafnk.svg";var b1="./assets/pin-gnd-e880nqyp.svg";var u1="./assets/pin-gnd-click-1zt7zrmx.svg";var p1="./assets/pin-name-6qz7s9wj.svg";import{jsx as Tt}from"preact/jsx-runtime";function f1({runtime:t,onRuntime:i}){let{splashVisible:o,appState:e}=Ot(),{meta:n,file:s,modified:r}=Et();u2(async()=>{if(!t)return;if(e.value?.running===!0){let c=`((/*${s.value.name}*/) => {
${s.value.script}})();`;t.launch(`${c}

runtime.start();`)}if(e.value?.running===!1){if(t.running)t.stop()}},[e.value?.running]),u2(async()=>{if(!t)return;if(o.value===!0){t.stop(),t.backdropLayer.destroyChildren(),t.paintLayer.destroyChildren(),t.spritesLayer.destroyChildren(),t.boardLayer.destroyChildren();return}if(e.value?.running)return},[t,o.value,r.value,n.value]),u2(()=>{if(!t)return;t.stage.listening(!e.value?.running)},[t,e.value?.running]);let a=vt(async(c)=>{let d=new b2(c);i(d);let l={iotbit:await d.loadImage(e1),display:await d.loadImage(s1),button:await d.loadImage(n1),buttonClick:await d.loadImage(l1),pin:await d.loadImage(r1),pinClick:await d.loadImage(a1),pin0:await d.loadImage(d1),pin0Click:await d.loadImage(c1),pinGND:await d.loadImage(b1),pinGNDClick:await d.loadImage(u1),pinName:await d.loadImage(p1)};return d.backdropLayer.add(new Konva.Image({id:"iotbit",x:0,y:0,scaleY:d.stage.scaleY(),image:l.iotbit,width:l.iotbit.width,height:l.iotbit.height,offsetX:l.iotbit.width/2,offsetY:l.iotbit.height/2})),d.boardLayer.add(new Konva.Image({id:"display",x:0,y:20,scaleY:d.stage.scaleY(),image:l.display,width:l.display.width,height:l.display.height,offsetX:l.display.width/2,offsetY:l.display.height/2})),["a","b"].forEach((N,L)=>{let b=new Konva.Image({id:"button-"+N,x:-105+L*210,y:7,scaleY:d.stage.scaleY(),image:l.button,width:l.button.width,height:l.button.height,offsetX:l.button.width/2,offsetY:l.button.height/2});d.spritesLayer.add(b),b.on("pointerdown",()=>b.setAttrs({image:l.buttonClick,width:l.buttonClick.width,height:l.buttonClick.height,offsetX:l.buttonClick.width/2,offsetY:l.buttonClick.height/2})),b.on("pointerup",()=>b.setAttrs({image:l.button,width:l.button.width,height:l.button.height,offsetX:l.button.width/2,offsetY:l.button.height/2}))}),["0","1","2","3v","gnd"].forEach((N,L)=>{let b=L>0&&L<4?"pin":`pin${N.toUpperCase()}`,D=new Konva.Image({id:"pin-"+N,x:-123+L*61.5+(L===0?6:L===4?-7:L===3?0.2:0),y:-88,scaleY:d.stage.scaleY(),image:l[b],width:l[b].width,height:l[b].height,offsetX:l[b].width/2,offsetY:l[b].height/2});d.spritesLayer.add(D),D.on("pointerdown",()=>D.setAttrs({image:l[`${b}Click`],width:l[`${b}Click`].width,height:l[`${b}Click`].height,offsetX:l[`${b}Click`].width/2,offsetY:l[`${b}Click`].height/2})),D.on("pointerup",()=>D.setAttrs({image:l[b],width:l[b].width,height:l[b].height,offsetX:l[b].width/2,offsetY:l[b].height/2}))}),d.boardLayer.add(new Konva.Image({id:"pin-name",x:4,y:-95,scaleY:d.stage.scaleY(),image:l.pinName,width:l.pinName.width,height:l.pinName.height,offsetX:l.pinName.width/2,offsetY:l.pinName.height/2})),()=>{i(null)}},[i]);return Tt(Nt,{id:"iotbit-emulator",zoom:e.value?.stageSize!==g.Large?0.8:1,width:g.Width,height:g.Height,onRuntime:a})}import{useCallback as p2}from"preact/hooks";import{classNames as k1}from"@blockcode/utils";import{useAppContext as Dt,translate as G,setAppState as f2}from"@blockcode/core";import{ToggleButtons as xt}from"@blockcode/core";R(".hZ1onW_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}.hZ1onW_green-flag,.hZ1onW_stop{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}.hZ1onW_green-flag:hover,.hZ1onW_stop:hover{background:var(--theme-light-transparent)}.hZ1onW_green-flag.hZ1onW_actived{background:var(--theme-transparent)}.hZ1onW_stop{opacity:.5}.hZ1onW_stop.hZ1onW_actived{opacity:1}.hZ1onW_green-flag.hZ1onW_disabled,.hZ1onW_stop.hZ1onW_disabled{opacity:.5}.hZ1onW_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.hZ1onW_space{margin-left:.2rem}.hZ1onW_toolbar-buttons-group{display:flex}.hZ1onW_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.hZ1onW_group-button{border-left:none;border-radius:0}.hZ1onW_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.hZ1onW_group-button-toggled-off{filter:saturate(0)}");var v={stop:"hZ1onW_stop",greenFlag:"hZ1onW_green-flag",groupButton:"hZ1onW_group-button",groupButtonLast:"hZ1onW_group-button-last",toolbarWrapper:"hZ1onW_toolbar-wrapper",toolbarButton:"hZ1onW_toolbar-button",groupButtonFirst:"hZ1onW_group-button-first",disabled:"hZ1onW_disabled",actived:"hZ1onW_actived",space:"hZ1onW_space",groupButtonToggledOff:"hZ1onW_group-button-toggled-off",toolbarButtonsGroup:"hZ1onW_toolbar-buttons-group"};var h1="./assets/icon-green-flag-tz1g77je.svg";var m1="./assets/icon-stop-all-zrx3gxr1.svg";var g1="./assets/icon-small-stage-anyzs7w9.svg";var C1="./assets/icon-large-stage-f6hyxzdr.svg";import{jsx as H,jsxs as L1}from"preact/jsx-runtime";function w1(){let{appState:t,tabIndex:i}=Dt(),o=p2(()=>{if(i.value!==0)return;f2({running:!0})},[]),e=p2(()=>{f2({running:!1})},[]),n=p2((s)=>{f2({stageSize:s})},[]);return L1("div",{className:v.toolbarWrapper,children:[L1("div",{className:v.toolbarButtonsGroup,children:[H("img",{className:k1(v.greenFlag,{[v.actived]:t.value?.running,[v.disabled]:i.value!==0}),src:h1,title:G("iotbit.emu.greenFlag","Go"),onClick:o}),H("img",{className:k1(v.stop,{[v.actived]:t.value?.running}),src:m1,title:G("iotbit.emu.stop","Stop"),onClick:e})]}),H("div",{className:v.toolbarButtonsGroup,children:H(xt,{items:[{icon:g1,title:G("iotbit.emu.smallStage","Switch to small stage"),value:g.Small},{icon:C1,title:G("iotbit.emu.largeStage","Switch to large stage"),value:g.Large}],value:t.value?.stageSize??g.Small,onChange:n})})]})}R(".K-thSq_stage-wrapper{position:relative}.K-thSq_stage{z-index:10;width:362px;height:302px;position:relative;overflow:hidden}.K-thSq_small-stage{width:290px;height:242px}");var Y={stage:"K-thSq_stage",stageWrapper:"K-thSq_stage-wrapper",smallStage:"K-thSq_small-stage"};import{jsx as h2,jsxs as Zt}from"preact/jsx-runtime";function R1({runtime:t,onRuntime:i}){let{appState:o}=Pt();return Zt("div",{className:Y.stageWrapper,children:[h2(w1,{}),h2("div",{className:At(Y.stage,{[Y.smallStage]:o.value?.stageSize!==g.Large}),children:h2(f1,{runtime:t,onRuntime:i})})]})}R(".-\\33 i13a_sidedock-wrapper{flex-direction:column;height:100%;display:flex}.-\\33 i13a_stage-wrapper{display:flex}.-\\33 i13a_selector-wrapper{margin-top:var(--space);flex-direction:row;flex-grow:1;width:362px;display:flex}.-\\33 i13a_selector-wrapper.-\\33 i13a_small{width:290px}");var Z={sidedockWrapper:"-3i13a_sidedock-wrapper",small:"-3i13a_small",selectorWrapper:"-3i13a_selector-wrapper",stageWrapper:"-3i13a_stage-wrapper"};import{jsx as _1,jsxs as Gt}from"preact/jsx-runtime";function v1(){let{appState:t}=Vt(),i=Bt(null);return $t(()=>{Ut({stageSize:window.innerWidth<1200?g.Small:g.Large})},[]),Gt("div",{className:Z.sidedockWrapper,children:[_1(R1,{className:Z.stageWrapper,runtime:i.value,onRuntime:Wt((o)=>i.value=o,[])}),_1("div",{className:Ft(Z.selectorWrapper,{[Z.small]:t.value?.stageSize!==g.Large})})]})}var O1={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as m2}from"preact/jsx-runtime";var Ce={onNew(){return O1},onSave(t,i,o){let e=[];return t=t.map((n)=>{return e.push(n.extensions),{id:n.id,type:n.type,xml:n.xml}}),{files:t,assets:i,meta:{extensions:Array.from(new Set(e.flat()))}}},async onThumb(){let t=W.getMainWorkspace();if(t){let i=t.getCanvas();if(i)return await Ht(i,{})}},onUndo(t){if(t instanceof MouseEvent)W.getMainWorkspace()?.undo(!1)},onRedo(t){if(t instanceof MouseEvent)W.getMainWorkspace()?.undo(!0)},onEnableUndo(){let t=W.getMainWorkspace();return t?.undoStack_&&t.undoStack_.length!==0},onEnableRedo(){let t=W.getMainWorkspace();return t?.redoStack_&&t.redoStack_.length!==0},menuItems:[{icon:m2(W2,{}),label:m2(Xt,{id:"iotbit.menubar.device",defaultMessage:"iot:bit"}),Menu:o1}],tabs:[{...Yt,Content:P2},{...Kt,Content:()=>m2(zt,{})},{...qt,disabled:!0}],docks:[{expand:"right",Content:v1}]};export{Ce as default};
