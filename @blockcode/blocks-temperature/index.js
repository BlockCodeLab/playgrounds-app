import{addLocalesMessages as A,Text as h}from"@blockcode/core";import{Text as r}from"@blockcode/core";import{jsx as d}from"preact/jsx-runtime";var c=(i)=>["ArduinoUno","BLEUNO"].includes(i.boardType),C=(i)=>["ArduinoNano","BLENANO"].includes(i.boardType),_=(i)=>["ESP32","ESP32_IOT_BOARD"].includes(i.boardType),N=(i)=>["ESP32S3"].includes(i.boardType),a=(i)=>{if(c(i))return"unoAdc";if(C(i))return"nanoAdc";if(_(i))return"esp32Adc";if(N(i))return"esp32s3Adc"},p=(i)=>[{id:"lm35",text:d(r,{id:"blocks.temperature.lm35",defaultMessage:"pin [PIN] LM35 temperature"}),output:"number",inputs:{PIN:{menu:a(i)}},ino(o){let e=o.getFieldValue("PIN");return this.definitions_[`setup_pin_${e}`]=`pinMode(${e}, INPUT);`,[`(analogRead(${e}) * 500.0 / 1023.0)`,this.ORDER_FUNCTION_CALL]},mpy(o){let e=o.getFieldValue("PIN"),t=`_lm${e}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[t]=`${t} = ADC(Pin(${e}), atten=ADC.ATTN_11DB)`,[`(${t}.read_uv() / 10_000)`,this.ORDER_FUNCTION_CALL]}},{id:"nl50",text:d(r,{id:"blocks.temperature.nl50",defaultMessage:"pin [PIN] NL50 temperature"}),output:"number",inputs:{PIN:{menu:a(i)}},ino(o){let e=o.getFieldValue("PIN");return this.definitions_[`setup_pin_${e}`]=`pinMode(${e}, INPUT);`,[`(analogRead(${e}) * 500.0 / 1023.0 - 50.0)`,this.ORDER_FUNCTION_CALL]},mpy(o){let e=o.getFieldValue("PIN"),t=`_nl${e}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[t]=`${t} = ADC(Pin(${e}), atten=ADC.ATTN_11DB)`,[`(${t}.read_uv() / 10_000 - 50)`,this.ORDER_FUNCTION_CALL]}},{id:"ds8b20",text:d(r,{id:"blocks.temperature.ds8b20",defaultMessage:"pin [PIN] DS8B20 temperature"}),output:"number",inputs:{PIN:{type:"integer",defaultValue:"1"}},ino(o){let e=this.valueToCode(o,"PIN",this.ORDER_NONE),t=`_ow${e}`,n=`_ds${e}`;this.definitions_.include_onewire="#include <OneWire.h>",this.definitions_.include_dallastemperature="#include <DallasTemperature.h>",this.definitions_[`variable_${t}`]=`OneWire ${t}(${e});`,this.definitions_[`variable_${n}`]=`DallasTemperature ${n}(&${t});`,this.definitions_[`setup_${n}`]=`${n}.begin();`;let s="";return s+=`float getTempC(DallasTemperature dt) {
`,s+=`  dt.requestTemperatures();
`,s+=`  return dt.getTempCByIndex(0);
`,s+=`}
`,this.definitions_.declare_getTempC="float getTempC(DallasTemperature dt);",this.definitions_.getTempC=s,[`getTempC(${n})`,this.ORDER_FUNCTION_CALL]},mpy(o){let e=this.valueToCode(o,"PIN",this.ORDER_NONE),t=`_ds${e}`;this.definitions_.import_pin="from machine import Pin",this.definitions_.import_onewire="from onewire import OneWire",this.definitions_.import_ds18x20="from ds18x20 import DS18X20",this.definitions_[t]=`${t} = DS18X20(OneWire(Pin(${e})))`;let n="";return n+=`def get_tempc(ds):
`,n+=`  ds.convert_temp()
`,n+=`  roms = ds.scan()
`,n+=`  return ds.read_temp(roms[0]) if len(roms) and roms[0] else 0
`,this.definitions_.get_tempc=n,[`get_tempc(${t})`,this.ORDER_FUNCTION_CALL]}}],m={unoAdc:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]]},nanoAdc:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"],["A6","A6"],["A7","A7"]]},esp32Adc:{items:[["0","0"],["2","2"],["4","4"],["12","12"],["13","13"],["14","14"],["15","15"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"]]},esp32s3Adc:{items:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"]]}};var l={en:{"blocks.temperature.name":"Temperature","blocks.temperature.lm35":"pin [PIN] LM35 temperature","blocks.temperature.nl50":"pin [PIN] NL50 temperature","blocks.temperature.ds8b20":"pin [PIN] DS8B20 temperature"},"zh-Hans":{"blocks.temperature.name":"温度模块","blocks.temperature.lm35":"引脚[PIN] LM35 温度","blocks.temperature.nl50":"引脚[PIN] NL50 温度","blocks.temperature.ds8b20":"引脚[PIN] DS8B20 温度"},"zh-Hant":{"blocks.temperature.name":"溫度模組","blocks.temperature.lm35":"引腳[PIN] LM35 溫度","blocks.temperature.nl50":"引腳[PIN] NL50 溫度","blocks.temperature.ds8b20":"引腳[PIN] DS8B20 溫度"}};var u="./assets/icon-3shvb9d2.svg";import{jsx as L}from"preact/jsx-runtime";A(l);var R={icon:u,name:L(h,{id:"blocks.temperature.name",defaultMessage:"Temperature"}),blocks:p,menus:m};export{R as default};
