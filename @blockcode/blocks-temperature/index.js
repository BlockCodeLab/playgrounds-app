import{addLocalesMessages as _,Text as c}from"@blockcode/core";import{Text as r}from"@blockcode/core";import{jsx as a}from"preact/jsx-runtime";var l=(n)=>n.editor==="@blockcode/gui-iotbit",d=(n)=>[{id:"lm35",text:a(r,{id:"blocks.temperature.lm35",defaultMessage:"pin [PIN] LM35 temperature"}),output:"number",inputs:{PIN:n.boardPins?{menu:n.boardPins.adc}:{type:"positive_integer",defaultValue:1}},ino(i){let e=n.boardPins?i.getFieldValue("PIN"):this.valueToCode(i,"PIN",this.ORDER_NONE);return this.definitions_[`setup_pin_${e}`]=`pinMode(${e}, INPUT);`,[`(analogRead(${e}) * 500.0 / 1023.0)`,this.ORDER_FUNCTION_CALL]},mpy(i){let e=n.boardPins?i.getFieldValue("PIN"):this.valueToCode(i,"PIN",this.ORDER_NONE),t=`_lm${e}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[t]=`${t} = ADC(Pin(${e}), atten=ADC.ATTN_11DB)`,[`(${t}.read_uv() / 10_000)`,this.ORDER_FUNCTION_CALL]}},{id:"nl50",text:a(r,{id:"blocks.temperature.nl50",defaultMessage:"pin [PIN] NL50 temperature"}),output:"number",inputs:{PIN:n.boardPins?{menu:n.boardPins.adc}:{type:"positive_integer",defaultValue:1}},ino(i){let e=n.boardPins?i.getFieldValue("PIN"):this.valueToCode(i,"PIN",this.ORDER_NONE);return this.definitions_[`setup_pin_${e}`]=`pinMode(${e}, INPUT);`,[`(analogRead(${e}) * 500.0 / 1023.0 - 50.0)`,this.ORDER_FUNCTION_CALL]},mpy(i){let e=n.boardPins?i.getFieldValue("PIN"):this.valueToCode(i,"PIN",this.ORDER_NONE),t=`_nl${e}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[t]=`${t} = ADC(Pin(${e}), atten=ADC.ATTN_11DB)`,[`(${t}.read_uv() / 10_000 - 50)`,this.ORDER_FUNCTION_CALL]}},{id:"ds8b20",text:a(r,{id:"blocks.temperature.ds8b20",defaultMessage:"pin [PIN] DS8B20 temperature"}),output:"number",inputs:{PIN:n.boardPins?{menu:n.boardPins.out}:{type:"positive_integer",defaultValue:1}},ino(i){let e=this.valueToCode(i,"PIN",this.ORDER_NONE),t=`_ow${e}`,o=`_ds${e}`;this.definitions_.include_onewire="#include <OneWire.h>",this.definitions_.include_dallastemperature="#include <DallasTemperature.h>",this.definitions_[`variable_${t}`]=`OneWire ${t}(${e});`,this.definitions_[`variable_${o}`]=`DallasTemperature ${o}(&${t});`,this.definitions_[`setup_${o}`]=`${o}.begin();`;let s="";return s+=`float getTempC(DallasTemperature dt) {
`,s+=`  dt.requestTemperatures();
`,s+=`  return dt.getTempCByIndex(0);
`,s+=`}
`,this.definitions_.declare_getTempC="float getTempC(DallasTemperature dt);",this.definitions_.getTempC=s,[`getTempC(${o})`,this.ORDER_FUNCTION_CALL]},mpy(i){let e=l(n)?i.getFieldValue("PIN"):this.valueToCode(i,"PIN",this.ORDER_NONE),t=`_ds${e}`;this.definitions_.import_pin="from machine import Pin",this.definitions_.import_onewire="from onewire import OneWire",this.definitions_.import_ds18x20="from ds18x20 import DS18X20",this.definitions_[t]=`${t} = DS18X20(OneWire(Pin(${e})))`;let o="";return o+=`def get_tempc(ds):
`,o+=`  ds.convert_temp()
`,o+=`  roms = ds.scan()
`,o+=`  return ds.read_temp(roms[0]) if len(roms) and roms[0] else 0
`,this.definitions_.get_tempc=o,[`get_tempc(${t})`,this.ORDER_FUNCTION_CALL]}}];var p={en:{"blocks.temperature.name":"Temperature","blocks.temperature.lm35":"pin [PIN] LM35 temperature","blocks.temperature.nl50":"pin [PIN] NL50 temperature","blocks.temperature.ds8b20":"pin [PIN] DS8B20 temperature"},"zh-Hans":{"blocks.temperature.name":"温度模块","blocks.temperature.lm35":"引脚[PIN] LM35 温度","blocks.temperature.nl50":"引脚[PIN] NL50 温度","blocks.temperature.ds8b20":"引脚[PIN] DS8B20 温度"},"zh-Hant":{"blocks.temperature.name":"溫度模組","blocks.temperature.lm35":"引腳[PIN] LM35 溫度","blocks.temperature.nl50":"引腳[PIN] NL50 溫度","blocks.temperature.ds8b20":"引腳[PIN] DS8B20 溫度"}};var m="./assets/icon-3shvb9d2.svg";import{jsx as N}from"preact/jsx-runtime";_(p);var O={icon:m,name:N(c,{id:"blocks.temperature.name",defaultMessage:"Temperature"}),blocks:d};export{O as default};
