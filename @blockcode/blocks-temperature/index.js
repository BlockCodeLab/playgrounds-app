import{addLocalesMessages as f,Text as h}from"@blockcode/core";import{Text as r}from"@blockcode/core";import{jsx as d}from"preact/jsx-runtime";var P=(e)=>["ArduinoUno","BLEUNO"].includes(e.boardType),C=(e)=>["ArduinoNano","BLENANO"].includes(e.boardType),_=(e)=>["ESP32","ESP32_IOT_BOARD"].includes(e.boardType),A=(e)=>["ESP32S3"].includes(e.boardType),a=(e)=>e.editor==="@blockcode/gui-iotbit",p=(e)=>{if(P(e))return"unoAdc";if(C(e))return"nanoAdc";if(_(e))return"esp32Adc";if(A(e))return"esp32s3Adc";if(a(e))return"iotAdc"},m=(e)=>[{id:"lm35",text:d(r,{id:"blocks.temperature.lm35",defaultMessage:"pin [PIN] LM35 temperature"}),output:"number",inputs:{PIN:{menu:p(e)}},ino(o){let t=o.getFieldValue("PIN");return this.definitions_[`setup_pin_${t}`]=`pinMode(${t}, INPUT);`,[`(analogRead(${t}) * 500.0 / 1023.0)`,this.ORDER_FUNCTION_CALL]},mpy(o){let t=o.getFieldValue("PIN"),i=`_lm${t}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[i]=`${i} = ADC(Pin(${t}), atten=ADC.ATTN_11DB)`,[`(${i}.read_uv() / 10_000)`,this.ORDER_FUNCTION_CALL]}},{id:"nl50",text:d(r,{id:"blocks.temperature.nl50",defaultMessage:"pin [PIN] NL50 temperature"}),output:"number",inputs:{PIN:{menu:p(e)}},ino(o){let t=o.getFieldValue("PIN");return this.definitions_[`setup_pin_${t}`]=`pinMode(${t}, INPUT);`,[`(analogRead(${t}) * 500.0 / 1023.0 - 50.0)`,this.ORDER_FUNCTION_CALL]},mpy(o){let t=o.getFieldValue("PIN"),i=`_nl${t}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[i]=`${i} = ADC(Pin(${t}), atten=ADC.ATTN_11DB)`,[`(${i}.read_uv() / 10_000 - 50)`,this.ORDER_FUNCTION_CALL]}},{id:"ds8b20",text:d(r,{id:"blocks.temperature.ds8b20",defaultMessage:"pin [PIN] DS8B20 temperature"}),output:"number",inputs:{PIN:a(e)?{menu:"iotPins"}:{type:"positive_integer",defaultValue:1}},ino(o){let t=this.valueToCode(o,"PIN",this.ORDER_NONE),i=`_ow${t}`,n=`_ds${t}`;this.definitions_.include_onewire="#include <OneWire.h>",this.definitions_.include_dallastemperature="#include <DallasTemperature.h>",this.definitions_[`variable_${i}`]=`OneWire ${i}(${t});`,this.definitions_[`variable_${n}`]=`DallasTemperature ${n}(&${i});`,this.definitions_[`setup_${n}`]=`${n}.begin();`;let s="";return s+=`float getTempC(DallasTemperature dt) {
`,s+=`  dt.requestTemperatures();
`,s+=`  return dt.getTempCByIndex(0);
`,s+=`}
`,this.definitions_.declare_getTempC="float getTempC(DallasTemperature dt);",this.definitions_.getTempC=s,[`getTempC(${n})`,this.ORDER_FUNCTION_CALL]},mpy(o){let t=a(e)?o.getFieldValue("PIN"):this.valueToCode(o,"PIN",this.ORDER_NONE),i=`_ds${t}`;this.definitions_.import_pin="from machine import Pin",this.definitions_.import_onewire="from onewire import OneWire",this.definitions_.import_ds18x20="from ds18x20 import DS18X20",this.definitions_[i]=`${i} = DS18X20(OneWire(Pin(${t})))`;let n="";return n+=`def get_tempc(ds):
`,n+=`  ds.convert_temp()
`,n+=`  roms = ds.scan()
`,n+=`  return ds.read_temp(roms[0]) if len(roms) and roms[0] else 0
`,this.definitions_.get_tempc=n,[`get_tempc(${i})`,this.ORDER_FUNCTION_CALL]}}],u={unoAdc:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]]},nanoAdc:{items:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"],["A6","A6"],["A7","A7"]]},esp32Adc:{items:[["0","0"],["2","2"],["4","4"],["12","12"],["13","13"],["14","14"],["15","15"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"]]},esp32s3Adc:{items:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"]]},iotAdc:{items:[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]]},iotPins:{items:[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P6","16"],["P7","17"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P13","18"],["P14","19"],["P15","21"],["P16","5"],["P19","22"],["P20","23"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]]}};var l={en:{"blocks.temperature.name":"Temperature","blocks.temperature.lm35":"pin [PIN] LM35 temperature","blocks.temperature.nl50":"pin [PIN] NL50 temperature","blocks.temperature.ds8b20":"pin [PIN] DS8B20 temperature"},"zh-Hans":{"blocks.temperature.name":"温度模块","blocks.temperature.lm35":"引脚[PIN] LM35 温度","blocks.temperature.nl50":"引脚[PIN] NL50 温度","blocks.temperature.ds8b20":"引脚[PIN] DS8B20 温度"},"zh-Hant":{"blocks.temperature.name":"溫度模組","blocks.temperature.lm35":"引腳[PIN] LM35 溫度","blocks.temperature.nl50":"引腳[PIN] NL50 溫度","blocks.temperature.ds8b20":"引腳[PIN] DS8B20 溫度"}};var c="./assets/icon-3shvb9d2.svg";import{jsx as L}from"preact/jsx-runtime";f(l);var E={icon:c,name:L(h,{id:"blocks.temperature.name",defaultMessage:"Temperature"}),blocks:m,menus:u};export{E as default};
