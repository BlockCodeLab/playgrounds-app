import{addLocalesMessages as at}from"@blockcode/core";var he={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.sync":"Sync program","esp32.menubar.device.download":"Download program","esp32.menubar.device.reset":"Reset device","esp32.menubar.device.connectUsb":"Connect device with USB","esp32.menubar.device.connectBle":"Connect device with Bluetooth (BLE)","esp32.menubar.device.disconnect":"Disconnect device","esp32.menubar.device.iotboardFirmware":"Restore IOT Board firmware (v{version})","esp32.menubar.device.firmware":"Restore MicroPython firmware","esp32.menubar.device.erasing":"Erasing...","esp32.menubar.device.restoring":"Firmware restoring...{progress}%","esp32.menubar.device.recovering":"Recovering...","esp32.menubar.device.restoreDone":"Firmware resotre completed! Now press RESET key","esp32.menubar.device.caching":"Caching latest firmware...","esp32.extension.tags.controllers":"Controllers","esp32.extension.tags.sensors":"Sensors","esp32.extension.tags.actuators":"Actuators","esp32.extension.tags.displays":"Displays","esp32.extension.tags.modules":"Modules","esp32.extension.tags.communication":"Communication","esp32.extension.tags.data":"Data","esp32.extension.tags.kits":"Kits","esp32.blocks.wait":"wait %1 milliseconds","esp32.blocks.break":"break","esp32.blocks.continue":"continue","esp32.blocks.elseif":"else if %1 then","esp32.blocks.else":"else","esp32.blocks.runtime":"run time %1","esp32.blocks.runtimeMilliseconds":"milliseconds","esp32.blocks.runtimeSeconds":"seconds","esp32.blocks.dataConvert":"convert %1 to %2","esp32.blocks.dataConvert.int":"int","esp32.blocks.dataConvert.float":"float","esp32.blocks.dataConvert.string":"str","esp32.blocks.dataConvert.list":"list","esp32.blocks.dataLengthOf":"length of %1","esp32.blocks.dataConstrain":"constrain %1 between %2 to %3","esp32.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","esp32.blocks.whenstart":"when {name} start","esp32.blocks.timerset":"set timer # %1 per %2 milliseconds","esp32.blocks.timeroff":"stop timer # %1","esp32.blocks.operatorLarger":"larger of %1 and %2","esp32.blocks.operatorSmaller":"smaller of %1 and %2","esp32.blocks.pin":"Pins","esp32.blocks.setmode":"set pin %1 mode to %2","esp32.blocks.inputMode":"input","esp32.blocks.ouputMode":"output","esp32.blocks.inputPullUpMode":"input pull-up","esp32.blocks.inputPullDownMode":"input pull-down","esp32.blocks.setdigital":"set pin %1 to %2","esp32.blocks.digitalHigh":"high","esp32.blocks.digitalLow":"low","esp32.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","esp32.blocks.setpwm":"set pin %1 pwm to %2","esp32.blocks.setanalog":"set pin %1 analog to %2","esp32.blocks.isDigitalHigh":"pin %1 is high?","esp32.blocks.analogValue":"pin %1 analog value","esp32.blocks.attachinterrupt":"attach pin %1 interrupt to %2","esp32.blocks.interruptRising":"rising","esp32.blocks.interruptFalling":"falling","esp32.blocks.interruptChange":"change","esp32.blocks.interruptHigh":"high","esp32.blocks.interruptLow":"low","esp32.blocks.detachinterrupt":"detach pin %1 interrupt","esp32.blocks.network":"Network","esp32.blocks.protocols":"Protocols","esp32.blocks.serial":"Serial","esp32.blocks.serialBaudrate":"set baudrate to %1","esp32.blocks.serialTimeout":"set timeout to %1 milliseconds","esp32.blocks.serialPrint":"send %1 with %2","esp32.blocks.serialPrintWarp":"warp","esp32.blocks.serialPrintNoWarp":"no-warp","esp32.blocks.serialPrintHEX":"hex","esp32.blocks.serialAvailable":"available data?","esp32.blocks.serialAvailableLength":"available data length","esp32.blocks.serialReadString":"read a string","esp32.blocks.serialReadStringUntil":"read a string until %1","esp32.blocks.serialReadParse":"read a %1 number","esp32.blocks.serialReadParseInteger":"int","esp32.blocks.serialReadParseFloat":"float","esp32.blocks.serialRead":"read a byte","esp32.blocks.serialReadBytes":"read %1 bytes","esp32.blocks.text":"Text","esp32.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","esp32.blocks.textRemove":"remove letters from %1 to %2 of %3","esp32.blocks.textReplace":"replace %1 of %2 with %3","esp32.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","esp32.blocks.textSubstring":"substring of %1 from %2 to %3","esp32.blocks.textFind":"find %1 of %2 place","esp32.blocks.textWith":"%1 %2 with %3?","esp32.blocks.textStartsWith":"starts","esp32.blocks.textEndsWith":"ends","esp32.blocks.textCase":"get %1 of %2","esp32.blocks.textLowerCase":"lower-case","esp32.blocks.textUpperCase":"upper-case","esp32.blocks.textTrim":"remove %1 leading and trailing whitespace","esp32.blocks.textConvert":"convert %1 to %2","esp32.blocks.textConvertFrom":"convert %1 to String","esp32.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","esp32.blocks.disconnectWifi":"disconnect wi-fi","esp32.blocks.isWifiConnected":"wi-fi is connected?","esp32.blocks.wifiScan":"start scan wi-fi","esp32.blocks.wifiItem":"%2 of item %1 of available wi-fi","esp32.blocks.wifiItemSsid":"ssid","esp32.blocks.wifiItemMac":"mac","esp32.blocks.wifiItemRssi":"rssi","esp32.blocks.wifiItemSecurity":"security","esp32.blocks.wifiCounts":"available wi-fi counts","esp32.blocks.startap":"start ap ssid: %1","esp32.blocks.stopap":"stop ap","esp32.blocks.espnowBroadcast":"broadcast %1 via esp-now","esp32.blocks.espnowSend":"send %1 to %2 via esp-now","esp32.blocks.espnowRecv":"wait for esp-now incoming","esp32.blocks.espnowMsg":"%1 of incoming","esp32.blocks.espnowMsgText":"message","esp32.blocks.espnowMsgMac":"mac address","esp32.blocks.espnowRepeat":"repeat wait for esp-now incoming","esp32.blocks.espnowWhen":"when esp-now receive %1","esp32.blocks.spiInit":"initialize SPI %1 freq:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 write %2","esp32.blocks.spiRead":"SPI %1 read %2 bytes","esp32.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","esp32.blocks.i2cScan":"I2C scan devices","esp32.blocks.i2cWrite":"I2C write to %1:%2","esp32.blocks.i2cRead":"I2C read from %1 :%2 bytes","esp32.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","esp32.blocks.i2sPlay":"I2S play %1","esp32.blocks.terminal":"Terminal","esp32.blocks.terminalPrint":"print %1","esp32.blocks.temperature":"temperature"};var ge={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.sync":"同步程序","esp32.menubar.device.download":"下载程序","esp32.menubar.device.reset":"复位","esp32.menubar.device.connectUsb":"通过 USB 连接","esp32.menubar.device.connectBle":"通过蓝牙（BLE）连接","esp32.menubar.device.disconnect":"断开连接","esp32.menubar.device.iotboardFirmware":"恢复 IOT Borad 固件（v{version}）","esp32.menubar.device.firmware":"恢复 MicroPython 固件","esp32.menubar.device.erasing":"正在清除…","esp32.menubar.device.restoring":"正在恢复固件…{progress}%","esp32.menubar.device.recovering":"恢复设备…","esp32.menubar.device.restoreDone":"恢复固件完成，请按下 RESET 键。","esp32.menubar.device.caching":"正在缓存最新固件…","esp32.extension.tags.controllers":"输入模块","esp32.extension.tags.sensors":"传感器","esp32.extension.tags.actuators":"执行器","esp32.extension.tags.displays":"显示模块","esp32.extension.tags.modules":"智能模块","esp32.extension.tags.communication":"通讯","esp32.extension.tags.data":"数据","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重复执行","esp32.blocks.continue":"跳到下一次执行","esp32.blocks.elseif":"否则，如果 %1 那么","esp32.blocks.else":"否则","esp32.blocks.runtime":"运行时长 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"将 %1 转为 %2","esp32.blocks.dataConvert.int":"整数","esp32.blocks.dataConvert.float":"浮点数","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataLengthOf":"%1 长度","esp32.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","esp32.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"当 {name} 启动","esp32.blocks.timerset":"将定时器 # %1 间隔设为每 %2 毫秒","esp32.blocks.timeroff":"关闭定时器 # %1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引脚","esp32.blocks.setmode":"将引脚 %1 设为 %2 模式","esp32.blocks.inputMode":"输入","esp32.blocks.ouputMode":"输出","esp32.blocks.inputPullUpMode":"上拉输入","esp32.blocks.inputPullDownMode":"下拉输入","esp32.blocks.setdigital":"将引脚 %1 设为 %2","esp32.blocks.digitalHigh":"高电平","esp32.blocks.digitalLow":"低电平","esp32.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","esp32.blocks.setpwm":"将引脚 %1 PWM 设为 %2","esp32.blocks.setanalog":"将引脚 %1 模拟值设为 %2","esp32.blocks.isDigitalHigh":"引脚 %1 是高电平？","esp32.blocks.analogValue":"引脚 %1 模拟值","esp32.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","esp32.blocks.interruptRising":"电平上升","esp32.blocks.interruptFalling":"电平下降","esp32.blocks.interruptChange":"电平改变","esp32.blocks.interruptHigh":"高电平","esp32.blocks.interruptLow":"低电平","esp32.blocks.detachinterrupt":"取消引脚 %1 中断","esp32.blocks.network":"网络","esp32.blocks.protocols":"协议","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"将波特率设为 %1","esp32.blocks.serialTimeout":"将通讯超时设为 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式发送 %1","esp32.blocks.serialPrintWarp":"换行","esp32.blocks.serialPrintNoWarp":"不换行","esp32.blocks.serialPrintHEX":"16进制","esp32.blocks.serialAvailable":"存在可读取数据?","esp32.blocks.serialAvailableLength":"可读取数据长度","esp32.blocks.serialReadString":"读取文本","esp32.blocks.serialReadStringUntil":"读取文本直到 %1","esp32.blocks.serialReadParse":"读取 %1","esp32.blocks.serialReadParseInteger":"整数","esp32.blocks.serialReadParseFloat":"浮点数","esp32.blocks.serialRead":"读取 1 个字节","esp32.blocks.serialReadBytes":"读取 %1 个字节","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","esp32.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","esp32.blocks.textReplace":"将 %2 中的 %1 替换为 %3","esp32.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","esp32.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"开始于","esp32.blocks.textEndsWith":"结束于","esp32.blocks.textCase":"将 %2 字母转为 %1","esp32.blocks.textLowerCase":"小写","esp32.blocks.textUpperCase":"大写","esp32.blocks.textTrim":"清除 %1 前后空白字符","esp32.blocks.textConvert":"将 %1 转为 %2","esp32.blocks.textConvertFrom":"将 %1 转为文本","esp32.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","esp32.blocks.disconnectWifi":"断开 Wi-Fi 网络","esp32.blocks.isWifiConnected":"Wi-Fi 网络已连接？","esp32.blocks.wifiScan":"开始扫描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemMac":"MAC","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密类型","esp32.blocks.wifiCounts":"可用 Wi-Fi 数量","esp32.blocks.startap":"开启热点 SSID: %1","esp32.blocks.stopap":"关闭热点","esp32.blocks.espnowBroadcast":"ESP-Now 广播 %1","esp32.blocks.espnowSend":"ESP-Now 发送 %1 给 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"消息","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"当 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 频率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 写入 %2","esp32.blocks.spiRead":"SPI %1 读取 %2 字节","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","esp32.blocks.i2cScan":"I2C扫描设备","esp32.blocks.i2cWrite":"I2C写入到 %1:%2","esp32.blocks.i2cRead":"I2C从 %1 读取 %2 字节","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"终端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度"};var fe={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.sync":"同步程式","esp32.menubar.device.download":"下載程式","esp32.menubar.device.reset":"重置","esp32.menubar.device.connectUsb":"通過 USB 連接","esp32.menubar.device.connectBle":"通過藍牙（BLE）連接","esp32.menubar.device.disconnect":"斷開連接","esp32.menubar.device.iotboardFirmware":"還原 IOT Borad 固件（v{version}）","esp32.menubar.device.firmware":"還原 MicroPython 固件","esp32.menubar.device.erasing":"正在清除…","esp32.menubar.device.restoring":"正在還原固件…{progress}%","esp32.menubar.device.recovering":"恢復設備…","esp32.menubar.device.restoreDone":"還原固件完成，請按下 RESET 鍵。","esp32.menubar.device.caching":"正在緩存最新固件…","esp32.extension.tags.controllers":"輸入模組","esp32.extension.tags.sensors":"傳感器","esp32.extension.tags.actuators":"執行器","esp32.extension.tags.displays":"顯示模組","esp32.extension.tags.modules":"智能模組","esp32.extension.tags.communication":"通訊","esp32.extension.tags.data":"數據","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重複","esp32.blocks.continue":"跳到下一次","esp32.blocks.elseif":"否則，如果 %1 那麼","esp32.blocks.else":"否則","esp32.blocks.runtime":"運行時長 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"將 %1 轉為 %2","esp32.blocks.dataConvert.int":"整數","esp32.blocks.dataConvert.float":"浮點數","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataLengthOf":"%1 長度","esp32.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","esp32.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"當 {name} 開始","esp32.blocks.timerset":"將定時器 # %1 間隔設為每 %2 毫秒","esp32.blocks.timeroff":"關閉定時器 # %1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引腳","esp32.blocks.setmode":"將引腳 %1 設為 %2 模式","esp32.blocks.inputMode":"輸入","esp32.blocks.ouputMode":"輸出","esp32.blocks.inputPullUpMode":"上拉輸入","esp32.blocks.inputPullDownMode":"下拉輸入","esp32.blocks.setdigital":"將引腳 %1 設為 %2","esp32.blocks.digitalHigh":"高電平","esp32.blocks.digitalLow":"低電平","esp32.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","esp32.blocks.setpwm":"將引腳 %1 PWM 設為 %2","esp32.blocks.setanalog":"將引腳 %1 模擬值設為 %2","esp32.blocks.isDigitalHigh":"引腳 %1 是高電平？","esp32.blocks.analogValue":"引腳 %1 模擬值","esp32.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","esp32.blocks.interruptRising":"電平上升","esp32.blocks.interruptFalling":"電平下降","esp32.blocks.interruptChange":"電平改變","esp32.blocks.interruptHigh":"高電平","esp32.blocks.interruptLow":"低電平","esp32.blocks.detachinterrupt":"取消引腳 %1 中斷","esp32.blocks.network":"網絡","esp32.blocks.protocols":"協議","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"將波特率設為 %1","esp32.blocks.serialTimeout":"將通訊超時設為 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式打印 %1","esp32.blocks.serialPrintWarp":"換行","esp32.blocks.serialPrintNoWarp":"不換行","esp32.blocks.serialPrintHEX":"16進制","esp32.blocks.serialAvailable":"存在可讀取數據?","esp32.blocks.serialAvailableLength":"可讀取數據長度","esp32.blocks.serialReadString":"讀取文本","esp32.blocks.serialReadStringUntil":"讀取文本直到 %1","esp32.blocks.serialReadParse":"讀取 %1","esp32.blocks.serialReadParseInteger":"整數","esp32.blocks.serialReadParseFloat":"浮點數","esp32.blocks.serialRead":"讀取 1 個字節","esp32.blocks.serialReadBytes":"讀取 %1 個字節","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","esp32.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","esp32.blocks.textReplace":"將 %2 中的 %1 替換為 %3","esp32.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","esp32.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"開始於","esp32.blocks.textEndsWith":"結束於","esp32.blocks.textCase":"將 %2 字母轉為 %1","esp32.blocks.textLowerCase":"小寫","esp32.blocks.textUpperCase":"大寫","esp32.blocks.textTrim":"清除 %1 前後空白字符","esp32.blocks.textConvert":"將 %1 轉為 %2","esp32.blocks.textConvertFrom":"將 %1 轉為文本","esp32.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","esp32.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","esp32.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","esp32.blocks.wifiScan":"開始掃描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemMac":"MAC","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密類型","esp32.blocks.wifiCounts":"可用 Wi-Fi 數量","esp32.blocks.startap":"開啟 AP SSID: %1","esp32.blocks.stopap":"關閉 AP","esp32.blocks.espnowBroadcast":"ESP-Now 廣播 %1","esp32.blocks.espnowSend":"ESP-Now 發送 %1 給 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"消息","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"當 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 寫入 %2","esp32.blocks.spiRead":"SPI %1 讀取 %2 位元組","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","esp32.blocks.i2cScan":"I2C掃描設備","esp32.blocks.i2cWrite":"I2C寫入到 %1:%2","esp32.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"終端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度"};at({en:he,"zh-Hans":ge,"zh-Hant":fe});import{svgAsDataUri as ls}from"@blockcode/utils";import{ScratchBlocks as F,blocksTab as as,codeReviewTab as ps}from"@blockcode/blocks";import{terminalTab as cs}from"@blockcode/code";function v(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Ee(e,t){var s="",i=0,n=-1,o=0,l;for(var r=0;r<=e.length;++r){if(r<e.length)l=e.charCodeAt(r);else if(l===47)break;else l=47;if(l===47){if(n===r-1||o===1);else if(n!==r-1&&o===2){if(s.length<2||i!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var a=s.lastIndexOf("/");if(a!==s.length-1){if(a===-1)s="",i=0;else s=s.slice(0,a),i=s.length-1-s.lastIndexOf("/");n=r,o=0;continue}}else if(s.length===2||s.length===1){s="",i=0,n=r,o=0;continue}}if(t){if(s.length>0)s+="/..";else s="..";i=2}}else{if(s.length>0)s+="/"+e.slice(n+1,r);else s=e.slice(n+1,r);i=r-n-1}n=r,o=0}else if(l===46&&o!==-1)++o;else o=-1}return s}function pt(e,t){var s=t.dir||t.root,i=t.base||(t.name||"")+(t.ext||"");if(!s)return i;if(s===t.root)return s+i;return s+e+i}function Q(){var e="",t=!1,s;for(var i=arguments.length-1;i>=-1&&!t;i--){var n;if(i>=0)n=arguments[i];else{if(s===void 0)s=process.cwd();n=s}if(v(n),n.length===0)continue;e=n+"/"+e,t=n.charCodeAt(0)===47}if(e=Ee(e,!t),t)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function Oe(e){if(v(e),e.length===0)return".";var t=e.charCodeAt(0)===47,s=e.charCodeAt(e.length-1)===47;if(e=Ee(e,!t),e.length===0&&!t)e=".";if(e.length>0&&s)e+="/";if(t)return"/"+e;return e}function ct(e){return v(e),e.length>0&&e.charCodeAt(0)===47}function ut(){if(arguments.length===0)return".";var e;for(var t=0;t<arguments.length;++t){var s=arguments[t];if(v(s),s.length>0)if(e===void 0)e=s;else e+="/"+s}if(e===void 0)return".";return Oe(e)}function dt(e,t){if(v(e),v(t),e===t)return"";if(e=Q(e),t=Q(t),e===t)return"";var s=1;for(;s<e.length;++s)if(e.charCodeAt(s)!==47)break;var i=e.length,n=i-s,o=1;for(;o<t.length;++o)if(t.charCodeAt(o)!==47)break;var l=t.length,r=l-o,a=n<r?n:r,p=-1,c=0;for(;c<=a;++c){if(c===a){if(r>a){if(t.charCodeAt(o+c)===47)return t.slice(o+c+1);else if(c===0)return t.slice(o+c)}else if(n>a){if(e.charCodeAt(s+c)===47)p=c;else if(c===0)p=0}break}var d=e.charCodeAt(s+c),D=t.charCodeAt(o+c);if(d!==D)break;else if(d===47)p=c}var S="";for(c=s+p+1;c<=i;++c)if(c===i||e.charCodeAt(c)===47)if(S.length===0)S+="..";else S+="/..";if(S.length>0)return S+t.slice(o+p);else{if(o+=p,t.charCodeAt(o)===47)++o;return t.slice(o)}}function mt(e){return e}function bt(e){if(v(e),e.length===0)return".";var t=e.charCodeAt(0),s=t===47,i=-1,n=!0;for(var o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!n){i=o;break}}else n=!1;if(i===-1)return s?"/":".";if(s&&i===1)return"//";return e.slice(0,i)}function Z(e,t){if(t!==void 0&&typeof t!=="string")throw TypeError('"ext" argument must be a string');v(e);var s=0,i=-1,n=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var l=t.length-1,r=-1;for(o=e.length-1;o>=0;--o){var a=e.charCodeAt(o);if(a===47){if(!n){s=o+1;break}}else{if(r===-1)n=!1,r=o+1;if(l>=0)if(a===t.charCodeAt(l)){if(--l===-1)i=o}else l=-1,i=r}}if(s===i)i=r;else if(i===-1)i=e.length;return e.slice(s,i)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!n){s=o+1;break}}else if(i===-1)n=!1,i=o+1;if(i===-1)return"";return e.slice(s,i)}}function J(e){v(e);var t=-1,s=0,i=-1,n=!0,o=0;for(var l=e.length-1;l>=0;--l){var r=e.charCodeAt(l);if(r===47){if(!n){s=l+1;break}continue}if(i===-1)n=!1,i=l+1;if(r===46){if(t===-1)t=l;else if(o!==1)o=1}else if(t!==-1)o=-1}if(t===-1||i===-1||o===0||o===1&&t===i-1&&t===s+1)return"";return e.slice(t,i)}function Rt(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return pt("/",e)}function ht(e){v(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var s=e.charCodeAt(0),i=s===47,n;if(i)t.root="/",n=1;else n=0;var o=-1,l=0,r=-1,a=!0,p=e.length-1,c=0;for(;p>=n;--p){if(s=e.charCodeAt(p),s===47){if(!a){l=p+1;break}continue}if(r===-1)a=!1,r=p+1;if(s===46){if(o===-1)o=p;else if(c!==1)c=1}else if(o!==-1)c=-1}if(o===-1||r===-1||c===0||c===1&&o===r-1&&o===l+1){if(r!==-1)if(l===0&&i)t.base=t.name=e.slice(1,r);else t.base=t.name=e.slice(l,r)}else{if(l===0&&i)t.name=e.slice(1,o),t.base=e.slice(1,r);else t.name=e.slice(l,o),t.base=e.slice(l,r);t.ext=e.slice(o,r)}if(l>0)t.dir=e.slice(0,l-1);else if(i)t.dir="/";return t}var gt="/",ft=":",fs=((e)=>(e.posix=e,e))({resolve:Q,normalize:Oe,isAbsolute:ct,join:ut,relative:dt,_makeLong:mt,dirname:bt,basename:Z,extname:J,format:Rt,parse:ht,sep:gt,delimiter:ft,win32:null,posix:null});import{useCallback as Le}from"preact/hooks";import{useAppContext as vt,useProjectContext as _t}from"@blockcode/core";import{MicroPythonGenerator as Nt,BlocksEditor as St}from"@blockcode/blocks";import{translate as b,themeColors as j}from"@blockcode/core";import{keyMirror as Et}from"@blockcode/utils";var u=Et({ESP32:null,ESP32S2:null,ESP32S3:null,ESP32C3:null,ESP32C5:null,ESP32C6:null,ESP32_IOT_BOARD:null});var ke=(e)=>{let t=e===u.ESP32S3,s=t?"ESP32S3_PINS":"ESP32_PINS",i=t?"ESP32S3_PINS":"ESP32_OUT_PINS",n=t?"ESP32S3_ADC_PINS":"ESP32_ADC_PINS";return{id:"pin",name:b("esp32.blocks.pin","Pins"),themeColor:j.blocks.motion.primary,inputColor:j.blocks.motion.secondary,otherColor:j.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:b("esp32.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:s},MODE:{menu:[[b("esp32.blocks.ouputMode","output"),"OUTPUT"],[b("esp32.blocks.inputMode","input"),"INPUT"],[b("esp32.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[b("esp32.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=o.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let p="";if(a==="INPUT")p=`${r} = Pin(${l}, Pin.IN)`;else if(a==="INPUT_PULLUP")p=`${r} = Pin(${l}, Pin.IN, Pin.PULL_UP)`;else if(a==="INPUT_PULLDOWN")p=`${r} = Pin(${l}, Pin.IN, Pin.PULL_DOWN)`;else p=`${r} = Pin(${l}, Pin.OUT)`;return this.definitions_[r]=p,""}},"---",{id:"setdigital",text:b("esp32.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:i},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[b("esp32.blocks.digitalHigh","high"),"1"],[b("esp32.blocks.digitalLow","low"),"0"]]}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=this.definitions_[r]??`${r} = Pin(${l}, Pin.OUT)`,`${r}.value(${a})
`}},...e===u.ESP32_IOT_BOARD||e===u.ESP32?[{id:"setDAC",text:b("esp32.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:"ESP32_DAC_PINS"},VALUE:{shadow:"slider255"}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[r]=`${r} = DAC(Pin(${l}))`,`${r}.write(${a})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(o){return[o.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}}]:[],{id:"digital",text:b("esp32.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:s}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=`${r} = Pin(${l}, Pin.IN)`,[`(${r}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:b("esp32.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:n}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[r]=`${r} = ADC(Pin(${l}))`,this.definitions_[`${r}_atten`]=`${r}.atten(ADC.ATTN_11DB)`,this.definitions_[`${r}_width`]=`${r}.width(ADC.WIDTH_10BIT)`,[`${r}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:b("esp32.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:i},FREQ:{type:"integer",defaultValue:"1000"}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=this.valueToCode(o,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[r]=`${r} = PWM(Pin(${l}), freq=1000)`,`${r}.freq(${a})
`}},{id:"setPWM",text:b("esp32.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:i},VALUE:{shadow:"slider1023"}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[r]=`${r} = PWM(Pin(${l}), freq=1000)`,`${r}.duty(${a})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(o){return[o.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:b("esp32.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:s},INTERRUPT:{menu:[[b("esp32.blocks.interruptRising","rising"),"RISING"],[b("esp32.blocks.interruptFalling","falling"),"FALLING"],[b("esp32.blocks.interruptChange","change"),"CHANGE"],[b("esp32.blocks.interruptHigh","high"),"HIGH"],[b("esp32.blocks.interruptLow","low"),"LOW"]]}},mpy(o){let l=o.getFieldValue("PIN")||0,r=`pin_${l}`,a=`interrupt_${l}_flag`,p=o.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=this.definitions_[r]??`${r} = Pin(${l}, Pin.IN)`,this.definitions_[a]=`${a} = asyncio.ThreadSafeFlag()`;let c=this.statementToCode(o,"SUBSTACK")||this.PASS,d="";d+=`while True:
`,d+=`${this.INDENT}await ${a}.wait()
`,d+=c,c=this.prefixLines(d,this.INDENT),c=this.addEventTrap(c,o.id),d=`@_tasks__.append
`,d+=c,this.definitions_[`interrupt_${l}`]=d;let S={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[p]||"Pin.IRQ_RISING";return`${r}.irq(trigger=${S}, handler=lambda _: ${a}.set())
`}},{id:"detachinterrupt",text:b("esp32.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:s}},mpy(o){return`pin_${o.getFieldValue("PIN")||0}.irq(handler=None)
`}}],menus:{ESP32_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["39","39"]]},ESP32S3_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"],["21","21"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"],["40","40"],["41","41"],["42","42"],["43","43"],["44","44"],["45","45"],["46","46"],["47","47"],["48","48"]]},ESP32_OUT_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"]]},ESP32_ADC_PINS:{items:[["0","0"],["2","2"],["4","4"],["12","12"],["13","13"],["14","14"],["15","15"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"]]},ESP32S3_ADC_PINS:{items:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"]]},ESP32_DAC_PINS:{items:[["25","25"],["26","26"]]}}}};import{translate as f,themeColors as ee}from"@blockcode/core";var Te=()=>({id:"serial",name:f("esp32.blocks.serial","Serial"),themeColor:ee.blocks.looks.primary,inputColor:ee.blocks.looks.secondary,otherColor:ee.blocks.looks.tertiary,order:1,blocks:[{id:"baudrate",text:f("esp32.blocks.serialBaudrate","set baudrate to %1"),inputs:{BAUDRATE:{menu:{items:["115200","57600","38400","19200","9600","4800"]}}},mpy(e){let t=e.getFieldValue("BAUDRATE");return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",`uart.init(${t})
`}},{id:"timeout",text:f("esp32.blocks.serialTimeout","set timeout to %1 milliseconds"),inputs:{TIMEOUT:{type:"integer",defaultValue:1000}},mpy(e){let t=this.valueToCode(e,"TIMEOUT",this.ORDER_NONE);return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",`uart.timeout = ${t} / 1000
`}},{id:"print",text:f("esp32.blocks.serialPrint","send %1 with %2"),inputs:{STRING:{type:"string",defaultValue:"hello"},MODE:{menu:[[f("esp32.blocks.serialPrintWarp","warp"),"WARP"],[f("esp32.blocks.serialPrintNoWarp","no-warp"),"NOWARP"],[f("esp32.blocks.serialPrintHEX","hex"),"HEX"]]}},mpy(e){let t=this.valueToCode(e,"STRING",this.ORDER_NONE),s=e.getFieldValue("MODE")||"WARP";this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)";let i=`uart.write(str(${t}) + '\\n')
`;if(s==="NOWARP")i=`uart.write(str(${t}))
`;else if(s==="HEX")i=`uart.write(hex(${t}))
`;return i}},"---",{id:"available",text:f("esp32.blocks.serialAvailable","available data?"),output:"boolean",mpy(e){return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",["(uart.any() > 0)",this.ORDER_RELATIONAL]}},{id:"available_length",text:f("esp32.blocks.serialAvailableLength","available data length"),output:"number",mpy(e){return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",["uart.any()",this.ORDER_FUNCTION_CALL]}},"---",{id:"read_string",text:f("esp32.blocks.serialReadString","read a string"),output:"string",mpy(e){return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",["uart.read().decode('utf-8')",this.ORDER_FUNCTION_CALL]}},{id:"read_string_until",text:f("esp32.blocks.serialReadStringUntil","read a string until %1"),output:"string",inputs:{CHAR:{type:"string",defaultValue:"a"}},mpy(e){let t=this.valueToCode(e,"CHAR",this.ORDER_NONE);return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",[`uart.readuntil(${t}).decode('utf-8')`,this.ORDER_FUNCTION_CALL]}},{id:"read_parse",text:f("esp32.blocks.serialReadParse","read a %1 number"),output:"number",inputs:{TYPE:{menu:[[f("esp32.blocks.serialReadParseInteger","int"),"INT"],[f("esp32.blocks.serialReadParseFloat","float"),"FLOAT"]]}},mpy(e){let t=e.getFieldValue("TYPE")||"INT";if(this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",t==="INT")return["int(uart.read())",this.ORDER_FUNCTION_CALL];else if(t==="FLOAT")return["float(uart.read())",this.ORDER_FUNCTION_CALL]}},"---",{id:"read",text:f("esp32.blocks.serialRead","read a byte"),output:!0,mpy(e){return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",["uart.read(1)",this.ORDER_FUNCTION_CALL]}},{id:"read_bytes",text:f("esp32.blocks.serialReadBytes","read %1 bytes"),output:!0,inputs:{LEN:{type:"integer",defaultValue:2}},mpy(e){let t=this.valueToCode(e,"LEN",this.ORDER_NONE);return this.definitions_.import_uart="from machine import UART",this.definitions_.uart="uart = UART(0)",[`uart.read(${t})`,this.ORDER_FUNCTION_CALL]}}]});import{translate as C,themeColors as te}from"@blockcode/core";var ve=(e)=>{let t=C("esp32.menubar.device.esp32","ESP32");switch(e){case u.ESP32S3:t=C("esp32.menubar.device.esp32s3","ESP32-S3");break;case u.ESP32C3:t=C("esp32.menubar.device.esp32c3","ESP32-C3");break;case u.ESP32_IOT_BOARD:t=C("esp32.menubar.device.esp32IotBoard","ESP32 IOT Board");break}let s=["1","2","3","4"];return{id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:te.blocks.events.primary,inputColor:te.blocks.events.secondary,otherColor:te.blocks.events.tertiary,blocks:[{id:"whenstart",text:C("esp32.blocks.whenstart","when {name} start",{name:t}),hat:!0,mpy(i){let n=this.statementToCode(i)||this.PASS;n=this.addEventTrap(n,i.id);let o="";return o+=`@_tasks__.append
`,o+=n,o}},"---",{id:"timerset",text:C("esp32.blocks.timerset","set timer # %1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:s},PERIOD:{type:"integer",defaultValue:500}},mpy(i){let n=this.valueToCode(i,"PERIOD",this.ORDER_NONE)||500,o=parseInt(i.getFieldValue("ID")||"1",10)-1;if(o<0)o=0;let l=`timer_${o}`,r=`period_${o}_flag`;this.definitions_.import_timer="from machine import Timer",this.definitions_[l]=`${l} = Timer(${o})`,this.definitions_[r]=`${r} = asyncio.ThreadSafeFlag()`;let a=this.statementToCode(i,"SUBSTACK")||this.PASS,p="";return p+=`while True:
`,p+=`${this.INDENT}await ${r}.wait()
`,p+=a,a=this.prefixLines(p,this.INDENT),a=this.addEventTrap(a,i.id),p=`@_tasks__.append
`,p+=a,this.definitions_[`period_${o}`]=p,`${l}.init(mode=Timer.PERIODIC, period=${n}, callback=lambda _: ${r}.set())
`}},{id:"timeroff",text:C("esp32.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:s}},mpy(i){let n=parseInt(i.getFieldValue("ID")||"1",10)-1;if(n<0)n=0;return`timer_${n}.deinit()
`}}]}};import{translate as L,themeColors as se}from"@blockcode/core";import{ScratchBlocks as x}from"@blockcode/blocks";var _e=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:se.blocks.control.primary,inputColor:se.blocks.control.secondary,otherColor:se.blocks.control.tertiary,blocks:[{id:"wait",text:L("esp32.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(e){return`await asyncio.sleep_ms(${this.valueToCode(e,"MS",this.ORDER_NONE)})
`}},{id:"forever",text:x.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:x.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:x.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:L("esp32.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"CONDITION",this.ORDER_NONE)||"False",s=this.statementToCode(e,"SUBSTACK")||this.PASS,i="";return i+=`elif ${t}:
`,i+=s,i}},{id:"else",text:L("esp32.blocks.else","else"),substack:!0,mpy(e){let t=this.statementToCode(e,"SUBSTACK")||this.PASS,s="";return s+=`else:
`,s+=t,s}},"---",{id:"repeat_until",text:x.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:x.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:L("esp32.blocks.continue","continue"),end:!0,mpy(e){return`continue
`}},{id:"break",text:L("esp32.blocks.break","break"),end:!0,mpy(e){return`break
`}}]});import{translate as R,themeColors as ws}from"@blockcode/core";var Ne=()=>({id:"network",name:R("esp32.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:5,blocks:[{id:"connectwifi",text:R("esp32.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"esp32"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(e){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let t=this.valueToCode(e,"SSID",this.ORDER_NONE),s=this.valueToCode(e,"PASSWORD",this.ORDER_NONE);t=isNaN(t)?t:this.quote_(t),s=isNaN(s)?s:this.quote_(s);let i="";return i+="if not wlan.isconnected(): threading.start_new_thread(",i+=`lambda: wlan.connect(${t}, ${s}), ())
`,i+="while wlan.active() and not wlan.isconnected(): ",i+=`await asyncio.sleep_ms(500)
`,i}},{id:"disconnect",text:R("esp32.blocks.disconnectWifi","disconnect wifi"),mpy(e){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let t="";return t+=`wlan.disconnect()
`,t+=`wlan.active(False)
`,t}},{id:"isconnected",text:R("esp32.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(e){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"wifiscan",text:R("esp32.blocks.wifiScan","start scan wifi"),mpy(e){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let t="";return t+="threading.start_new_thread(",t+=`lambda: wifi_list.extend(wlan.scan()), ())
`,t}},{id:"wifiitem",text:R("esp32.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[R("esp32.blocks.wifiItemSsid","ssid"),"SSID"],[R("esp32.blocks.wifiItemMac","mac"),"MAC"],[R("esp32.blocks.wifiItemRssi","rssi"),"RSSI"],[R("esp32.blocks.wifiItemSecurity","security"),"SECURITY"]]}},mpy(e){let t=this.getAdjusted(e,"INDEX")||0,s=e.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let i=`wifi_list[${t}]`;switch(s){case"MAC":i+="[1]";break;case"RSSI":i+="[3]";break;case"SECURITY":i+="[4]";break;default:i+="[0]";break}return[i,this.ORDER_ATOMIC]}},{id:"wificounts",text:R("esp32.blocks.wifiCounts","available wifi counts"),output:"number",mpy(e){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},"---",{id:"startap",text:R("esp32.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(e){let t=this.valueToCode(e,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let s="";return s+=`ap.config(ssid=${t})
`,s+=`ap.active(True)
`,s}},{id:"stopap",text:R("esp32.blocks.stopap","stop ap"),mpy(e){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:R("esp32.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(e){let t=this.valueToCode(e,"MESSAGE",this.ORDER_NONE),s=this.valueToCode(e,"MAC",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let i="";return i+=`async def espnow_asend(mac, msg):
`,i+=`${this.INDENT}mac_addr = bytes.fromhex(mac.replace(':', ''))
`,i+=`${this.INDENT}try:
`,i+=`${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,i+=`${this.INDENT}except OSError as err:
`,i+=`${this.INDENT}${this.INDENT}if len(err.args) > 1 and err.args[1] == 'ESP_ERR_ESPNOW_NOT_FOUND':
`,i+=`${this.INDENT}${this.INDENT}${this.INDENT}espnow.add_peer(mac_addr)
`,i+=`${this.INDENT}${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,this.definitions_.espnow_asend=i,`await espnow_asend(${s}, ${t})
`}},{id:"espnowbroadcast",text:R("esp32.blocks.espnowBroadcast","broadcast %1 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"}},mpy(e){let t=this.valueToCode(e,"MESSAGE",this.ORDER_NONE),s=this.valueToCode(e,"MAC",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let i="";return i+=`async def espnow_asend(mac, msg):
`,i+=`${this.INDENT}mac_addr = bytes.fromhex(mac.replace(':', ''))
`,i+=`${this.INDENT}try:
`,i+=`${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,i+=`${this.INDENT}except OSError as err:
`,i+=`${this.INDENT}${this.INDENT}if len(err.args) > 1 and err.args[1] == 'ESP_ERR_ESPNOW_NOT_FOUND':
`,i+=`${this.INDENT}${this.INDENT}${this.INDENT}espnow.add_peer(mac_addr)
`,i+=`${this.INDENT}${this.INDENT}${this.INDENT}await espnow.asend(mac_addr, msg.encode())
`,this.definitions_.espnow_asend=i,`await espnow_asend(${s}, 'ff:ff:ff:ff:ff:ff')
`}},{id:"espnowmsg",text:R("esp32.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[R("esp32.blocks.espnowMsgText","message"),"MESSAGE"],[R("esp32.blocks.espnowMsgMac","mac address"),"MAC"]]}},mpy(e){let t=e.getFieldValue("TYPE")||"MESSAGE";return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",[t==="MAC"?'peer.hex(":")':"msg.decode()",this.ORDER_FUNCTION_CALL]}},"---",{id:"espnowwhen",text:R("esp32.blocks.espnowWhen","when esp-now receive %1"),hat:!0,inputs:{MSG:{type:"string",defaultValue:R("esp32.blocks.espnowMsgText","message")}},mpy(e){let t=this.valueToCode(e,"MSG",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let s=`${this.getFunctionName(e.id)}_flag`;if(this.definitions_[s]=`${s} = asyncio.ThreadSafeFlag()`,!this.definitions_.espnowwhen){let o="";o+=`@_tasks__.append
`,o+=`async def espnow_when():
`,o+=`  async for peer, msg in espnow:
`,this.definitions_.espnowwhen=o}this.definitions_.espnowwhen+=`    if msg.decode() == ${t}: ${s}.set()
`;let i=this.statementToCode(e)||this.PASS,n="";return n+=`while True:
`,n+=`  await ${s}.wait()
`,n+=i,i=this.prefixLines(n,this.INDENT),i=this.addEventTrap(i,e.id),n=`@_tasks__.append
`,n+=i,n}},{id:"espnowrepeat",text:R("esp32.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(e){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let t=this.statementToCode(e,"SUBSTACK")||this.PASS;t=this.addLoopTrap(t,e.id);let s="";return s+=`async for peer, msg in espnow:
`,s+=t,s}}]});import{translate as Ot,themeColors as ie}from"@blockcode/core";var Se=()=>({id:"protocol",name:Ot("esp32.blocks.protocols","Protocols"),themeColor:ie.blocks.sounds.primary,inputColor:ie.blocks.sounds.secondary,otherColor:ie.blocks.sounds.tertiary,order:2,blocks:[]});import{translate as h,themeColors as oe}from"@blockcode/core";import{ScratchBlocks as m}from"@blockcode/blocks";var Ce=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:oe.blocks.operators.primary,inputColor:oe.blocks.operators.secondary,otherColor:oe.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||"+",n={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${t} ${i} ${s})`,n[i]]}},"---",{id:"random",text:m.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(e){this.definitions_.import_random="import random";let t=this.valueToCode(e,"FROM",this.ORDER_NONE),s=this.valueToCode(e,"TO",this.ORDER_NONE);return[`random.randint(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||">",n={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${t} ${i} ${s})`,n[i]]}},"---",{id:"and",text:m.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${t} and ${s})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:m.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${t} or ${s})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:m.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(e){return[`(not ${this.valueToCode(e,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||"&",n={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${t} ${i} ${s})`,n[i]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(e){return[`(~${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:h("esp32.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`max(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:h("esp32.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`min(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:m.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`(${t} % ${s})`,this.ORDER_MODULUS]}},{id:"round",text:m.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(e){return this.definitions_.import_math="import math",[`round(${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:m.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[m.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[m.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[m.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[m.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[m.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[m.Msg.OPERATORS_MATHOP_COS,"math.cos"],[m.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[m.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[m.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[m.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[m.Msg.OPERATORS_MATHOP_LN,"math.log"],[m.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[m.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[m.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(e){this.definitions_.import_math="import math";let t=e.getFieldValue("OPERATOR")||"abs",s=this.valueToCode(e,"NUM",this.ORDER_NONE),i="";if(t==="pow10")i+=`math.pow(10, ${s})`;else i+=`${t}(${s})`;return[i,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:h("esp32.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE),s=this.valueToCode(e,"FROM",this.ORDER_NONE),i=this.valueToCode(e,"TO",this.ORDER_NONE);return[`min(max(${t}, ${s}), ${i})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:h("esp32.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE),s=this.valueToCode(e,"FROMLOW",this.ORDER_NONE),i=this.valueToCode(e,"FROMHIGH",this.ORDER_NONE),n=this.valueToCode(e,"TOLOW",this.ORDER_NONE),o=this.valueToCode(e,"TOHIGHT",this.ORDER_NONE);return[`(${t} - ${s}) * (${o} - ${n}) // (${i} - ${s}) + ${n}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:h("esp32.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(e){return[`len(${this.valueToCode(e,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"join",text:m.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE),s=this.valueToCode(e,"STRING2",this.ORDER_NONE);return[`(${t} + ${s})`,this.ORDER_ADDITION]}},{id:"letter_of",text:m.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"esp32"}},mpy(e){let t=this.getAdjusted(e,"LETTER");return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}[${t}]`,this.ORDER_FUNCTION_CALL]}},{id:"replace",text:h("esp32.blocks.textReplace","replace %1 of %2 with %3"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"},STRING3:{type:"string",defaultValue:"The E"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE),s=this.valueToCode(e,"STRING2",this.ORDER_NONE),i=this.valueToCode(e,"STRING3",this.ORDER_NONE);return[`${s}.replace(${t}, ${i})
`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:h("esp32.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(e){let t=this.getAdjusted(e,"FROM"),s=this.valueToCode(e,"TO",this.ORDER_NONE);return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}[${t}:${s}]`,this.ORDER_FUNCTION_CALL]}},{id:"find",text:h("esp32.blocks.textFind","find %1 of %2 place"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(e,"STRING2",this.ORDER_NONE)}.find(${t}) + 1)
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:m.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"e"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(e,"STRING2",this.ORDER_NONE)} in ${t})`,this.ORDER_EQUALITY]}},{id:"with",text:h("esp32.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},WITH:{type:"string",menu:[[h("esp32.blocks.textStartsWith","starts"),"START"],[h("esp32.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE),s=this.valueToCode(e,"STRING2",this.ORDER_NONE),n=(e.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${t}.${n}(${s})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:h("esp32.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"ESP32"}},mpy(e){let t=this.valueToCode(e,"STRING1",this.ORDER_NONE),s=this.valueToCode(e,"STRING2",this.ORDER_NONE);return[`${t}.lower() == ${s}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:h("esp32.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[h("esp32.blocks.textLowerCase","lower"),"LOWER"],[h("esp32.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"ESP32"}},mpy(e){let t=e.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}.${t==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:h("esp32.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"}},mpy(e){return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:h("esp32.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[h("esp32.blocks.dataConvert.int","int"),"int"],[h("esp32.blocks.dataConvert.float","float"),"float"],[h("esp32.blocks.dataConvert.string","str"),"str"],[h("esp32.blocks.dataConvert.list","list"),"list"]]}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE);return[`${e.getFieldValue("TYPE")||"int"}(${t})`,this.ORDER_FUNCTION_CALL]}}]});var Ie=()=>({id:"data",skipXML:!0,blocks:[{id:"variable",mpy(e){return[this.getVariableName(e.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"setvariableto",mpy(e){let t=this.getVariableName(e.getFieldValue("VARIABLE")),s=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${t} = ${s}
`}},{id:"changevariableby",mpy(e){let t=this.getVariableName(e.getFieldValue("VARIABLE")),s=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${t} += ${s}
`}},{id:"listcontents",mpy(e){return[this.getVariableName(e.getFieldValue("LIST"))+"_ls",this.ORDER_ATOMIC]}},{id:"addtolist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${t}.append(${s})
`}},{id:"deleteoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX");return`${t}.pop(${s})
`}},{id:"deletealloflist",mpy(e){return`${this.getVariableName(e.getFieldValue("LIST"))+"_ls"} = []
`}},{id:"insertatlist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX"),i=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${t}.insert(${s}, ${i})
`}},{id:"replaceitemoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE),i=this.getAdjusted(e,"INDEX");return`${t}[${i}] = ${s}
`}},{id:"itemoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX");return[`${t}[${s}]`,this.ORDER_MEMBER]}},{id:"itemnumoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`${t}.index(${s})`,this.ORDER_FUNCTION_CALL]}},{id:"lengthoflist",mpy(e){return[`len(${this.getVariableName(e.getFieldValue("LIST"))+"_ls"})`,this.ORDER_FUNCTION_CALL]}},{id:"listcontainsitem",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`(${t}.count(${s}) > 0)`,this.ORDER_FUNCTION_CALL]}}]});import{translate as Ae,themeColors as De}from"@blockcode/core";var Pe=()=>({id:"terminal",name:Ae("esp32.blocks.terminal","Terminal"),themeColor:De.blocks.debug.primary,inputColor:De.blocks.debug.secondary,order:8,blocks:[{id:"print",text:Ae("esp32.blocks.terminalPrint","print %1"),inputs:{STRING:{type:"string",defaultValue:"hello"}},mpy(e){return`print(str(${this.valueToCode(e,"STRING",this.ORDER_NONE)}))
`}}]});import{themeColors as ne,translate as U}from"@blockcode/core";import{ScratchBlocks as Ys}from"@blockcode/blocks";var ye=()=>({id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:ne.blocks.sensing.primary,inputColor:ne.blocks.sensing.secondary,otherColor:ne.blocks.sensing.tertiary,blocks:[{id:"temperature",text:U("esp32.blocks.temperature","temperature"),output:"number",mpy(e){return this.definitions_.import_esp32="import esp32",["((esp32.raw_temperature() - 32) * 5 / 9)",this.ORDER_ATOMIC]}},"---",{id:"runtime",text:U("esp32.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[U("esp32.blocks.runtimeMilliseconds","milliseconds"),"MS"],[U("esp32.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(e){let t=e.getFieldValue("UNIT"),s="(time.ticks_ms() - _times__)";if(t==="SEC")s=`(${s} / 1000)`;return[s,this.ORDER_ATOMIC]}}]});import{MicroPythonGenerator as kt}from"@blockcode/blocks";var Tt=`# Generate by BlockCode
`;class W extends kt{finish(e){return Tt+super.finish(e)}}function Me(e){let t=ke(e),s=Te(),i=ve(e),n=_e(),o=Ne(),l=Se(),r=Ce(),a=Ie(),p=Pe(),c=ye();return[t,s,l,i,n,o,c,p,r,a]}import{Text as _}from"@blockcode/core";import{jsx as N}from"preact/jsx-runtime";var we=[{tag:"controller",label:N(_,{id:"esp32.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:N(_,{id:"esp32.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:N(_,{id:"esp32.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:N(_,{id:"esp32.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:N(_,{id:"esp32.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:N(_,{id:"esp32.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:N(_,{id:"esp32.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:N(_,{id:"esp32.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as At}from"preact/jsx-runtime";var Ct=(e)=>e.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),xe=new W,It=()=>["device","data","ai"];function $e(){let{tabIndex:e}=vt(),{meta:t}=_t(),s=Le(()=>{return Me(t.value.boardType,t.value.classicEvents)},[t.value.boardType,t.value.classicEvents]),i=Le((n,o,l,r)=>{Nt.prototype.onDefinitions.call(xe);for(let a in l)for(let p of l[a])if(!p.common){let c=Z(p.name,J(p.name));o(`import_${a}_${c}`,`from ${Ct(a)} import ${c}`)}},[]);return At(St,{enableCodePreview:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:e.value!==0,extensionTags:we,generator:xe,onBuildinExtensions:s,onDefinitions:i,onExtensionsFilter:It})}import{useAppContext as Pt}from"@blockcode/core";function re(e){let t=globalThis.document,s=t.createElement("style");s.appendChild(t.createTextNode(e)),t.head.append(s)}re("._1Ep-la_device-icon{width:20px;height:20px}._1Ep-la_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}._1Ep-la_check-icon._1Ep-la_checked{visibility:visible}._1Ep-la_blank-check-item>div{padding-left:calc(var(--space)/2 + 14px)}");var g={checkIcon:"_1Ep-la_check-icon",checked:"_1Ep-la_checked",blankCheckItem:"_1Ep-la_blank-check-item",deviceIcon:"_1Ep-la_device-icon"};var Ve="./assets/icon-device-40zreghe.png";import{jsx as yt}from"preact/jsx-runtime";function Be(){let{appState:e}=Pt();return yt("img",{className:g.deviceIcon,src:Ve})}import{useProjectContext as Mt,Text as G}from"@blockcode/core";import{jsx as H}from"preact/jsx-runtime";function Fe(){let{meta:e}=Mt();switch(e.value.boardType){case u.ESP32S3:return H(G,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"});case u.ESP32C3:return H(G,{id:"esp32.menubar.device.esp32c3",defaultMessage:"ESP32-C3"});case u.ESP32_IOT_BOARD:return H(G,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"ESP32 IOT Board"})}return H(G,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})}import{useCallback as M}from"preact/hooks";import{nanoid as es,classNames as V,sleepMs as ts}from"@blockcode/utils";import{useAppContext as ss,useProjectContext as is,setAlert as be,delAlert as os,setAppState as tt}from"@blockcode/core";import{MPYUtils as X}from"@blockcode/board";var z=[{usbVendorId:12346},{usbVendorId:6790}];import{Spinner as ns,Text as w,MenuSection as st,MenuItem as B}from"@blockcode/core";import{useEffect as Lt,useCallback as xt}from"preact/hooks";import{batch as Ue}from"@preact/signals";import{classNames as le}from"@blockcode/utils";import{useAppContext as $t,useProjectContext as Vt,setAppState as Bt,setMeta as We,Text as ae,MenuSection as Ft,MenuItem as pe}from"@blockcode/core";var Y="./assets/icon-check-5hn8sb1h.svg";import{jsx as I,jsxs as q,Fragment as Ut}from"preact/jsx-runtime";function Ge({disabled:e,itemClassName:t}){let{appState:s}=$t(),{meta:i}=Vt();Lt(()=>{if(!i.value.boardType)We("boardType",u.ESP32S3)},[]);let n=xt((o)=>()=>Ue(()=>{s.value?.currentDevice?.disconnect(),Ue(()=>{Bt("currentDevice",null),We({boardType:o})})}),[]);return I(Ut,{children:q(Ft,{disabled:e,children:[q(pe,{className:t,onClick:n(u.ESP32),children:[I("img",{className:le(g.checkIcon,{[g.checked]:i.value.boardType===u.ESP32}),src:Y}),I(ae,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})]}),q(pe,{className:t,onClick:n(u.ESP32S3),children:[I("img",{className:le(g.checkIcon,{[g.checked]:i.value.boardType===u.ESP32S3}),src:Y}),I(ae,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"})]}),q(pe,{className:t,onClick:n(u.ESP32_IOT_BOARD),children:[I("img",{className:le(g.checkIcon,{[g.checked]:i.value.boardType===u.ESP32_IOT_BOARD}),src:Y}),I(ae,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"ESP32 IOT Board"})]})]})})}import{useEffect as Ye,useMemo as qe,useCallback as Wt}from"preact/hooks";import{useSignal as Xe}from"@preact/signals";import{nanoid as Qe,classNames as Gt,sleep as Ht,Base64Utils as Ze,getBinaryCache as Je,setBinaryCache as zt}from"@blockcode/utils";import{useAppContext as Yt,useProjectContext as qt,setAlert as $,delAlert as Xt,setAppState as Kt}from"@blockcode/core";import{ESPTool as y}from"@blockcode/board";var Hi="0.1.5";var ze={iotboard:{download:"https://firmware.blockcode.fun/iotboard"}};import{Text as A,Spinner as ue,MenuSection as Qt,MenuItem as Zt}from"@blockcode/core";import{jsx as T}from"preact/jsx-runtime";var k=null,Jt=(e)=>{if(!k)k=Qe();if(e<100)$({id:k,icon:T(ue,{level:"success"}),message:T(A,{id:"esp32.menubar.device.restoring",defaultMessage:"Firmware restoring...{progress}%",progress:e})});else $({id:k,icon:T(ue,{level:"success"}),message:T(A,{id:"esp32.menubar.device.recovering",defaultMessage:"Recovering..."})})},ce=()=>{Xt(k),k=null},de=(e)=>{if(e==="NotFoundError")return;$("connectionError",1000)},je=async(e)=>{try{return await fetch(e,{method:"GET"})}catch(t){return await Ht(1),je(e)}},P=async(e,t,s,i,n)=>{if(n.value)return;let o=await Je(e);if(o?.hash===s&&o?.binaryString){n.value=!0,delete P.downloading;return}if(P.downloading)return;P.downloading=!0;let r=await(await je(t)).arrayBuffer();delete P.downloading;let a=await crypto.subtle.digest("SHA-256",r);if(Array.from(new Uint8Array(a)).map((c)=>c.toString(16).padStart(2,"0")).join("")!==s){P(e,t,s,i,n);return}await zt(e,{version:i,hash:s,binaryString:Ze.arrayBufferToBinaryString(r)}),n.value=!0},Ke=async(e,t)=>{if(!k)k=Qe();$({id:k,icon:T(ue,{level:"success"}),message:T(A,{id:"esp32.menubar.device.erasing",defaultMessage:"Erasing..."})});let s=y.check(e).catch(()=>{de(),ce(),y.disconnect(e)});try{await e.main(),await y.writeFlash(e,t,!0,(i)=>Jt(i)),$({id:k,icon:null,message:T(A,{id:"esp32.menubar.device.restoreDone",defaultMessage:"Firmware resotre completed! Now press RESET key"}),onClose:ce})}catch(i){de(i.name),ce()}await y.disconnect(e),s.cancel()},jt=async(e)=>{if(k)return;let t;try{t=await y.connect(z,460800)}catch(i){de(i.name)}if(!t)return;if(e){let i=await Je(e);if(i)Ke(t,[{data:i.binaryString,address:0}]);return}let s=document.createElement("input");s.type="file",s.accept=".bin",s.multiple=!1,s.click(),s.addEventListener("cancel",()=>y.disconnect(t)),s.addEventListener("change",async(i)=>{let n=new FileReader;n.readAsArrayBuffer(i.target.files[0]),n.addEventListener("load",(o)=>Ke(t,[{data:Ze.arrayBufferToBinaryString(o.target.result),address:0}]))})};function et({disabled:e,itemClassName:t}){let{appState:s}=Yt(),{meta:i}=qt(),n=Xe(!1),o=Xe(null),l=qe(()=>{if(i.value.boardType===u.ESP32_IOT_BOARD)return"iotboardFirmware"},[i.value.boardType]),r=qe(()=>{if(i.value.boardType===u.ESP32_IOT_BOARD)return T(A,{id:"esp32.menubar.device.iotboardFirmware",defaultMessage:"Restore IOT Board firmware (v{version})",version:o.value?.version})},[i.value.boardType,o.value?.version]);Ye(()=>k=null,[]),Ye(async()=>{if(!l)return;n.value=!1;let p=ze.iotboard.download;if(!o.value)o.value=await fetch(`${p}/version.json`).then((D)=>D.json());let c=`${p}/${o.value.download}`.replaceAll("{version}",o.value.version),d=o.value.hash;P(l,c,d,o.value.version,n)},[l]);let a=Wt(async()=>{Kt("currentDevice",null),await s.value?.currentDevice?.disconnect(),jt(l)},[l]);return T(Qt,{children:T(Zt,{disabled:e||k||r&&!n.value,className:Gt(t,g.blankCheckItem),onClick:a,children:r?n.value?r:T(A,{id:"esp32.menubar.device.caching",defaultMessage:"Caching latest firmware..."}):T(A,{id:"esp32.menubar.device.firmware",defaultMessage:"Restore MicroPython firmware"})})})}import{jsx as E,jsxs as me,Fragment as ot}from"preact/jsx-runtime";var O=null,Re=()=>{os(O),O=null},it=(e)=>{if(!O)O=es();if(e<100)be({id:O,icon:E(ns,{level:"success"}),message:E(w,{id:"gui.alert.downloadingProgress",defaultMessage:"Downloading...{progress}%",progress:e})});else be("downloadCompleted",{id:O}),setTimeout(Re,2000)},K=(e)=>{if(e==="NotFoundError")return;be("connectionError",1000)},rs=async(e,t,s)=>{let i=[].concat(t,s).map((n)=>({...n,filename:n.id}));it(0);try{await X.write(e,i,it),e.reset()}catch(n){K(n.name)}Re()};function nt({itemClassName:e}){let{appState:t}=ss(),{meta:s,file:i,assets:n}=is(),o=M(async(d)=>{await t.value?.currentDevice?.disconnect();let D=X.check(d).catch(()=>{K(),Re()});d.on("disconnect",()=>{D.cancel(),tt("currentDevice",null)}),await ts(500),tt("currentDevice",d)},[]),l=M(async()=>{if(O)return;try{let d=await X.connect(z,{baudRate:115200});o(d)}catch(d){K(d.name)}},[]),r=M(async()=>{if(O)return;try{let d=await X.connectBLE();o(d)}catch(d){K(d.name)}},[]),a=M(()=>{if(O)return;if(!t.value?.currentDevice)return;rs(t.value.currentDevice,i.value,n.value)},[]),p=M(()=>{if(O)return;t.value?.currentDevice?.reset()},[]),c=M(()=>{if(O)return;t.value?.currentDevice?.disconnect()});return me(ot,{children:[me(st,{disabled:O||!t.value?.currentDevice,children:[E(B,{className:V(e,g.blankCheckItem),label:E(w,{id:"esp32.menubar.device.download",defaultMessage:"Download program"}),onClick:a}),E(B,{className:V(e,g.blankCheckItem),label:E(w,{id:"esp32.menubar.device.reset",defaultMessage:"Reset device"}),onClick:p})]}),E(st,{disabled:O,children:t.value?.currentDevice?E(B,{className:V(e,g.blankCheckItem),label:E(w,{id:"esp32.menubar.device.disconnect",defaultMessage:"Disconnect device"}),onClick:c}):me(ot,{children:[E(B,{className:V(e,g.blankCheckItem),label:E(w,{id:"esp32.menubar.device.connectUsb",defaultMessage:"Connect device with USB"}),onClick:l}),s.value.boardType===u.ESP32_IOT_BOARD&&E(B,{className:V(e,g.blankCheckItem),label:E(w,{id:"esp32.menubar.device.connectBle",defaultMessage:"Connect device with Bluetooth (BLE)"}),onClick:r})]})}),E(Ge,{disabled:O,itemClassName:e}),E(et,{disabled:O,itemClassName:e})]})}var rt={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as lt}from"preact/jsx-runtime";var Co={onNew(){return rt},onSave(e,t,s){let i=[];return e=e.map((n)=>{return i.push(n.extensions),{id:n.id,type:n.type,xml:n.xml}}),{files:e,assets:t,meta:{extensions:Array.from(new Set(i.flat())),boardType:s.boardType??u.ESP32}}},async onThumb(){let e=F.getMainWorkspace();if(e){let t=e.getCanvas();if(t)return await ls(t,{})}},onUndo(e){if(e instanceof MouseEvent)F.getMainWorkspace()?.undo(!1)},onRedo(e){if(e instanceof MouseEvent)F.getMainWorkspace()?.undo(!0)},onEnableUndo(){let e=F.getMainWorkspace();return e?.undoStack_&&e.undoStack_.length!==0},onEnableRedo(){let e=F.getMainWorkspace();return e?.redoStack_&&e.redoStack_.length!==0},menuItems:[{icon:lt(Be,{}),label:lt(Fe,{}),Menu:nt}],tabs:[{...as,Content:$e},{...ps},{...cs}]};export{Co as default};
