import{addLocalesMessages as Is}from"@blockcode/core";var Ne={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.nulllab":"NULLLAB","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"ESP32S3 CAM","esp32.menubar.device.m5stack":"M5Stack","esp32.menubar.device.atomS3rCam":"AtomS3R CAM","esp32.menubar.device.micropythonFirmware":"Restore MicroPython firmware...","esp32.extension.tags.controllers":"Controllers","esp32.extension.tags.sensors":"Sensors","esp32.extension.tags.actuators":"Actuators","esp32.extension.tags.displays":"Displays","esp32.extension.tags.modules":"Modules","esp32.extension.tags.communication":"Communication","esp32.extension.tags.data":"Data","esp32.extension.tags.kits":"Kits","esp32.blocks.wait":"wait %1 milliseconds","esp32.blocks.break":"break","esp32.blocks.continue":"continue","esp32.blocks.elseif":"else if %1 then","esp32.blocks.else":"else","esp32.blocks.runtime":"run time %1","esp32.blocks.runtimeMilliseconds":"milliseconds","esp32.blocks.runtimeSeconds":"seconds","esp32.blocks.dataConvert":"convert %1 to %2","esp32.blocks.dataConvert.int":"int","esp32.blocks.dataConvert.float":"float","esp32.blocks.dataConvert.string":"str","esp32.blocks.dataConvert.list":"list","esp32.blocks.dataConvert.bytes":"bytes","esp32.blocks.dataLengthOf":"length of %1","esp32.blocks.dataConstrain":"constrain %1 between %2 to %3","esp32.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","esp32.blocks.whenstart":"when {name} start","esp32.blocks.timerset":"trigger timer #%1 per %2 milliseconds","esp32.blocks.timeroff":"stop timer #%1","esp32.blocks.operatorLarger":"larger of %1 and %2","esp32.blocks.operatorSmaller":"smaller of %1 and %2","esp32.blocks.pin":"Pins","esp32.blocks.setmode":"set pin %1 mode to %2","esp32.blocks.inputMode":"input","esp32.blocks.ouputMode":"output","esp32.blocks.inputPullUpMode":"input pull-up","esp32.blocks.inputPullDownMode":"input pull-down","esp32.blocks.setdigital":"set pin %1 to %2","esp32.blocks.digitalHigh":"high","esp32.blocks.digitalLow":"low","esp32.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","esp32.blocks.setpwm":"set pin %1 pwm to %2","esp32.blocks.setanalog":"set pin %1 analog to %2","esp32.blocks.isDigitalHigh":"pin %1 is high?","esp32.blocks.analogValue":"pin %1 analog value","esp32.blocks.attachinterrupt":"attach pin %1 interrupt to %2","esp32.blocks.interruptRising":"rising","esp32.blocks.interruptFalling":"falling","esp32.blocks.interruptChange":"change","esp32.blocks.interruptHigh":"high","esp32.blocks.interruptLow":"low","esp32.blocks.detachinterrupt":"detach pin %1 interrupt","esp32.blocks.network":"Network","esp32.blocks.protocols":"Protocols","esp32.blocks.serial":"Serial","esp32.blocks.serialBaudrate":"set baudrate to %1","esp32.blocks.serialTimeout":"set timeout to %1 milliseconds","esp32.blocks.serialPrint":"send %1 with %2","esp32.blocks.serialPrintWarp":"warp","esp32.blocks.serialPrintNoWarp":"no-warp","esp32.blocks.serialPrintHEX":"hex","esp32.blocks.serialAvailable":"available data?","esp32.blocks.serialAvailableLength":"available data length","esp32.blocks.serialReadString":"read a string","esp32.blocks.serialReadStringUntil":"read a string until %1","esp32.blocks.serialReadParse":"read a %1 number","esp32.blocks.serialReadParseInteger":"int","esp32.blocks.serialReadParseFloat":"float","esp32.blocks.serialRead":"read a byte","esp32.blocks.serialReadBytes":"read %1 bytes","esp32.blocks.text":"Text","esp32.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","esp32.blocks.textRemove":"remove letters from %1 to %2 of %3","esp32.blocks.textReplace":"replace %1 of %2 with %3","esp32.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","esp32.blocks.textSubstring":"substring of %1 from %2 to %3","esp32.blocks.textFind":"find %1 of %2 place","esp32.blocks.textWith":"%1 %2 with %3?","esp32.blocks.textStartsWith":"starts","esp32.blocks.textEndsWith":"ends","esp32.blocks.textCase":"get %1 of %2","esp32.blocks.textLowerCase":"lower-case","esp32.blocks.textUpperCase":"upper-case","esp32.blocks.textTrim":"remove %1 leading and trailing whitespace","esp32.blocks.textConvert":"convert %1 to %2","esp32.blocks.textConvertFrom":"convert %1 to String","esp32.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","esp32.blocks.disconnectWifi":"disconnect wi-fi","esp32.blocks.networkCofing":"local %1","esp32.blocks.networkCofingIp":"ip","esp32.blocks.networkCofingMac":"mac address","esp32.blocks.isWifiConnected":"wi-fi is connected?","esp32.blocks.wifiScan":"start scan wi-fi","esp32.blocks.wifiItem":"%2 of item %1 of available wi-fi","esp32.blocks.wifiItemSsid":"ssid","esp32.blocks.wifiItemRssi":"rssi","esp32.blocks.wifiItemSecurity":"security","esp32.blocks.wifiItemMac":"mac address","esp32.blocks.wifiCounts":"available wi-fi counts","esp32.blocks.startap":"start ap ssid: %1","esp32.blocks.stopap":"stop ap","esp32.blocks.espnowBroadcast":"broadcast %1 via esp-now","esp32.blocks.espnowSend":"send %1 to %2 via esp-now","esp32.blocks.espnowRecv":"wait for esp-now incoming","esp32.blocks.espnowMsg":"%1 of incoming","esp32.blocks.espnowMsgText":"text","esp32.blocks.espnowMsgBytes":"bytes","esp32.blocks.espnowMsgMac":"mac address","esp32.blocks.espnowRepeat":"repeat wait for esp-now incoming","esp32.blocks.espnowWhen":"when esp-now receive %1","esp32.blocks.spiInit":"initialize SPI %1 freq:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 write %2","esp32.blocks.spiRead":"SPI %1 read %2 bytes","esp32.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","esp32.blocks.i2cScan":"I2C scan devices","esp32.blocks.i2cWrite":"I2C write to %1:%2","esp32.blocks.i2cRead":"I2C read from %1 :%2 bytes","esp32.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","esp32.blocks.i2sPlay":"I2S play %1","esp32.blocks.terminal":"Terminal","esp32.blocks.terminalPrint":"print %1","esp32.blocks.temperature":"temperature","esp32.blocks.turnon":"on","esp32.blocks.turnoff":"off","esp32.blocks.camera":"Camera","esp32.blocks.cameraCapture":"capture","esp32.blocks.cameraFlashlamp":"flashlamp %1","esp32.blocks.cameraFlip":"flip %1","esp32.blocks.cameraMirror":"mirror %1","esp32.blocks.cameraEffect":"set effect to %1","esp32.blocks.cameraFramesize":"set framesize to %1","esp32.blocks.cameraFormat":"set picture format to %1","esp32.blocks.cameraQuality":"set picture quality to %1","esp32.blocks.cameraContrast":"set contrast to %1","esp32.blocks.cameraSaturation":"set saturation to %1","esp32.blocks.cameraBrightness":"set brightness to %1","esp32.blocks.cameraWhiteBalance":"set white balance to %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"Grayscale","esp32.blocks.cameraEffectNone":"none","esp32.blocks.cameraEffectNegative":"negative","esp32.blocks.cameraEffectGrayscale":"grayscale","esp32.blocks.cameraEffectSepia":"sepia","esp32.blocks.cameraEffectRed":"red","esp32.blocks.cameraEffectGreen":"green","esp32.blocks.cameraEffectBlue":"blue","esp32.blocks.cameraEffectAntique":"antique","esp32.blocks.cameraEffectSketch":"sketch","esp32.blocks.cameraEffectSolarize":"solarize","esp32.blocks.cameraEffectPosterize":"posterize","esp32.blocks.cameraEffectWhiteboard":"whiteboard","esp32.blocks.cameraEffectBlackboard":"blackboard","esp32.blocks.cameraEffectAqua":"aqua","esp32.blocks.cameraWBNone":"none","esp32.blocks.cameraWBSunny":"sunny","esp32.blocks.cameraWBCloudy":"cloudy","esp32.blocks.cameraWBOffice":"office","esp32.blocks.cameraWBHome":"home"};var Fe={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.nulllab":"NULLLAB","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"ESP32S3 CAM","esp32.menubar.device.m5stack":"M5Stack","esp32.menubar.device.atomS3rCam":"AtomS3R CAM","esp32.menubar.device.micropythonFirmware":"恢复 MicroPython 固件…","esp32.extension.tags.controllers":"输入模块","esp32.extension.tags.sensors":"传感器","esp32.extension.tags.actuators":"执行器","esp32.extension.tags.displays":"显示模块","esp32.extension.tags.modules":"智能模块","esp32.extension.tags.communication":"通讯","esp32.extension.tags.data":"数据","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重复执行","esp32.blocks.continue":"跳到下一次执行","esp32.blocks.elseif":"否则，如果 %1 那么","esp32.blocks.else":"否则","esp32.blocks.runtime":"运行时长 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"将 %1 转为 %2","esp32.blocks.dataConvert.int":"整数","esp32.blocks.dataConvert.float":"浮点数","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataConvert.bytes":"字节数组","esp32.blocks.dataLengthOf":"%1 长度","esp32.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","esp32.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"当 {name} 启动时","esp32.blocks.timerset":"定时器 #%1 每间隔 %2 毫秒执行","esp32.blocks.timeroff":"关闭定时器 #%1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引脚","esp32.blocks.setmode":"将引脚 %1 设为 %2 模式","esp32.blocks.inputMode":"输入","esp32.blocks.ouputMode":"输出","esp32.blocks.inputPullUpMode":"上拉输入","esp32.blocks.inputPullDownMode":"下拉输入","esp32.blocks.setdigital":"将引脚 %1 设为 %2","esp32.blocks.digitalHigh":"高电平","esp32.blocks.digitalLow":"低电平","esp32.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","esp32.blocks.setpwm":"将引脚 %1 PWM 设为 %2","esp32.blocks.setanalog":"将引脚 %1 模拟值设为 %2","esp32.blocks.isDigitalHigh":"引脚 %1 是高电平？","esp32.blocks.analogValue":"引脚 %1 模拟值","esp32.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","esp32.blocks.interruptRising":"电平上升","esp32.blocks.interruptFalling":"电平下降","esp32.blocks.interruptChange":"电平改变","esp32.blocks.interruptHigh":"高电平","esp32.blocks.interruptLow":"低电平","esp32.blocks.detachinterrupt":"取消引脚 %1 中断","esp32.blocks.network":"网络","esp32.blocks.protocols":"协议","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"将波特率设为 %1","esp32.blocks.serialTimeout":"将通讯超时设为 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式发送 %1","esp32.blocks.serialPrintWarp":"换行","esp32.blocks.serialPrintNoWarp":"不换行","esp32.blocks.serialPrintHEX":"16进制","esp32.blocks.serialAvailable":"存在可读取数据?","esp32.blocks.serialAvailableLength":"可读取数据长度","esp32.blocks.serialReadString":"读取文本","esp32.blocks.serialReadStringUntil":"读取文本直到 %1","esp32.blocks.serialReadParse":"读取 %1","esp32.blocks.serialReadParseInteger":"整数","esp32.blocks.serialReadParseFloat":"浮点数","esp32.blocks.serialRead":"读取 1 个字节","esp32.blocks.serialReadBytes":"读取 %1 个字节","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","esp32.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","esp32.blocks.textReplace":"将 %2 中的 %1 替换为 %3","esp32.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","esp32.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"开始于","esp32.blocks.textEndsWith":"结束于","esp32.blocks.textCase":"将 %2 字母转为 %1","esp32.blocks.textLowerCase":"小写","esp32.blocks.textUpperCase":"大写","esp32.blocks.textTrim":"清除 %1 前后空白字符","esp32.blocks.textConvert":"将 %1 转为 %2","esp32.blocks.textConvertFrom":"将 %1 转为文本","esp32.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","esp32.blocks.disconnectWifi":"断开 Wi-Fi 网络","esp32.blocks.networkCofing":"本地 %1","esp32.blocks.networkCofingIp":"IP","esp32.blocks.networkCofingMac":"MAC 地址","esp32.blocks.isWifiConnected":"Wi-Fi 网络已连接？","esp32.blocks.wifiScan":"开始扫描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密类型","esp32.blocks.wifiItemMac":"MAC 地址","esp32.blocks.wifiCounts":"可用 Wi-Fi 数量","esp32.blocks.startap":"开启热点 SSID: %1","esp32.blocks.stopap":"关闭热点","esp32.blocks.espnowBroadcast":"ESP-Now 广播 %1","esp32.blocks.espnowSend":"ESP-Now 发送 %1 给 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"文本","esp32.blocks.espnowMsgBytes":"字节数组","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"当 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 频率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 写入 %2","esp32.blocks.spiRead":"SPI %1 读取 %2 字节","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","esp32.blocks.i2cScan":"I2C扫描设备","esp32.blocks.i2cWrite":"I2C写入到 %1:%2","esp32.blocks.i2cRead":"I2C从 %1 读取 %2 字节","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"终端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度","esp32.blocks.turnon":"开启","esp32.blocks.turnoff":"关闭","esp32.blocks.camera":"摄像头","esp32.blocks.cameraCapture":"拍摄","esp32.blocks.cameraFlashlamp":"闪光灯 %1","esp32.blocks.cameraFlip":"上下翻转 %1","esp32.blocks.cameraMirror":"左右镜像 %1","esp32.blocks.cameraEffect":"将特效设为 %1","esp32.blocks.cameraFramesize":"将分辨率设为 %1","esp32.blocks.cameraFormat":"将图片格式设为 %1","esp32.blocks.cameraQuality":"将图片质量设为 %1","esp32.blocks.cameraContrast":"将对比度设为 %1","esp32.blocks.cameraSaturation":"将饱和度设为 %1","esp32.blocks.cameraBrightness":"将亮度设为 %1","esp32.blocks.cameraWhiteBalance":"将白平衡设为 %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"灰度","esp32.blocks.cameraEffectNone":"原图","esp32.blocks.cameraEffectNegative":"负片","esp32.blocks.cameraEffectGrayscale":"灰度","esp32.blocks.cameraEffectSepia":"棕褐色","esp32.blocks.cameraEffectRed":"红色","esp32.blocks.cameraEffectGreen":"绿色","esp32.blocks.cameraEffectBlue":"蓝色","esp32.blocks.cameraEffectAntique":"复古","esp32.blocks.cameraEffectSketch":"素描","esp32.blocks.cameraEffectSolarize":"日光","esp32.blocks.cameraEffectPosterize":"海报","esp32.blocks.cameraEffectWhiteboard":"白板","esp32.blocks.cameraEffectBlackboard":"黑板","esp32.blocks.cameraEffectAqua":"水晶","esp32.blocks.cameraWBNone":"原始","esp32.blocks.cameraWBSunny":"晴天","esp32.blocks.cameraWBCloudy":"阴天","esp32.blocks.cameraWBOffice":"办公室","esp32.blocks.cameraWBHome":"家中"};var Ie={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.nulllab":"NULLLAB","esp32.menubar.device.esp32IotBoard":"ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"ESP32S3 CAM","esp32.menubar.device.m5stack":"M5Stack","esp32.menubar.device.atomS3rCam":"AtomS3R CAM","esp32.menubar.device.micropythonFirmware":"還原 MicroPython 固件…","esp32.extension.tags.controllers":"輸入模組","esp32.extension.tags.sensors":"傳感器","esp32.extension.tags.actuators":"執行器","esp32.extension.tags.displays":"顯示模組","esp32.extension.tags.modules":"智能模組","esp32.extension.tags.communication":"通訊","esp32.extension.tags.data":"數據","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重複","esp32.blocks.continue":"跳到下一次","esp32.blocks.elseif":"否則，如果 %1 那麼","esp32.blocks.else":"否則","esp32.blocks.runtime":"運行時長 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"將 %1 轉為 %2","esp32.blocks.dataConvert.int":"整數","esp32.blocks.dataConvert.float":"浮點數","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataConvert.bytes":"字節數組","esp32.blocks.dataLengthOf":"%1 長度","esp32.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","esp32.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"當 {name} 開始","esp32.blocks.timerset":"定時器 #%1 每間隔 %2 毫秒執行","esp32.blocks.timeroff":"關閉定時器 #%1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引腳","esp32.blocks.setmode":"將引腳 %1 設為 %2 模式","esp32.blocks.inputMode":"輸入","esp32.blocks.ouputMode":"輸出","esp32.blocks.inputPullUpMode":"上拉輸入","esp32.blocks.inputPullDownMode":"下拉輸入","esp32.blocks.setdigital":"將引腳 %1 設為 %2","esp32.blocks.digitalHigh":"高電平","esp32.blocks.digitalLow":"低電平","esp32.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","esp32.blocks.setpwm":"將引腳 %1 PWM 設為 %2","esp32.blocks.setanalog":"將引腳 %1 模擬值設為 %2","esp32.blocks.isDigitalHigh":"引腳 %1 是高電平？","esp32.blocks.analogValue":"引腳 %1 模擬值","esp32.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","esp32.blocks.interruptRising":"電平上升","esp32.blocks.interruptFalling":"電平下降","esp32.blocks.interruptChange":"電平改變","esp32.blocks.interruptHigh":"高電平","esp32.blocks.interruptLow":"低電平","esp32.blocks.detachinterrupt":"取消引腳 %1 中斷","esp32.blocks.network":"網絡","esp32.blocks.protocols":"協議","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"將波特率設為 %1","esp32.blocks.serialTimeout":"將通訊超時設為 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式打印 %1","esp32.blocks.serialPrintWarp":"換行","esp32.blocks.serialPrintNoWarp":"不換行","esp32.blocks.serialPrintHEX":"16進制","esp32.blocks.serialAvailable":"存在可讀取數據?","esp32.blocks.serialAvailableLength":"可讀取數據長度","esp32.blocks.serialReadString":"讀取文本","esp32.blocks.serialReadStringUntil":"讀取文本直到 %1","esp32.blocks.serialReadParse":"讀取 %1","esp32.blocks.serialReadParseInteger":"整數","esp32.blocks.serialReadParseFloat":"浮點數","esp32.blocks.serialRead":"讀取 1 個字節","esp32.blocks.serialReadBytes":"讀取 %1 個字節","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","esp32.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","esp32.blocks.textReplace":"將 %2 中的 %1 替換為 %3","esp32.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","esp32.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"開始於","esp32.blocks.textEndsWith":"結束於","esp32.blocks.textCase":"將 %2 字母轉為 %1","esp32.blocks.textLowerCase":"小寫","esp32.blocks.textUpperCase":"大寫","esp32.blocks.textTrim":"清除 %1 前後空白字符","esp32.blocks.textConvert":"將 %1 轉為 %2","esp32.blocks.textConvertFrom":"將 %1 轉為文本","esp32.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","esp32.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","esp32.blocks.networkCofing":"本地 %1","esp32.blocks.networkCofingIp":"IP","esp32.blocks.networkCofingMac":"MAC 地址","esp32.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","esp32.blocks.wifiScan":"開始掃描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密類型","esp32.blocks.wifiItemMac":"MAC 地址","esp32.blocks.wifiCounts":"可用 Wi-Fi 數量","esp32.blocks.startap":"開啟 AP SSID: %1","esp32.blocks.stopap":"關閉 AP","esp32.blocks.espnowBroadcast":"ESP-Now 廣播 %1","esp32.blocks.espnowSend":"ESP-Now 發送 %1 給 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"文本","esp32.blocks.espnowMsgBytes":"字節數組","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"當 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 寫入 %2","esp32.blocks.spiRead":"SPI %1 讀取 %2 位元組","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","esp32.blocks.i2cScan":"I2C掃描設備","esp32.blocks.i2cWrite":"I2C寫入到 %1:%2","esp32.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"終端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度","esp32.blocks.turnon":"開啟","esp32.blocks.turnoff":"關閉","esp32.blocks.camera":"攝像頭","esp32.blocks.cameraCapture":"拍攝","esp32.blocks.cameraFlashlamp":"閃光燈 %1","esp32.blocks.cameraFlip":"上下翻轉 %1","esp32.blocks.cameraMirror":"左右鏡像 %1","esp32.blocks.cameraEffect":"將特效設為 %1","esp32.blocks.cameraFramesize":"將分辨率設為 %1","esp32.blocks.cameraFormat":"將圖片格式設為 %1","esp32.blocks.cameraQuality":"將圖片質量設為 %1","esp32.blocks.cameraContrast":"將對比度設為 %1","esp32.blocks.cameraSaturation":"將飽和度設為 %1","esp32.blocks.cameraBrightness":"將亮度設為 %1","esp32.blocks.cameraWhiteBalance":"將白平衡設為 %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"灰度","esp32.blocks.cameraEffectNone":"原圖","esp32.blocks.cameraEffectNegative":"負片","esp32.blocks.cameraEffectGrayscale":"灰度","esp32.blocks.cameraEffectSepia":"棕褐色","esp32.blocks.cameraEffectRed":"紅色","esp32.blocks.cameraEffectGreen":"綠色","esp32.blocks.cameraEffectBlue":"藍色","esp32.blocks.cameraEffectAntique":"復古","esp32.blocks.cameraEffectSketch":"素描","esp32.blocks.cameraEffectSolarize":"日光","esp32.blocks.cameraEffectPosterize":"海報","esp32.blocks.cameraEffectWhiteboard":"白板","esp32.blocks.cameraEffectBlackboard":"黑板","esp32.blocks.cameraEffectAqua":"水晶","esp32.blocks.cameraWBNone":"原始","esp32.blocks.cameraWBSunny":"晴天","esp32.blocks.cameraWBCloudy":"陰天","esp32.blocks.cameraWBOffice":"辦公室","esp32.blocks.cameraWBHome":"家中"};Is({en:Ne,"zh-Hans":Fe,"zh-Hant":Ie});import{svgAsDataUri as Yt}from"@blockcode/utils";import{ScratchBlocks as U,blocksTab as qt,codeReviewTab as Kt}from"@blockcode/blocks";import{terminalTab as Zt}from"@blockcode/code";function _(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function De(e,t){var s="",o=0,i=-1,a=0,r;for(var c=0;c<=e.length;++c){if(c<e.length)r=e.charCodeAt(c);else if(r===47)break;else r=47;if(r===47){if(i===c-1||a===1);else if(i!==c-1&&a===2){if(s.length<2||o!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var l=s.lastIndexOf("/");if(l!==s.length-1){if(l===-1)s="",o=0;else s=s.slice(0,l),o=s.length-1-s.lastIndexOf("/");i=c,a=0;continue}}else if(s.length===2||s.length===1){s="",o=0,i=c,a=0;continue}}if(t){if(s.length>0)s+="/..";else s="..";o=2}}else{if(s.length>0)s+="/"+e.slice(i+1,c);else s=e.slice(i+1,c);o=c-i-1}i=c,a=0}else if(r===46&&a!==-1)++a;else a=-1}return s}function Ds(e,t){var s=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");if(!s)return o;if(s===t.root)return s+o;return s+e+o}function te(){var e="",t=!1,s;for(var o=arguments.length-1;o>=-1&&!t;o--){var i;if(o>=0)i=arguments[o];else{if(s===void 0)s=process.cwd();i=s}if(_(i),i.length===0)continue;e=i+"/"+e,t=i.charCodeAt(0)===47}if(e=De(e,!t),t)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function Me(e){if(_(e),e.length===0)return".";var t=e.charCodeAt(0)===47,s=e.charCodeAt(e.length-1)===47;if(e=De(e,!t),e.length===0&&!t)e=".";if(e.length>0&&s)e+="/";if(t)return"/"+e;return e}function Ms(e){return _(e),e.length>0&&e.charCodeAt(0)===47}function ys(){if(arguments.length===0)return".";var e;for(var t=0;t<arguments.length;++t){var s=arguments[t];if(_(s),s.length>0)if(e===void 0)e=s;else e+="/"+s}if(e===void 0)return".";return Me(e)}function Ps(e,t){if(_(e),_(t),e===t)return"";if(e=te(e),t=te(t),e===t)return"";var s=1;for(;s<e.length;++s)if(e.charCodeAt(s)!==47)break;var o=e.length,i=o-s,a=1;for(;a<t.length;++a)if(t.charCodeAt(a)!==47)break;var r=t.length,c=r-a,l=i<c?i:c,m=-1,u=0;for(;u<=l;++u){if(u===l){if(c>l){if(t.charCodeAt(a+u)===47)return t.slice(a+u+1);else if(u===0)return t.slice(a+u)}else if(i>l){if(e.charCodeAt(s+u)===47)m=u;else if(u===0)m=0}break}var O=e.charCodeAt(s+u),N=t.charCodeAt(a+u);if(O!==N)break;else if(O===47)m=u}var b="";for(u=s+m+1;u<=o;++u)if(u===o||e.charCodeAt(u)===47)if(b.length===0)b+="..";else b+="/..";if(b.length>0)return b+t.slice(a+m);else{if(a+=m,t.charCodeAt(a)===47)++a;return t.slice(a)}}function Gs(e){return e}function ws(e){if(_(e),e.length===0)return".";var t=e.charCodeAt(0),s=t===47,o=-1,i=!0;for(var a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!i){o=a;break}}else i=!1;if(o===-1)return s?"/":".";if(s&&o===1)return"//";return e.slice(0,o)}function oe(e,t){if(t!==void 0&&typeof t!=="string")throw TypeError('"ext" argument must be a string');_(e);var s=0,o=-1,i=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var r=t.length-1,c=-1;for(a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){s=a+1;break}}else{if(c===-1)i=!1,c=a+1;if(r>=0)if(l===t.charCodeAt(r)){if(--r===-1)o=a}else r=-1,o=c}}if(s===o)o=c;else if(o===-1)o=e.length;return e.slice(s,o)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!i){s=a+1;break}}else if(o===-1)i=!1,o=a+1;if(o===-1)return"";return e.slice(s,o)}}function ie(e){_(e);var t=-1,s=0,o=-1,i=!0,a=0;for(var r=e.length-1;r>=0;--r){var c=e.charCodeAt(r);if(c===47){if(!i){s=r+1;break}continue}if(o===-1)i=!1,o=r+1;if(c===46){if(t===-1)t=r;else if(a!==1)a=1}else if(t!==-1)a=-1}if(t===-1||o===-1||a===0||a===1&&t===o-1&&t===s+1)return"";return e.slice(t,o)}function Vs(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Ds("/",e)}function Ls(e){_(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var s=e.charCodeAt(0),o=s===47,i;if(o)t.root="/",i=1;else i=0;var a=-1,r=0,c=-1,l=!0,m=e.length-1,u=0;for(;m>=i;--m){if(s=e.charCodeAt(m),s===47){if(!l){r=m+1;break}continue}if(c===-1)l=!1,c=m+1;if(s===46){if(a===-1)a=m;else if(u!==1)u=1}else if(a!==-1)u=-1}if(a===-1||c===-1||u===0||u===1&&a===c-1&&a===r+1){if(c!==-1)if(r===0&&o)t.base=t.name=e.slice(1,c);else t.base=t.name=e.slice(r,c)}else{if(r===0&&o)t.name=e.slice(1,a),t.base=e.slice(1,c);else t.name=e.slice(r,a),t.base=e.slice(r,c);t.ext=e.slice(a,c)}if(r>0)t.dir=e.slice(0,r-1);else if(o)t.dir="/";return t}var xs="/",zs=":",ao=((e)=>(e.posix=e,e))({resolve:te,normalize:Me,isAbsolute:Ms,join:ys,relative:Ps,_makeLong:Gs,dirname:ws,basename:oe,extname:ie,format:Vs,parse:Ls,sep:xs,delimiter:zs,win32:null,posix:null});import{useCallback as qe,useEffect as st}from"preact/hooks";import{useAppContext as tt,useProjectContext as ot,setMeta as it}from"@blockcode/core";import{MicroPythonGenerator as at,BlocksEditor as rt}from"@blockcode/blocks";import{translate as k,themeColors as ae}from"@blockcode/core";import{keyMirror as Bs}from"@blockcode/utils";var p=Bs({ESP32:null,ESP32S2:null,ESP32S3:null,ESP32C3:null,ESP32C5:null,ESP32C6:null,ESP32_IOT_BOARD:null,ESP32S3_CAM:null,ATOMS3R_CAM:null});var ye=(e)=>[p.ESP32,p.ESP32_IOT_BOARD].includes(e),$s=(e)=>e===p.ESP32S3_CAM,Ws=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23","25","26","27","32","33","34","35","36","39"],Hs=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23","25","26","27","32","33"],Us=["0","2","4","12","13","14","15","25","26","27","32","33","34","35","36","37","38","39"],Qs=["25","26"],Xs=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","35","36","37","38","39","40","41","42","43","44","45","46","47","48"],Ys=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],qs=["0","1","2","14","41","42","43","44","46","47","48"],Ks=["1","2","14"],re=(e)=>{let t=Xs,s=Ys,o=t,i;if(ye(e))t=Ws,s=Us,i=Qs,o=Hs;if($s(e))t=qs,s=Ks;return{all:t,out:o,adc:s,dac:i,pwm:o,in:t}},Pe=(e)=>{let t=re(e);return{id:"pin",name:k("esp32.blocks.pin","Pins"),themeColor:ae.blocks.motion.primary,inputColor:ae.blocks.motion.secondary,otherColor:ae.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:k("esp32.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:t.all},MODE:{menu:[[k("esp32.blocks.ouputMode","output"),"OUTPUT"],[k("esp32.blocks.inputMode","input"),"INPUT"],[k("esp32.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[k("esp32.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=s.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let r="";if(a==="INPUT")r=`${i} = Pin(${o}, Pin.IN)`;else if(a==="INPUT_PULLUP")r=`${i} = Pin(${o}, Pin.IN, Pin.PULL_UP)`;else if(a==="INPUT_PULLDOWN")r=`${i} = Pin(${o}, Pin.IN, Pin.PULL_DOWN)`;else r=`${i} = Pin(${o}, Pin.OUT)`;return this.definitions_[i]=r,""}},"---",{id:"setdigital",text:k("esp32.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:t.all},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[k("esp32.blocks.digitalHigh","high"),"1"],[k("esp32.blocks.digitalLow","low"),"0"]]}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=this.valueToCode(s,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[i]=this.definitions_[i]??`${i} = Pin(${o}, Pin.OUT)`,`${i}.value(${a})
`}},{id:"setDAC",hidden:!ye(e),text:k("esp32.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:t.dac},VALUE:{shadow:"slider255"}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=this.valueToCode(s,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[i]=`${i} = DAC(Pin(${o}))`,`${i}.write(${a})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(s){return[s.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},{id:"digital",text:k("esp32.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:t.all}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[i]=`${i} = Pin(${o}, Pin.IN)`,[`(${i}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:k("esp32.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:t.adc}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[i]=`${i} = ADC(Pin(${o}))`,this.definitions_[`${i}_atten`]=`${i}.atten(ADC.ATTN_11DB)`,this.definitions_[`${i}_width`]=`${i}.width(ADC.WIDTH_10BIT)`,[`${i}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:k("esp32.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:t.pwm},FREQ:{type:"integer",defaultValue:"1000"}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=this.valueToCode(s,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[i]=`${i} = PWM(Pin(${o}), freq=1000)`,`${i}.freq(${a})
`}},{id:"setPWM",text:k("esp32.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:t.pwm},VALUE:{shadow:"slider1023"}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=this.valueToCode(s,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[i]=`${i} = PWM(Pin(${o}), freq=1000)`,`${i}.duty(${a})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(s){return[s.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:k("esp32.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:t.all},INTERRUPT:{menu:[[k("esp32.blocks.interruptRising","rising"),"RISING"],[k("esp32.blocks.interruptFalling","falling"),"FALLING"],[k("esp32.blocks.interruptChange","change"),"CHANGE"],[k("esp32.blocks.interruptHigh","high"),"HIGH"],[k("esp32.blocks.interruptLow","low"),"LOW"]]}},mpy(s){let o=s.getFieldValue("PIN")||0,i=`pin_${o}`,a=this.createName("event_flag"),r=s.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[i]=this.definitions_[i]??`${i} = Pin(${o}, Pin.IN)`,this.definitions_[a]=`${a} = asyncio.ThreadSafeFlag()`;let c=this.statementToCode(s,"SUBSTACK")||this.PASS,l="";l+=`while True:
`,l+=`${this.INDENT}await ${a}.wait()
`,l+=c,c=this.prefixLines(l,this.INDENT),c=this.addEventTrap(c,"pin_irq"),l=`@_tasks__.append
`,l+=c,this.definitions_[`${a}_callback`]=l;let u={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[r]||"Pin.IRQ_RISING";return`${i}.irq(trigger=${u}, handler=lambda _: ${a}.set())
`}},{id:"detachinterrupt",text:k("esp32.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:t.all}},mpy(s){return`pin_${s.getFieldValue("PIN")||0}.irq(handler=None)
`}}]}};import{translate as n,themeColors as ce}from"@blockcode/core";var Ge=(e,t)=>({id:"camera",name:n("esp32.blocks.camera","Camera"),themeColor:ce.blocks.looks.primary,inputColor:ce.blocks.looks.secondary,otherColor:ce.blocks.looks.tertiary,order:t,blocks:[{id:"capture",text:n("esp32.blocks.cameraCapture","capture"),output:"raw",mpy(s){return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",["camera.capture()",this.ORDER_FUNCTION_CALL]}},"---",e===p.ESP32S3_CAM&&{id:"flashlamp",text:n("esp32.blocks.cameraFlashlamp","flashlamp %1"),inputs:{STATUS:{menu:"Status"}},mpy(s){let o=this.valueToCode(s,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.flashlamp(${o})
`}},{id:"effect",text:n("esp32.blocks.cameraEffect","set effect to %1"),inputs:{EFFECT:{menu:"Effect"}},mpy(s){let o=s.getFieldValue("EFFECT")||"EFFECT_NONE";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.speffect(camera.${o})
`}},{id:"flip",text:n("esp32.blocks.cameraFlip","flip %1"),inputs:{STATUS:{menu:"Status"}},mpy(s){let o=this.valueToCode(s,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.flip(${o})
`}},{id:"mirror",text:n("esp32.blocks.cameraMirror","mirror %1"),inputs:{STATUS:{menu:"Status"}},mpy(s){let o=this.valueToCode(s,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.mirror(${o})
`}},"---",{id:"framesize",text:n("esp32.blocks.cameraFramesize","set framesize to %1"),inputs:{FRAMESIZE:{menu:"Framesize"}},mpy(s){let o=s.getFieldValue("FRAMESIZE")||"FRAME_VGA";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.framesize(camera.${o})
`}},{id:"format",text:n("esp32.blocks.cameraFormat","set picture format to %1"),inputs:{FORMAT:{menu:"Format"}},mpy(s){let o=s.getFieldValue("FORMAT")||"JPEG";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=`camera.init(format=camera.${o})`,""}},{id:"quality",text:n("esp32.blocks.cameraQuality","set picture quality to %1"),inputs:{RANGE:{shadow:"rangeQuality"}},mpy(s){let o=this.valueToCode(s,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.quality(${o})
`}},{id:"contrast",text:n("esp32.blocks.cameraContrast","set contrast to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(s){let o=this.valueToCode(s,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.contrast(${o})
`}},{id:"saturation",text:n("esp32.blocks.cameraSaturation","set saturation to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(s){let o=this.valueToCode(s,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.saturation(${o})
`}},{id:"brightness",text:n("esp32.blocks.cameraBrightness","set brightness to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(s){let o=this.valueToCode(s,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.brightness(${o})
`}},{id:"whitebalance",text:n("esp32.blocks.cameraWhiteBalance","set white balance to %1"),inputs:{WB:{menu:"WhiteBalance"}},mpy(s){let o=s.getFieldValue("WB")||"WB_NONE";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.whitebalance(camera.${o})
`}},{id:"range22",shadow:!0,output:"number",inputs:{RANGE:{type:"slider",defaultValue:0,min:-2,max:2}},mpy(s){return[s.getFieldValue("RANGE")||0,this.ORDER_NONE]}},{id:"rangeQuality",shadow:!0,output:"number",inputs:{RANGE:{type:"slider",defaultValue:12,min:0,max:63}},mpy(s){return[s.getFieldValue("RANGE")||12,this.ORDER_NONE]}}].filter(Boolean),menus:{Status:{inputMode:!0,defaultValue:"1",type:"integer",items:[[n("esp32.blocks.turnon","on"),"1"],[n("esp32.blocks.turnoff","off"),"0"]]},Effect:{items:[[n("esp32.blocks.cameraEffectNone","none"),"EFFECT_NONE"],[n("esp32.blocks.cameraEffectNegative","negative"),"EFFECT_NEGATIVE"],[n("esp32.blocks.cameraEffectGrayscale","grayscale"),"EFFECT_GRAYSCALE"],[n("esp32.blocks.cameraEffectSepia","sepia"),"EFFECT_SEPIA"],[n("esp32.blocks.cameraEffectRed","red"),"EFFECT_RED"],[n("esp32.blocks.cameraEffectGreen","green"),"EFFECT_GREEN"],[n("esp32.blocks.cameraEffectBlue","blue"),"EFFECT_BLUE"],[n("esp32.blocks.cameraEffectAntique","antique"),"EFFECT_ANTIQUE"],[n("esp32.blocks.cameraEffectSketch","sketch"),"EFFECT_SKETCH"],[n("esp32.blocks.cameraEffectSolarize","solarize"),"EFFECT_SOLARIZE"],[n("esp32.blocks.cameraEffectPosterize","posterize"),"EFFECT_POSTERIZE"],[n("esp32.blocks.cameraEffectWhiteboard","whiteboard"),"EFFECT_WHITEBOARD"],[n("esp32.blocks.cameraEffectBlackboard","blackboard"),"EFFECT_BLACKBOARD"],[n("esp32.blocks.cameraEffectAqua","aqua"),"EFFECT_AQUA"]]},Framesize:{items:[[n("esp32.blocks.cameraFramesize96X96","96×96"),"FRAME_96X96"],[n("esp32.blocks.cameraFramesizeQQVGA","160×120"),"FRAME_QQVGA"],[n("esp32.blocks.cameraFramesizeQCIF","176×144"),"FRAME_QCIF"],[n("esp32.blocks.cameraFramesizeHQVGA","240×160"),"FRAME_HQVGA"],[n("esp32.blocks.cameraFramesize240X240","240×240"),"FRAME_240X240"],[n("esp32.blocks.cameraFramesizeQVGA","320×240"),"FRAME_QVGA"],[n("esp32.blocks.cameraFramesizeCIF","352×288"),"FRAME_CIF"],[n("esp32.blocks.cameraFramesizeHVGA","480×320"),"FRAME_HVGA"],[n("esp32.blocks.cameraFramesizeVGA","640×480"),"FRAME_VGA"],[n("esp32.blocks.cameraFramesizeSVGA","800×600"),"FRAME_SVGA"],[n("esp32.blocks.cameraFramesizeXGA","1024×768"),"FRAME_XGA"],[n("esp32.blocks.cameraFramesizeHD","1280×720"),"FRAME_HD"],[n("esp32.blocks.cameraFramesizeSXGA","1280×1024"),"FRAME_SXGA"],[n("esp32.blocks.cameraFramesizeUXGA","1900×1200"),"FRAME_UXGA"],[n("esp32.blocks.cameraFramesizeFHD","1920×1080"),"FRAME_FHD"],[n("esp32.blocks.cameraFramesizePHD","2560×1440"),"FRAME_P_HD"],[n("esp32.blocks.cameraFramesizeP3MP","2048×1536"),"FRAME_P_3MP"],[n("esp32.blocks.cameraFramesizeQXGA","2048×1536"),"FRAME_QXGA"],[n("esp32.blocks.cameraFramesizeQHD","2560×1440"),"FRAME_QHD"],[n("esp32.blocks.cameraFramesizeWQXGA","2560×1600"),"FRAME_WQXGA"],[n("esp32.blocks.cameraFramesizePFHD","2560×1600"),"FRAME_P_FHD"],[n("esp32.blocks.cameraFramesizeQSXGA","2560×2048"),"FRAME_QSXGA"]]},Format:{items:[[n("esp32.blocks.cameraFormatJPEG","JPEG"),"JPEG"],[n("esp32.blocks.cameraFormatYUV422","YUV422"),"YUV422"],[n("esp32.blocks.cameraFormatRGB565","RGB565"),"RGB565"],[n("esp32.blocks.cameraFormatGrayscale","Grayscale"),"GRAYSCALE"]]},WhiteBalance:{items:[[n("esp32.blocks.cameraWBNone","none"),"WB_NONE"],[n("esp32.blocks.cameraWBSunny","sunny"),"WB_SUNNY"],[n("esp32.blocks.cameraWBCloudy","cloudy"),"WB_CLOUDY"],[n("esp32.blocks.cameraWBOffice","office"),"WB_OFFICE"],[n("esp32.blocks.cameraWBHome","home"),"WB_HOME"]]}}});import{translate as C,themeColors as ne}from"@blockcode/core";var we=(e)=>{let t=C("esp32.menubar.device.esp32","ESP32");switch(e){case p.ESP32S3:t=C("esp32.menubar.device.esp32s3","ESP32-S3");break;case p.ESP32C3:t=C("esp32.menubar.device.esp32c3","ESP32-C3");break;case p.ESP32_IOT_BOARD:t=C("esp32.menubar.device.esp32IotBoard","ESP32 IOT Board");break;case p.ESP32S3_CAM:t=C("esp32.menubar.device.esp32s3Cam","ESP32S3 CAM");break;case p.ATOMS3R_CAM:t=C("esp32.menubar.device.atomS3rCam","AtomS3R CAM");break}let s=["1","2","3","4"];return{id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:ne.blocks.events.primary,inputColor:ne.blocks.events.secondary,otherColor:ne.blocks.events.tertiary,blocks:[{id:"whenstart",text:C("esp32.blocks.whenstart","when {name} start",{name:t}),hat:!0,mpy(o){let i=this.statementToCode(o)||this.PASS;i=this.addEventTrap(i,"start");let a="";return a+=`@_tasks__.append
`,a+=i,a}},"---",{id:"timerset",text:C("esp32.blocks.timerset","trigger timer #%1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:s},PERIOD:{type:"integer",defaultValue:500}},mpy(o){let i=this.valueToCode(o,"PERIOD",this.ORDER_NONE)||500,a=parseInt(o.getFieldValue("ID")||"1",10)-1;if(a<0)a=0;let r=`timer_${a}`,c=this.createName("event_flag");this.definitions_.import_timer="from machine import Timer",this.definitions_[r]=`${r} = Timer(${a})`,this.definitions_[c]=`${c} = asyncio.ThreadSafeFlag()`;let l=this.statementToCode(o,"SUBSTACK")||this.PASS,m="";return m+=`while True:
`,m+=`${this.INDENT}await ${c}.wait()
`,m+=l,l=this.prefixLines(m,this.INDENT),l=this.addEventTrap(l,"timer"),m=`@_tasks__.append
`,m+=l,this.definitions_[`${c}_callback`]=m,`${r}.init(mode=Timer.PERIODIC, period=${i}, callback=lambda _: ${c}.set())
`}},{id:"timeroff",text:C("esp32.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:s}},mpy(o){let i=parseInt(o.getFieldValue("ID")||"1",10)-1;if(i<0)i=0;return`timer_${i}.deinit()
`}}]}};import{translate as G,themeColors as le}from"@blockcode/core";import{ScratchBlocks as w}from"@blockcode/blocks";var Ve=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:le.blocks.control.primary,inputColor:le.blocks.control.secondary,otherColor:le.blocks.control.tertiary,blocks:[{id:"wait",text:G("esp32.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(e){return`await asyncio.sleep_ms(${this.valueToCode(e,"MS",this.ORDER_NONE)})
`}},{id:"forever",text:w.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:w.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:w.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:G("esp32.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"CONDITION",this.ORDER_NONE)||"False",s=this.statementToCode(e,"SUBSTACK")||this.PASS,o="";return o+=`elif ${t}:
`,o+=s,o}},{id:"else",text:G("esp32.blocks.else","else"),substack:!0,mpy(e){let t=this.statementToCode(e,"SUBSTACK")||this.PASS,s="";return s+=`else:
`,s+=t,s}},"---",{id:"repeat_until",text:w.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:w.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:G("esp32.blocks.continue","continue"),end:!0,mpy(e){return`continue
`}},{id:"break",text:G("esp32.blocks.break","break"),end:!0,mpy(e){return`break
`}}]});import{translate as d,themeColors as Ao}from"@blockcode/core";var Le=`
async def espnow_asend(msg, mac="ff:ff:ff:ff:ff:ff"):
  mac_addr = mac
  if isinstance(mac, str):
    mac_addr = bytes.fromhex(mac.replace(" ", "").replace(":", "").replace(",", ""))
  msg_data = msg if isinstance(msg, bytes) else str(msg).encode()
  max_size = min(250, len(msg_data))
  msg_data = msg_data[:max_size]
  try:
    await espnow.asend(mac_addr, msg_data)
  except OSError as err:
    if len(err.args) > 1 and err.args[1] == "ESP_ERR_ESPNOW_NOT_FOUND":
      espnow.add_peer(mac_addr)
      await espnow.asend(mac_addr, msg_data)
`,xe=(e)=>({id:"network",name:d("esp32.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:e,blocks:[{id:"ifconfig",text:d("esp32.blocks.networkCofing","local %1"),output:"string",inputs:{TYPE:{menu:[[d("esp32.blocks.networkCofingIp","ip"),"IP"],[d("esp32.blocks.networkCofingMac","mac address"),"MAC"]]}},mpy(t){let s=t.getFieldValue("TYPE")||"IP";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let o="";if(s==="IP")o="wlan.ifconfig()[0]";else if(s==="MAC")o='":".join(["%02x" % b for b in wlan.config("mac")])';return[o,this.ORDER_FUNCTION_CALL]}},{id:"isconnected",text:d("esp32.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"connectwifi",text:d("esp32.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"esp32"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let s=this.valueToCode(t,"SSID",this.ORDER_NONE),o=this.valueToCode(t,"PASSWORD",this.ORDER_NONE);s=isNaN(s)?s:this.quote_(s),o=isNaN(o)?o:this.quote_(o);let i="";return i+="if not wlan.isconnected(): threading.start_new_thread(",i+=`lambda: wlan.connect(${s}, ${o}), ())
`,i+="while wlan.active() and not wlan.isconnected(): ",i+=`await asyncio.sleep_ms(500)
`,i}},{id:"disconnect",text:d("esp32.blocks.disconnectWifi","disconnect wifi"),mpy(t){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let s="";return s+=`wlan.disconnect()
`,s+=`wlan.active(False)
`,s}},"---",{id:"wifiscan",text:d("esp32.blocks.wifiScan","start scan wifi"),mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let s="";return s+="threading.start_new_thread(",s+=`lambda: wifi_list.extend(wlan.scan()), ())
`,s}},{id:"wificounts",text:d("esp32.blocks.wifiCounts","available wifi counts"),output:"number",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},{id:"wifiitem",text:d("esp32.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[d("esp32.blocks.wifiItemSsid","ssid"),"SSID"],[d("esp32.blocks.wifiItemRssi","rssi"),"RSSI"],[d("esp32.blocks.wifiItemSecurity","security"),"SECURITY"],[d("esp32.blocks.wifiItemMac","mac address"),"MAC"]]}},mpy(t){let s=this.getAdjusted(t,"INDEX")||0,o=t.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let i=`wifi_list[${s}]`;switch(o){case"MAC":i+="[1]";break;case"RSSI":i+="[3]";break;case"SECURITY":i+="[4]";break;default:i+="[0]";break}return[i,this.ORDER_ATOMIC]}},"---",{id:"startap",text:d("esp32.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(t){let s=this.valueToCode(t,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let o="";return o+=`ap.config(ssid=${s})
`,o+=`ap.active(True)
`,o}},{id:"stopap",text:d("esp32.blocks.stopap","stop ap"),mpy(t){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:d("esp32.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(t){let s=this.valueToCode(t,"MESSAGE",this.ORDER_NONE),o=this.valueToCode(t,"MAC",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=Le,`await espnow_asend(${s}, ${o})
`}},{id:"espnowbroadcast",text:d("esp32.blocks.espnowBroadcast","broadcast %1 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"}},mpy(t){let s=this.valueToCode(t,"MESSAGE",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=Le,`await espnow_asend(${s})
`}},{id:"espnowmsg",text:d("esp32.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[d("esp32.blocks.espnowMsgText","text"),"TEXT"],[d("esp32.blocks.espnowMsgBytes","bytes"),"BYTES"],[d("esp32.blocks.espnowMsgMac","mac address"),"MAC"]]}},mpy(t){let s=t.getFieldValue("TYPE")||"TEXT";this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let o="msg";if(s==="MAC")o='peer.hex(":")';else if(s==="TEXT")o="msg.decode()";return[o,this.ORDER_FUNCTION_CALL]}},"---",{id:"espnowwhen",text:d("esp32.blocks.espnowWhen","when esp-now receive %1"),hat:!0,inputs:{MSG:{type:"string",defaultValue:d("esp32.blocks.espnowMsgText","message")}},mpy(t){let s=this.valueToCode(t,"MSG",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let o=this.createName("event_flag");if(this.definitions_[o]=`${o} = asyncio.ThreadSafeFlag()`,!this.definitions_.espnow_received){let r="";r+=`@_tasks__.append
`,r+=`async def espnow_received():
`,r+=`  async for peer, msg in espnow:
`,this.definitions_.espnow_received=r}this.definitions_.espnow_received+=`    if msg.decode() == ${s}: ${o}.set()
`;let i=this.statementToCode(t)||this.PASS,a="";return a+=`while True:
`,a+=`  await ${o}.wait()
`,a+=i,i=this.prefixLines(a,this.INDENT),i=this.addEventTrap(i,"espnow_received"),a=`@_tasks__.append
`,a+=i,a}},{id:"espnowrepeat",text:d("esp32.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(t){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let s=this.statementToCode(t,"SUBSTACK")||this.PASS;s=this.addLoopTrap(s,t.id);let o="";return o+=`async for peer, msg in espnow:
`,o+=s,o}}]});import{translate as Zs,themeColors as pe}from"@blockcode/core";var ze=(e)=>({id:"protocol",name:Zs("esp32.blocks.protocols","Protocols"),themeColor:pe.blocks.sounds.primary,inputColor:pe.blocks.sounds.secondary,otherColor:pe.blocks.sounds.tertiary,order:e,blocks:[]});import{translate as g,themeColors as me}from"@blockcode/core";import{ScratchBlocks as f}from"@blockcode/blocks";var Js=`
def to_bytes(val):
  if isinstance(val, int):
    if val <= 0:
        return bytes(b"\\x00")
    size = 0
    temp = val
    while temp > 0:
      size += 1
      temp >>= 8
    return val.to_bytes(size, "big")
  if isinstance(val, str):
    val = val.replace(" ", "").replace(":", "").replace(",", "")
    return bytes.fromhex(val)
  return bytes(b"")
`,Be=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:me.blocks.operators.primary,inputColor:me.blocks.operators.secondary,otherColor:me.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),o=e.getFieldValue("SYMBOL")||"+",i={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${t} ${o} ${s})`,i[o]]}},"---",{id:"random",text:f.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(e){this.definitions_.import_random="import random";let t=this.valueToCode(e,"FROM",this.ORDER_NONE),s=this.valueToCode(e,"TO",this.ORDER_NONE);return[`random.randint(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),o=e.getFieldValue("SYMBOL")||">",i={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${t} ${o} ${s})`,i[o]]}},"---",{id:"and",text:f.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${t} and ${s})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:f.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let t=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${t} or ${s})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:f.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(e){return[`(not ${this.valueToCode(e,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE),o=e.getFieldValue("SYMBOL")||"&",i={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${t} ${o} ${s})`,i[o]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(e){return[`(~${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:g("esp32.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`max(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:g("esp32.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`min(${t}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:f.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(e){let t=this.valueToCode(e,"NUM1",this.ORDER_NONE),s=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`(${t} % ${s})`,this.ORDER_MODULUS]}},{id:"round",text:f.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(e){return this.definitions_.import_math="import math",[`round(${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:f.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[f.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[f.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[f.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[f.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[f.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[f.Msg.OPERATORS_MATHOP_COS,"math.cos"],[f.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[f.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[f.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[f.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[f.Msg.OPERATORS_MATHOP_LN,"math.log"],[f.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[f.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[f.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(e){this.definitions_.import_math="import math";let t=e.getFieldValue("OPERATOR")||"abs",s=this.valueToCode(e,"NUM",this.ORDER_NONE),o="";if(t==="pow10")o+=`math.pow(10, ${s})`;else o+=`${t}(${s})`;return[o,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:g("esp32.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE),s=this.valueToCode(e,"FROM",this.ORDER_NONE),o=this.valueToCode(e,"TO",this.ORDER_NONE);return[`min(max(${t}, ${s}), ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:g("esp32.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE),s=this.valueToCode(e,"FROMLOW",this.ORDER_NONE),o=this.valueToCode(e,"FROMHIGH",this.ORDER_NONE),i=this.valueToCode(e,"TOLOW",this.ORDER_NONE),a=this.valueToCode(e,"TOHIGHT",this.ORDER_NONE);return[`(${t} - ${s}) * (${a} - ${i}) // (${o} - ${s}) + ${i}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:g("esp32.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(e){return[`len(${this.valueToCode(e,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:g("esp32.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[g("esp32.blocks.dataConvert.int","int"),"int"],[g("esp32.blocks.dataConvert.float","float"),"float"],[g("esp32.blocks.dataConvert.string","str"),"str"],[g("esp32.blocks.dataConvert.list","list"),"list"],[g("esp32.blocks.dataConvert.bytes","bytes"),"to_bytes"]]}},mpy(e){let t=this.valueToCode(e,"DATA",this.ORDER_NONE),s=e.getFieldValue("TYPE")||"int";if(s==="to_bytes")this.definitions_.to_bytes=Js;return[`${s}(${t})`,this.ORDER_FUNCTION_CALL]}}]});var $e=()=>({id:"data",skipXML:!0,blocks:[{id:"variable",mpy(e){return[this.getVariableName(e.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"setvariableto",mpy(e){let t=this.getVariableName(e.getFieldValue("VARIABLE")),s=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${t} = ${s}
`}},{id:"changevariableby",mpy(e){let t=this.getVariableName(e.getFieldValue("VARIABLE")),s=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${t} += ${s}
`}},{id:"listcontents",mpy(e){return[this.getVariableName(e.getFieldValue("LIST"))+"_ls",this.ORDER_ATOMIC]}},{id:"addtolist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${t}.append(${s})
`}},{id:"deleteoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX");return`${t}.pop(${s})
`}},{id:"deletealloflist",mpy(e){return`${this.getVariableName(e.getFieldValue("LIST"))+"_ls"} = []
`}},{id:"insertatlist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX"),o=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${t}.insert(${s}, ${o})
`}},{id:"replaceitemoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE),o=this.getAdjusted(e,"INDEX");return`${t}[${o}] = ${s}
`}},{id:"itemoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(e,"INDEX");return[`${t}[${s}]`,this.ORDER_MEMBER]}},{id:"itemnumoflist",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`${t}.index(${s})`,this.ORDER_FUNCTION_CALL]}},{id:"lengthoflist",mpy(e){return[`len(${this.getVariableName(e.getFieldValue("LIST"))+"_ls"})`,this.ORDER_FUNCTION_CALL]}},{id:"listcontainsitem",mpy(e){let t=this.getVariableName(e.getFieldValue("LIST"))+"_ls",s=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`(${t}.count(${s}) > 0)`,this.ORDER_FUNCTION_CALL]}}]});import{translate as We,themeColors as ue}from"@blockcode/core";var He=(e)=>({id:"terminal",name:We("esp32.blocks.terminal","Terminal"),themeColor:ue.blocks.debug.primary,inputColor:ue.blocks.debug.secondary,otherColor:ue.blocks.debug.tertiary,order:e,blocks:[{id:"print",text:We("esp32.blocks.terminalPrint","print %1"),inputs:{STRING:{type:"string",defaultValue:"hello"}},mpy(t){return`print(str(${this.valueToCode(t,"STRING",this.ORDER_NONE)}))
`}}]});import{themeColors as de,translate as Q}from"@blockcode/core";import{ScratchBlocks as Go}from"@blockcode/blocks";var Ue=()=>({id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:de.blocks.sensing.primary,inputColor:de.blocks.sensing.secondary,otherColor:de.blocks.sensing.tertiary,blocks:[{id:"temperature",text:Q("esp32.blocks.temperature","temperature"),output:"number",mpy(e){return this.definitions_.import_esp32="import esp32",["((esp32.raw_temperature() - 32) * 5 / 9)",this.ORDER_ATOMIC]}},"---",{id:"runtime",text:Q("esp32.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[Q("esp32.blocks.runtimeMilliseconds","milliseconds"),"MS"],[Q("esp32.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(e){let t=e.getFieldValue("UNIT"),s="time.ticks_diff(time.ticks_ms(), _times__)";if(t==="SEC")s=`(${s} / 1000)`;return[s,this.ORDER_ATOMIC]}}]});import{translate as h,themeColors as be}from"@blockcode/core";import{ScratchBlocks as ke}from"@blockcode/blocks";var Qe=(e)=>({id:"text",name:h("esp32.blocks.text","Text"),themeColor:be.blocks.text.primary,inputColor:be.blocks.text.secondary,otherColor:be.blocks.text.tertiary,order:e,blocks:[{id:"join",text:ke.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`(${s} + ${o})`,this.ORDER_ADDITION]}},{id:"letter_of",text:ke.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"esp32"}},mpy(t){let s=this.getAdjusted(t,"LETTER");return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${s}]`,this.ORDER_FUNCTION_CALL]}},{id:"replace",text:h("esp32.blocks.textReplace","replace %1 of %2 with %3"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"},STRING3:{type:"string",defaultValue:"The E"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE),i=this.valueToCode(t,"STRING3",this.ORDER_NONE);return[`${o}.replace(${s}, ${i})
`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:h("esp32.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(t){let s=this.getAdjusted(t,"FROM"),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${s}:${o}]`,this.ORDER_FUNCTION_CALL]}},{id:"find",text:h("esp32.blocks.textFind","find %1 of %2 place"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)}.find(${s}) + 1)
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:ke.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"e"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)} in ${s})`,this.ORDER_EQUALITY]}},{id:"with",text:h("esp32.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},WITH:{type:"string",menu:[[h("esp32.blocks.textStartsWith","starts"),"START"],[h("esp32.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE),a=(t.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${s}.${a}(${o})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:h("esp32.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"ESP32"}},mpy(t){let s=this.valueToCode(t,"STRING1",this.ORDER_NONE),o=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`${s}.lower() == ${o}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:h("esp32.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[h("esp32.blocks.textLowerCase","lower"),"LOWER"],[h("esp32.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"ESP32"}},mpy(t){let s=t.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.${s==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:h("esp32.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"}},mpy(t){return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}}]});import{MicroPythonGenerator as js}from"@blockcode/blocks";var et=`# Generate by BlockCode
`;class X extends js{finish(e){return et+super.finish(e)}}function Xe(e){let t=[p.ESP32S3_CAM,p.ATOMS3R_CAM].includes(e),s=Pe(e),o=Ge(e,1),i=ze(1+t),a=we(e),r=Ve(),c=xe(4+t),l=Ue(),m=Be(),u=Qe(7+t),O=He(8+t),N=$e();return[s,t&&o,i,a,r,c,l,m,u,O,N].filter(Boolean)}import{Text as T}from"@blockcode/core";import{jsx as S}from"preact/jsx-runtime";var Ye=[{tag:"controller",label:S(T,{id:"esp32.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:S(T,{id:"esp32.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:S(T,{id:"esp32.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:S(T,{id:"esp32.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:S(T,{id:"esp32.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:S(T,{id:"esp32.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:S(T,{id:"esp32.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:S(T,{id:"esp32.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as lt}from"preact/jsx-runtime";var ct=(e)=>e.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),Ke=new X,nt=()=>["device","data","ai"];function Ze(){let{tabIndex:e}=tt(),{meta:t}=ot();st(()=>{it("boardPins",re(t.value.boardType))},[t.value.boardType]);let s=qe(()=>{return Xe(t.value.boardType,t.value.classicEvents)},[t.value.boardType,t.value.classicEvents]),o=qe((i,a,r,c)=>{at.prototype.onDefinitions.call(Ke);for(let l in r)for(let m of r[l])if(!m.common){let u=oe(m.name,ie(m.name));a(`import_${l}_${u}`,`from ${ct(l)} import ${u}`)}},[]);return lt(rt,{enableCodePreview:!0,enableProcedureExecute:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:e.value!==0,extensionTags:Ye,generator:Ke,onBuildinExtensions:s,onDefinitions:o,onExtensionsFilter:nt})}import{useCallback as dt}from"preact/hooks";import{useComputed as es}from"@preact/signals";import{nanoid as bt}from"@blockcode/utils";import{useAppContext as kt,useProjectContext as ft,setAppState as ss,Text as Et}from"@blockcode/core";import{setAlert as Re,delAlert as pt,translate as fe,logger as Ee}from"@blockcode/core";import{MPYUtils as mt}from"@blockcode/board";var Je=(e,t)=>{if(t<100)Re("downloading",{id:e,progress:t});else Re("downloadCompleted",{id:e}),setTimeout(()=>pt(e),1000)},Y=async(e,t,s,o)=>{Je(e,0),Ee.log(fe("gui.logs.downloading","Downloading..."));let i=[].concat(s,o).map((a)=>({...a,filename:a.id}));try{await mt.write(t,i,Je.bind(null,e)),Ee.success(fe("gui.logs.downloaded","Download completed")),t.reset()}catch(a){Re("downloadError",{id:e},1000),Ee.error(fe("gui.logs.downloadError","Download failed")+": "+a.message)}};var je="./assets/icon-download-09b2xh4b.svg";import{jsx as he,jsxs as Rt}from"preact/jsx-runtime";function ts({className:e}){let{appState:t}=kt(),{file:s,assets:o}=ft(),i=es(()=>t.value?.device),a=es(()=>t.value?.deviceAlertId),r=dt(async()=>{if(!i.value)return;if(a.value)return;let c=bt();ss("deviceAlertId",c),await Y(c,i.value,s.value,o.value),ss("deviceAlertId",null)},[]);return Rt("label",{disabled:a.value||!i.value,className:e,onClick:r,children:[he("img",{src:je}),he("span",{children:he(Et,{id:"gui.menubar.device.download",defaultMessage:"Download program"})})]})}import{useAppContext as gt}from"@blockcode/core";function ge(e){let t=globalThis.document,s=t.createElement("style");s.appendChild(t.createTextNode(e)),t.head.append(s)}ge("._1Ep-la_device-icon{width:20px;height:20px}._1Ep-la_check-icon{margin-right:calc(var(--space) / 2);visibility:hidden;width:14px}._1Ep-la_check-icon._1Ep-la_checked{visibility:visible}._1Ep-la_blank-check-item>div{padding-left:calc(var(--space) / 2 + 14px)}._1Ep-la_section-title{padding-left:calc(var(--space) * 1.5 + 2px + 14px)}");var E={blankCheckItem:"_1Ep-la_blank-check-item",deviceIcon:"_1Ep-la_device-icon",sectionTitle:"_1Ep-la_section-title",checkIcon:"_1Ep-la_check-icon",checked:"_1Ep-la_checked"};var os="./assets/icon-device-40zreghe.png";import{jsx as Ot}from"preact/jsx-runtime";function is(){let{appState:e}=gt();return Ot("img",{className:E.deviceIcon,src:os})}import{useProjectContext as _t,Text as I}from"@blockcode/core";import{jsx as D}from"preact/jsx-runtime";function as(){let{meta:e}=_t();switch(e.value.boardType){case p.ESP32S3:return D(I,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"});case p.ESP32C3:return D(I,{id:"esp32.menubar.device.esp32c3",defaultMessage:"ESP32-C3"});case p.ESP32_IOT_BOARD:return D(I,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"ESP32 IOT Board"});case p.ESP32S3_CAM:return D(I,{id:"esp32.menubar.device.esp32s3Cam",defaultMessage:"ESP32S3 CAM"});case p.ATOMS3R_CAM:return D(I,{id:"esp32.menubar.device.atomS3RCam",defaultMessage:"AtomS3R CAM"})}return D(I,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})}import{useCallback as y,useEffect as Wt}from"preact/hooks";import{useComputed as Os}from"@preact/signals";import{classNames as B,sleepMs as Ht,nanoid as Ut}from"@blockcode/utils";import{useAppContext as Qt,useProjectContext as Xt,setAlert as H,setAppState as P,translate as j,logger as ee}from"@blockcode/core";import{MPYUtils as _s}from"@blockcode/board";var q=[{usbVendorId:12346},{usbVendorId:6790}];import{Text as $,MenuSection as As,MenuItem as W}from"@blockcode/core";import{useEffect as vt,useCallback as Tt}from"preact/hooks";import{batch as rs}from"@preact/signals";import{classNames as K}from"@blockcode/utils";import{useAppContext as St,useProjectContext as Nt,setAppState as Ft,setMeta as cs,Text as L,MenuSection as ns,MenuItem as Z}from"@blockcode/core";var V="./assets/icon-check-f984n1c2.svg";import{jsx as v,jsxs as F,Fragment as It}from"preact/jsx-runtime";function ls({disabled:e,itemClassName:t}){let{appState:s}=St(),{meta:o}=Nt();vt(()=>{if(!o.value.boardType)cs("boardType",p.ESP32S3)},[]);let i=Tt((a)=>()=>rs(()=>{s.value?.device?.disconnect(),rs(()=>{Ft("device",null),cs({boardType:a})})}),[]);return F(It,{children:[F(ns,{disabled:e,children:[F(Z,{className:t,onClick:i(p.ESP32),children:[v("img",{className:K(E.checkIcon,{[E.checked]:o.value.boardType===p.ESP32}),src:V}),v(L,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})]}),F(Z,{className:t,onClick:i(p.ESP32S3),children:[v("img",{className:K(E.checkIcon,{[E.checked]:o.value.boardType===p.ESP32S3}),src:V}),v(L,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"})]})]}),F(ns,{disabled:e,titleClassName:E.blankCheckItem,title:v(L,{id:"esp32.menubar.device.nulllab",defaultMessage:"NULLLAB"}),children:[F(Z,{className:t,onClick:i(p.ESP32_IOT_BOARD),children:[v("img",{className:K(E.checkIcon,{[E.checked]:o.value.boardType===p.ESP32_IOT_BOARD}),src:V}),v(L,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"ESP32 IOT Board"})]}),F(Z,{className:t,onClick:i(p.ESP32S3_CAM),children:[v("img",{className:K(E.checkIcon,{[E.checked]:o.value.boardType===p.ESP32S3_CAM}),src:V}),v(L,{id:"esp32.menubar.device.esp32s3Cam",defaultMessage:"ESP32S3 CAM"})]})]})]})}import{useEffect as ms,useMemo as us,useCallback as Dt}from"preact/hooks";import{useSignal as ds}from"@preact/signals";import{nanoid as Mt,classNames as yt,sleep as Pt,Base64Utils as fs,getBinaryCache as Es,setBinaryCache as Gt}from"@blockcode/utils";import{useAppContext as wt,useProjectContext as Vt,setAlert as z,delAlert as Lt,setAppState as ta}from"@blockcode/core";import{ESPTool as J}from"@blockcode/board";var Zi="0.2.1";var Oe={iotboard:{download:"https://firmware.blockcode.fun/iotboard"},esp32s3cam:{download:"https://firmware.blockcode.fun/esp32s3cam"}};import{Text as _e,MenuSection as xt,MenuItem as zt}from"@blockcode/core";import{jsx as x}from"preact/jsx-runtime";var A=null,Bt=(e)=>{if(e<100)z("restoring",{id:A,progress:e});else z("recovering",{id:A})},bs=()=>{Lt(A),A=null},Rs=(e)=>{if(e==="NotFoundError")return;z("connectionError",1000)},hs=async(e)=>{try{return await fetch(e,{method:"GET"})}catch(t){return await Pt(1),hs(e)}},M=async(e,t,s,o,i)=>{if(i.value)return;let a=`${e}Firmware`,r=await Es(a);if(r?.hash===s&&r?.binaryString){i.value=!0,delete M.downloading;return}if(M.downloading)return;M.downloading=!0;let l=await(await hs(t)).arrayBuffer();delete M.downloading;let m=await crypto.subtle.digest("SHA-256",l);if(Array.from(new Uint8Array(m)).map((O)=>O.toString(16).padStart(2,"0")).join("")!==s){M(e,t,s,o,i);return}await Gt(a,{version:o,hash:s,binaryString:fs.arrayBufferToBinaryString(l)}),i.value=!0},ks=async(e,t)=>{A=Mt(),z("erasing",{id:A});try{await J.writeFlash(e,t,!0,(s)=>Bt(s)),z("restoreCompleted",{id:A,onClose:bs})}catch(s){Rs(s.name),bs()}await J.disconnect(e)},$t=async(e,t=0)=>{if(A)return;let s;try{s=await J.connect(q,460800)}catch(i){Rs(i.name)}if(!s)return;if(e){let i=await Es(`${e}Firmware`);if(i)ks(s,[{address:t,data:i.binaryString}]);return}let o=document.createElement("input");o.type="file",o.accept=".bin",o.multiple=!1,o.click(),o.addEventListener("cancel",()=>J.disconnect(s)),o.addEventListener("change",async(i)=>{let a=new FileReader;a.readAsArrayBuffer(i.target.files[0]),a.addEventListener("load",(r)=>ks(s,[{address:t,data:fs.arrayBufferToBinaryString(r.target.result)}]))})};function gs({disabled:e,itemClassName:t}){let{appState:s}=wt(),{meta:o}=Vt(),i=ds(!1),a=ds(null),r=us(()=>{if(o.value.boardType===p.ESP32_IOT_BOARD)return a.value=null,"iotboard";if(o.value.boardType===p.ESP32S3_CAM)return a.value=null,"esp32s3cam"},[o.value.boardType]),c=us(()=>{if([p.ESP32_IOT_BOARD,p.ESP32S3_CAM].includes(o.value.boardType))return x(_e,{id:"gui.menubar.device.firmwareVersion",defaultMessage:"Restore v{version} firmware...",version:a.value?.version})},[o.value.boardType,a.value?.version]);ms(()=>A=null,[]),ms(async()=>{if(!r||!Oe[r])return;i.value=!1;let m=Oe[r].download;if(!a.value)a.value=await fetch(`${m}/version.json`).then((N)=>N.json());let u=`${m}/${a.value.download}`.replaceAll("{version}",a.value.version),O=a.value.hash;M(r,u,O,a.value.version,i)},[r]);let l=Dt(async()=>{if(s.value?.device)return;let m=0;if(o.value.boardType===p.ESP32)m=4096;$t(r,m)},[r]);return x(xt,{children:x(zt,{disabled:e||A||s.value?.device||c&&!i.value,className:yt(t,E.blankCheckItem),onClick:l,children:c?i.value?c:x(_e,{id:"gui.menubar.device.caching",defaultMessage:"Caching latest firmware..."}):x(_e,{id:"esp32.menubar.device.micropythonFirmware",defaultMessage:"Restore MicroPython firmware"})})})}import{jsx as R,jsxs as ve,Fragment as Ce}from"preact/jsx-runtime";var Ae=(e,t)=>{if(e.name==="NotFoundError")return;if(e.name==="NetworkError")H("connectionBusy",{id:t},1000);else H("connectionError",{id:t},1000)};function Cs({itemClassName:e}){let{appState:t}=Qt(),{meta:s,file:o,assets:i}=Xt(),a=Os(()=>t.value?.device),r=Os(()=>t.value?.deviceAlertId),c=y(async(b)=>{if(b===a.value)return;await a.value?.disconnect(),await Ht(500);let Te=()=>c(b),Se=(se)=>{if(se)Ae(se,r.value),ee.warn(j("gui.logs.disconnected","Device disconnected")+": "+se.message);P("device",null),P("deviceAlertId",null),b.off("connect",Te),b.off("disconnect",Se)};b.on("connect",Te),b.on("disconnect",Se),P("device",b)},[]),l=y(async()=>{if(r.value)return;try{let b=await _s.connect(q,{baudRate:115200});c(b),H("connected",1000),ee.success(j("gui.logs.connectedType","Device connected with {type}",{type:"USB"}))}catch(b){Ae(b,r.value)}},[]),m=y(async()=>{if(r.value)return;try{let b=await _s.connectBLE();c(b),H("connected",1000),ee.success(j("gui.logs.connectedType","Device connected with {type}",{type:"BLE"}))}catch(b){Ae(b,r.value)}},[]),u=y(async()=>{if(!a.value)return;if(r.value)return;let b=Ut();P("deviceAlertId",b),await Y(b,a.value,o.value,i.value),P("deviceAlertId",null)},[]),O=y(()=>{if(r.value)return;a.value?.disconnect(),ee.warn(j("gui.logs.disconnected","Device disconnected"))},[]),N=y(()=>{if(r.value)return;a.value?.reset(),H("reseting",1000)},[]);return Wt(()=>{if(r.value&&!a.value)P("deviceAlertId",null)},[a.value]),ve(Ce,{children:[R(As,{disabled:r.value||!a.value,children:R(W,{className:B(e,E.blankCheckItem),label:R($,{id:"gui.menubar.device.download",defaultMessage:"Download program"}),onClick:u})}),R(As,{disabled:r.value,children:a.value?ve(Ce,{children:[R(W,{className:B(e,E.blankCheckItem),label:R($,{id:"gui.menubar.device.disconnect",defaultMessage:"Disconnect device"}),onClick:O}),R(W,{className:B(e,E.blankCheckItem),label:R($,{id:"gui.menubar.device.reset",defaultMessage:"Reset device"}),onClick:N})]}):ve(Ce,{children:[R(W,{className:B(e,E.blankCheckItem),label:R($,{id:"gui.menubar.device.connectUsb",defaultMessage:"Connect device with USB..."}),onClick:l}),s.value.boardType===p.ESP32_IOT_BOARD&&R(W,{className:B(e,E.blankCheckItem),label:R($,{id:"gui.menubar.device.connectBle",defaultMessage:"Connect device with Bluetooth (BLE)..."}),onClick:m})]})}),R(ls,{disabled:r.value,itemClassName:e}),R(gs,{disabled:r.value,itemClassName:e})]})}var vs={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as Ts}from"preact/jsx-runtime";var Va={onNew(){return vs},onSave(e,t,s){return{files:e,assets:t,meta:{boardType:s.boardType??p.ESP32}}},async onThumb(){let e=U.getMainWorkspace();if(e){let t=e.getCanvas();if(t)return await Yt(t,{})}},onUndo(e){if(e instanceof MouseEvent)U.getMainWorkspace()?.undo(!1)},onRedo(e){if(e instanceof MouseEvent)U.getMainWorkspace()?.undo(!0)},onEnableUndo(){let e=U.getMainWorkspace();return e?.undoStack_&&e.undoStack_.length!==0},onEnableRedo(){let e=U.getMainWorkspace();return e?.redoStack_&&e.redoStack_.length!==0},menuItems:[{icon:Ts(is,{}),label:Ts(as,{}),Menu:Cs}],barItems:[{Label:ts}],tabs:[{...qt,Content:Ze},{...Kt},{...Zt}]};export{Va as default};
