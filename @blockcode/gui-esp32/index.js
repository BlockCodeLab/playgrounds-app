import{addLocalesMessages as ps}from"@blockcode/core";var fe={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"NULLLAB ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"NULLLAB ESP32S3 CAM","esp32.menubar.device.atomS3rCam":"M5Stack AtomS3R CAM","esp32.menubar.device.firmware":"Restore firmware (v{version})","esp32.menubar.device.micropythonFirmware":"Restore MicroPython firmware...","esp32.menubar.device.erasing":"Erasing...","esp32.menubar.device.restoring":"Firmware restoring...{progress}%","esp32.menubar.device.recovering":"Recovering...","esp32.menubar.device.restoreDone":"Firmware resotre completed! Now press RESET key","esp32.menubar.device.caching":"Caching latest firmware...","esp32.extension.tags.controllers":"Controllers","esp32.extension.tags.sensors":"Sensors","esp32.extension.tags.actuators":"Actuators","esp32.extension.tags.displays":"Displays","esp32.extension.tags.modules":"Modules","esp32.extension.tags.communication":"Communication","esp32.extension.tags.data":"Data","esp32.extension.tags.kits":"Kits","esp32.blocks.wait":"wait %1 milliseconds","esp32.blocks.break":"break","esp32.blocks.continue":"continue","esp32.blocks.elseif":"else if %1 then","esp32.blocks.else":"else","esp32.blocks.runtime":"run time %1","esp32.blocks.runtimeMilliseconds":"milliseconds","esp32.blocks.runtimeSeconds":"seconds","esp32.blocks.dataConvert":"convert %1 to %2","esp32.blocks.dataConvert.int":"int","esp32.blocks.dataConvert.float":"float","esp32.blocks.dataConvert.string":"str","esp32.blocks.dataConvert.list":"list","esp32.blocks.dataLengthOf":"length of %1","esp32.blocks.dataConstrain":"constrain %1 between %2 to %3","esp32.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","esp32.blocks.whenstart":"when {name} start","esp32.blocks.timerset":"set timer # %1 per %2 milliseconds","esp32.blocks.timeroff":"stop timer # %1","esp32.blocks.operatorLarger":"larger of %1 and %2","esp32.blocks.operatorSmaller":"smaller of %1 and %2","esp32.blocks.pin":"Pins","esp32.blocks.setmode":"set pin %1 mode to %2","esp32.blocks.inputMode":"input","esp32.blocks.ouputMode":"output","esp32.blocks.inputPullUpMode":"input pull-up","esp32.blocks.inputPullDownMode":"input pull-down","esp32.blocks.setdigital":"set pin %1 to %2","esp32.blocks.digitalHigh":"high","esp32.blocks.digitalLow":"low","esp32.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","esp32.blocks.setpwm":"set pin %1 pwm to %2","esp32.blocks.setanalog":"set pin %1 analog to %2","esp32.blocks.isDigitalHigh":"pin %1 is high?","esp32.blocks.analogValue":"pin %1 analog value","esp32.blocks.attachinterrupt":"attach pin %1 interrupt to %2","esp32.blocks.interruptRising":"rising","esp32.blocks.interruptFalling":"falling","esp32.blocks.interruptChange":"change","esp32.blocks.interruptHigh":"high","esp32.blocks.interruptLow":"low","esp32.blocks.detachinterrupt":"detach pin %1 interrupt","esp32.blocks.network":"Network","esp32.blocks.protocols":"Protocols","esp32.blocks.serial":"Serial","esp32.blocks.serialBaudrate":"set baudrate to %1","esp32.blocks.serialTimeout":"set timeout to %1 milliseconds","esp32.blocks.serialPrint":"send %1 with %2","esp32.blocks.serialPrintWarp":"warp","esp32.blocks.serialPrintNoWarp":"no-warp","esp32.blocks.serialPrintHEX":"hex","esp32.blocks.serialAvailable":"available data?","esp32.blocks.serialAvailableLength":"available data length","esp32.blocks.serialReadString":"read a string","esp32.blocks.serialReadStringUntil":"read a string until %1","esp32.blocks.serialReadParse":"read a %1 number","esp32.blocks.serialReadParseInteger":"int","esp32.blocks.serialReadParseFloat":"float","esp32.blocks.serialRead":"read a byte","esp32.blocks.serialReadBytes":"read %1 bytes","esp32.blocks.text":"Text","esp32.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","esp32.blocks.textRemove":"remove letters from %1 to %2 of %3","esp32.blocks.textReplace":"replace %1 of %2 with %3","esp32.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","esp32.blocks.textSubstring":"substring of %1 from %2 to %3","esp32.blocks.textFind":"find %1 of %2 place","esp32.blocks.textWith":"%1 %2 with %3?","esp32.blocks.textStartsWith":"starts","esp32.blocks.textEndsWith":"ends","esp32.blocks.textCase":"get %1 of %2","esp32.blocks.textLowerCase":"lower-case","esp32.blocks.textUpperCase":"upper-case","esp32.blocks.textTrim":"remove %1 leading and trailing whitespace","esp32.blocks.textConvert":"convert %1 to %2","esp32.blocks.textConvertFrom":"convert %1 to String","esp32.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","esp32.blocks.disconnectWifi":"disconnect wi-fi","esp32.blocks.isWifiConnected":"wi-fi is connected?","esp32.blocks.wifiScan":"start scan wi-fi","esp32.blocks.wifiItem":"%2 of item %1 of available wi-fi","esp32.blocks.wifiItemSsid":"ssid","esp32.blocks.wifiItemMac":"mac","esp32.blocks.wifiItemRssi":"rssi","esp32.blocks.wifiItemSecurity":"security","esp32.blocks.wifiCounts":"available wi-fi counts","esp32.blocks.startap":"start ap ssid: %1","esp32.blocks.stopap":"stop ap","esp32.blocks.espnowBroadcast":"broadcast %1 via esp-now","esp32.blocks.espnowSend":"send %1 to %2 via esp-now","esp32.blocks.espnowRecv":"wait for esp-now incoming","esp32.blocks.espnowMsg":"%1 of incoming","esp32.blocks.espnowMsgText":"message","esp32.blocks.espnowMsgMac":"mac address","esp32.blocks.espnowRepeat":"repeat wait for esp-now incoming","esp32.blocks.espnowWhen":"when esp-now receive %1","esp32.blocks.spiInit":"initialize SPI %1 freq:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 write %2","esp32.blocks.spiRead":"SPI %1 read %2 bytes","esp32.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","esp32.blocks.i2cScan":"I2C scan devices","esp32.blocks.i2cWrite":"I2C write to %1:%2","esp32.blocks.i2cRead":"I2C read from %1 :%2 bytes","esp32.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","esp32.blocks.i2sPlay":"I2S play %1","esp32.blocks.terminal":"Terminal","esp32.blocks.terminalPrint":"print %1","esp32.blocks.terminalEval":"eval %1","esp32.blocks.temperature":"temperature","esp32.blocks.turnon":"on","esp32.blocks.turnoff":"off","esp32.blocks.camera":"Camera","esp32.blocks.cameraCapture":"capture","esp32.blocks.cameraFlashlamp":"flashlamp %1","esp32.blocks.cameraFlip":"flip %1","esp32.blocks.cameraMirror":"mirror %1","esp32.blocks.cameraEffect":"set effect to %1","esp32.blocks.cameraFramesize":"set framesize to %1","esp32.blocks.cameraFormat":"set picture format to %1","esp32.blocks.cameraQuality":"set picture quality to %1","esp32.blocks.cameraContrast":"set contrast to %1","esp32.blocks.cameraSaturation":"set saturation to %1","esp32.blocks.cameraBrightness":"set brightness to %1","esp32.blocks.cameraWhiteBalance":"set white balance to %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"Grayscale","esp32.blocks.cameraEffectNone":"none","esp32.blocks.cameraEffectNegative":"negative","esp32.blocks.cameraEffectGrayscale":"grayscale","esp32.blocks.cameraEffectSepia":"sepia","esp32.blocks.cameraEffectRed":"red","esp32.blocks.cameraEffectGreen":"green","esp32.blocks.cameraEffectBlue":"blue","esp32.blocks.cameraEffectAntique":"antique","esp32.blocks.cameraEffectSketch":"sketch","esp32.blocks.cameraEffectSolarize":"solarize","esp32.blocks.cameraEffectPosterize":"posterize","esp32.blocks.cameraEffectWhiteboard":"whiteboard","esp32.blocks.cameraEffectBlackboard":"blackboard","esp32.blocks.cameraEffectAqua":"aqua","esp32.blocks.cameraWBNone":"none","esp32.blocks.cameraWBSunny":"sunny","esp32.blocks.cameraWBCloudy":"cloudy","esp32.blocks.cameraWBOffice":"office","esp32.blocks.cameraWBHome":"home"};var Ee={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"NULLLAB ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"NULLLAB ESP32S3 CAM","esp32.menubar.device.atomS3rCam":"M5Stack AtomS3R CAM","esp32.menubar.device.firmware":"恢复固件（v{version}）","esp32.menubar.device.micropythonFirmware":"恢复 MicroPython 固件…","esp32.menubar.device.erasing":"正在清除…","esp32.menubar.device.restoring":"正在恢复固件…{progress}%","esp32.menubar.device.recovering":"恢复设备…","esp32.menubar.device.restoreDone":"恢复固件完成，请按下 RESET 键。","esp32.menubar.device.caching":"正在缓存最新固件…","esp32.extension.tags.controllers":"输入模块","esp32.extension.tags.sensors":"传感器","esp32.extension.tags.actuators":"执行器","esp32.extension.tags.displays":"显示模块","esp32.extension.tags.modules":"智能模块","esp32.extension.tags.communication":"通讯","esp32.extension.tags.data":"数据","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重复执行","esp32.blocks.continue":"跳到下一次执行","esp32.blocks.elseif":"否则，如果 %1 那么","esp32.blocks.else":"否则","esp32.blocks.runtime":"运行时长 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"将 %1 转为 %2","esp32.blocks.dataConvert.int":"整数","esp32.blocks.dataConvert.float":"浮点数","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataLengthOf":"%1 长度","esp32.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","esp32.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"当 {name} 启动","esp32.blocks.timerset":"将定时器 # %1 间隔设为每 %2 毫秒","esp32.blocks.timeroff":"关闭定时器 # %1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引脚","esp32.blocks.setmode":"将引脚 %1 设为 %2 模式","esp32.blocks.inputMode":"输入","esp32.blocks.ouputMode":"输出","esp32.blocks.inputPullUpMode":"上拉输入","esp32.blocks.inputPullDownMode":"下拉输入","esp32.blocks.setdigital":"将引脚 %1 设为 %2","esp32.blocks.digitalHigh":"高电平","esp32.blocks.digitalLow":"低电平","esp32.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","esp32.blocks.setpwm":"将引脚 %1 PWM 设为 %2","esp32.blocks.setanalog":"将引脚 %1 模拟值设为 %2","esp32.blocks.isDigitalHigh":"引脚 %1 是高电平？","esp32.blocks.analogValue":"引脚 %1 模拟值","esp32.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","esp32.blocks.interruptRising":"电平上升","esp32.blocks.interruptFalling":"电平下降","esp32.blocks.interruptChange":"电平改变","esp32.blocks.interruptHigh":"高电平","esp32.blocks.interruptLow":"低电平","esp32.blocks.detachinterrupt":"取消引脚 %1 中断","esp32.blocks.network":"网络","esp32.blocks.protocols":"协议","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"将波特率设为 %1","esp32.blocks.serialTimeout":"将通讯超时设为 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式发送 %1","esp32.blocks.serialPrintWarp":"换行","esp32.blocks.serialPrintNoWarp":"不换行","esp32.blocks.serialPrintHEX":"16进制","esp32.blocks.serialAvailable":"存在可读取数据?","esp32.blocks.serialAvailableLength":"可读取数据长度","esp32.blocks.serialReadString":"读取文本","esp32.blocks.serialReadStringUntil":"读取文本直到 %1","esp32.blocks.serialReadParse":"读取 %1","esp32.blocks.serialReadParseInteger":"整数","esp32.blocks.serialReadParseFloat":"浮点数","esp32.blocks.serialRead":"读取 1 个字节","esp32.blocks.serialReadBytes":"读取 %1 个字节","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","esp32.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","esp32.blocks.textReplace":"将 %2 中的 %1 替换为 %3","esp32.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","esp32.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"开始于","esp32.blocks.textEndsWith":"结束于","esp32.blocks.textCase":"将 %2 字母转为 %1","esp32.blocks.textLowerCase":"小写","esp32.blocks.textUpperCase":"大写","esp32.blocks.textTrim":"清除 %1 前后空白字符","esp32.blocks.textConvert":"将 %1 转为 %2","esp32.blocks.textConvertFrom":"将 %1 转为文本","esp32.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","esp32.blocks.disconnectWifi":"断开 Wi-Fi 网络","esp32.blocks.isWifiConnected":"Wi-Fi 网络已连接？","esp32.blocks.wifiScan":"开始扫描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemMac":"MAC","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密类型","esp32.blocks.wifiCounts":"可用 Wi-Fi 数量","esp32.blocks.startap":"开启热点 SSID: %1","esp32.blocks.stopap":"关闭热点","esp32.blocks.espnowBroadcast":"ESP-Now 广播 %1","esp32.blocks.espnowSend":"ESP-Now 发送 %1 给 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"消息","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"当 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 频率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 写入 %2","esp32.blocks.spiRead":"SPI %1 读取 %2 字节","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","esp32.blocks.i2cScan":"I2C扫描设备","esp32.blocks.i2cWrite":"I2C写入到 %1:%2","esp32.blocks.i2cRead":"I2C从 %1 读取 %2 字节","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"终端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.terminalEval":"执行 %1","esp32.blocks.temperature":"温度","esp32.blocks.turnon":"开启","esp32.blocks.turnoff":"关闭","esp32.blocks.camera":"摄像头","esp32.blocks.cameraCapture":"拍摄","esp32.blocks.cameraFlashlamp":"闪光灯 %1","esp32.blocks.cameraFlip":"上下翻转 %1","esp32.blocks.cameraMirror":"左右镜像 %1","esp32.blocks.cameraEffect":"将特效设为 %1","esp32.blocks.cameraFramesize":"将分辨率设为 %1","esp32.blocks.cameraFormat":"将图片格式设为 %1","esp32.blocks.cameraQuality":"将图片质量设为 %1","esp32.blocks.cameraContrast":"将对比度设为 %1","esp32.blocks.cameraSaturation":"将饱和度设为 %1","esp32.blocks.cameraBrightness":"将亮度设为 %1","esp32.blocks.cameraWhiteBalance":"将白平衡设为 %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"灰度","esp32.blocks.cameraEffectNone":"原图","esp32.blocks.cameraEffectNegative":"负片","esp32.blocks.cameraEffectGrayscale":"灰度","esp32.blocks.cameraEffectSepia":"棕褐色","esp32.blocks.cameraEffectRed":"红色","esp32.blocks.cameraEffectGreen":"绿色","esp32.blocks.cameraEffectBlue":"蓝色","esp32.blocks.cameraEffectAntique":"复古","esp32.blocks.cameraEffectSketch":"素描","esp32.blocks.cameraEffectSolarize":"日光","esp32.blocks.cameraEffectPosterize":"海报","esp32.blocks.cameraEffectWhiteboard":"白板","esp32.blocks.cameraEffectBlackboard":"黑板","esp32.blocks.cameraEffectAqua":"水晶","esp32.blocks.cameraWBNone":"原始","esp32.blocks.cameraWBSunny":"晴天","esp32.blocks.cameraWBCloudy":"阴天","esp32.blocks.cameraWBOffice":"办公室","esp32.blocks.cameraWBHome":"家中"};var Re={"esp32.menubar.device":"ESP32","esp32.menubar.device.esp32":"ESP32","esp32.menubar.device.esp32s3":"ESP32-S3","esp32.menubar.device.esp32c3":"ESP32-C3","esp32.menubar.device.esp32c6":"ESP32-C6","esp32.menubar.device.esp32IotBoard":"NULLLAB ESP32 IOT Board","esp32.menubar.device.esp32s3Cam":"NULLLAB ESP32S3 CAM","esp32.menubar.device.atomS3rCam":"M5Stack AtomS3R CAM","esp32.menubar.device.firmware":"還原固件（v{version}）","esp32.menubar.device.micropythonFirmware":"還原 MicroPython 固件…","esp32.menubar.device.erasing":"正在清除…","esp32.menubar.device.restoring":"正在還原固件…{progress}%","esp32.menubar.device.recovering":"恢復設備…","esp32.menubar.device.restoreDone":"還原固件完成，請按下 RESET 鍵。","esp32.menubar.device.caching":"正在緩存最新固件…","esp32.extension.tags.controllers":"輸入模組","esp32.extension.tags.sensors":"傳感器","esp32.extension.tags.actuators":"執行器","esp32.extension.tags.displays":"顯示模組","esp32.extension.tags.modules":"智能模組","esp32.extension.tags.communication":"通訊","esp32.extension.tags.data":"數據","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重複","esp32.blocks.continue":"跳到下一次","esp32.blocks.elseif":"否則，如果 %1 那麼","esp32.blocks.else":"否則","esp32.blocks.runtime":"運行時長 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"將 %1 轉為 %2","esp32.blocks.dataConvert.int":"整數","esp32.blocks.dataConvert.float":"浮點數","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataLengthOf":"%1 長度","esp32.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","esp32.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"當 {name} 開始","esp32.blocks.timerset":"將定時器 # %1 間隔設為每 %2 毫秒","esp32.blocks.timeroff":"關閉定時器 # %1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引腳","esp32.blocks.setmode":"將引腳 %1 設為 %2 模式","esp32.blocks.inputMode":"輸入","esp32.blocks.ouputMode":"輸出","esp32.blocks.inputPullUpMode":"上拉輸入","esp32.blocks.inputPullDownMode":"下拉輸入","esp32.blocks.setdigital":"將引腳 %1 設為 %2","esp32.blocks.digitalHigh":"高電平","esp32.blocks.digitalLow":"低電平","esp32.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","esp32.blocks.setpwm":"將引腳 %1 PWM 設為 %2","esp32.blocks.setanalog":"將引腳 %1 模擬值設為 %2","esp32.blocks.isDigitalHigh":"引腳 %1 是高電平？","esp32.blocks.analogValue":"引腳 %1 模擬值","esp32.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","esp32.blocks.interruptRising":"電平上升","esp32.blocks.interruptFalling":"電平下降","esp32.blocks.interruptChange":"電平改變","esp32.blocks.interruptHigh":"高電平","esp32.blocks.interruptLow":"低電平","esp32.blocks.detachinterrupt":"取消引腳 %1 中斷","esp32.blocks.network":"網絡","esp32.blocks.protocols":"協議","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"將波特率設為 %1","esp32.blocks.serialTimeout":"將通訊超時設為 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式打印 %1","esp32.blocks.serialPrintWarp":"換行","esp32.blocks.serialPrintNoWarp":"不換行","esp32.blocks.serialPrintHEX":"16進制","esp32.blocks.serialAvailable":"存在可讀取數據?","esp32.blocks.serialAvailableLength":"可讀取數據長度","esp32.blocks.serialReadString":"讀取文本","esp32.blocks.serialReadStringUntil":"讀取文本直到 %1","esp32.blocks.serialReadParse":"讀取 %1","esp32.blocks.serialReadParseInteger":"整數","esp32.blocks.serialReadParseFloat":"浮點數","esp32.blocks.serialRead":"讀取 1 個字節","esp32.blocks.serialReadBytes":"讀取 %1 個字節","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","esp32.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","esp32.blocks.textReplace":"將 %2 中的 %1 替換為 %3","esp32.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","esp32.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"開始於","esp32.blocks.textEndsWith":"結束於","esp32.blocks.textCase":"將 %2 字母轉為 %1","esp32.blocks.textLowerCase":"小寫","esp32.blocks.textUpperCase":"大寫","esp32.blocks.textTrim":"清除 %1 前後空白字符","esp32.blocks.textConvert":"將 %1 轉為 %2","esp32.blocks.textConvertFrom":"將 %1 轉為文本","esp32.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","esp32.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","esp32.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","esp32.blocks.wifiScan":"開始掃描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemMac":"MAC","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密類型","esp32.blocks.wifiCounts":"可用 Wi-Fi 數量","esp32.blocks.startap":"開啟 AP SSID: %1","esp32.blocks.stopap":"關閉 AP","esp32.blocks.espnowBroadcast":"ESP-Now 廣播 %1","esp32.blocks.espnowSend":"ESP-Now 發送 %1 給 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"消息","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"當 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 寫入 %2","esp32.blocks.spiRead":"SPI %1 讀取 %2 位元組","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","esp32.blocks.i2cScan":"I2C掃描設備","esp32.blocks.i2cWrite":"I2C寫入到 %1:%2","esp32.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"終端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.terminalEval":"執行 %1","esp32.blocks.temperature":"温度","esp32.blocks.turnon":"開啟","esp32.blocks.turnoff":"關閉","esp32.blocks.camera":"攝像頭","esp32.blocks.cameraCapture":"拍攝","esp32.blocks.cameraFlashlamp":"閃光燈 %1","esp32.blocks.cameraFlip":"上下翻轉 %1","esp32.blocks.cameraMirror":"左右鏡像 %1","esp32.blocks.cameraEffect":"將特效設為 %1","esp32.blocks.cameraFramesize":"將分辨率設為 %1","esp32.blocks.cameraFormat":"將圖片格式設為 %1","esp32.blocks.cameraQuality":"將圖片質量設為 %1","esp32.blocks.cameraContrast":"將對比度設為 %1","esp32.blocks.cameraSaturation":"將飽和度設為 %1","esp32.blocks.cameraBrightness":"將亮度設為 %1","esp32.blocks.cameraWhiteBalance":"將白平衡設為 %1","esp32.blocks.cameraFramesize96X96":"96×96","esp32.blocks.cameraFramesizeQQVGA":"160×120","esp32.blocks.cameraFramesizeQCIF":"176×144","esp32.blocks.cameraFramesizeHQVGA":"240×160","esp32.blocks.cameraFramesize240X240":"240×240","esp32.blocks.cameraFramesizeQVGA":"320×240","esp32.blocks.cameraFramesizeCIF":"352×288","esp32.blocks.cameraFramesizeHVGA":"480×320","esp32.blocks.cameraFramesizeVGA":"640×480","esp32.blocks.cameraFramesizeSVGA":"800×600","esp32.blocks.cameraFramesizeXGA":"1024×768","esp32.blocks.cameraFramesizeHD":"1280×720","esp32.blocks.cameraFramesizeSXGA":"1280×1024","esp32.blocks.cameraFramesizeUXGA":"1900×1200","esp32.blocks.cameraFramesizeFHD":"1920×1080","esp32.blocks.cameraFramesizePHD":"2560×1440","esp32.blocks.cameraFramesizeP3MP":"2048×1536","esp32.blocks.cameraFramesizeQXGA":"2048×1536","esp32.blocks.cameraFramesizeQHD":"2560×1440","esp32.blocks.cameraFramesizeWQXGA":"2560×1600","esp32.blocks.cameraFramesizePFHD":"2560×1600","esp32.blocks.cameraFramesizeQSXGA":"2560×2048","esp32.blocks.cameraFormatJPEG":"JPEG","esp32.blocks.cameraFormatYUV422":"YUV422","esp32.blocks.cameraFormatRGB565":"RGB565","esp32.blocks.cameraFormatGrayscale":"灰度","esp32.blocks.cameraEffectNone":"原圖","esp32.blocks.cameraEffectNegative":"負片","esp32.blocks.cameraEffectGrayscale":"灰度","esp32.blocks.cameraEffectSepia":"棕褐色","esp32.blocks.cameraEffectRed":"紅色","esp32.blocks.cameraEffectGreen":"綠色","esp32.blocks.cameraEffectBlue":"藍色","esp32.blocks.cameraEffectAntique":"復古","esp32.blocks.cameraEffectSketch":"素描","esp32.blocks.cameraEffectSolarize":"日光","esp32.blocks.cameraEffectPosterize":"海報","esp32.blocks.cameraEffectWhiteboard":"白板","esp32.blocks.cameraEffectBlackboard":"黑板","esp32.blocks.cameraEffectAqua":"水晶","esp32.blocks.cameraWBNone":"原始","esp32.blocks.cameraWBSunny":"晴天","esp32.blocks.cameraWBCloudy":"陰天","esp32.blocks.cameraWBOffice":"辦公室","esp32.blocks.cameraWBHome":"家中"};ps({en:fe,"zh-Hans":Ee,"zh-Hant":Re});import{svgAsDataUri as nt}from"@blockcode/utils";import{ScratchBlocks as H,blocksTab as lt,codeReviewTab as pt}from"@blockcode/blocks";import{terminalTab as mt}from"@blockcode/code";function T(e){if(typeof e!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function he(e,s){var t="",i=0,a=-1,o=0,c;for(var r=0;r<=e.length;++r){if(r<e.length)c=e.charCodeAt(r);else if(c===47)break;else c=47;if(c===47){if(a===r-1||o===1);else if(a!==r-1&&o===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){if(l===-1)t="",i=0;else t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/");a=r,o=0;continue}}else if(t.length===2||t.length===1){t="",i=0,a=r,o=0;continue}}if(s){if(t.length>0)t+="/..";else t="..";i=2}}else{if(t.length>0)t+="/"+e.slice(a+1,r);else t=e.slice(a+1,r);i=r-a-1}a=r,o=0}else if(c===46&&o!==-1)++o;else o=-1}return t}function ms(e,s){var t=s.dir||s.root,i=s.base||(s.name||"")+(s.ext||"");if(!t)return i;if(t===s.root)return t+i;return t+e+i}function j(){var e="",s=!1,t;for(var i=arguments.length-1;i>=-1&&!s;i--){var a;if(i>=0)a=arguments[i];else{if(t===void 0)t=process.cwd();a=t}if(T(a),a.length===0)continue;e=a+"/"+e,s=a.charCodeAt(0)===47}if(e=he(e,!s),s)if(e.length>0)return"/"+e;else return"/";else if(e.length>0)return e;else return"."}function ge(e){if(T(e),e.length===0)return".";var s=e.charCodeAt(0)===47,t=e.charCodeAt(e.length-1)===47;if(e=he(e,!s),e.length===0&&!s)e=".";if(e.length>0&&t)e+="/";if(s)return"/"+e;return e}function us(e){return T(e),e.length>0&&e.charCodeAt(0)===47}function ds(){if(arguments.length===0)return".";var e;for(var s=0;s<arguments.length;++s){var t=arguments[s];if(T(t),t.length>0)if(e===void 0)e=t;else e+="/"+t}if(e===void 0)return".";return ge(e)}function bs(e,s){if(T(e),T(s),e===s)return"";if(e=j(e),s=j(s),e===s)return"";var t=1;for(;t<e.length;++t)if(e.charCodeAt(t)!==47)break;var i=e.length,a=i-t,o=1;for(;o<s.length;++o)if(s.charCodeAt(o)!==47)break;var c=s.length,r=c-o,l=a<r?a:r,p=-1,u=0;for(;u<=l;++u){if(u===l){if(r>l){if(s.charCodeAt(o+u)===47)return s.slice(o+u+1);else if(u===0)return s.slice(o+u)}else if(a>l){if(e.charCodeAt(t+u)===47)p=u;else if(u===0)p=0}break}var d=e.charCodeAt(t+u),M=s.charCodeAt(o+u);if(d!==M)break;else if(d===47)p=u}var F="";for(u=t+p+1;u<=i;++u)if(u===i||e.charCodeAt(u)===47)if(F.length===0)F+="..";else F+="/..";if(F.length>0)return F+s.slice(o+p);else{if(o+=p,s.charCodeAt(o)===47)++o;return s.slice(o)}}function ks(e){return e}function fs(e){if(T(e),e.length===0)return".";var s=e.charCodeAt(0),t=s===47,i=-1,a=!0;for(var o=e.length-1;o>=1;--o)if(s=e.charCodeAt(o),s===47){if(!a){i=o;break}}else a=!1;if(i===-1)return t?"/":".";if(t&&i===1)return"//";return e.slice(0,i)}function ee(e,s){if(s!==void 0&&typeof s!=="string")throw TypeError('"ext" argument must be a string');T(e);var t=0,i=-1,a=!0,o;if(s!==void 0&&s.length>0&&s.length<=e.length){if(s.length===e.length&&s===e)return"";var c=s.length-1,r=-1;for(o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!a){t=o+1;break}}else{if(r===-1)a=!1,r=o+1;if(c>=0)if(l===s.charCodeAt(c)){if(--c===-1)i=o}else c=-1,i=r}}if(t===i)i=r;else if(i===-1)i=e.length;return e.slice(t,i)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!a){t=o+1;break}}else if(i===-1)a=!1,i=o+1;if(i===-1)return"";return e.slice(t,i)}}function se(e){T(e);var s=-1,t=0,i=-1,a=!0,o=0;for(var c=e.length-1;c>=0;--c){var r=e.charCodeAt(c);if(r===47){if(!a){t=c+1;break}continue}if(i===-1)a=!1,i=c+1;if(r===46){if(s===-1)s=c;else if(o!==1)o=1}else if(s!==-1)o=-1}if(s===-1||i===-1||o===0||o===1&&s===i-1&&s===t+1)return"";return e.slice(s,i)}function Es(e){if(e===null||typeof e!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return ms("/",e)}function Rs(e){T(e);var s={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return s;var t=e.charCodeAt(0),i=t===47,a;if(i)s.root="/",a=1;else a=0;var o=-1,c=0,r=-1,l=!0,p=e.length-1,u=0;for(;p>=a;--p){if(t=e.charCodeAt(p),t===47){if(!l){c=p+1;break}continue}if(r===-1)l=!1,r=p+1;if(t===46){if(o===-1)o=p;else if(u!==1)u=1}else if(o!==-1)u=-1}if(o===-1||r===-1||u===0||u===1&&o===r-1&&o===c+1){if(r!==-1)if(c===0&&i)s.base=s.name=e.slice(1,r);else s.base=s.name=e.slice(c,r)}else{if(c===0&&i)s.name=e.slice(1,o),s.base=e.slice(1,r);else s.name=e.slice(c,o),s.base=e.slice(c,r);s.ext=e.slice(o,r)}if(c>0)s.dir=e.slice(0,c-1);else if(i)s.dir="/";return s}var hs="/",gs=":",ht=((e)=>(e.posix=e,e))({resolve:j,normalize:ge,isAbsolute:us,join:ds,relative:bs,_makeLong:ks,dirname:fs,basename:ee,extname:se,format:Es,parse:Rs,sep:hs,delimiter:gs,win32:null,posix:null});import{useCallback as ye}from"preact/hooks";import{useAppContext as Cs,useProjectContext as Ss}from"@blockcode/core";import{MicroPythonGenerator as Ns,BlocksEditor as vs}from"@blockcode/blocks";import{translate as k,themeColors as te}from"@blockcode/core";import{keyMirror as _s}from"@blockcode/utils";var m=_s({ESP32:null,ESP32S2:null,ESP32S3:null,ESP32C3:null,ESP32C5:null,ESP32C6:null,ESP32_IOT_BOARD:null,ESP32S3_CAM:null,ATOMS3R_CAM:null});var _e=(e)=>{let s=[m.ESP32,m.ESP32_IOT_BOARD].includes(e),t=s?"ESP32_PINS":"ESP32S3_PINS",i=s?"ESP32_OUT_PINS":"ESP32S3_PINS",a=s?"ESP32_ADC_PINS":"ESP32S3_ADC_PINS";return{id:"pin",name:k("esp32.blocks.pin","Pins"),themeColor:te.blocks.motion.primary,inputColor:te.blocks.motion.secondary,otherColor:te.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:k("esp32.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:t},MODE:{menu:[[k("esp32.blocks.ouputMode","output"),"OUTPUT"],[k("esp32.blocks.inputMode","input"),"INPUT"],[k("esp32.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[k("esp32.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=o.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let p="";if(l==="INPUT")p=`${r} = Pin(${c}, Pin.IN)`;else if(l==="INPUT_PULLUP")p=`${r} = Pin(${c}, Pin.IN, Pin.PULL_UP)`;else if(l==="INPUT_PULLDOWN")p=`${r} = Pin(${c}, Pin.IN, Pin.PULL_DOWN)`;else p=`${r} = Pin(${c}, Pin.OUT)`;return this.definitions_[r]=p,""}},"---",{id:"setdigital",text:k("esp32.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:i},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[k("esp32.blocks.digitalHigh","high"),"1"],[k("esp32.blocks.digitalLow","low"),"0"]]}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=this.definitions_[r]??`${r} = Pin(${c}, Pin.OUT)`,`${r}.value(${l})
`}},...e===m.ESP32_IOT_BOARD||e===m.ESP32?[{id:"setDAC",text:k("esp32.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:"ESP32_DAC_PINS"},VALUE:{shadow:"slider255"}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[r]=`${r} = DAC(Pin(${c}))`,`${r}.write(${l})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(o){return[o.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}}]:[],{id:"digital",text:k("esp32.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:t}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=`${r} = Pin(${c}, Pin.IN)`,[`(${r}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:k("esp32.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:a}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[r]=`${r} = ADC(Pin(${c}))`,this.definitions_[`${r}_atten`]=`${r}.atten(ADC.ATTN_11DB)`,this.definitions_[`${r}_width`]=`${r}.width(ADC.WIDTH_10BIT)`,[`${r}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:k("esp32.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:i},FREQ:{type:"integer",defaultValue:"1000"}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=this.valueToCode(o,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[r]=`${r} = PWM(Pin(${c}), freq=1000)`,`${r}.freq(${l})
`}},{id:"setPWM",text:k("esp32.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:i},VALUE:{shadow:"slider1023"}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=this.valueToCode(o,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[r]=`${r} = PWM(Pin(${c}), freq=1000)`,`${r}.duty(${l})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(o){return[o.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:k("esp32.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:t},INTERRUPT:{menu:[[k("esp32.blocks.interruptRising","rising"),"RISING"],[k("esp32.blocks.interruptFalling","falling"),"FALLING"],[k("esp32.blocks.interruptChange","change"),"CHANGE"],[k("esp32.blocks.interruptHigh","high"),"HIGH"],[k("esp32.blocks.interruptLow","low"),"LOW"]]}},mpy(o){let c=o.getFieldValue("PIN")||0,r=`pin_${c}`,l=`interrupt_${c}_flag`,p=o.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[r]=this.definitions_[r]??`${r} = Pin(${c}, Pin.IN)`,this.definitions_[l]=`${l} = asyncio.ThreadSafeFlag()`;let u=this.statementToCode(o,"SUBSTACK")||this.PASS,d="";d+=`while True:
`,d+=`${this.INDENT}await ${l}.wait()
`,d+=u,u=this.prefixLines(d,this.INDENT),u=this.addEventTrap(u,o.id),d=`@_tasks__.append
`,d+=u,this.definitions_[`interrupt_${c}`]=d;let F={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[p]||"Pin.IRQ_RISING";return`${r}.irq(trigger=${F}, handler=lambda _: ${l}.set())
`}},{id:"detachinterrupt",text:k("esp32.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:t}},mpy(o){return`pin_${o.getFieldValue("PIN")||0}.irq(handler=None)
`}}],menus:{ESP32_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["39","39"]]},ESP32S3_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"],["21","21"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"],["40","40"],["41","41"],["42","42"],["43","43"],["44","44"],["45","45"],["46","46"],["47","47"],["48","48"]]},ESP32_OUT_PINS:{items:[["0","0"],["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["21","21"],["22","22"],["23","23"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"]]},ESP32_ADC_PINS:{items:[["0","0"],["2","2"],["4","4"],["12","12"],["13","13"],["14","14"],["15","15"],["25","25"],["26","26"],["27","27"],["32","32"],["33","33"],["34","34"],["35","35"],["36","36"],["37","37"],["38","38"],["39","39"]]},ESP32S3_ADC_PINS:{items:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["14","14"],["15","15"],["16","16"],["17","17"],["18","18"],["19","19"],["20","20"]]},ESP32_DAC_PINS:{items:[["25","25"],["26","26"]]}}}};import{translate as n,themeColors as ie}from"@blockcode/core";var Oe=(e,s)=>({id:"camera",name:n("esp32.blocks.camera","Camera"),themeColor:ie.blocks.looks.primary,inputColor:ie.blocks.looks.secondary,otherColor:ie.blocks.looks.tertiary,order:s,blocks:[{id:"capture",text:n("esp32.blocks.cameraCapture","capture"),output:"raw",mpy(t){return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",["camera.capture()",this.ORDER_FUNCTION_CALL]}},"---",e===m.ESP32S3_CAM&&{id:"flashlamp",text:n("esp32.blocks.cameraFlashlamp","flashlamp %1"),inputs:{STATUS:{menu:"Status"}},mpy(t){let i=this.valueToCode(t,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.flashlamp(${i})
`}},{id:"effect",text:n("esp32.blocks.cameraEffect","set effect to %1"),inputs:{EFFECT:{menu:"Effect"}},mpy(t){let i=t.getFieldValue("EFFECT")||"EFFECT_NONE";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.speffect(camera.${i})
`}},{id:"flip",text:n("esp32.blocks.cameraFlip","flip %1"),inputs:{STATUS:{menu:"Status"}},mpy(t){let i=this.valueToCode(t,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.flip(${i})
`}},{id:"mirror",text:n("esp32.blocks.cameraMirror","mirror %1"),inputs:{STATUS:{menu:"Status"}},mpy(t){let i=this.valueToCode(t,"STATUS",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.mirror(${i})
`}},"---",{id:"framesize",text:n("esp32.blocks.cameraFramesize","set framesize to %1"),inputs:{FRAMESIZE:{menu:"Framesize"}},mpy(t){let i=t.getFieldValue("FRAMESIZE")||"FRAME_VGA";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.framesize(camera.${i})
`}},{id:"format",text:n("esp32.blocks.cameraFormat","set picture format to %1"),inputs:{FORMAT:{menu:"Format"}},mpy(t){let i=t.getFieldValue("FORMAT")||"JPEG";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=`camera.init(format=camera.${i})`,""}},{id:"quality",text:n("esp32.blocks.cameraQuality","set picture quality to %1"),inputs:{RANGE:{shadow:"rangeQuality"}},mpy(t){let i=this.valueToCode(t,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.quality(${i})
`}},{id:"contrast",text:n("esp32.blocks.cameraContrast","set contrast to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(t){let i=this.valueToCode(t,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.contrast(${i})
`}},{id:"saturation",text:n("esp32.blocks.cameraSaturation","set saturation to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(t){let i=this.valueToCode(t,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.saturation(${i})
`}},{id:"brightness",text:n("esp32.blocks.cameraBrightness","set brightness to %1"),inputs:{RANGE:{shadow:"range22"}},mpy(t){let i=this.valueToCode(t,"RANGE",this.ORDER_NONE);return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.brightness(${i})
`}},{id:"whitebalance",text:n("esp32.blocks.cameraWhiteBalance","set white balance to %1"),inputs:{WB:{menu:"WhiteBalance"}},mpy(t){let i=t.getFieldValue("WB")||"WB_NONE";return this.definitions_.import_camera="import camera",this.definitions_.camera_init=this.definitions_.camera_init??"camera.init()",`camera.whitebalance(camera.${i})
`}},{id:"range22",shadow:!0,output:"number",inputs:{RANGE:{type:"slider",defaultValue:0,min:-2,max:2}},mpy(t){return[t.getFieldValue("RANGE")||0,this.ORDER_NONE]}},{id:"rangeQuality",shadow:!0,output:"number",inputs:{RANGE:{type:"slider",defaultValue:12,min:0,max:63}},mpy(t){return[t.getFieldValue("RANGE")||12,this.ORDER_NONE]}}].filter(Boolean),menus:{Status:{inputMode:!0,defaultValue:"1",type:"integer",items:[[n("esp32.blocks.turnon","on"),"1"],[n("esp32.blocks.turnoff","off"),"0"]]},Effect:{items:[[n("esp32.blocks.cameraEffectNone","none"),"EFFECT_NONE"],[n("esp32.blocks.cameraEffectNegative","negative"),"EFFECT_NEGATIVE"],[n("esp32.blocks.cameraEffectGrayscale","grayscale"),"EFFECT_GRAYSCALE"],[n("esp32.blocks.cameraEffectSepia","sepia"),"EFFECT_SEPIA"],[n("esp32.blocks.cameraEffectRed","red"),"EFFECT_RED"],[n("esp32.blocks.cameraEffectGreen","green"),"EFFECT_GREEN"],[n("esp32.blocks.cameraEffectBlue","blue"),"EFFECT_BLUE"],[n("esp32.blocks.cameraEffectAntique","antique"),"EFFECT_ANTIQUE"],[n("esp32.blocks.cameraEffectSketch","sketch"),"EFFECT_SKETCH"],[n("esp32.blocks.cameraEffectSolarize","solarize"),"EFFECT_SOLARIZE"],[n("esp32.blocks.cameraEffectPosterize","posterize"),"EFFECT_POSTERIZE"],[n("esp32.blocks.cameraEffectWhiteboard","whiteboard"),"EFFECT_WHITEBOARD"],[n("esp32.blocks.cameraEffectBlackboard","blackboard"),"EFFECT_BLACKBOARD"],[n("esp32.blocks.cameraEffectAqua","aqua"),"EFFECT_AQUA"]]},Framesize:{items:[[n("esp32.blocks.cameraFramesize96X96","96×96"),"FRAME_96X96"],[n("esp32.blocks.cameraFramesizeQQVGA","160×120"),"FRAME_QQVGA"],[n("esp32.blocks.cameraFramesizeQCIF","176×144"),"FRAME_QCIF"],[n("esp32.blocks.cameraFramesizeHQVGA","240×160"),"FRAME_HQVGA"],[n("esp32.blocks.cameraFramesize240X240","240×240"),"FRAME_240X240"],[n("esp32.blocks.cameraFramesizeQVGA","320×240"),"FRAME_QVGA"],[n("esp32.blocks.cameraFramesizeCIF","352×288"),"FRAME_CIF"],[n("esp32.blocks.cameraFramesizeHVGA","480×320"),"FRAME_HVGA"],[n("esp32.blocks.cameraFramesizeVGA","640×480"),"FRAME_VGA"],[n("esp32.blocks.cameraFramesizeSVGA","800×600"),"FRAME_SVGA"],[n("esp32.blocks.cameraFramesizeXGA","1024×768"),"FRAME_XGA"],[n("esp32.blocks.cameraFramesizeHD","1280×720"),"FRAME_HD"],[n("esp32.blocks.cameraFramesizeSXGA","1280×1024"),"FRAME_SXGA"],[n("esp32.blocks.cameraFramesizeUXGA","1900×1200"),"FRAME_UXGA"],[n("esp32.blocks.cameraFramesizeFHD","1920×1080"),"FRAME_FHD"],[n("esp32.blocks.cameraFramesizePHD","2560×1440"),"FRAME_P_HD"],[n("esp32.blocks.cameraFramesizeP3MP","2048×1536"),"FRAME_P_3MP"],[n("esp32.blocks.cameraFramesizeQXGA","2048×1536"),"FRAME_QXGA"],[n("esp32.blocks.cameraFramesizeQHD","2560×1440"),"FRAME_QHD"],[n("esp32.blocks.cameraFramesizeWQXGA","2560×1600"),"FRAME_WQXGA"],[n("esp32.blocks.cameraFramesizePFHD","2560×1600"),"FRAME_P_FHD"],[n("esp32.blocks.cameraFramesizeQSXGA","2560×2048"),"FRAME_QSXGA"]]},Format:{items:[[n("esp32.blocks.cameraFormatJPEG","JPEG"),"JPEG"],[n("esp32.blocks.cameraFormatYUV422","YUV422"),"YUV422"],[n("esp32.blocks.cameraFormatRGB565","RGB565"),"RGB565"],[n("esp32.blocks.cameraFormatGrayscale","Grayscale"),"GRAYSCALE"]]},WhiteBalance:{items:[[n("esp32.blocks.cameraWBNone","none"),"WB_NONE"],[n("esp32.blocks.cameraWBSunny","sunny"),"WB_SUNNY"],[n("esp32.blocks.cameraWBCloudy","cloudy"),"WB_CLOUDY"],[n("esp32.blocks.cameraWBOffice","office"),"WB_OFFICE"],[n("esp32.blocks.cameraWBHome","home"),"WB_HOME"]]}}});import{translate as C,themeColors as oe}from"@blockcode/core";var Ae=(e)=>{let s=C("esp32.menubar.device.esp32","ESP32");switch(e){case m.ESP32S3:s=C("esp32.menubar.device.esp32s3","ESP32-S3");break;case m.ESP32C3:s=C("esp32.menubar.device.esp32c3","ESP32-C3");break;case m.ESP32_IOT_BOARD:s=C("esp32.menubar.device.esp32IotBoard","ESP32 IOT Board");break;case m.ESP32S3_CAM:s=C("esp32.menubar.device.esp32s3Cam","ESP32S3 CAM");break;case m.ATOMS3R_CAM:s=C("esp32.menubar.device.atomS3rCam","AtomS3R CAM");break}let t=["1","2","3","4"];return{id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:oe.blocks.events.primary,inputColor:oe.blocks.events.secondary,otherColor:oe.blocks.events.tertiary,blocks:[{id:"whenstart",text:C("esp32.blocks.whenstart","when {name} start",{name:s}),hat:!0,mpy(i){let a=this.statementToCode(i)||this.PASS;a=this.addEventTrap(a,i.id);let o="";return o+=`@_tasks__.append
`,o+=a,o}},"---",{id:"timerset",text:C("esp32.blocks.timerset","set timer # %1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:t},PERIOD:{type:"integer",defaultValue:500}},mpy(i){let a=this.valueToCode(i,"PERIOD",this.ORDER_NONE)||500,o=parseInt(i.getFieldValue("ID")||"1",10)-1;if(o<0)o=0;let c=`timer_${o}`,r=`period_${o}_flag`;this.definitions_.import_timer="from machine import Timer",this.definitions_[c]=`${c} = Timer(${o})`,this.definitions_[r]=`${r} = asyncio.ThreadSafeFlag()`;let l=this.statementToCode(i,"SUBSTACK")||this.PASS,p="";return p+=`while True:
`,p+=`${this.INDENT}await ${r}.wait()
`,p+=l,l=this.prefixLines(p,this.INDENT),l=this.addEventTrap(l,i.id),p=`@_tasks__.append
`,p+=l,this.definitions_[`period_${o}`]=p,`${c}.init(mode=Timer.PERIODIC, period=${a}, callback=lambda _: ${r}.set())
`}},{id:"timeroff",text:C("esp32.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:t}},mpy(i){let a=parseInt(i.getFieldValue("ID")||"1",10)-1;if(a<0)a=0;return`timer_${a}.deinit()
`}}]}};import{translate as w,themeColors as ae}from"@blockcode/core";import{ScratchBlocks as z}from"@blockcode/blocks";var Te=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:ae.blocks.control.primary,inputColor:ae.blocks.control.secondary,otherColor:ae.blocks.control.tertiary,blocks:[{id:"wait",text:w("esp32.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(e){return`await asyncio.sleep_ms(${this.valueToCode(e,"MS",this.ORDER_NONE)})
`}},{id:"forever",text:z.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:z.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:z.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:w("esp32.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(e){let s=this.valueToCode(e,"CONDITION",this.ORDER_NONE)||"False",t=this.statementToCode(e,"SUBSTACK")||this.PASS,i="";return i+=`elif ${s}:
`,i+=t,i}},{id:"else",text:w("esp32.blocks.else","else"),substack:!0,mpy(e){let s=this.statementToCode(e,"SUBSTACK")||this.PASS,t="";return t+=`else:
`,t+=s,t}},"---",{id:"repeat_until",text:z.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:z.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:w("esp32.blocks.continue","continue"),end:!0,mpy(e){return`continue
`}},{id:"break",text:w("esp32.blocks.break","break"),end:!0,mpy(e){return`break
`}}]});import{translate as f,themeColors as Lt}from"@blockcode/core";var E="";E+=`async def espnow_asend(msg, mac="ff:ff:ff:ff:ff:ff"):
`;E+=`  chuck_size = 250
`;E+=`  msg_data = msg if type(msg) is bytes else str(msg).encode()
`;E+=`  size = len(msg_data)
`;E+=`  if size > chuck_size:
`;E+=`    chucks_count = 1 + size // chuck_size
`;E+=`    for i in range(chucks_count):
`;E+=`      n = i * chuck_size
`;E+=`      m = (i + 1) * chuck_size
`;E+=`      data = msg_data[n:m] if m <= size else msg_data[n:]
`;E+=`      await espnow_asend(data, mac)
`;E+=`    return
`;E+=`  mac_addr = bytes.fromhex(mac.replace(":", "")) if type(mac) is str else mac
`;E+=`  try:
`;E+=`    await espnow.asend(mac_addr, msg_data)
`;E+=`  except OSError as err:
`;E+=`    if len(err.args) > 1 and err.args[1] == "ESP_ERR_ESPNOW_NOT_FOUND":
`;E+=`      espnow.add_peer(mac_addr)
`;E+=`      await espnow.asend(mac_addr, msg_data)
`;var Ce=(e)=>({id:"network",name:f("esp32.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:e,blocks:[{id:"connectwifi",text:f("esp32.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"esp32"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(s){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let t=this.valueToCode(s,"SSID",this.ORDER_NONE),i=this.valueToCode(s,"PASSWORD",this.ORDER_NONE);t=isNaN(t)?t:this.quote_(t),i=isNaN(i)?i:this.quote_(i);let a="";return a+="if not wlan.isconnected(): threading.start_new_thread(",a+=`lambda: wlan.connect(${t}, ${i}), ())
`,a+="while wlan.active() and not wlan.isconnected(): ",a+=`await asyncio.sleep_ms(500)
`,a}},{id:"disconnect",text:f("esp32.blocks.disconnectWifi","disconnect wifi"),mpy(s){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let t="";return t+=`wlan.disconnect()
`,t+=`wlan.active(False)
`,t}},{id:"isconnected",text:f("esp32.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(s){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"wifiscan",text:f("esp32.blocks.wifiScan","start scan wifi"),mpy(s){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let t="";return t+="threading.start_new_thread(",t+=`lambda: wifi_list.extend(wlan.scan()), ())
`,t}},{id:"wifiitem",text:f("esp32.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[f("esp32.blocks.wifiItemSsid","ssid"),"SSID"],[f("esp32.blocks.wifiItemMac","mac"),"MAC"],[f("esp32.blocks.wifiItemRssi","rssi"),"RSSI"],[f("esp32.blocks.wifiItemSecurity","security"),"SECURITY"]]}},mpy(s){let t=this.getAdjusted(s,"INDEX")||0,i=s.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let a=`wifi_list[${t}]`;switch(i){case"MAC":a+="[1]";break;case"RSSI":a+="[3]";break;case"SECURITY":a+="[4]";break;default:a+="[0]";break}return[a,this.ORDER_ATOMIC]}},{id:"wificounts",text:f("esp32.blocks.wifiCounts","available wifi counts"),output:"number",mpy(s){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},"---",{id:"startap",text:f("esp32.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(s){let t=this.valueToCode(s,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let i="";return i+=`ap.config(ssid=${t})
`,i+=`ap.active(True)
`,i}},{id:"stopap",text:f("esp32.blocks.stopap","stop ap"),mpy(s){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:f("esp32.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(s){let t=this.valueToCode(s,"MESSAGE",this.ORDER_NONE),i=this.valueToCode(s,"MAC",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=E,`await espnow_asend(${t}, ${i})
`}},{id:"espnowbroadcast",text:f("esp32.blocks.espnowBroadcast","broadcast %1 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"}},mpy(s){let t=this.valueToCode(s,"MESSAGE",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=E,`await espnow_asend(${t})
`}},{id:"espnowmsg",text:f("esp32.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[f("esp32.blocks.espnowMsgText","message"),"MESSAGE"],[f("esp32.blocks.espnowMsgMac","mac address"),"MAC"]]}},mpy(s){let t=s.getFieldValue("TYPE")||"MESSAGE";return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",[t==="MAC"?'peer.hex(":")':"msg.decode()",this.ORDER_FUNCTION_CALL]}},"---",{id:"espnowwhen",text:f("esp32.blocks.espnowWhen","when esp-now receive %1"),hat:!0,inputs:{MSG:{type:"string",defaultValue:f("esp32.blocks.espnowMsgText","message")}},mpy(s){let t=this.valueToCode(s,"MSG",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let i=`${this.getFunctionName(s.id)}_flag`;if(this.definitions_[i]=`${i} = asyncio.ThreadSafeFlag()`,!this.definitions_.espnowwhen){let c="";c+=`@_tasks__.append
`,c+=`async def espnow_when():
`,c+=`  async for peer, msg in espnow:
`,this.definitions_.espnowwhen=c}this.definitions_.espnowwhen+=`    if msg.decode() == ${t}: ${i}.set()
`;let a=this.statementToCode(s)||this.PASS,o="";return o+=`while True:
`,o+=`  await ${i}.wait()
`,o+=a,a=this.prefixLines(o,this.INDENT),a=this.addEventTrap(a,s.id),o=`@_tasks__.append
`,o+=a,o}},{id:"espnowrepeat",text:f("esp32.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(s){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let t=this.statementToCode(s,"SUBSTACK")||this.PASS;t=this.addLoopTrap(t,s.id);let i="";return i+=`async for peer, msg in espnow:
`,i+=t,i}}]});import{translate as Os,themeColors as re}from"@blockcode/core";var Se=(e)=>({id:"protocol",name:Os("esp32.blocks.protocols","Protocols"),themeColor:re.blocks.sounds.primary,inputColor:re.blocks.sounds.secondary,otherColor:re.blocks.sounds.tertiary,order:e,blocks:[]});import{translate as R,themeColors as ce}from"@blockcode/core";import{ScratchBlocks as b}from"@blockcode/blocks";var Ne=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:ce.blocks.operators.primary,inputColor:ce.blocks.operators.secondary,otherColor:ce.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||"+",a={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${s} ${i} ${t})`,a[i]]}},"---",{id:"random",text:b.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(e){this.definitions_.import_random="import random";let s=this.valueToCode(e,"FROM",this.ORDER_NONE),t=this.valueToCode(e,"TO",this.ORDER_NONE);return[`random.randint(${s}, ${t})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||">",a={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${s} ${i} ${t})`,a[i]]}},"---",{id:"and",text:b.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let s=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),t=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${s} and ${t})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:b.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(e){let s=this.valueToCode(e,"OPERAND1",this.ORDER_NONE),t=this.valueToCode(e,"OPERAND2",this.ORDER_NONE);return[`(${s} or ${t})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:b.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(e){return[`(not ${this.valueToCode(e,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE),i=e.getFieldValue("SYMBOL")||"&",a={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${s} ${i} ${t})`,a[i]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(e){return[`(~${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:R("esp32.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`max(${s}, ${t})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:R("esp32.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`min(${s}, ${t})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:b.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(e){let s=this.valueToCode(e,"NUM1",this.ORDER_NONE),t=this.valueToCode(e,"NUM2",this.ORDER_NONE);return[`(${s} % ${t})`,this.ORDER_MODULUS]}},{id:"round",text:b.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(e){return this.definitions_.import_math="import math",[`round(${this.valueToCode(e,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:b.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[b.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[b.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[b.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[b.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[b.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[b.Msg.OPERATORS_MATHOP_COS,"math.cos"],[b.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[b.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[b.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[b.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[b.Msg.OPERATORS_MATHOP_LN,"math.log"],[b.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[b.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[b.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(e){this.definitions_.import_math="import math";let s=e.getFieldValue("OPERATOR")||"abs",t=this.valueToCode(e,"NUM",this.ORDER_NONE),i="";if(s==="pow10")i+=`math.pow(10, ${t})`;else i+=`${s}(${t})`;return[i,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:R("esp32.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(e){let s=this.valueToCode(e,"DATA",this.ORDER_NONE),t=this.valueToCode(e,"FROM",this.ORDER_NONE),i=this.valueToCode(e,"TO",this.ORDER_NONE);return[`min(max(${s}, ${t}), ${i})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:R("esp32.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(e){let s=this.valueToCode(e,"DATA",this.ORDER_NONE),t=this.valueToCode(e,"FROMLOW",this.ORDER_NONE),i=this.valueToCode(e,"FROMHIGH",this.ORDER_NONE),a=this.valueToCode(e,"TOLOW",this.ORDER_NONE),o=this.valueToCode(e,"TOHIGHT",this.ORDER_NONE);return[`(${s} - ${t}) * (${o} - ${a}) // (${i} - ${t}) + ${a}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:R("esp32.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(e){return[`len(${this.valueToCode(e,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"join",text:b.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE),t=this.valueToCode(e,"STRING2",this.ORDER_NONE);return[`(${s} + ${t})`,this.ORDER_ADDITION]}},{id:"letter_of",text:b.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"esp32"}},mpy(e){let s=this.getAdjusted(e,"LETTER");return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}[${s}]`,this.ORDER_FUNCTION_CALL]}},{id:"replace",text:R("esp32.blocks.textReplace","replace %1 of %2 with %3"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"},STRING3:{type:"string",defaultValue:"The E"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE),t=this.valueToCode(e,"STRING2",this.ORDER_NONE),i=this.valueToCode(e,"STRING3",this.ORDER_NONE);return[`${t}.replace(${s}, ${i})
`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:R("esp32.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(e){let s=this.getAdjusted(e,"FROM"),t=this.valueToCode(e,"TO",this.ORDER_NONE);return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}[${s}:${t}]`,this.ORDER_FUNCTION_CALL]}},{id:"find",text:R("esp32.blocks.textFind","find %1 of %2 place"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"esp32"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(e,"STRING2",this.ORDER_NONE)}.find(${s}) + 1)
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:b.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"e"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(e,"STRING2",this.ORDER_NONE)} in ${s})`,this.ORDER_EQUALITY]}},{id:"with",text:R("esp32.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},WITH:{type:"string",menu:[[R("esp32.blocks.textStartsWith","starts"),"START"],[R("esp32.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE),t=this.valueToCode(e,"STRING2",this.ORDER_NONE),a=(e.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${s}.${a}(${t})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:R("esp32.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"esp32"},STRING2:{type:"string",defaultValue:"ESP32"}},mpy(e){let s=this.valueToCode(e,"STRING1",this.ORDER_NONE),t=this.valueToCode(e,"STRING2",this.ORDER_NONE);return[`${s}.lower() == ${t}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:R("esp32.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[R("esp32.blocks.textLowerCase","lower"),"LOWER"],[R("esp32.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"ESP32"}},mpy(e){let s=e.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}.${s==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:R("esp32.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"esp32"}},mpy(e){return[`${this.valueToCode(e,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:R("esp32.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[R("esp32.blocks.dataConvert.int","int"),"int"],[R("esp32.blocks.dataConvert.float","float"),"float"],[R("esp32.blocks.dataConvert.string","str"),"str"],[R("esp32.blocks.dataConvert.list","list"),"list"]]}},mpy(e){let s=this.valueToCode(e,"DATA",this.ORDER_NONE);return[`${e.getFieldValue("TYPE")||"int"}(${s})`,this.ORDER_FUNCTION_CALL]}}]});var ve=()=>({id:"data",skipXML:!0,blocks:[{id:"variable",mpy(e){return[this.getVariableName(e.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"setvariableto",mpy(e){let s=this.getVariableName(e.getFieldValue("VARIABLE")),t=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${s} = ${t}
`}},{id:"changevariableby",mpy(e){let s=this.getVariableName(e.getFieldValue("VARIABLE")),t=this.valueToCode(e,"VALUE",this.ORDER_NONE);return`${s} += ${t}
`}},{id:"listcontents",mpy(e){return[this.getVariableName(e.getFieldValue("LIST"))+"_ls",this.ORDER_ATOMIC]}},{id:"addtolist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${s}.append(${t})
`}},{id:"deleteoflist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.getAdjusted(e,"INDEX");return`${s}.pop(${t})
`}},{id:"deletealloflist",mpy(e){return`${this.getVariableName(e.getFieldValue("LIST"))+"_ls"} = []
`}},{id:"insertatlist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.getAdjusted(e,"INDEX"),i=this.valueToCode(e,"ITEM",this.ORDER_NONE);return`${s}.insert(${t}, ${i})
`}},{id:"replaceitemoflist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.valueToCode(e,"ITEM",this.ORDER_NONE),i=this.getAdjusted(e,"INDEX");return`${s}[${i}] = ${t}
`}},{id:"itemoflist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.getAdjusted(e,"INDEX");return[`${s}[${t}]`,this.ORDER_MEMBER]}},{id:"itemnumoflist",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`${s}.index(${t})`,this.ORDER_FUNCTION_CALL]}},{id:"lengthoflist",mpy(e){return[`len(${this.getVariableName(e.getFieldValue("LIST"))+"_ls"})`,this.ORDER_FUNCTION_CALL]}},{id:"listcontainsitem",mpy(e){let s=this.getVariableName(e.getFieldValue("LIST"))+"_ls",t=this.valueToCode(e,"ITEM",this.ORDER_NONE);return[`(${s}.count(${t}) > 0)`,this.ORDER_FUNCTION_CALL]}}]});import{translate as ne,themeColors as Fe}from"@blockcode/core";var De=(e)=>({id:"terminal",name:ne("esp32.blocks.terminal","Terminal"),themeColor:Fe.blocks.debug.primary,inputColor:Fe.blocks.debug.secondary,order:e,blocks:[{id:"print",text:ne("esp32.blocks.terminalPrint","print %1"),inputs:{STRING:{type:"string",defaultValue:"hello"}},mpy(s){return`print(str(${this.valueToCode(s,"STRING",this.ORDER_NONE)}))
`}},{id:"eval",text:ne("esp32.blocks.terminalEval","eval %1"),inputs:{CODE:{type:"string",defaultValue:'print("hello")'}},mpy(s){let t=this.valueToCode(s,"CODE",this.ORDER_NONE);return t=`${t.replace(/^["']/,"").replace(/["']$/,"")}
`,t}}]});import{themeColors as le,translate as U}from"@blockcode/core";import{ScratchBlocks as qt}from"@blockcode/blocks";var Ie=()=>({id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:le.blocks.sensing.primary,inputColor:le.blocks.sensing.secondary,otherColor:le.blocks.sensing.tertiary,blocks:[{id:"temperature",text:U("esp32.blocks.temperature","temperature"),output:"number",mpy(e){return this.definitions_.import_esp32="import esp32",["((esp32.raw_temperature() - 32) * 5 / 9)",this.ORDER_ATOMIC]}},"---",{id:"runtime",text:U("esp32.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[U("esp32.blocks.runtimeMilliseconds","milliseconds"),"MS"],[U("esp32.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(e){let s=e.getFieldValue("UNIT"),t="(time.ticks_ms() - _times__)";if(s==="SEC")t=`(${t} / 1000)`;return[t,this.ORDER_ATOMIC]}}]});import{MicroPythonGenerator as As}from"@blockcode/blocks";var Ts=`# Generate by BlockCode
`;class Q extends As{finish(e){return Ts+super.finish(e)}}function Me(e){let s=[m.ESP32S3_CAM,m.ATOMS3R_CAM].includes(e),t=_e(e),i=Oe(e,1),a=Se(1+s),o=Ae(e),c=Te(),r=Ce(4+s),l=Ie(),p=Ne(),u=De(7+s),d=ve();return[t,s&&i,a,o,c,r,l,p,u,d].filter(Boolean)}import{Text as S}from"@blockcode/core";import{jsx as N}from"preact/jsx-runtime";var Pe=[{tag:"controller",label:N(S,{id:"esp32.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:N(S,{id:"esp32.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:N(S,{id:"esp32.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:N(S,{id:"esp32.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:N(S,{id:"esp32.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:N(S,{id:"esp32.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:N(S,{id:"esp32.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:N(S,{id:"esp32.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as Is}from"preact/jsx-runtime";var Fs=(e)=>e.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),Ge=new Q,Ds=()=>["device","data","ai"];function Le(){let{tabIndex:e}=Cs(),{meta:s}=Ss(),t=ye(()=>{return Me(s.value.boardType,s.value.classicEvents)},[s.value.boardType,s.value.classicEvents]),i=ye((a,o,c,r)=>{Ns.prototype.onDefinitions.call(Ge);for(let l in c)for(let p of c[l])if(!p.common){let u=ee(p.name,se(p.name));o(`import_${l}_${u}`,`from ${Fs(l)} import ${u}`)}},[]);return Is(vs,{enableCodePreview:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:e.value!==0,extensionTags:Pe,generator:Ge,onBuildinExtensions:t,onDefinitions:i,onExtensionsFilter:Ds})}import{useAppContext as Ps}from"@blockcode/core";function pe(e){let s=globalThis.document,t=s.createElement("style");t.appendChild(s.createTextNode(e)),s.head.append(t)}pe("._1Ep-la_device-icon{width:20px;height:20px}._1Ep-la_check-icon{margin-right:calc(var(--space)/2);visibility:hidden;width:14px}._1Ep-la_check-icon._1Ep-la_checked{visibility:visible}._1Ep-la_blank-check-item>div{padding-left:calc(var(--space)/2 + 14px)}");var h={checkIcon:"_1Ep-la_check-icon",blankCheckItem:"_1Ep-la_blank-check-item",deviceIcon:"_1Ep-la_device-icon",checked:"_1Ep-la_checked"};var Ve="./assets/icon-device-40zreghe.png";import{jsx as ys}from"preact/jsx-runtime";function we(){let{appState:e}=Ps();return ys("img",{className:h.deviceIcon,src:Ve})}import{useProjectContext as Gs,Text as P}from"@blockcode/core";import{jsx as y}from"preact/jsx-runtime";function ze(){let{meta:e}=Gs();switch(e.value.boardType){case m.ESP32S3:return y(P,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"});case m.ESP32C3:return y(P,{id:"esp32.menubar.device.esp32c3",defaultMessage:"ESP32-C3"});case m.ESP32_IOT_BOARD:return y(P,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"NULLLAB ESP32 IOT Board"});case m.ESP32S3_CAM:return y(P,{id:"esp32.menubar.device.esp32s3Cam",defaultMessage:"NULLLAB ESP32S3 CAM"});case m.ATOMS3R_CAM:return y(P,{id:"esp32.menubar.device.atomS3RCam",defaultMessage:"M5Stack AtomS3R CAM"})}return y(P,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})}import{useCallback as L}from"preact/hooks";import{nanoid as st,classNames as $,sleepMs as tt}from"@blockcode/utils";import{useAppContext as it,useProjectContext as ot,setAlert as be,delAlert as at,setAppState as ts}from"@blockcode/core";import{MPYUtils as ke}from"@blockcode/board";var X=[{usbVendorId:12346},{usbVendorId:6790}];import{Spinner as rt,Text as V,MenuSection as is,MenuItem as W}from"@blockcode/core";import{useEffect as Vs,useCallback as ws}from"preact/hooks";import{batch as xe}from"@preact/signals";import{classNames as q}from"@blockcode/utils";import{useAppContext as zs,useProjectContext as xs,setAppState as Bs,setMeta as Be,Text as Y,MenuSection as $e,MenuItem as K}from"@blockcode/core";var x="./assets/icon-check-5hn8sb1h.svg";import{jsx as v,jsxs as D,Fragment as $s}from"preact/jsx-runtime";function We({disabled:e,itemClassName:s}){let{appState:t}=zs(),{meta:i}=xs();Vs(()=>{if(!i.value.boardType)Be("boardType",m.ESP32S3)},[]);let a=ws((o)=>()=>xe(()=>{t.value?.currentDevice?.disconnect(),xe(()=>{Bs("currentDevice",null),Be({boardType:o})})}),[]);return D($s,{children:[D($e,{disabled:e,children:[D(K,{className:s,onClick:a(m.ESP32),children:[v("img",{className:q(h.checkIcon,{[h.checked]:i.value.boardType===m.ESP32}),src:x}),v(Y,{id:"esp32.menubar.device.esp32",defaultMessage:"ESP32"})]}),D(K,{className:s,onClick:a(m.ESP32S3),children:[v("img",{className:q(h.checkIcon,{[h.checked]:i.value.boardType===m.ESP32S3}),src:x}),v(Y,{id:"esp32.menubar.device.esp32s3",defaultMessage:"ESP32-S3"})]})]}),D($e,{disabled:e,children:[D(K,{className:s,onClick:a(m.ESP32_IOT_BOARD),children:[v("img",{className:q(h.checkIcon,{[h.checked]:i.value.boardType===m.ESP32_IOT_BOARD}),src:x}),v(Y,{id:"esp32.menubar.device.esp32IotBoard",defaultMessage:"NULLLAB ESP32 IOT Board"})]}),D(K,{className:s,onClick:a(m.ESP32S3_CAM),children:[v("img",{className:q(h.checkIcon,{[h.checked]:i.value.boardType===m.ESP32S3_CAM}),src:x}),v(Y,{id:"esp32.menubar.device.esp32s3Cam",defaultMessage:"NULLLAB ESP32S3 CAM"})]})]})]})}import{useEffect as Ue,useMemo as Qe,useCallback as Ws}from"preact/hooks";import{useSignal as Xe}from"@preact/signals";import{nanoid as Ke,classNames as Hs,sleep as Us,Base64Utils as Ze,getBinaryCache as Je,setBinaryCache as Qs}from"@blockcode/utils";import{useAppContext as Xs,useProjectContext as qs,setAlert as B,delAlert as Ys,setAppState as Ks}from"@blockcode/core";import{ESPTool as Z}from"@blockcode/board";var Xi="0.1.5";var me={iotboard:{download:"https://firmware.blockcode.fun/iotboard"},esp32s3cam:{download:"https://firmware.blockcode.fun/esp32s3cam"}};import{Text as I,Spinner as ue,MenuSection as Zs,MenuItem as Js}from"@blockcode/core";import{jsx as A}from"preact/jsx-runtime";var O=null,js=(e)=>{if(!O)O=Ke();if(e<100)B({id:O,icon:A(ue,{level:"success"}),message:A(I,{id:"esp32.menubar.device.restoring",defaultMessage:"Firmware restoring...{progress}%",progress:e})});else B({id:O,icon:A(ue,{level:"success"}),message:A(I,{id:"esp32.menubar.device.recovering",defaultMessage:"Recovering..."})})},qe=()=>{Ys(O),O=null},je=(e)=>{if(e==="NotFoundError")return;B("connectionError",1000)},es=async(e)=>{try{return await fetch(e,{method:"GET"})}catch(s){return await Us(1),es(e)}},G=async(e,s,t,i,a)=>{if(a.value)return;let o=`${e}Firmware`,c=await Je(o);if(c?.hash===t&&c?.binaryString){a.value=!0,delete G.downloading;return}if(G.downloading)return;G.downloading=!0;let l=await(await es(s)).arrayBuffer();delete G.downloading;let p=await crypto.subtle.digest("SHA-256",l);if(Array.from(new Uint8Array(p)).map((d)=>d.toString(16).padStart(2,"0")).join("")!==t){G(e,s,t,i,a);return}await Qs(o,{version:i,hash:t,binaryString:Ze.arrayBufferToBinaryString(l)}),a.value=!0},Ye=async(e,s)=>{if(!O)O=Ke();B({id:O,icon:A(ue,{level:"success"}),message:A(I,{id:"esp32.menubar.device.erasing",defaultMessage:"Erasing..."})});try{await e.main(),await Z.writeFlash(e,s,!0,(t)=>js(t)),B({id:O,icon:null,message:A(I,{id:"esp32.menubar.device.restoreDone",defaultMessage:"Firmware resotre completed! Now press RESET key"}),onClose:qe})}catch(t){je(t.name),qe()}await Z.disconnect(e)},et=async(e)=>{if(O)return;let s;try{s=await Z.connect(X,460800)}catch(i){je(i.name)}if(!s)return;if(e){let i=await Je(`${e}Firmware`);if(i)Ye(s,[{data:i.binaryString,address:0}]);return}let t=document.createElement("input");t.type="file",t.accept=".bin",t.multiple=!1,t.click(),t.addEventListener("cancel",()=>Z.disconnect(s)),t.addEventListener("change",async(i)=>{let a=new FileReader;a.readAsArrayBuffer(i.target.files[0]),a.addEventListener("load",(o)=>Ye(s,[{data:Ze.arrayBufferToBinaryString(o.target.result),address:0}]))})};function ss({disabled:e,itemClassName:s}){let{appState:t}=Xs(),{meta:i}=qs(),a=Xe(!1),o=Xe(null),c=Qe(()=>{if(i.value.boardType===m.ESP32_IOT_BOARD)return o.value=null,"iotboard";if(i.value.boardType===m.ESP32S3_CAM)return o.value=null,"esp32s3cam"},[i.value.boardType]),r=Qe(()=>{if([m.ESP32_IOT_BOARD,m.ESP32S3_CAM].includes(i.value.boardType))return A(I,{id:"esp32.menubar.device.firmware",defaultMessage:"Restore firmware (v{version})",version:o.value?.version})},[i.value.boardType,o.value?.version]);Ue(()=>O=null,[]),Ue(async()=>{if(!c||!me[c])return;a.value=!1;let p=me[c].download;if(!o.value)o.value=await fetch(`${p}/version.json`).then((M)=>M.json());let u=`${p}/${o.value.download}`.replaceAll("{version}",o.value.version),d=o.value.hash;G(c,u,d,o.value.version,a)},[c]);let l=Ws(async()=>{Ks("currentDevice",null),await t.value?.currentDevice?.disconnect(),et(c)},[c]);return A(Zs,{children:A(Js,{disabled:e||O||r&&!a.value,className:Hs(s,h.blankCheckItem),onClick:l,children:r?a.value?r:A(I,{id:"esp32.menubar.device.caching",defaultMessage:"Caching latest firmware..."}):A(I,{id:"esp32.menubar.device.micropythonFirmware",defaultMessage:"Restore MicroPython firmware"})})})}import{jsx as g,jsxs as de,Fragment as as}from"preact/jsx-runtime";var _=null,rs=()=>{at(_),_=null},os=(e)=>{if(!_)_=st();if(e<100)be({id:_,icon:g(rt,{level:"success"}),message:g(V,{id:"gui.alert.downloadingProgress",defaultMessage:"Downloading...{progress}%",progress:e})});else be("downloadCompleted",{id:_}),setTimeout(rs,2000)},J=(e)=>{if(e==="NotFoundError")return;be("connectionError",1000)},ct=async(e,s,t)=>{let i=[].concat(s,t).map((a)=>({...a,filename:a.id}));os(0);try{await ke.write(e,i,os),e.reset()}catch(a){J(a.name)}rs()};function cs({itemClassName:e}){let{appState:s}=it(),{meta:t,file:i,assets:a}=ot(),o=L(async(d)=>{if(await s.value?.currentDevice?.disconnect(),!d.binding)d.binding=!0,d.on("connect",()=>{o(d)}),d.on("disconnect",(M)=>{if(M)J();ts("currentDevice",null)}),await tt(500);ts("currentDevice",d)},[]),c=L(async()=>{if(_)return;try{let d=await ke.connect(X,{baudRate:115200});o(d)}catch(d){J(d.name)}},[]),r=L(async()=>{if(_)return;try{let d=await ke.connectBLE();o(d)}catch(d){J(d.name)}},[]),l=L(()=>{if(_)return;if(!s.value?.currentDevice)return;ct(s.value.currentDevice,i.value,a.value)},[]),p=L(()=>{if(_)return;s.value?.currentDevice?.reset()},[]),u=L(()=>{if(_)return;s.value?.currentDevice?.disconnect()});return de(as,{children:[de(is,{disabled:_||!s.value?.currentDevice,children:[g(W,{className:$(e,h.blankCheckItem),label:g(V,{id:"gui.menubar.device.download",defaultMessage:"Download program"}),onClick:l}),g(W,{className:$(e,h.blankCheckItem),label:g(V,{id:"gui.menubar.device.reset",defaultMessage:"Reset device"}),onClick:p})]}),g(is,{disabled:_,children:s.value?.currentDevice?g(W,{className:$(e,h.blankCheckItem),label:g(V,{id:"gui.menubar.device.disconnect",defaultMessage:"Disconnect device"}),onClick:u}):de(as,{children:[g(W,{className:$(e,h.blankCheckItem),label:g(V,{id:"gui.menubar.device.connectUsb",defaultMessage:"Connect device with USB"}),onClick:c}),t.value.boardType===m.ESP32_IOT_BOARD&&g(W,{className:$(e,h.blankCheckItem),label:g(V,{id:"gui.menubar.device.connectBle",defaultMessage:"Connect device with Bluetooth (BLE)"}),onClick:r})]})}),g(We,{disabled:_,itemClassName:e}),g(ss,{disabled:_,itemClassName:e})]})}var ns={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as ls}from"preact/jsx-runtime";var Do={onNew(){return ns},onSave(e,s,t){let i=[];return e=e.map((a)=>{return i.push(a.extensions),{id:a.id,type:a.type,xml:a.xml}}),{files:e,assets:s,meta:{extensions:Array.from(new Set(i.flat())),boardType:t.boardType??m.ESP32}}},async onThumb(){let e=H.getMainWorkspace();if(e){let s=e.getCanvas();if(s)return await nt(s,{})}},onUndo(e){if(e instanceof MouseEvent)H.getMainWorkspace()?.undo(!1)},onRedo(e){if(e instanceof MouseEvent)H.getMainWorkspace()?.undo(!0)},onEnableUndo(){let e=H.getMainWorkspace();return e?.undoStack_&&e.undoStack_.length!==0},onEnableRedo(){let e=H.getMainWorkspace();return e?.redoStack_&&e.redoStack_.length!==0},menuItems:[{icon:ls(we,{}),label:ls(ze,{}),Menu:cs}],tabs:[{...lt,Content:Le},{...pt},{...mt}]};export{Do as default};
