import{getUserConfig as se,setUserConfig as ae}from"@blockcode/utils";import{addLocalesMessages as j,openPromptModal as re,Text as H}from"@blockcode/core";import{fetchSpark as I,getUserConfig as i,getUserLanguage as N}from"@blockcode/utils";var S="https://spark-api-open.xf-yun.com/v1/chat/completions",d="qQIJHdBFkpbHDoMnPqnW:oeanHZdXCBHIHTOYvVim",C="db45f79e",q="MWFiNjVmNDA4YjNhODFkZGE0MGQ1YWRj",v="6a3dfe79b9e9ec588ca65bf3b9d9c847",A=(s=d)=>({"Content-Type":"application/json",Authorization:`Bearer ${s}`}),W=(s,e={})=>({model:e.model??"lite",user:e.user??"default",messages:s,temperature:0.4,top_k:3,max_tokens:70,stream:!1}),p={en:"English",zh:"中文",jp:"日本語",ko:"한국어"};function u(s){return{get key(){return"translate"},get language(){let e=N();return p[e.slice(0,2)]},async translate(e,a,n="lite"){let o=i("SparkAI.APIPassword")||d,f=i("SparkAI.APPID")||C,T=i("SparkAI.APISecret")||q,E=i("SparkAI.APIKey")||v;if(!Object.values(p).includes(a))return e;let l;try{l=await I(S,{method:"POST",mode:"no-cors",headers:A(o),body:JSON.stringify(W([{role:"system",content:"You are an excellent translator."},{role:"user",content:`Translate the following text to ${a}:

 ${e}`}],{model:n})),auth:{appId:f,apiSecret:T,apiKey:E}}),l=await l.json()}catch(P){console.error(P)}return l?.choices[0]?.message.content??e}}}import{getUserConfig as c}from"@blockcode/utils";import{Text as t}from"@blockcode/core";import{jsx as r}from"preact/jsx-runtime";var h=[{id:"translate",text:r(t,{id:"blocks.translate.translate",defaultMessage:"translate [WORDS] to [LANGUAGE]"}),output:"string",inputs:{WORDS:{type:"string",defaultValue:r(t,{id:"blocks.translate.hello",defaultMessage:"hello"})},LANGUAGE:{menu:"languageMenu"}},emu(s){let e=this.quote_(c("SparkAI.Model")??"lite"),a=this.valueToCode(s,"WORDS",this.ORDER_NONE),n=this.valueToCode(s,"LANGUAGE",this.ORDER_NONE);return[`(await runtime.extensions.translate.translate(${a}, ${n}, ${e}))`,this.ORDER_FUNCTION_CALL]},mpy(s){let e=this.quote_(c("SparkAI.Model")??"lite"),a=this.quote_(c("SparkAI.APIPassword")??d),n=this.valueToCode(s,"WORDS",this.ORDER_NONE),o=this.valueToCode(s,"LANGUAGE",this.ORDER_NONE);return[`(await translate.translate(${n}, ${o}, ${a}, ${e}))`,this.ORDER_FUNCTION_CALL]}}],_={languageMenu:{inputMode:!0,type:"string",defaultValue:"English",items:[[r(t,{id:"blocks.translate.english",defaultMessage:"English"}),"English"],[r(t,{id:"blocks.translate.chinese",defaultMessage:"Chinese"}),"中文"],[r(t,{id:"blocks.translate.japanese",defaultMessage:"Japanese"}),"日本語"],[r(t,{id:"blocks.translate.korean",defaultMessage:"Korean"}),"한국어"]]}};var m="./assets/translate-s5b2bd1h.py";var y="./assets/aiohttp-0qva3nva.py";var k="./assets/aiohttp_ws-cykkq64e.py";var b="./assets/sparkai-gnvbpvrd.py";var w={en:{"blocks.translate.name":"Translate","blocks.translate.openplatform":"iFLYTEK Open Platform authorization","blocks.translate.openplatform.APIPassword":"HTTP authorization APIPassword","blocks.translate.openplatform.APPID":"WebSocket authorization APPID","blocks.translate.openplatform.APISecret":"WebSocket authorization APISecret","blocks.translate.openplatform.APIKey":"WebSocket authorization APIKey","blocks.translate.openplatform.description1":"Please register your own ","blocks.translate.openplatform.description2":"iFLYTEK Open Platform (Chinese)","blocks.translate.openplatform.description3":" account, the test account we provide does not guarantee that every request will be successful.","blocks.translate.language":"language","blocks.translate.translate":"translate [WORDS] to [LANGUAGE]","blocks.translate.hello":"hello","blocks.translate.english":"English","blocks.translate.chinese":"Chinese","blocks.translate.japanese":"Japanese","blocks.translate.korean":"Korean"},"zh-Hans":{"blocks.translate.name":"翻译","blocks.translate.openplatform":"讯飞开放平台认证信息","blocks.translate.openplatform.APIPassword":"HTTP 服务鉴权 APIPassword","blocks.translate.openplatform.APPID":"WebSocket 服务鉴权 APPID","blocks.translate.openplatform.APISecret":"WebSocket 服务鉴权 APISecret","blocks.translate.openplatform.APIKey":"WebSocket 服务鉴权 APIKey","blocks.translate.openplatform.description1":"请注册您自己的","blocks.translate.openplatform.description2":"讯飞开放平台","blocks.translate.openplatform.description3":"账号，我们提供的测试账号不保证每次请求都成功。","blocks.translate.language":"访客语言","blocks.translate.translate":"将 [WORDS] 译为 [LANGUAGE]","blocks.translate.hello":"你好","blocks.translate.english":"英文","blocks.translate.chinese":"中文","blocks.translate.japanese":"日语","blocks.translate.korean":"韩语"},"zh-Hant":{"blocks.translate.name":"翻譯","blocks.translate.openplatform":"訊飛開放平台認證信息","blocks.translate.openplatform.APIPassword":"HTTP 服務鑒權 APIPassword","blocks.translate.openplatform.APPID":"WebSocket 服務鑒權 APPID","blocks.translate.openplatform.APISecret":"WebSocket 服務鑒權 APISecret","blocks.translate.openplatform.APIKey":"WebSocket 服務鑒權 APIKey","blocks.translate.openplatform.description1":"請註冊您自己的","blocks.translate.openplatform.description2":"訊飛開放平台","blocks.translate.openplatform.description3":"賬號，我們提供的測試賬號不保證每次請求都成功。","blocks.translate.language":"訪客語言","blocks.translate.translate":"將 [WORDS] 譯為 [LANGUAGE]","blocks.translate.hello":"你好","blocks.translate.english":"英文","blocks.translate.chinese":"中文","blocks.translate.japanese":"日文","blocks.translate.korean":"韓文"}};var g="./assets/icon-bf4kf31b.png";import{jsx as L}from"preact/jsx-runtime";j(w);var ue={icon:g,name:L(H,{id:"blocks.translate.name",defaultMessage:"Translate"}),files:[{name:"translate",type:"text/x-python",uri:m},{name:"_aiohttp/__init__",type:"text/x-python",uri:y},{name:"_aiohttp/aiohttp_ws",type:"text/x-python",uri:k},{name:"_sparkai",type:"text/x-python",uri:b}],emulator:u,blocks:h,menus:_};export{ue as default};
