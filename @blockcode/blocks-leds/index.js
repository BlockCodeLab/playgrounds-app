import{addLocalesMessages as g,Text as N}from"@blockcode/core";import{Text as l}from"@blockcode/core";import{jsx as r}from"preact/jsx-runtime";var f=(t)=>t.editor==="@blockcode/gui-iotbit",c=(t)=>[{id:"ledState",text:r(l,{id:"blocks.leds.ledState",defaultMessage:"pin [PIN] LED [STATE]"}),inputs:{PIN:t.boardPins?{menu:t.boardPins.out}:{type:"positive_integer",defaultValue:1},STATE:{menu:"LedStates"}},ino(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=this.valueToCode(e,"STATE",this.ORDER_NONE);return this.definitions_[`setup_pin_${i}`]=`pinMode(${i}, OUTPUT);`,`digitalWrite(${i}, ${s==1?"HIGH":"LOW"});
`},mpy(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=this.valueToCode(e,"STATE",this.ORDER_NONE),n=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[n]=`${n} = PWM(Pin(${i}), freq=1000, duty_u16=0)`,`${n}.duty(${s==1?1023:0})
`}},{id:"toggleLed",text:r(l,{id:"blocks.leds.toggleLed",defaultMessage:"toggle pin [PIN] LED state"}),inputs:{PIN:t.boardPins?{menu:t.boardPins.out}:{type:"positive_integer",defaultValue:1}},ino(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=this.valueToCode(e,"STATE",this.ORDER_NONE);return this.definitions_[`setup_pin_${i}`]=`pinMode(${i}, OUTPUT);`,`digitalWrite(${i}, digitalRead(${i}) ? LOW : HIGH);
`},mpy(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[s]=`${s} = PWM(Pin(${i}), freq=1000, duty_u16=0)`,`${s}.duty(0 if ${s}.duty() else 1023)
`}},{id:"brightness",text:r(l,{id:"blocks.leds.brightness",defaultMessage:"set pin [PIN] LED brightness [LEVEL]"}),inputs:{PIN:t.boardPins?{menu:t.boardPins.out}:{type:"positive_integer",defaultValue:1},LEVEL:{shadow:"brightnessLevel",defaultValue:"10"}},ino(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=this.valueToCode(e,"LEVEL",this.ORDER_NONE);return this.definitions_[`setup_pin_${i}`]=`pinMode(${i}, OUTPUT);`,`analogWrite(${i}, round(${s} * 12.75f));
`},mpy(e){let i=t.boardPins?e.getFieldValue("PIN"):this.valueToCode(e,"PIN",this.ORDER_NONE),s=this.valueToCode(e,"LEVEL",this.ORDER_NONE),n=`pin_${i}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[n]=`${n} = PWM(Pin(${i}), freq=1000, duty_u16=0)`,`${n}.duty(round(${s} * 51.15))
`}},{id:"brightnessLevel",shadow:!0,output:"number",inputs:{LEVEL:{type:"slider",defaultValue:0,min:0,max:20}},ino(e){return[e.getFieldValue("LEVEL")||0,this.ORDER_NONE]},mpy(e){return[e.getFieldValue("LEVEL")||0,this.ORDER_NONE]}},"---",{id:"trafficLedsInit",text:r(l,{id:"blocks.leds.trafficLeds.init",defaultMessage:"set traffic leds pins green:[G] yellow:[Y] red:[R] "}),inputs:{G:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"18":"1"}:{type:"positive_integer",defaultValue:1},Y:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"19":"2"}:{type:"positive_integer",defaultValue:2},R:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"21":"3"}:{type:"positive_integer",defaultValue:3}},ino(e){let i=t.boardPins?e.getFieldValue("R"):this.valueToCode(e,"R",this.ORDER_NONE),s=t.boardPins?e.getFieldValue("Y"):this.valueToCode(e,"Y",this.ORDER_NONE),n=t.boardPins?e.getFieldValue("G"):this.valueToCode(e,"G",this.ORDER_NONE);this.definitions_[`setup_pin_${i}`]=`pinMode(${i}, OUTPUT);`,this.definitions_[`setup_pin_${s}`]=`pinMode(${s}, OUTPUT);`,this.definitions_[`setup_pin_${n}`]=`pinMode(${n}, OUTPUT);`;let o="";return o+=`void setTrafficLeds(bool g, bool y, bool r) {
`,o+=`  digitalWrite(${i}, r);
`,o+=`  digitalWrite(${s}, y);
`,o+=`  digitalWrite(${n}, g);
`,o+="}",this.definitions_.declare_setTrafficLeds="void setTrafficLeds(bool g, bool y, bool r);",this.definitions_.setTrafficLeds=o,""},mpy(e){let i=this.valueToCode(e,"R",this.ORDER_NONE),s=this.valueToCode(e,"Y",this.ORDER_NONE),n=this.valueToCode(e,"G",this.ORDER_NONE),o=`pin_${i}`,a=`pin_${s}`,u=`pin_${n}`;this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${i}), freq=1000)`,this.definitions_[a]=`${a} = PWM(Pin(${s}), freq=1000)`,this.definitions_[u]=`${u} = PWM(Pin(${n}), freq=1000)`;let d="";return d+=`def set_traffic_leds(g, y, r):
`,d+=`  ${o}.duty(1023 if r else 0)
`,d+=`  ${a}.duty(1023 if y else 0)
`,d+=`  ${u}.duty(1023 if g else 0)
`,this.definitions_.set_traffic_leds=d,""}},{id:"trafficLedsColor",text:r(l,{id:"blocks.leds.trafficLeds.color",defaultMessage:"set traffic leds [G] green [Y] yellow [R] red"}),inputs:{R:{menu:"LedStates"},Y:{menu:"LedStates"},G:{menu:"LedStates"}},ino(e){let i=this.valueToCode(e,"R",this.ORDER_NONE),s=this.valueToCode(e,"Y",this.ORDER_NONE),n=this.valueToCode(e,"G",this.ORDER_NONE),o="setTrafficLeds(";return o+=`${n==1?"HIGH":"LOW"}, `,o+=`${s==1?"HIGH":"LOW"}, `,o+=`${i==1?"HIGH":"LOW"});
`,o},mpy(e){let i=this.valueToCode(e,"R",this.ORDER_NONE),s=this.valueToCode(e,"Y",this.ORDER_NONE),n=this.valueToCode(e,"G",this.ORDER_NONE),o="set_traffic_leds(";return o+=`${n==1?"True":"False"}, `,o+=`${s==1?"True":"False"}, `,o+=`${i==1?"True":"False"})
`,o}},"---",{id:"rgbLedInit",text:r(l,{id:"blocks.leds.rgbLed.init",defaultMessage:"set RGB LED pins red:[R] green:[G] blue:[B]"}),inputs:{R:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"18":"1"}:{type:"positive_integer",defaultValue:1},G:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"19":"2"}:{type:"positive_integer",defaultValue:2},B:t.boardPins?{menu:t.boardPins.out,defaultValue:f(t)?"21":"3"}:{type:"positive_integer",defaultValue:3}},ino(e){let i=this.valueToCode(e,"R",this.ORDER_NONE),s=this.valueToCode(e,"G",this.ORDER_NONE),n=this.valueToCode(e,"B",this.ORDER_NONE);this.definitions_[`setup_pin_${i}`]=`pinMode(${i}, OUTPUT);`,this.definitions_[`setup_pin_${s}`]=`pinMode(${s}, OUTPUT);`,this.definitions_[`setup_pin_${n}`]=`pinMode(${n}, OUTPUT);`;let o="";return o+=`void setRGBLed(int rgb[]) {
`,o+=`  analogWrite(${i}, rgb[0]);
`,o+=`  analogWrite(${s}, rgb[1]);
`,o+=`  analogWrite(${n}, rgb[2]);
`,o+="}",this.definitions_.declare_setRGBLed="void setRGBLed(int rgb[]);",this.definitions_.setRGBLed=o,""},mpy(e){let i=t.boardPins?e.getFieldValue("R"):this.valueToCode(e,"R",this.ORDER_NONE),s=t.boardPins?e.getFieldValue("G"):this.valueToCode(e,"G",this.ORDER_NONE),n=t.boardPins?e.getFieldValue("B"):this.valueToCode(e,"B",this.ORDER_NONE),o=`pin_${i}`,a=`pin_${s}`,u=`pin_${n}`;this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${i}), freq=1000)`,this.definitions_[a]=`${a} = PWM(Pin(${s}), freq=1000)`,this.definitions_[u]=`${u} = PWM(Pin(${n}), freq=1000)`;let d="";return d+=`def set_rgb_led(rgb):
`,d+=`  ${o}.duty(round(rgb[0] / 255 * 1023))
`,d+=`  ${a}.duty(round(rgb[1] / 255 * 1023))
`,d+=`  ${u}.duty(round(rgb[2] / 255 * 1023))
`,this.definitions_.set_rgb_led=d,""}},{id:"rgbLedColor",text:r(l,{id:"blocks.leds.rgbLed.color",defaultMessage:"set RGB LED color [COLOR]"}),inputs:{COLOR:{type:"color"}},ino(e){return`{ int rgb[3]=${this.valueToCode(e,"COLOR",this.ORDER_NONE)}; setRGBLed(rgb); }
`},mpy(e){return`set_rgb_led(${this.valueToCode(e,"COLOR",this.ORDER_NONE)})
`}},{id:"rgbLedOff",text:r(l,{id:"blocks.leds.rgbLed.off",defaultMessage:"turn off RGB LED"}),ino(e){return`{ int rgb[3]={0}; setRGBLed(rgb); }
`},mpy(e){return`set_rgb_led((0,0,0))
`}}],p={LedStates:{type:"integer",inputMode:!0,defaultValue:"1",items:[[r(l,{id:"blocks.leds.state.on",defaultMessage:"on"}),"1"],[r(l,{id:"blocks.leds.state.off",defaultMessage:"off"}),"0"]]}};var _={en:{"blocks.leds.name":"LED","blocks.leds.ledState":"pin [PIN] LED [STATE]","blocks.leds.state.on":"on","blocks.leds.state.off":"off","blocks.leds.toggleLed":"toggle pin [PIN] LED state","blocks.leds.brightness":"set pin [PIN] LED brightness [LEVEL]","blocks.leds.trafficLeds.init":"set traffic leds pins red:[R] yellow:[Y] green:[G]","blocks.leds.trafficLeds.color":"set traffic leds [R] red [Y] yellow [G] green","blocks.leds.rgbLed.init":"set RGB LED pins red:[R] green:[G] blue:[B]","blocks.leds.rgbLed.color":"set RGB LED color [COLOR]","blocks.leds.rgbLed.off":"turn off RGB LED"},"zh-Hans":{"blocks.leds.name":"LED 灯","blocks.leds.ledState":"[STATE]引脚[PIN] LED 灯","blocks.leds.state.on":"开启","blocks.leds.state.off":"关闭","blocks.leds.toggleLed":"切换引脚[PIN] LED 灯状态","blocks.leds.brightness":"将引脚[PIN] LED 灯亮度设为[LEVEL]","blocks.leds.trafficLeds.init":"初始交通灯引脚绿灯:[G]黄灯:[Y]红灯:[R]","blocks.leds.trafficLeds.color":"设置交通灯[G]绿灯[Y]黄灯[R]红灯","blocks.leds.rgbLed.init":"初始 RGB 灯引脚红色:[R]绿色:[G]蓝色:[B]","blocks.leds.rgbLed.color":"将 RGB 灯颜色设为[COLOR]","blocks.leds.rgbLed.off":"关闭 RGB 灯"},"zh-Hant":{"blocks.leds.name":"LED 燈","blocks.leds.ledState":"[STATE]引腳[PIN] LED 燈","blocks.leds.state.on":"開啟","blocks.leds.state.off":"關閉","blocks.leds.toggleLed":"切換引腳[PIN] LED 燈狀態","blocks.leds.brightness":"將引腳[PIN] LED 燈亮度設為[LEVEL]","blocks.leds.trafficLeds.init":"初始交通燈引腳紅燈:[R]黃燈:[Y]綠燈:[G]","blocks.leds.trafficLeds.color":"設置交通燈[R]紅燈[Y]黃燈[G]綠燈","blocks.leds.rgbLed.init":"初始 RGB 燈引腳紅色:[R]綠色:[G]藍色:[B]","blocks.leds.rgbLed.color":"將 RGB 燈顏色設為[COLOR]","blocks.leds.rgbLed.off":"關閉 RGB 燈"}};var E="./assets/icon-5ej94635.png";import{jsx as P}from"preact/jsx-runtime";g(_);var C={icon:E,name:P(N,{id:"blocks.leds.name",defaultMessage:"LED"}),blocks:c,menus:p};export{C as default};
