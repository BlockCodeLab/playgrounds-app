import{addLocalesMessages as te}from"@blockcode/core";var A2={"iotbit.menubar.device":"iot:bit","iotbit.emu.greenFlag":"Go","iotbit.emu.stop":"Stop","iotbit.emu.smallStage":"Switch to small stage","iotbit.emu.largeStage":"Switch to large stage","esp32.extension.tags.controllers":"Controllers","esp32.extension.tags.sensors":"Sensors","esp32.extension.tags.actuators":"Actuators","esp32.extension.tags.displays":"Displays","esp32.extension.tags.modules":"Modules","esp32.extension.tags.communication":"Communication","esp32.extension.tags.data":"Data","esp32.extension.tags.kits":"Kits","esp32.blocks.wait":"wait %1 milliseconds","esp32.blocks.break":"break","esp32.blocks.continue":"continue","esp32.blocks.elseif":"else if %1 then","esp32.blocks.else":"else","esp32.blocks.runtime":"run time %1","esp32.blocks.runtimeMilliseconds":"milliseconds","esp32.blocks.runtimeSeconds":"seconds","esp32.blocks.dataConvert":"convert %1 to %2","esp32.blocks.dataConvert.int":"int","esp32.blocks.dataConvert.float":"float","esp32.blocks.dataConvert.string":"str","esp32.blocks.dataConvert.list":"list","esp32.blocks.dataConvert.bytes":"bytes","esp32.blocks.dataLengthOf":"length of %1","esp32.blocks.dataConstrain":"constrain %1 between %2 to %3","esp32.blocks.dataMap":"map %1 from %2 - %3 to %4 - %5","esp32.blocks.whenstart":"when {name} start","esp32.blocks.timerset":"trigger timer #%1 per %2 milliseconds","esp32.blocks.timeroff":"stop timer #%1","esp32.blocks.operatorLarger":"larger of %1 and %2","esp32.blocks.operatorSmaller":"smaller of %1 and %2","esp32.blocks.pin":"Pins","esp32.blocks.setmode":"set pin %1 mode to %2","esp32.blocks.inputMode":"input","esp32.blocks.ouputMode":"output","esp32.blocks.inputPullUpMode":"input pull-up","esp32.blocks.inputPullDownMode":"input pull-down","esp32.blocks.setdigital":"set pin %1 to %2","esp32.blocks.digitalHigh":"high","esp32.blocks.digitalLow":"low","esp32.blocks.setpwmfreq":"set pin %1 pwm frequency to %2 Hz","esp32.blocks.setpwm":"set pin %1 pwm to %2","esp32.blocks.setanalog":"set pin %1 analog to %2","esp32.blocks.isDigitalHigh":"pin %1 is high?","esp32.blocks.analogValue":"pin %1 analog value","esp32.blocks.attachinterrupt":"attach pin %1 interrupt to %2","esp32.blocks.interruptRising":"rising","esp32.blocks.interruptFalling":"falling","esp32.blocks.interruptChange":"change","esp32.blocks.interruptHigh":"high","esp32.blocks.interruptLow":"low","esp32.blocks.detachinterrupt":"detach pin %1 interrupt","esp32.blocks.network":"Network","esp32.blocks.protocols":"Protocols","esp32.blocks.serial":"Serial","esp32.blocks.serialBaudrate":"set baudrate to %1","esp32.blocks.serialTimeout":"set timeout to %1 milliseconds","esp32.blocks.serialPrint":"send %1 with %2","esp32.blocks.serialPrintWarp":"warp","esp32.blocks.serialPrintNoWarp":"no-warp","esp32.blocks.serialPrintHEX":"hex","esp32.blocks.serialAvailable":"available data?","esp32.blocks.serialAvailableLength":"available data length","esp32.blocks.serialReadString":"read a string","esp32.blocks.serialReadStringUntil":"read a string until %1","esp32.blocks.serialReadParse":"read a %1 number","esp32.blocks.serialReadParseInteger":"int","esp32.blocks.serialReadParseFloat":"float","esp32.blocks.serialRead":"read a byte","esp32.blocks.serialReadBytes":"read %1 bytes","esp32.blocks.text":"Text","esp32.blocks.textEquals":"%1 equals %2 (not case-sensitive)?","esp32.blocks.textRemove":"remove letters from %1 to %2 of %3","esp32.blocks.textReplace":"replace %1 of %2 with %3","esp32.blocks.textReplaceLetter":"replace letter %1 of %2 with %3","esp32.blocks.textSubstring":"substring of %1 from %2 to %3","esp32.blocks.textFind":"find %1 of %2 place","esp32.blocks.textWith":"%1 %2 with %3?","esp32.blocks.textStartsWith":"starts","esp32.blocks.textEndsWith":"ends","esp32.blocks.textCase":"get %1 of %2","esp32.blocks.textLowerCase":"lower-case","esp32.blocks.textUpperCase":"upper-case","esp32.blocks.textTrim":"remove %1 leading and trailing whitespace","esp32.blocks.textConvert":"convert %1 to %2","esp32.blocks.textConvertFrom":"convert %1 to String","esp32.blocks.connectWifi":"connect wi-fi ssid: %1 password: %2","esp32.blocks.disconnectWifi":"disconnect wi-fi","esp32.blocks.networkCofing":"local %1","esp32.blocks.networkCofingIp":"ip","esp32.blocks.networkCofingMac":"mac address","esp32.blocks.isWifiConnected":"wi-fi is connected?","esp32.blocks.wifiScan":"start scan wi-fi","esp32.blocks.wifiItem":"%2 of item %1 of available wi-fi","esp32.blocks.wifiItemSsid":"ssid","esp32.blocks.wifiItemRssi":"rssi","esp32.blocks.wifiItemSecurity":"security","esp32.blocks.wifiItemMac":"mac address","esp32.blocks.wifiCounts":"available wi-fi counts","esp32.blocks.startap":"start ap ssid: %1","esp32.blocks.stopap":"stop ap","esp32.blocks.espnowBroadcast":"broadcast %1 via esp-now","esp32.blocks.espnowSend":"send %1 to %2 via esp-now","esp32.blocks.espnowRecv":"wait for esp-now incoming","esp32.blocks.espnowMsg":"%1 of incoming","esp32.blocks.espnowMsgText":"text","esp32.blocks.espnowMsgBytes":"bytes","esp32.blocks.espnowMsgMac":"mac address","esp32.blocks.espnowRepeat":"repeat wait for esp-now incoming","esp32.blocks.espnowWhen":"when esp-now receive %1","esp32.blocks.spiInit":"initialize SPI %1 freq:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 write %2","esp32.blocks.spiRead":"SPI %1 read %2 bytes","esp32.blocks.i2cInit":"initialize I2C SDA:%1 SCL:%2 freq:%3Hz","esp32.blocks.i2cScan":"I2C scan devices","esp32.blocks.i2cWrite":"I2C write to %1:%2","esp32.blocks.i2cRead":"I2C read from %1 :%2 bytes","esp32.blocks.i2sInit":"initialize I2S BCK:%1 WS:%2 DATA:%3 rate:%4Hz","esp32.blocks.i2sPlay":"I2S play %1","esp32.blocks.terminal":"Terminal","esp32.blocks.terminalPrint":"print %1","esp32.blocks.temperature":"temperature","iotbit.blocks.whenstart":"when %1 start","iotbit.blocks.pinTouched":"when %1 touched","iotbit.blocks.playNote":"play note %1 for %2 beats","iotbit.blocks.playMusic":"start sound %1","iotbit.blocks.playMusicDone":"play sound %1 until done","iotbit.blocks.stopMusic":"stop music","iotbit.blocks.musicDadadadum":"dadadadum","iotbit.blocks.musicEntertainer":"entertainer","iotbit.blocks.musicPrelude":"prelude","iotbit.blocks.musicOde":"ode","iotbit.blocks.musicNyan":"nyan","iotbit.blocks.musicRingtone":"ringtone","iotbit.blocks.musicFunk":"funk","iotbit.blocks.musicBlues":"blues","iotbit.blocks.musicBirthday":"birthday","iotbit.blocks.musicWedding":"wedding","iotbit.blocks.musicFuneral":"funeral","iotbit.blocks.musicPunchline":"punchline","iotbit.blocks.musicPython":"python","iotbit.blocks.musicBaddy":"baddy","iotbit.blocks.musicChase":"chase","iotbit.blocks.musicBaDing":"ba ding","iotbit.blocks.musicWawawawaa":"wawawawaa","iotbit.blocks.musicJumpUp":"jump up","iotbit.blocks.musicJumpDown":"jump down","iotbit.blocks.musicPowerUp":"power up","iotbit.blocks.musicPowerDown":"power down","iotbit.blocks.magneticForce":"magnetic force %1","iotbit.blocks.strength":"strength","iotbit.blocks.compassHeading":"compass heading","iotbit.blocks.calibrateCompass":"calibrate compass","iotbit.blocks.acceleration":"acceleration %1","iotbit.blocks.accelerometerRange":"set accelerometer range %1","iotbit.blocks.gyroscope":"gyroscope %1","iotbit.blocks.rotation":"rotation %1","iotbit.blocks.rotationPitch":"pitch","iotbit.blocks.rotationRoll":"roll","iotbit.blocks.rotationYaw":"yaw","iotbit.blocks.gesture":"is %1 gesture?","iotbit.blocks.gestureShake":"shake","iotbit.blocks.gestureLedsUp":"leds up","iotbit.blocks.gestureLedsDown":"leds down","iotbit.blocks.gestureScreenUp":"screen up","iotbit.blocks.gestureScreenDown":"screen down","iotbit.blocks.gestureTiltLeft":"tilt left","iotbit.blocks.gestureTiltRight":"tilt right","iotbit.blocks.gestureFreeFall":"free fall","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"brightness","iotbit.blocks.loudness":"loudness","iotbit.blocks.setLeds":"set led %1 %2 brightness %3","iotbit.blocks.closeLeds":"close leds","iotbit.blocks.display":"Display","iotbit.blocks.displayText":"display text %1 at x:%2 y:%3","iotbit.blocks.displayTextLine":"display text %1 at line %2","iotbit.blocks.displayImage":"display %1","iotbit.blocks.displayClear":"clear display","iotbit.blocks.displayPixel":"pixel x1:%1 y1:%2","iotbit.blocks.displayLine":"line from x1:%1 y1:%2 to x2:%3 y2:%4","iotbit.blocks.displayEllipse":"ellipse with x-radius:%1 and y-radius:%2 at x:%3 y:%4","iotbit.blocks.displayRect":"rect with width:%1 height:%2 at x:%3 y:%4","iotbit.blocks.displayFill":"fill with width:%1 height:%2 at x:%3 y:%4"};var P2={"iotbit.menubar.device":"物联板","iotbit.emu.greenFlag":"运行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"缩小舞台","iotbit.emu.largeStage":"放大舞台","esp32.extension.tags.controllers":"输入模块","esp32.extension.tags.sensors":"传感器","esp32.extension.tags.actuators":"执行器","esp32.extension.tags.displays":"显示模块","esp32.extension.tags.modules":"智能模块","esp32.extension.tags.communication":"通讯","esp32.extension.tags.data":"数据","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重复执行","esp32.blocks.continue":"跳到下一次执行","esp32.blocks.elseif":"否则，如果 %1 那么","esp32.blocks.else":"否则","esp32.blocks.runtime":"运行时长 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"将 %1 转为 %2","esp32.blocks.dataConvert.int":"整数","esp32.blocks.dataConvert.float":"浮点数","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataConvert.bytes":"字节数组","esp32.blocks.dataLengthOf":"%1 长度","esp32.blocks.dataConstrain":"约束 %1 在 %2 和 %3 之间","esp32.blocks.dataMap":"映射 %1 从 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"当 {name} 启动时","esp32.blocks.timerset":"定时器 #%1 每间隔 %2 毫秒执行","esp32.blocks.timeroff":"关闭定时器 #%1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引脚","esp32.blocks.setmode":"将引脚 %1 设为 %2 模式","esp32.blocks.inputMode":"输入","esp32.blocks.ouputMode":"输出","esp32.blocks.inputPullUpMode":"上拉输入","esp32.blocks.inputPullDownMode":"下拉输入","esp32.blocks.setdigital":"将引脚 %1 设为 %2","esp32.blocks.digitalHigh":"高电平","esp32.blocks.digitalLow":"低电平","esp32.blocks.setpwmfreq":"将引脚 %1 PWM 频率设为 %2","esp32.blocks.setpwm":"将引脚 %1 PWM 设为 %2","esp32.blocks.setanalog":"将引脚 %1 模拟值设为 %2","esp32.blocks.isDigitalHigh":"引脚 %1 是高电平？","esp32.blocks.analogValue":"引脚 %1 模拟值","esp32.blocks.attachinterrupt":"将引脚 %1 中断模式设为 %2","esp32.blocks.interruptRising":"电平上升","esp32.blocks.interruptFalling":"电平下降","esp32.blocks.interruptChange":"电平改变","esp32.blocks.interruptHigh":"高电平","esp32.blocks.interruptLow":"低电平","esp32.blocks.detachinterrupt":"取消引脚 %1 中断","esp32.blocks.network":"网络","esp32.blocks.protocols":"协议","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"将波特率设为 %1","esp32.blocks.serialTimeout":"将通讯超时设为 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式发送 %1","esp32.blocks.serialPrintWarp":"换行","esp32.blocks.serialPrintNoWarp":"不换行","esp32.blocks.serialPrintHEX":"16进制","esp32.blocks.serialAvailable":"存在可读取数据?","esp32.blocks.serialAvailableLength":"可读取数据长度","esp32.blocks.serialReadString":"读取文本","esp32.blocks.serialReadStringUntil":"读取文本直到 %1","esp32.blocks.serialReadParse":"读取 %1","esp32.blocks.serialReadParseInteger":"整数","esp32.blocks.serialReadParseFloat":"浮点数","esp32.blocks.serialRead":"读取 1 个字节","esp32.blocks.serialReadBytes":"读取 %1 个字节","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽视大小写）？","esp32.blocks.textRemove":"删除 %3 从第 %1 个到第 %2 个字符","esp32.blocks.textReplace":"将 %2 中的 %1 替换为 %3","esp32.blocks.textReplaceLetter":"将 %2 中的第 %1 个字符替换为 %3","esp32.blocks.textSubstring":"截取 %1 从第 %2 个到第 %3 个字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"开始于","esp32.blocks.textEndsWith":"结束于","esp32.blocks.textCase":"将 %2 字母转为 %1","esp32.blocks.textLowerCase":"小写","esp32.blocks.textUpperCase":"大写","esp32.blocks.textTrim":"清除 %1 前后空白字符","esp32.blocks.textConvert":"将 %1 转为 %2","esp32.blocks.textConvertFrom":"将 %1 转为文本","esp32.blocks.connectWifi":"连接 Wi-Fi 网络 SSID: %1 密码: %2","esp32.blocks.disconnectWifi":"断开 Wi-Fi 网络","esp32.blocks.networkCofing":"本地 %1","esp32.blocks.networkCofingIp":"IP","esp32.blocks.networkCofingMac":"MAC 地址","esp32.blocks.isWifiConnected":"Wi-Fi 网络已连接？","esp32.blocks.wifiScan":"开始扫描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 个可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密类型","esp32.blocks.wifiItemMac":"MAC 地址","esp32.blocks.wifiCounts":"可用 Wi-Fi 数量","esp32.blocks.startap":"开启热点 SSID: %1","esp32.blocks.stopap":"关闭热点","esp32.blocks.espnowBroadcast":"ESP-Now 广播 %1","esp32.blocks.espnowSend":"ESP-Now 发送 %1 给 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"文本","esp32.blocks.espnowMsgBytes":"字节数组","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"当 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 频率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 写入 %2","esp32.blocks.spiRead":"SPI %1 读取 %2 字节","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 频率:%3Hz","esp32.blocks.i2cScan":"I2C扫描设备","esp32.blocks.i2cWrite":"I2C写入到 %1:%2","esp32.blocks.i2cRead":"I2C从 %1 读取 %2 字节","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"终端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度","iotbit.blocks.whenstart":"当 %1 系统启动","iotbit.blocks.pinTouched":"当 %1 被触摸","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.playMusicDone":"播放 %1 等待播完","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"开场","iotbit.blocks.musicEntertainer":"娱乐","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"颂歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"铃声","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"蓝调","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚礼","iotbit.blocks.musicFuneral":"葬礼","iotbit.blocks.musicPunchline":"笑点","iotbit.blocks.musicPython":"贪吃蛇","iotbit.blocks.musicBaddy":"坏人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"奖励","iotbit.blocks.musicWawawawaa":"退场","iotbit.blocks.musicJumpUp":"跳起来","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打开电源","iotbit.blocks.musicPowerDown":"关闭电源","iotbit.blocks.magneticForce":"磁力%1","iotbit.blocks.strength":"强度","iotbit.blocks.compassHeading":"指南针朝向","iotbit.blocks.calibrateCompass":"校准指南针","iotbit.blocks.acceleration":"加速度%1","iotbit.blocks.accelerometerRange":"将加速计范围设为%1","iotbit.blocks.gyroscope":"陀螺仪%1","iotbit.blocks.rotation":"旋转%1","iotbit.blocks.rotationPitch":"俯仰","iotbit.blocks.rotationRoll":"横滚","iotbit.blocks.rotationYaw":"偏航","iotbit.blocks.gesture":"%1 手势？","iotbit.blocks.gestureShake":"震动","iotbit.blocks.gestureLedsUp":"LED 朝上","iotbit.blocks.gestureLedsDown":"LED 朝下","iotbit.blocks.gestureScreenUp":"屏幕朝上","iotbit.blocks.gestureScreenDown":"屏幕朝下","iotbit.blocks.gestureTiltLeft":"向左倾斜","iotbit.blocks.gestureTiltRight":"向右倾斜","iotbit.blocks.gestureFreeFall":"自由落体","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"光线强度","iotbit.blocks.loudness":"声音响度","iotbit.blocks.setLeds":"将第 %1 个灯设为 %2 亮度 %3","iotbit.blocks.closeLeds":"关闭所有灯","iotbit.blocks.display":"显示","iotbit.blocks.displayText":"在 x:%2 y:%3 显示 %1","iotbit.blocks.displayTextLine":"在第%2行显示%1","iotbit.blocks.displayImage":"显示%1","iotbit.blocks.displayClear":"清除屏幕","iotbit.blocks.displayPixel":"在 x1:%1 y1:%2 画点","iotbit.blocks.displayLine":"从 x1:%1 y1:%2 到 x2:%3 y2:%4 的画线","iotbit.blocks.displayEllipse":"在 x:%3 y:%4 画横半径:%1 纵半径:%2 的椭圆","iotbit.blocks.displayRect":"在 x:%3 y:%4 画宽:%1 高:%2 的矩形","iotbit.blocks.displayFill":"在 x:%3 y:%4 填充宽:%1 高:%2 的矩形"};var $2={"iotbit.menubar.device":"iot:bit","iotbit.emu.greenFlag":"運行","iotbit.emu.stop":"停止","iotbit.emu.smallStage":"縮小舞臺","iotbit.emu.largeStage":"放大舞臺","esp32.extension.tags.controllers":"輸入模組","esp32.extension.tags.sensors":"傳感器","esp32.extension.tags.actuators":"執行器","esp32.extension.tags.displays":"顯示模組","esp32.extension.tags.modules":"智能模組","esp32.extension.tags.communication":"通訊","esp32.extension.tags.data":"數據","esp32.extension.tags.kits":"套件","esp32.blocks.wait":"等待 %1 毫秒","esp32.blocks.break":"跳出重複","esp32.blocks.continue":"跳到下一次","esp32.blocks.elseif":"否則，如果 %1 那麼","esp32.blocks.else":"否則","esp32.blocks.runtime":"運行時長 %1","esp32.blocks.runtimeMilliseconds":"毫秒","esp32.blocks.runtimeSeconds":"秒","esp32.blocks.dataConvert":"將 %1 轉為 %2","esp32.blocks.dataConvert.int":"整數","esp32.blocks.dataConvert.float":"浮點數","esp32.blocks.dataConvert.string":"字符串","esp32.blocks.dataConvert.list":"列表","esp32.blocks.dataConvert.bytes":"字節數組","esp32.blocks.dataLengthOf":"%1 長度","esp32.blocks.dataConstrain":"約束 %1 在 %2 和 %3 之間","esp32.blocks.dataMap":"映射 %1 從 %2 - %3 到 %4 - %5","esp32.blocks.whenstart":"當 {name} 開始","esp32.blocks.timerset":"定時器 #%1 每間隔 %2 毫秒執行","esp32.blocks.timeroff":"關閉定時器 #%1","esp32.blocks.operatorLarger":"%1 和 %2 之中最大","esp32.blocks.operatorSmaller":"%1 和 %2 之中最小","esp32.blocks.pin":"引腳","esp32.blocks.setmode":"將引腳 %1 設為 %2 模式","esp32.blocks.inputMode":"輸入","esp32.blocks.ouputMode":"輸出","esp32.blocks.inputPullUpMode":"上拉輸入","esp32.blocks.inputPullDownMode":"下拉輸入","esp32.blocks.setdigital":"將引腳 %1 設為 %2","esp32.blocks.digitalHigh":"高電平","esp32.blocks.digitalLow":"低電平","esp32.blocks.setpwmfreq":"將引腳 %1 PWM 頻率設為 %2","esp32.blocks.setpwm":"將引腳 %1 PWM 設為 %2","esp32.blocks.setanalog":"將引腳 %1 模擬值設為 %2","esp32.blocks.isDigitalHigh":"引腳 %1 是高電平？","esp32.blocks.analogValue":"引腳 %1 模擬值","esp32.blocks.attachinterrupt":"將引腳 %1 中斷模式設為 %2","esp32.blocks.interruptRising":"電平上升","esp32.blocks.interruptFalling":"電平下降","esp32.blocks.interruptChange":"電平改變","esp32.blocks.interruptHigh":"高電平","esp32.blocks.interruptLow":"低電平","esp32.blocks.detachinterrupt":"取消引腳 %1 中斷","esp32.blocks.network":"網絡","esp32.blocks.protocols":"協議","esp32.blocks.serial":"串口","esp32.blocks.serialBaudrate":"將波特率設為 %1","esp32.blocks.serialTimeout":"將通訊超時設為 %1 毫秒","esp32.blocks.serialPrint":"用 %2 模式打印 %1","esp32.blocks.serialPrintWarp":"換行","esp32.blocks.serialPrintNoWarp":"不換行","esp32.blocks.serialPrintHEX":"16進制","esp32.blocks.serialAvailable":"存在可讀取數據?","esp32.blocks.serialAvailableLength":"可讀取數據長度","esp32.blocks.serialReadString":"讀取文本","esp32.blocks.serialReadStringUntil":"讀取文本直到 %1","esp32.blocks.serialReadParse":"讀取 %1","esp32.blocks.serialReadParseInteger":"整數","esp32.blocks.serialReadParseFloat":"浮點數","esp32.blocks.serialRead":"讀取 1 個字節","esp32.blocks.serialReadBytes":"讀取 %1 個字節","esp32.blocks.text":"文本","esp32.blocks.textEquals":"%1 和 %2 相同（忽視大小寫）？","esp32.blocks.textRemove":"刪除 %3 從第 %1 個到第 %2 個字符","esp32.blocks.textReplace":"將 %2 中的 %1 替換為 %3","esp32.blocks.textReplaceLetter":"將 %2 中的第 %1 個字符替換為 %3","esp32.blocks.textSubstring":"截取 %1 從第 %2 個到第 %3 個字符","esp32.blocks.textFind":"在 %2 中查找 %1 的位置","esp32.blocks.textWith":"%1 %2 %3?","esp32.blocks.textStartsWith":"開始於","esp32.blocks.textEndsWith":"結束於","esp32.blocks.textCase":"將 %2 字母轉為 %1","esp32.blocks.textLowerCase":"小寫","esp32.blocks.textUpperCase":"大寫","esp32.blocks.textTrim":"清除 %1 前後空白字符","esp32.blocks.textConvert":"將 %1 轉為 %2","esp32.blocks.textConvertFrom":"將 %1 轉為文本","esp32.blocks.connectWifi":"連接 Wi-Fi 網絡 SSID: %1 密碼: %2","esp32.blocks.disconnectWifi":"斷開 Wi-Fi 網絡","esp32.blocks.networkCofing":"本地 %1","esp32.blocks.networkCofingIp":"IP","esp32.blocks.networkCofingMac":"MAC 地址","esp32.blocks.isWifiConnected":"Wi-Fi 網絡已連接？","esp32.blocks.wifiScan":"開始掃描 Wi-Fi","esp32.blocks.wifiItem":"第 %1 個可用 Wi-Fi 的 %2","esp32.blocks.wifiItemSsid":"SSID","esp32.blocks.wifiItemRssi":"RSSI","esp32.blocks.wifiItemSecurity":"加密類型","esp32.blocks.wifiItemMac":"MAC 地址","esp32.blocks.wifiCounts":"可用 Wi-Fi 數量","esp32.blocks.startap":"開啟 AP SSID: %1","esp32.blocks.stopap":"關閉 AP","esp32.blocks.espnowBroadcast":"ESP-Now 廣播 %1","esp32.blocks.espnowSend":"ESP-Now 發送 %1 給 %2","esp32.blocks.espnowRecv":"等待 ESP-Now 接收消息","esp32.blocks.espnowMsg":"收到的 %1","esp32.blocks.espnowMsgText":"文本","esp32.blocks.espnowMsgBytes":"字節數組","esp32.blocks.espnowMsgMac":"MAC 地址","esp32.blocks.espnowRepeat":"等待 ESP-Now 收到消息","esp32.blocks.espnowWhen":"當 ESP-Now 收到 %1","esp32.blocks.spiInit":"初始化SPI %1 頻率:%2Hz","esp32.blocks.spiHSPI":"HSPI","esp32.blocks.spiVSPI":"VSPI","esp32.blocks.spiWrite":"SPI %1 寫入 %2","esp32.blocks.spiRead":"SPI %1 讀取 %2 位元組","esp32.blocks.i2cInit":"初始化I2C SDA:%1 SCL:%2 頻率:%3Hz","esp32.blocks.i2cScan":"I2C掃描設備","esp32.blocks.i2cWrite":"I2C寫入到 %1:%2","esp32.blocks.i2cRead":"I2C從 %1 讀取 %2 位元組","esp32.blocks.i2sInit":"初始化I2S BCK:%1 WS:%2 DATA:%3 速率:%4Hz","esp32.blocks.i2sPlay":"I2S播放 %1","esp32.blocks.terminal":"終端","esp32.blocks.terminalPrint":"打印 %1","esp32.blocks.temperature":"温度","iotbit.blocks.whenstart":"當 %1 開始運行","iotbit.blocks.pinTouched":"當 %1 被觸摸","iotbit.blocks.playNote":"演奏音符 %1 %2 拍","iotbit.blocks.playMusic":"播放 %1","iotbit.blocks.playMusicDone":"播放 %1 直到結束","iotbit.blocks.stopMusic":"停止播放","iotbit.blocks.musicDadadadum":"開場","iotbit.blocks.musicEntertainer":"娛樂","iotbit.blocks.musicPrelude":"前奏","iotbit.blocks.musicOde":"頌歌","iotbit.blocks.musicNyan":"初音","iotbit.blocks.musicRingtone":"鈴聲","iotbit.blocks.musicFunk":"恐慌","iotbit.blocks.musicBlues":"藍調","iotbit.blocks.musicBirthday":"生日","iotbit.blocks.musicWedding":"婚禮","iotbit.blocks.musicFuneral":"葬禮","iotbit.blocks.musicPunchline":"笑點","iotbit.blocks.musicPython":"貪吃蛇","iotbit.blocks.musicBaddy":"壞人","iotbit.blocks.musicChase":"追逐","iotbit.blocks.musicBaDing":"獎勵","iotbit.blocks.musicWawawawaa":"退場","iotbit.blocks.musicJumpUp":"跳起來","iotbit.blocks.musicJumpDown":"跳下去","iotbit.blocks.musicPowerUp":"打開電源","iotbit.blocks.musicPowerDown":"關閉電源","iotbit.blocks.magneticForce":"磁力%1","iotbit.blocks.strength":"強度","iotbit.blocks.compassHeading":"指南針朝向","iotbit.blocks.calibrateCompass":"校準指南針","iotbit.blocks.acceleration":"加速度%1","iotbit.blocks.accelerometerRange":"將加速計範圍設為%1","iotbit.blocks.gyroscope":"陀螺儀%1","iotbit.blocks.rotation":"旋轉%1","iotbit.blocks.rotationPitch":"俯仰","iotbit.blocks.rotationRoll":"橫滾","iotbit.blocks.rotationYaw":"偏航","iotbit.blocks.gesture":"%1 手勢？","iotbit.blocks.gestureShake":"震動","iotbit.blocks.gestureLedsUp":"LED 朝上","iotbit.blocks.gestureLedsDown":"LED 朝下","iotbit.blocks.gestureScreenUp":"屏幕朝上","iotbit.blocks.gestureScreenDown":"屏幕朝下","iotbit.blocks.gestureTiltLeft":"向左傾斜","iotbit.blocks.gestureTiltRight":"向右傾斜","iotbit.blocks.gestureFreeFall":"自由落體","iotbit.blocks.gesture3g":"3g","iotbit.blocks.gesture6g":"6g","iotbit.blocks.gesture8g":"8g","iotbit.blocks.brightness":"光線強度","iotbit.blocks.loudness":"聲音響度","iotbit.blocks.setLeds":"將第 %1 個燈設為 %2 亮度 %3","iotbit.blocks.closeLeds":"關閉所有燈","iotbit.blocks.display":"顯示","iotbit.blocks.displayText":"在 x:%2 y:%3 顯示 %1","iotbit.blocks.displayTextLine":"在第%2行顯示%1","iotbit.blocks.displayImage":"顯示%1","iotbit.blocks.displayClear":"清除屏幕","iotbit.blocks.displayPixel":"在 x1:%1 y1:%2 畫點","iotbit.blocks.displayLine":"從 x1:%1 y1:%2 到 x2:%3 y2:%4 的畫線","iotbit.blocks.displayEllipse":"在 x:%3 y:%4 畫橫半徑:%1 縱半徑:%2 的橢圓","iotbit.blocks.displayRect":"在 x:%3 y:%4 畫寬:%1 高:%2 的矩形","iotbit.blocks.displayFill":"在 x:%3 y:%4 填充寬:%1 高:%2 的矩形"};te({en:A2,"zh-Hans":P2,"zh-Hant":$2});import{svgAsDataUri as Z1}from"@blockcode/utils";import{ScratchBlocks as z,blocksTab as B1,codeReviewTab as W1,CodeReview as mi}from"@blockcode/blocks";import{terminalTab as V1}from"@blockcode/code";import{Text as F1}from"@blockcode/core";function w(t){if(typeof t!=="string")throw TypeError("Path must be a string. Received "+JSON.stringify(t))}function Z2(t,e){var s="",o=0,i=-1,l=0,a;for(var r=0;r<=t.length;++r){if(r<t.length)a=t.charCodeAt(r);else if(a===47)break;else a=47;if(a===47){if(i===r-1||l===1);else if(i!==r-1&&l===2){if(s.length<2||o!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var u=s.lastIndexOf("/");if(u!==s.length-1){if(u===-1)s="",o=0;else s=s.slice(0,u),o=s.length-1-s.lastIndexOf("/");i=r,l=0;continue}}else if(s.length===2||s.length===1){s="",o=0,i=r,l=0;continue}}if(e){if(s.length>0)s+="/..";else s="..";o=2}}else{if(s.length>0)s+="/"+t.slice(i+1,r);else s=t.slice(i+1,r);o=r-i-1}i=r,l=0}else if(a===46&&l!==-1)++l;else l=-1}return s}function ee(t,e){var s=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");if(!s)return o;if(s===e.root)return s+o;return s+t+o}function a2(){var t="",e=!1,s;for(var o=arguments.length-1;o>=-1&&!e;o--){var i;if(o>=0)i=arguments[o];else{if(s===void 0)s=process.cwd();i=s}if(w(i),i.length===0)continue;t=i+"/"+t,e=i.charCodeAt(0)===47}if(t=Z2(t,!e),e)if(t.length>0)return"/"+t;else return"/";else if(t.length>0)return t;else return"."}function B2(t){if(w(t),t.length===0)return".";var e=t.charCodeAt(0)===47,s=t.charCodeAt(t.length-1)===47;if(t=Z2(t,!e),t.length===0&&!e)t=".";if(t.length>0&&s)t+="/";if(e)return"/"+t;return t}function se(t){return w(t),t.length>0&&t.charCodeAt(0)===47}function oe(){if(arguments.length===0)return".";var t;for(var e=0;e<arguments.length;++e){var s=arguments[e];if(w(s),s.length>0)if(t===void 0)t=s;else t+="/"+s}if(t===void 0)return".";return B2(t)}function ie(t,e){if(w(t),w(e),t===e)return"";if(t=a2(t),e=a2(e),t===e)return"";var s=1;for(;s<t.length;++s)if(t.charCodeAt(s)!==47)break;var o=t.length,i=o-s,l=1;for(;l<e.length;++l)if(e.charCodeAt(l)!==47)break;var a=e.length,r=a-l,u=i<r?i:r,p=-1,n=0;for(;n<=u;++n){if(n===u){if(r>u){if(e.charCodeAt(l+n)===47)return e.slice(l+n+1);else if(n===0)return e.slice(l+n)}else if(i>u){if(t.charCodeAt(s+n)===47)p=n;else if(n===0)p=0}break}var m=t.charCodeAt(s+n),d=e.charCodeAt(l+n);if(m!==d)break;else if(m===47)p=n}var c="";for(n=s+p+1;n<=o;++n)if(n===o||t.charCodeAt(n)===47)if(c.length===0)c+="..";else c+="/..";if(c.length>0)return c+e.slice(l+p);else{if(l+=p,e.charCodeAt(l)===47)++l;return e.slice(l)}}function le(t){return t}function ne(t){if(w(t),t.length===0)return".";var e=t.charCodeAt(0),s=e===47,o=-1,i=!0;for(var l=t.length-1;l>=1;--l)if(e=t.charCodeAt(l),e===47){if(!i){o=l;break}}else i=!1;if(o===-1)return s?"/":".";if(s&&o===1)return"//";return t.slice(0,o)}function r2(t,e){if(e!==void 0&&typeof e!=="string")throw TypeError('"ext" argument must be a string');w(t);var s=0,o=-1,i=!0,l;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,r=-1;for(l=t.length-1;l>=0;--l){var u=t.charCodeAt(l);if(u===47){if(!i){s=l+1;break}}else{if(r===-1)i=!1,r=l+1;if(a>=0)if(u===e.charCodeAt(a)){if(--a===-1)o=l}else a=-1,o=r}}if(s===o)o=r;else if(o===-1)o=t.length;return t.slice(s,o)}else{for(l=t.length-1;l>=0;--l)if(t.charCodeAt(l)===47){if(!i){s=l+1;break}}else if(o===-1)i=!1,o=l+1;if(o===-1)return"";return t.slice(s,o)}}function p2(t){w(t);var e=-1,s=0,o=-1,i=!0,l=0;for(var a=t.length-1;a>=0;--a){var r=t.charCodeAt(a);if(r===47){if(!i){s=a+1;break}continue}if(o===-1)i=!1,o=a+1;if(r===46){if(e===-1)e=a;else if(l!==1)l=1}else if(e!==-1)l=-1}if(e===-1||o===-1||l===0||l===1&&e===o-1&&e===s+1)return"";return t.slice(e,o)}function ae(t){if(t===null||typeof t!=="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return ee("/",t)}function re(t){w(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var s=t.charCodeAt(0),o=s===47,i;if(o)e.root="/",i=1;else i=0;var l=-1,a=0,r=-1,u=!0,p=t.length-1,n=0;for(;p>=i;--p){if(s=t.charCodeAt(p),s===47){if(!u){a=p+1;break}continue}if(r===-1)u=!1,r=p+1;if(s===46){if(l===-1)l=p;else if(n!==1)n=1}else if(l!==-1)n=-1}if(l===-1||r===-1||n===0||n===1&&l===r-1&&l===a+1){if(r!==-1)if(a===0&&o)e.base=e.name=t.slice(1,r);else e.base=e.name=t.slice(a,r)}else{if(a===0&&o)e.name=t.slice(1,l),e.base=t.slice(1,r);else e.name=t.slice(a,l),e.base=t.slice(a,r);e.ext=t.slice(l,r)}if(a>0)e.dir=t.slice(0,a-1);else if(o)e.dir="/";return e}var pe="/",ce=":",J1=((t)=>(t.posix=t,t))({resolve:a2,normalize:B2,isAbsolute:se,join:oe,relative:ie,_makeLong:le,dirname:ne,basename:r2,extname:p2,format:ae,parse:re,sep:pe,delimiter:ce,win32:null,posix:null});import{useCallback as Le,useEffect as Re}from"preact/hooks";import{useAppContext as ye,useProjectContext as Oe,setMeta as Ee}from"@blockcode/core";import{MicroPythonGenerator as we,BlocksEditor as ve}from"@blockcode/blocks";import{translate as f,themeColors as c2}from"@blockcode/core";var W2=[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P6","16"],["P7","17"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P13","18"],["P14","19"],["P15","21"],["P16","5"],["P19","22"],["P20","23"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]],V2=[["P0","33"],["P1","32"],["P5","0"],["P6","16"],["P7","17"],["P8","26"],["P9","25"],["P11","2"],["P13","18"],["P14","19"],["P15","21"],["P16","5"],["P19","22"],["P20","23"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]],de=[["P0","33"],["P1","32"],["P2","35"],["P3","34"],["P4","39"],["P5","0"],["P8","26"],["P9","25"],["P10","36"],["P11","2"],["P23","27"],["P24","14"],["P25","12"],["P26","13"],["P27","15"],["P28","4"]],ue=[["P8","26"],["P9","25"]],d2=()=>({all:W2,in:W2,out:V2,adc:de,dac:ue,pwm:V2}),F2=()=>{let t=d2();return{id:"pin",name:f("esp32.blocks.pin","Pins"),themeColor:c2.blocks.motion.primary,inputColor:c2.blocks.motion.secondary,otherColor:c2.blocks.motion.tertiary,order:0,blocks:[{id:"setmode",text:f("esp32.blocks.setmode","set pin %1 mode to %2"),inputs:{PIN:{menu:t.all},MODE:{menu:[[f("esp32.blocks.ouputMode","output"),"OUTPUT"],[f("esp32.blocks.inputMode","input"),"INPUT"],[f("esp32.blocks.inputPullUpMode","input pull-up"),"INPUT_PULLUP"],[f("esp32.blocks.inputPullDownMode","input pull-down"),"INPUT_PULLDOWN"]]}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=e.getFieldValue("MODE")||"OUTPUT";this.definitions_.import_pin="from machine import Pin";let l="";if(i==="INPUT")l=`${o} = Pin(${s}, Pin.IN)`;else if(i==="INPUT_PULLUP")l=`${o} = Pin(${s}, Pin.IN, Pin.PULL_UP)`;else if(i==="INPUT_PULLDOWN")l=`${o} = Pin(${s}, Pin.IN, Pin.PULL_DOWN)`;else l=`${o} = Pin(${s}, Pin.OUT)`;return this.definitions_[o]=l,""}},"---",{id:"setdigital",text:f("esp32.blocks.setdigital","set pin %1 to %2"),inputs:{PIN:{menu:t.out},VALUE:{inputMode:!0,type:"integer",defaultValue:"1",menu:[[f("esp32.blocks.digitalHigh","high"),"1"],[f("esp32.blocks.digitalLow","low"),"0"]]}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=this.valueToCode(e,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=this.definitions_[o]??`${o} = Pin(${s}, Pin.OUT)`,`${o}.value(${i})
`}},{id:"setDAC",text:f("esp32.blocks.setanalog","set pin %1 analog to %2"),inputs:{PIN:{menu:t.dac},VALUE:{shadow:"slider255"}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=this.valueToCode(e,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_dac="from machine import DAC",this.definitions_[o]=`${o} = DAC(Pin(${s}))`,`${o}.write(${i})
`}},{id:"slider255",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:255,step:1,defaultValue:128}},mpy(e){return[e.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},{id:"digital",text:f("esp32.blocks.isDigitalHigh","pin %1 is high?"),output:"boolean",inputs:{PIN:{menu:t.in}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=`${o} = Pin(${s}, Pin.IN)`,[`(${o}.value() == 1)`,this.ORDER_RELATIONAL]}},{id:"analog",text:f("esp32.blocks.analogValue","pin %1 analog value"),output:"integer",inputs:{PIN:{menu:t.adc}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`;return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_adc="from machine import ADC",this.definitions_[o]=`${o} = ADC(Pin(${s}))`,this.definitions_[`${o}_atten`]=`${o}.atten(ADC.ATTN_11DB)`,this.definitions_[`${o}_width`]=`${o}.width(ADC.WIDTH_10BIT)`,[`${o}.read()`,this.ORD_FUNCTION_CALL]}},"---",{id:"setPWMFreq",text:f("esp32.blocks.setpwmfreq","set pin %1 pwm frequency to %2 Hz"),inputs:{PIN:{menu:t.pwm},FREQ:{type:"integer",defaultValue:"1000"}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=this.valueToCode(e,"FREQ",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${s}), freq=1000)`,`${o}.freq(${i})
`}},{id:"setPWM",text:f("esp32.blocks.setpwm","set pin %1 pwm to %2"),inputs:{PIN:{menu:t.pwm},VALUE:{shadow:"slider1023"}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=this.valueToCode(e,"VALUE",this.ORDER_NONE);return this.definitions_.import_pin="from machine import Pin",this.definitions_.import_pwm="from machine import PWM",this.definitions_[o]=`${o} = PWM(Pin(${s}), freq=1000)`,`${o}.duty(${i})
`}},{id:"slider1023",shadow:!0,output:"integer",inputs:{VALUE:{type:"slider",min:0,max:1023,step:1,defaultValue:512}},mpy(e){return[e.getFieldValue("VALUE")||0,this.ORDER_ATOMIC]}},"---",{id:"attachinterrupt",text:f("esp32.blocks.attachinterrupt","attach pin %1 interrupt to %2"),substack:!0,inputs:{PIN:{menu:t.in},INTERRUPT:{menu:[[f("esp32.blocks.interruptRising","rising"),"RISING"],[f("esp32.blocks.interruptFalling","falling"),"FALLING"],[f("esp32.blocks.interruptChange","change"),"CHANGE"],[f("esp32.blocks.interruptHigh","high"),"HIGH"],[f("esp32.blocks.interruptLow","low"),"LOW"]]}},mpy(e){let s=e.getFieldValue("PIN")||0,o=`pin_${s}`,i=this.createName("event_flag"),l=e.getFieldValue("INTERRUPT")||"RISING";this.definitions_.import_pin="from machine import Pin",this.definitions_[o]=this.definitions_[o]??`${o} = Pin(${s}, Pin.IN)`,this.definitions_[i]=`${i} = asyncio.ThreadSafeFlag()`;let a=this.statementToCode(e,"SUBSTACK")||this.PASS,r="";r+=`while True:
`,r+=`${this.INDENT}await ${i}.wait()
`,r+=a,a=this.prefixLines(r,this.INDENT),a=this.addEventTrap(a,"pin_irq"),r=`@_tasks__.append
`,r+=a,this.definitions_[`${i}_callback`]=r;let p={RISING:"Pin.IRQ_RISING",FALLING:"Pin.IRQ_FALLING",CHANGE:"Pin.IRQ_RISING | Pin.IRQ_FALLING",HIGH:"Pin.IRQ_HIGH_LEVEL",LOW:"Pin.IRQ_LOW_LEVEL"}[l]||"Pin.IRQ_RISING";return`${o}.irq(trigger=${p}, handler=lambda _: ${i}.set())
`}},{id:"detachinterrupt",text:f("esp32.blocks.detachinterrupt","detach pin %1 interrupt"),inputs:{PIN:{menu:t.in}},mpy(e){return`pin_${e.getFieldValue("PIN")||0}.irq(handler=None)
`}}]}};import{translate as O,themeColors as u2}from"@blockcode/core";var G2=()=>({id:"display",name:O("iotbit.blocks.display","Display"),themeColor:u2.blocks.looks.primary,inputColor:u2.blocks.looks.secondary,otherColor:u2.blocks.looks.tertiary,order:1,blocks:[{id:"setLeds",text:O("iotbit.blocks.setLeds","set led %1 %2 brightness %3"),inputs:{POS:{type:"positive_integer",defaultValue:1,inputMode:!0,menu:[1,2,3]},COLOR:{type:"color"},BRIGHTNESS:{shadow:"brightnessSlider",defaultValue:10}},mpy(t){let e=this.getAdjusted(t,"POS"),s=this.valueToCode(t,"COLOR",this.ORDER_NONE),o=this.valueToCode(t,"BRIGHTNESS",this.ORDER_NONE),i=`pixels.set_led(${e}, ${o}, ${s})
`;if(t.getNextBlock()?.type.endsWith("_setLeds"))return i;return i+=`pixels.write()
`,i},emu(t){let e=this.getAdjusted(t,"POS"),s=this.valueToCode(t,"COLOR",this.ORDER_NONE),o=this.valueToCode(t,"BRIGHTNESS",this.ORDER_NONE);return`runtime.setLed(${e}, ${s}, ${o});
`}},{id:"brightnessSlider",shadow:!0,output:"number",inputs:{BRIGHTNESS:{type:"slider",defaultValue:0,min:0,max:10}},mpy(t){return[t.getFieldValue("BRIGHTNESS")||0,this.ORDER_NONE]},emu(t){return[t.getFieldValue("BRIGHTNESS")||0,this.ORDER_NONE]}},{id:"closeLeds",text:O("iotbit.blocks.closeLeds","close leds"),mpy(t){return`pixels.clear()
`},emu(t){return`runtime.clearLeds();
`}},"---",{id:"displayText",text:O("iotbit.blocks.displayText","display text %1 at x: %2 y: %3"),inputs:{TEXT:{type:"string",defaultValue:"hello"},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"TEXT",this.ORDER_NONE),s=this.valueToCode(t,"X",this.ORDER_NONE),o=this.valueToCode(t,"Y",this.ORDER_NONE),i=`display.write(f"{${e}}", ${s}, ${o})
`,l=t.getNextBlock();if(l&&l.type.search(/_display[\w]+$/)!==-1)return i;return i+=`display.show()
`,i},emu(t){let e=this.valueToCode(t,"TEXT",this.ORDER_NONE)||'""',s=this.valueToCode(t,"X",this.ORDER_NONE),o=this.valueToCode(t,"Y",this.ORDER_NONE);return`runtime.drawText(\`\${${e}}\`, ${s}, ${o});
`}},{id:"displayTextLine",text:O("iotbit.blocks.displayTextLine","display text %1 at line %2"),inputs:{TEXT:{type:"string",defaultValue:"hello world"},LINE:{menu:[1,2,3,4,5]}},mpy(t){let e=this.valueToCode(t,"TEXT",this.ORDER_NONE),s=parseInt(t.getFieldValue("LINE"))-1,o=`display.write(f"{${e}}", 2, ${s*13}, wrap=True)
`,i=t.getNextBlock();if(i&&i.type.search(/_display[\w]+$/)!==-1)return o;return o+=`display.show()
`,o},emu(t){let e=this.valueToCode(t,"TEXT",this.ORDER_NONE)||'""',s=parseInt(t.getFieldValue("LINE"))-1;return`runtime.drawTextLine(\`\${${e}}\`, ${s});
`}},{id:"displayClear",text:O("iotbit.blocks.displayClear","clear display"),mpy(t){let e=`display.fill(0)
`,s=t.getNextBlock();if(s&&s.type.search(/_display[\w]+$/)!==-1)return e;return e+=`display.show()
`,e},emu(t){return`runtime.clearScreen();
`}},"---",{id:"displayPixel",text:O("iotbit.blocks.displayPixel","pixel x:%1 y:%2"),inputs:{X:{type:"integer",defaultValue:10},Y:{type:"integer",defaultValue:10}},mpy(t){let e=this.valueToCode(t,"X",this.ORDER_NONE),s=this.valueToCode(t,"Y",this.ORDER_NONE),o=`display.pixel(${e}, ${s}, 1)
`,i=t.getNextBlock();if(i&&i.type.search(/_display[\w]+$/)!==-1)return o;return o+=`display.show()
`,o},emu(t){let e=this.valueToCode(t,"X",this.ORDER_NONE),s=this.valueToCode(t,"Y",this.ORDER_NONE);return`runtime.drawPixel(${e}, ${s});
`}},{id:"displayLine",text:O("iotbit.blocks.displayLine","line from x1:%1 y1:%2 to x2:%3 y2%4"),inputs:{X1:{type:"integer",defaultValue:0},Y1:{type:"integer",defaultValue:0},X2:{type:"integer",defaultValue:20},Y2:{type:"integer",defaultValue:20}},mpy(t){let e=this.valueToCode(t,"X1",this.ORDER_NONE),s=this.valueToCode(t,"Y1",this.ORDER_NONE),o=this.valueToCode(t,"X2",this.ORDER_NONE),i=this.valueToCode(t,"Y2",this.ORDER_NONE),l=`display.line(${e}, ${s}, ${o}, ${i})
`,a=t.getNextBlock();if(a&&a.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l},emu(t){let e=this.valueToCode(t,"X1",this.ORDER_NONE),s=this.valueToCode(t,"Y1",this.ORDER_NONE),o=this.valueToCode(t,"X2",this.ORDER_NONE),i=this.valueToCode(t,"Y2",this.ORDER_NONE);return`runtime.drawLine(${e}, ${s}, ${o}, ${i});
`}},{id:"displayEllipse",text:O("iotbit.blocks.displayEllipse","ellipse with x-radius:%1 and y-radius:%2 at x:%3 y:%4"),inputs:{RX:{type:"positive_integer",defaultValue:20},RY:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"RX",this.ORDER_NONE),s=this.valueToCode(t,"RY",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.ellipse(${o}, ${i}, ${e}, ${s})
`,a=t.getNextBlock();if(a&&a.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l},emu(t){let e=this.valueToCode(t,"RX",this.ORDER_NONE),s=this.valueToCode(t,"RY",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE);return`runtime.drawEllipse(${o}, ${i}, ${e}, ${s});
`}},{id:"displayRect",text:O("iotbit.blocks.displayRect","rect with width:%1 height:%2 at x:%3 y:%4"),inputs:{WIDTH:{type:"positive_integer",defaultValue:20},HEIGHT:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"WIDTH",this.ORDER_NONE),s=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.rect(${o}, ${i}, ${e}, ${s})
`,a=t.getNextBlock();if(a&&a.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l},emu(t){let e=this.valueToCode(t,"WIDTH",this.ORDER_NONE),s=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE);return`runtime.drawRect(${o}, ${i}, ${e}, ${s});
`}},{id:"displayFill",text:O("iotbit.blocks.displayFill","fill with width:%1 height:%2 at x:%3 y:%4"),inputs:{WIDTH:{type:"positive_integer",defaultValue:20},HEIGHT:{type:"positive_integer",defaultValue:10},X:{type:"integer",defaultValue:0},Y:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"WIDTH",this.ORDER_NONE),s=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE),l=`display.fill_rect(${o}, ${i}, ${e}, ${s})
`,a=t.getNextBlock();if(a&&a.type.search(/_display[\w]+$/)!==-1)return l;return l+=`display.show()
`,l},emu(t){let e=this.valueToCode(t,"WIDTH",this.ORDER_NONE),s=this.valueToCode(t,"HEIGHT",this.ORDER_NONE),o=this.valueToCode(t,"X",this.ORDER_NONE),i=this.valueToCode(t,"Y",this.ORDER_NONE);return`runtime.fillRect(${o}, ${i}, ${e}, ${s});
`}}]});import{translate as b,themeColors as b2}from"@blockcode/core";var U2=()=>({id:"sound",name:"%{BKY_CATEGORY_SOUND}",themeColor:b2.blocks.sounds.primary,inputColor:b2.blocks.sounds.secondary,otherColor:b2.blocks.sounds.tertiary,order:2,blocks:[{id:"playnote",text:b("iotbit.blocks.playNote","play note %1 for %2 beats"),inputs:{NOTE:{type:"note",defaultValue:"60"},BEAT:{type:"integer",defaultValue:"1"}},mpy(t){let e=this.valueToCode(t,"NOTE",this.ORDER_NONE),s=this.valueToCode(t,"BEAT",this.ORDER_NONE);return`await audio.aplay(${e}":${s}")
`},emu(t){let e=this.valueToCode(t,"NOTE",this.ORDER_NONE),s=this.valueToCode(t,"BEAT",this.ORDER_NONE);return`await runtime.tone.play(${e} + ":${s}");
`}},"---",{id:"playmusicawait",text:b("iotbit.blocks.playMusicDone","play sound %1 until done"),inputs:{MUSIC:{menu:"MUSIC"}},mpy(t){return`await audio.aplay(Music.${t.getFieldValue("MUSIC")})
`},emu(t){return`await runtime.tone.play(runtime.tone.Music.${t.getFieldValue("MUSIC")});
`}},{id:"playmusic",text:b("iotbit.blocks.playMusic","start sound %1"),inputs:{MUSIC:{menu:"MUSIC"}},mpy(t){return`asyncio.create_task(audio.aplay(Music.${t.getFieldValue("MUSIC")}))
`},emu(t){return`runtime.tone.play(runtime.tone.Music.${t.getFieldValue("MUSIC")});
`}},{id:"stopmusic",text:b("iotbit.blocks.stopMusic","stop music"),mpy(t){return`audio.stop()
`},emu(t){return`runtime.tone.stop();
`}}],menus:{MUSIC:{type:"string",defaultValue:"DADADADUM",items:[[b("iotbit.blocks.musicDadadadum","dadadadum"),"DADADADUM"],[b("iotbit.blocks.musicEntertainer","entertainer"),"ENTERTAINER"],[b("iotbit.blocks.musicPrelude","prelude"),"PRELUDE"],[b("iotbit.blocks.musicOde","ode"),"ODE"],[b("iotbit.blocks.musicNyan","nyan"),"NYAN"],[b("iotbit.blocks.musicRingtone","ringtone"),"RINGTONE"],[b("iotbit.blocks.musicFunk","funk"),"FUNK"],[b("iotbit.blocks.musicBlues","blues"),"BLUES"],[b("iotbit.blocks.musicBirthday","birthday"),"BIRTHDAY"],[b("iotbit.blocks.musicWedding","wedding"),"WEDDING"],[b("iotbit.blocks.musicFuneral","funeral"),"FUNERAL"],[b("iotbit.blocks.musicPunchline","punchline"),"PUNCHLINE"],[b("iotbit.blocks.musicPython","python"),"PYTHON"],[b("iotbit.blocks.musicBaddy","baddy"),"BADDY"],[b("iotbit.blocks.musicChase","chase"),"CHASE"],[b("iotbit.blocks.musicBaDing","ba ding"),"BA_DING"],[b("iotbit.blocks.musicWawawawaa","wawawawaa"),"WAWAWAWAA"],[b("iotbit.blocks.musicJumpUp","jump up"),"JUMP_UP"],[b("iotbit.blocks.musicJumpDown","jump down"),"JUMP_DOWN"],[b("iotbit.blocks.musicPowerUp","power up"),"POWER_UP"],[b("iotbit.blocks.musicPowerDown","power down"),"POWER_DOWN"]]}}});import{translate as J,themeColors as h2}from"@blockcode/core";import{ScratchBlocks as he}from"@blockcode/blocks";var q="./assets/icon-device-qx17f37n.svg";var H2=["1","2","3","4"],Y2=()=>({id:"event",name:"%{BKY_CATEGORY_EVENTS}",themeColor:h2.blocks.events.primary,inputColor:h2.blocks.events.secondary,otherColor:h2.blocks.events.tertiary,blocks:[{id:"whenstart",text:J("iotbit.blocks.whenstart","when %1 start"),inputs:{DEVICE:{type:"image",src:q}},hat:!0,mpy(t){let e=this.statementToCode(t)||this.PASS;e=this.addEventTrap(e,"start");let s="";return s+=`@_tasks__.append
`,s+=e,s},emu(t){let e=this.statementToCode(t);return e=this.addEventTrap(e,t.id),e=e.replace(`(done) => {
`,`(done) => {
`),`runtime.when('start', ${e});
`}},"---",{id:"whenkeypressed",text:he.Msg.EVENT_WHENKEYPRESSED,hat:!0,inputs:{KEY_OPTION:{type:"string",defaultValue:"a",menu:[["A","a"],["B","b"],["A+B","ab"]]}},mpy(t){let e=t.getFieldValue("KEY_OPTION"),s=this.createName("event_flag");this.definitions_[s]=`${s} = asyncio.ThreadSafeFlag()`;let o=this.statementToCode(t)||this.PASS,i="";return i+=`while True:
`,i+=`  await ${s}.wait()
`,i+=o,o=this.prefixLines(i,this.INDENT),o=this.addEventTrap(o,"button_pressed"),i=`@_tasks__.append
`,i+=o,i+=`button_${e}.on_pressed(lambda _: ${s}.set())
`,i},emu(t){let e=t.getFieldValue("KEY_OPTION"),s=this.statementToCode(t);return s=this.addEventTrap(s,t.id),`runtime.when('pressed:${e}', ${s});
`}},{id:"whenpintouched",text:J("iotbit.blocks.pinTouched","when %1 touched"),hat:!0,inputs:{PIN_OPTION:{type:"string",defaultValue:"P0",menu:["P0","P1","P2"]}},mpy(t){let e=t.getFieldValue("PIN_OPTION"),s=this.createName("event_flag");this.definitions_.import_pin="from machine import Pin",this.definitions_[e]=`${e}.init(Pin.IN)`,this.definitions_[s]=`${s} = asyncio.ThreadSafeFlag()`;let o=this.statementToCode(t)||this.PASS,i="";return i+=`while True:
`,i+=`  await ${s}.wait()
`,i+=o,o=this.prefixLines(i,this.INDENT),o=this.addEventTrap(o,"pin_touched"),i=`@_tasks__.append
`,i+=o,i+=`${e}.irq(trigger=Pin.IRQ_RISING, handler=lambda _: ${s}.set())
`,i},emu(t){let e=t.getFieldValue("PIN_OPTION"),s=this.statementToCode(t);return s=this.addEventTrap(s,t.id),`runtime.when('touched:${e}', ${s});
`}},"---",{id:"timerset",text:J("esp32.blocks.timerset","trigger timer #%1 per %2 milliseconds"),substack:!0,inputs:{ID:{menu:H2},PERIOD:{type:"integer",defaultValue:500}},mpy(t){let e=this.valueToCode(t,"PERIOD",this.ORDER_NONE)||500,s=parseInt(t.getFieldValue("ID")||"1",10)-1;if(s<0)s=0;let o=`timer_${s}`,i=this.createName("event_flag");this.definitions_.import_timer="from machine import Timer",this.definitions_[o]=`${o} = Timer(${s})`,this.definitions_[i]=`${i} = asyncio.ThreadSafeFlag()`;let l=this.statementToCode(t,"SUBSTACK")||this.PASS,a="";return a+=`while True:
`,a+=`${this.INDENT}await ${i}.wait()
`,a+=l,l=this.prefixLines(a,this.INDENT),l=this.addEventTrap(l,"timer"),a=`@_tasks__.append
`,a+=l,this.definitions_[`${i}_callback`]=a,`${o}.init(mode=Timer.PERIODIC, period=${e}, callback=lambda _: ${i}.set())
`},emu(t){let e=this.valueToCode(t,"PERIOD",this.ORDER_NONE)||500,s=parseInt(t.getFieldValue("ID")||"1",10)-1;if(s<0)s=0;let o=`timer_${s}`;this.definitions_[o]=`let ${o};`;let i=this.statementToCode(t,"SUBSTACK"),l="";return l+=`${o} = setInterval(() => {
${i}}, ${e});
`,l}},{id:"timeroff",text:J("esp32.blocks.timeroff","stop timer # %1"),inputs:{ID:{menu:H2}},mpy(t){let e=parseInt(t.getFieldValue("ID")||"1",10)-1;if(e<0)e=0;return`timer_${e}.deinit()
`},emu(t){let e=parseInt(t.getFieldValue("ID")||"1",10)-1;if(e<0)e=0;return`clearInterval(timer_${e});
`}}]});import{translate as W,themeColors as f2}from"@blockcode/core";import{ScratchBlocks as V}from"@blockcode/blocks";var X2=()=>({id:"control",name:"%{BKY_CATEGORY_CONTROL}",themeColor:f2.blocks.control.primary,inputColor:f2.blocks.control.secondary,otherColor:f2.blocks.control.tertiary,blocks:[{id:"wait",text:W("esp32.blocks.wait","wait %1 milliseconds"),inputs:{MS:{type:"integer",defaultValue:1000}},mpy(t){return`await asyncio.sleep_ms(${this.valueToCode(t,"MS",this.ORDER_NONE)})
`},emu(t){return`await runtime.sleep(${this.valueToCode(t,"MS",this.ORDER_NONE)}/1000);
`}},{id:"forever",text:V.Msg.CONTROL_FOREVER,repeat:!0,end:!0},"---",{id:"repeat",text:V.Msg.CONTROL_REPEAT,repeat:!0,inputs:{TIMES:{type:"integer",defaultValue:10}}},"---",{id:"if",text:V.Msg.CONTROL_IF,substack:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"elseif",text:W("esp32.blocks.elseif","else if %1 then"),substack:!0,inputs:{CONDITION:{type:"boolean"}},mpy(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"False",s=this.statementToCode(t,"SUBSTACK")||this.PASS,o="";return o+=`elif ${e}:
`,o+=s,o},emu(t){let e=this.valueToCode(t,"CONDITION",this.ORDER_NONE)||"false",s=this.statementToCode(t,"SUBSTACK"),o="";return o+=`else if (${e}) {
`,o+=s,o+=`}
`,o}},{id:"else",text:W("esp32.blocks.else","else"),substack:!0,mpy(t){let e=this.statementToCode(t,"SUBSTACK")||this.PASS,s="";return s+=`else:
`,s+=e,s},emu(t){let e=this.statementToCode(t,"SUBSTACK"),s="";return s+=`else {
`,s+=e,s+=`}
`,s}},"---",{id:"repeat_until",text:V.Msg.CONTROL_REPEATUNTIL,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"while",text:V.Msg.CONTROL_WHILE,repeat:!0,inputs:{CONDITION:{type:"boolean"}}},{id:"continue",text:W("esp32.blocks.continue","continue"),end:!0,mpy(t){return`continue
`},emu(t){return`continue;
`}},{id:"break",text:W("esp32.blocks.break","break"),end:!0,mpy(t){return`break
`},emu(t){return`break;
`}}]});import{translate as h,themeColors as bs}from"@blockcode/core";var z2=`
async def espnow_asend(msg, mac="ff:ff:ff:ff:ff:ff"):
  mac_addr = mac
  if isinstance(mac, str):
    mac_addr = bytes.fromhex(mac.replace(" ", "").replace(":", "").replace(",", ""))
  msg_data = msg if isinstance(msg, bytes) else str(msg).encode()
  max_size = min(250, len(msg_data))
  msg_data = msg_data[:max_size]
  try:
    await espnow.asend(mac_addr, msg_data)
  except OSError as err:
    if len(err.args) > 1 and err.args[1] == "ESP_ERR_ESPNOW_NOT_FOUND":
      espnow.add_peer(mac_addr)
      await espnow.asend(mac_addr, msg_data)
`,q2=()=>({id:"network",name:h("esp32.blocks.network","Network"),themeColor:"#28A0DC",inputColor:"#42A8DB",otherColor:"#1386BF",order:5,blocks:[{id:"ifconfig",text:h("esp32.blocks.networkCofing","local %1"),output:"string",inputs:{TYPE:{menu:[[h("esp32.blocks.networkCofingIp","ip"),"IP"],[h("esp32.blocks.networkCofingMac","mac address"),"MAC"]]}},mpy(t){let e=t.getFieldValue("TYPE")||"IP";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let s="";if(e==="IP")s="wlan.ifconfig()[0]";else if(e==="MAC")s='":".join(["%02x" % b for b in wlan.config("mac")])';return[s,this.ORDER_FUNCTION_CALL]}},{id:"isconnected",text:h("esp32.blocks.isWifiConnected","wifi is connected?"),output:"boolean",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",["wlan.isconnected()",this.ORDER_FUNCTION_CALL]}},"---",{id:"connectwifi",text:h("esp32.blocks.connectWifi","connect wifi ssid: %1 password: %2"),inputs:{SSID:{type:"string",defaultValue:"iotbit"},PASSWORD:{type:"string",defaultValue:"12345678"}},mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let e=this.valueToCode(t,"SSID",this.ORDER_NONE),s=this.valueToCode(t,"PASSWORD",this.ORDER_NONE);e=isNaN(e)?e:this.quote_(e),s=isNaN(s)?s:this.quote_(s);let o="";return o+="if not wlan.isconnected(): threading.start_new_thread(",o+=`lambda: wlan.connect(${e}, ${s}), ())
`,o+="while wlan.active() and not wlan.isconnected(): ",o+=`await asyncio.sleep_ms(500)
`,o}},{id:"disconnect",text:h("esp32.blocks.disconnectWifi","disconnect wifi"),mpy(t){this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)";let e="";return e+=`wlan.disconnect()
`,e+=`wlan.active(False)
`,e}},"---",{id:"wifiscan",text:h("esp32.blocks.wifiScan","start scan wifi"),mpy(t){this.definitions_.import_threading="import _thread as threading",this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let e="";return e+="threading.start_new_thread(",e+=`lambda: wifi_list.extend(wlan.scan()), ())
`,e}},{id:"wificounts",text:h("esp32.blocks.wifiCounts","available wifi counts"),output:"number",mpy(t){return this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []",["len(wifi_list)",this.ORDER_FUNCTION_CALL]}},{id:"wifiitem",text:h("esp32.blocks.wifiItem","%2 of item %1 of available wifi"),output:"number",inputs:{INDEX:{type:"integer",defaultValue:1},ITEM:{menu:[[h("esp32.blocks.wifiItemSsid","ssid"),"SSID"],[h("esp32.blocks.wifiItemRssi","rssi"),"RSSI"],[h("esp32.blocks.wifiItemSecurity","security"),"SECURITY"],[h("esp32.blocks.wifiItemMac","mac address"),"MAC"]]}},mpy(t){let e=this.getAdjusted(t,"INDEX")||0,s=t.getFieldValue("ITEM")||"SSID";this.definitions_.import_network="import network",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.wifi_list="wifi_list = []";let o=`wifi_list[${e}]`;switch(s){case"MAC":o+="[1]";break;case"RSSI":o+="[3]";break;case"SECURITY":o+="[4]";break;default:o+="[0]";break}return[o,this.ORDER_ATOMIC]}},"---",{id:"startap",text:h("esp32.blocks.startap","start ap ssid: %1"),inputs:{SSID:{type:"string",defaultValue:"esp-ap"}},mpy(t){let e=this.valueToCode(t,"SSID",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.WLAN.IF_AP)";let s="";return s+=`ap.config(ssid=${e})
`,s+=`ap.active(True)
`,s}},{id:"stopap",text:h("esp32.blocks.stopap","stop ap"),mpy(t){return this.definitions_.import_network="import network",this.definitions_.ap="ap = network.WLAN(network.AP_IF)",`ap.active(False)
`}},"---",{id:"espnowsend",text:h("esp32.blocks.espnowSend","send %1 to %2 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"},MAC:{type:"string",defaultValue:"ff:ff:ff:ff:ff:ff"}},mpy(t){let e=this.valueToCode(t,"MESSAGE",this.ORDER_NONE),s=this.valueToCode(t,"MAC",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=z2,`await espnow_asend(${e}, ${s})
`}},{id:"espnowbroadcast",text:h("esp32.blocks.espnowBroadcast","broadcast %1 via esp-now"),inputs:{MESSAGE:{type:"string",defaultValue:"hello"}},mpy(t){let e=this.valueToCode(t,"MESSAGE",this.ORDER_NONE);return this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)",this.definitions_.espnow_asend=z2,`await espnow_asend(${e})
`}},{id:"espnowmsg",text:h("esp32.blocks.espnowMsg","%1 of incoming"),output:"string",inputs:{TYPE:{menu:[[h("esp32.blocks.espnowMsgText","text"),"TEXT"],[h("esp32.blocks.espnowMsgBytes","bytes"),"BYTES"],[h("esp32.blocks.espnowMsgMac","mac address"),"MAC"]]}},mpy(t){let e=t.getFieldValue("TYPE")||"TEXT";this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let s="msg";if(e==="MAC")s='peer.hex(":")';else if(e==="TEXT")s="msg.decode()";return[s,this.ORDER_FUNCTION_CALL]}},"---",{id:"espnowwhen",text:h("esp32.blocks.espnowWhen","when esp-now receive %1"),hat:!0,inputs:{MESSAGE:{type:"string",defaultValue:h("esp32.blocks.espnowMsgText","message")}},mpy(t){let e=this.valueToCode(t,"MSG",this.ORDER_NONE);this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let s=this.createName("event_flag");if(this.definitions_[s]=`${s} = asyncio.ThreadSafeFlag()`,!this.definitions_.espnow_received){let l="";l+=`@_tasks__.append
`,l+=`async def espnow_received():
`,l+=`  async for peer, msg in espnow:
`,this.definitions_.espnow_received=l}this.definitions_.espnow_received+=`    if msg.decode() == ${e}: ${s}.set()
`;let o=this.statementToCode(t)||this.PASS,i="";return i+=`while True:
`,i+=`  await ${s}.wait()
`,i+=o,o=this.prefixLines(i,this.INDENT),o=this.addEventTrap(o,"espnow_received"),i=`@_tasks__.append
`,i+=o,i}},{id:"espnowrepeat",text:h("esp32.blocks.espnowRepeat","repeat wait for esp-now incoming"),repeat:!0,end:!0,mpy(t){this.definitions_.import_network="import network",this.definitions_.import_aioespnow="from aioespnow import AIOESPNow",this.definitions_.wlan="wlan = network.WLAN(); wlan.active(True)",this.definitions_.espnow="espnow = AIOESPNow(); espnow.active(True)";let e=this.statementToCode(t,"SUBSTACK")||this.PASS;e=this.addLoopTrap(e,t.id);let s="";return s+=`async for peer, msg in espnow:
`,s+=e,s}}]});import{themeColors as g2,translate as C}from"@blockcode/core";import{ScratchBlocks as fe}from"@blockcode/blocks";var J2=()=>({id:"sensing",name:"%{BKY_CATEGORY_SENSING}",themeColor:g2.blocks.sensing.primary,inputColor:g2.blocks.sensing.secondary,otherColor:g2.blocks.sensing.tertiary,blocks:[{id:"keypressed",text:fe.Msg.SENSING_KEYPRESSED,output:"boolean",inputs:{KEY_OPTION:{menu:[["a","a"],["b","b"],["a+b","ab"]]}},mpy(t){return[`button_${t.getFieldValue("KEY_OPTION")}.is_pressed()`,this.ORDER_FUNCTION_CALL]}},"---",{id:"magneticForce",text:C("iotbit.blocks.magneticForce","magnetic force %1"),output:"number",inputs:{MAGNETIC_OPTION:{menu:"xyz"}},mpy(t){let e=t.getFieldValue("MAGNETIC_OPTION");return this.definitions_.compass_calibrate="if not compass.is_calibrated(): compass.calibrate(display)",[`compass.get_${e}()`,this.ORDER_FUNCTION_CALL]}},{id:"compassHeading",text:C("iotbit.blocks.compassHeading","compass heading"),output:"number",mpy(t){return this.definitions_.compass_calibrate="if not compass.is_calibrated(): compass.calibrate(display)",["compass.get_heading()",this.ORDER_FUNCTION_CALL]}},{id:"calibrateCompass",text:C("iotbit.blocks.calibrateCompass","calibrate compass"),mpy(t){return`compass.calibrate(display)
`}},"---",{id:"acceleration",text:C("iotbit.blocks.acceleration","acceleration %1"),output:"number",inputs:{XYZ_OPTION:{menu:"xyz"}},mpy(t){return[`accelerometer.get_${t.getFieldValue("XYZ_OPTION")}()`,this.ORDER_FUNCTION_CALL]}},{id:"accelerometerRange",text:C("iotbit.blocks.accelerometerRange","set accelerometer range %1"),inputs:{RANGE_OPTION:{menu:[["2g","0"],["4g","1"],["8g","2"]]}},mpy(t){return`accelerometer.set_range(${t.getFieldValue("RANGE_OPTION")})
`}},"---",{id:"rotation",text:C("iotbit.blocks.rotation","rotation %1"),output:"number",inputs:{ROTATE_OPTION:{menu:[[C("iotbit.blocks.rotationPitch","pitch"),"pitch"],[C("iotbit.blocks.rotationRoll","roll"),"roll"],[C("iotbit.blocks.rotationYaw","yaw"),"yaw"]]}},mpy(t){return[`gyroscope.get_${t.getFieldValue("ROTATE_OPTION")}()`,this.ORDER_FUNCTION_CALL]}},"---",{id:"brightness",text:C("iotbit.blocks.brightness","brightness"),output:"number",mpy(t){return["light.get_brightness()",this.ORDER_FUNCTION_CALL]}},{id:"loudness",text:C("iotbit.blocks.loudness","loudness"),output:"number",mpy(t){return["microphone.get_loudness()",this.ORDER_FUNCTION_CALL]}},{id:"temperature",text:C("esp32.blocks.temperature","temperature"),output:"number",mpy(t){return this.definitions_.import_esp32="import esp32",["round((esp32.raw_temperature() - 32) * 5 / 9, 3)",this.ORDER_FUNCTION_CALL]}},"---",{id:"runtime",text:C("esp32.blocks.runtime","run time %1"),output:"number",inputs:{UNIT:{menu:[[C("esp32.blocks.runtimeMilliseconds","milliseconds"),"MS"],[C("esp32.blocks.runtimeSeconds","seconds"),"SEC"]]}},mpy(t){let e=t.getFieldValue("UNIT"),s="time.ticks_diff(time.ticks_ms(), _times__)";if(e==="SEC")s=`(${s} / 1000)`;return[s,this.ORDER_ATOMIC]}}],menus:{xyz:{items:[["x","x"],["y","y"],["z","z"],[C("iotbit.blocks.strength","strength"),"strength"]]}}});import{translate as E,themeColors as C2}from"@blockcode/core";import{ScratchBlocks as g}from"@blockcode/blocks";var ge=`
def to_bytes(val):
  if isinstance(val, int):
    if val <= 0:
        return bytes(b"\\x00")
    size = 0
    temp = val
    while temp > 0:
      size += 1
      temp >>= 8
    return val.to_bytes(size, "big")
  if isinstance(val, str):
    val = val.replace(" ", "").replace(":", "").replace(",", "")
    return bytes.fromhex(val)
  return bytes(b"")
`,K2=()=>({id:"operator",name:"%{BKY_CATEGORY_OPERATORS}",themeColor:C2.blocks.operators.primary,inputColor:C2.blocks.operators.secondary,otherColor:C2.blocks.operators.tertiary,blocks:[{id:"calculate",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[["+","+"],["-","-"],["×","*"],["÷","/"]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"+",i={"+":this.ORDER_ADDITION,"-":this.ORDER_SUBTRACTION,"*":this.ORDER_MULTIPLICATION,"/":this.ORDER_DIVISION};return[`(${e} ${o} ${s})`,i[o]]}},"---",{id:"random",text:g.Msg.OPERATORS_RANDOM,output:"number",inputs:{FROM:{type:"integer",defaultValue:1},TO:{type:"integer",defaultValue:10}},mpy(t){this.definitions_.import_random="import random";let e=this.valueToCode(t,"FROM",this.ORDER_NONE),s=this.valueToCode(t,"TO",this.ORDER_NONE);return[`random.randint(${e}, ${s})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"compare",text:"%1 %2 %3",output:"boolean",inputs:{NUM1:{type:"number",defaultValue:0},SYMBOL:{menu:[[">",">"],["<","<"],["=","=="],["≥",">="],["≤","<="],["≠","!="]]},NUM2:{type:"number",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||">",i={">":this.ORDER_RELATIONAL,"<":this.ORDER_RELATIONAL,"==":this.ORDER_EQUALITY,">=":this.ORDER_RELATIONAL,"<=":this.ORDER_RELATIONAL,"!=":this.ORDER_EQUALITY};return[`(${e} ${o} ${s})`,i[o]]}},"---",{id:"and",text:g.Msg.OPERATORS_AND,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let e=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${e} and ${s})`,this.ORDER_LOGICAL_AND]}},{id:"or",text:g.Msg.OPERATORS_OR,output:"boolean",inputs:{OPERAND1:{type:"boolean"},OPERAND2:{type:"boolean"}},mpy(t){let e=this.valueToCode(t,"OPERAND1",this.ORDER_NONE),s=this.valueToCode(t,"OPERAND2",this.ORDER_NONE);return[`(${e} or ${s})`,this.ORDER_LOGICAL_OR]}},{id:"not",text:g.Msg.OPERATORS_NOT,output:"boolean",inputs:{OPERAND:{type:"boolean"}},mpy(t){return[`(not ${this.valueToCode(t,"OPERAND",this.ORDER_NONE)||"True"})`,this.ORDER_LOGICAL_NOT]}},"---",{id:"bitwise",text:"%1 %2 %3",output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},SYMBOL:{menu:[["&","&"],["|","|"],["^","^"],["<<","<<"],[">>",">>"]]},NUM2:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE),o=t.getFieldValue("SYMBOL")||"&",i={"&":this.ORDER_BITWISE_AND,"|":this.ORDER_BITWISE_OR,"^":this.ORDER_BITWISE_XOR,"<<":this.ORDER_BITWISE_SHIFT,">>":this.ORDER_BITWISE_SHIFT};return[`(${e} ${o} ${s})`,i[o]]}},{id:"bitwise_not",text:"~ %1",output:"number",inputs:{NUM:{type:"integer",defaultValue:0}},mpy(t){return[`(~${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_BITWISE_NOT]}},"---",{id:"larger",text:E("esp32.blocks.operatorLarger","larger of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`max(${e}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"smaller",text:E("esp32.blocks.operatorSmaller","smaller of %1 and %2"),output:"number",inputs:{NUM1:{type:"number",defaultValue:0},NUM2:{type:"number",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`min(${e}, ${s})`,this.ORDER_FUNCTION_CALL]}},{id:"mod",text:g.Msg.OPERATORS_MOD,output:"number",inputs:{NUM1:{type:"integer",defaultValue:0},NUM2:{type:"integer",defaultValue:0}},mpy(t){let e=this.valueToCode(t,"NUM1",this.ORDER_NONE),s=this.valueToCode(t,"NUM2",this.ORDER_NONE);return[`(${e} % ${s})`,this.ORDER_MODULUS]}},{id:"round",text:g.Msg.OPERATORS_ROUND,output:"number",inputs:{NUM:{type:"number",defaultValue:0}},mpy(t){return this.definitions_.import_math="import math",[`round(${this.valueToCode(t,"NUM",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"mathop",text:g.Msg.MATHOP,output:"number",inputs:{OPERATOR:{menu:[[g.Msg.OPERATORS_MATHOP_ABS,"math.fabs"],[g.Msg.OPERATORS_MATHOP_FLOOR,"math.floor"],[g.Msg.OPERATORS_MATHOP_CEILING,"math.ceil"],[g.Msg.OPERATORS_MATHOP_SQRT,"math.sqrt"],[g.Msg.OPERATORS_MATHOP_SIN,"math.sin"],[g.Msg.OPERATORS_MATHOP_COS,"math.cos"],[g.Msg.OPERATORS_MATHOP_TAN,"math.tan"],[g.Msg.OPERATORS_MATHOP_ASIN,"math.asin"],[g.Msg.OPERATORS_MATHOP_ACOS,"math.acos"],[g.Msg.OPERATORS_MATHOP_ATAN,"math.atan"],[g.Msg.OPERATORS_MATHOP_LN,"math.log"],[g.Msg.OPERATORS_MATHOP_LOG,"math.log10"],[g.Msg.OPERATORS_MATHOP_EEXP,"math.exp"],[g.Msg.OPERATORS_MATHOP_10EXP,"pow10"]]},NUM:{type:"integer",defaultValue:0}},mpy(t){this.definitions_.import_math="import math";let e=t.getFieldValue("OPERATOR")||"abs",s=this.valueToCode(t,"NUM",this.ORDER_NONE),o="";if(e==="pow10")o+=`math.pow(10, ${s})`;else o+=`${e}(${s})`;return[o,this.ORDER_FUNCTION_CALL]}},{id:"constrain",text:E("esp32.blocks.dataConstrain","constrain %1 between %2 to %3"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROM:{type:"integer",defaultValue:0},TO:{type:"integer",defaultValue:255}},mpy(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),s=this.valueToCode(t,"FROM",this.ORDER_NONE),o=this.valueToCode(t,"TO",this.ORDER_NONE);return[`min(max(${e}, ${s}), ${o})`,this.ORDER_FUNCTION_CALL]}},{id:"map",text:E("esp32.blocks.dataMap","map %1 from %2 - %3 to %4 - %5"),output:"number",inputs:{DATA:{type:"integer",defaultValue:0},FROMLOW:{type:"integer",defaultValue:0},FROMHIGH:{type:"integer",defaultValue:1023},TOLOW:{type:"integer",defaultValue:0},TOHIGHT:{type:"integer",defaultValue:255}},mpy(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),s=this.valueToCode(t,"FROMLOW",this.ORDER_NONE),o=this.valueToCode(t,"FROMHIGH",this.ORDER_NONE),i=this.valueToCode(t,"TOLOW",this.ORDER_NONE),l=this.valueToCode(t,"TOHIGHT",this.ORDER_NONE);return[`(${e} - ${s}) * (${l} - ${i}) // (${o} - ${s}) + ${i}`,this.ORDER_FUNCTION_CALL]}},"---",{id:"sizeof",text:E("esp32.blocks.dataLengthOf","length of %1"),output:"number",inputs:{DATA:{type:"string",defaultValue:"esp32"}},mpy(t){return[`len(${this.valueToCode(t,"DATA",this.ORDER_NONE)})`,this.ORDER_FUNCTION_CALL]}},"---",{id:"convert",text:E("esp32.blocks.dataConvert","convert %1 to %2"),output:!0,inputs:{DATA:{type:"string",defaultValue:"3.1415"},TYPE:{menu:[[E("esp32.blocks.dataConvert.int","int"),"int"],[E("esp32.blocks.dataConvert.float","float"),"float"],[E("esp32.blocks.dataConvert.string","str"),"str"],[E("esp32.blocks.dataConvert.list","list"),"list"],[E("esp32.blocks.dataConvert.bytes","bytes"),"to_bytes"]]}},mpy(t){let e=this.valueToCode(t,"DATA",this.ORDER_NONE),s=t.getFieldValue("TYPE")||"int";if(s==="to_bytes")this.definitions_.to_bytes=ge;return[`${s}(${e})`,this.ORDER_FUNCTION_CALL]}}]});var Q2=()=>({id:"data",skipXML:!0,blocks:[{id:"variable",mpy(t){return[this.getVariableName(t.getFieldValue("VARIABLE")),this.ORDER_ATOMIC]}},{id:"setvariableto",mpy(t){let e=this.getVariableName(t.getFieldValue("VARIABLE")),s=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${e} = ${s}
`}},{id:"changevariableby",mpy(t){let e=this.getVariableName(t.getFieldValue("VARIABLE")),s=this.valueToCode(t,"VALUE",this.ORDER_NONE);return`${e} += ${s}
`}},{id:"listcontents",mpy(t){return[this.getVariableName(t.getFieldValue("LIST"))+"_ls",this.ORDER_ATOMIC]}},{id:"addtolist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.valueToCode(t,"ITEM",this.ORDER_NONE);return`${e}.append(${s})
`}},{id:"deleteoflist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(t,"INDEX");return`${e}.pop(${s})
`}},{id:"deletealloflist",mpy(t){return`${this.getVariableName(t.getFieldValue("LIST"))+"_ls"} = []
`}},{id:"insertatlist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(t,"INDEX"),o=this.valueToCode(t,"ITEM",this.ORDER_NONE);return`${e}.insert(${s}, ${o})
`}},{id:"replaceitemoflist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.valueToCode(t,"ITEM",this.ORDER_NONE),o=this.getAdjusted(t,"INDEX");return`${e}[${o}] = ${s}
`}},{id:"itemoflist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.getAdjusted(t,"INDEX");return[`${e}[${s}]`,this.ORDER_MEMBER]}},{id:"itemnumoflist",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.valueToCode(t,"ITEM",this.ORDER_NONE);return[`${e}.index(${s})`,this.ORDER_FUNCTION_CALL]}},{id:"lengthoflist",mpy(t){return[`len(${this.getVariableName(t.getFieldValue("LIST"))+"_ls"})`,this.ORDER_FUNCTION_CALL]}},{id:"listcontainsitem",mpy(t){let e=this.getVariableName(t.getFieldValue("LIST"))+"_ls",s=this.valueToCode(t,"ITEM",this.ORDER_NONE);return[`(${e}.count(${s}) > 0)`,this.ORDER_FUNCTION_CALL]}}]});var j2=()=>({id:"procedures",skipXML:!0,blocks:[{id:"definition",mpy(t){let e=t.childBlocks_[0],s=this.getFunctionName(e.getProcCode()),o=this.statementToCode(t)||this.PASS,i=e.childBlocks_.map((a)=>`${this.getVariableName(a.getFieldValue("VALUE"))}`),l="";l+=`async def ${s}(${i.join(", ")}):
`,l+=o,this.definitions_[s]=l}},{id:"call",mpy(t){let e=this.getFunctionName(t.getProcCode()),s=t.argumentIds_.map((i)=>this.valueToCode(t,i,this.ORDER_NONE)||"False"),o=`await ${e}(${s.join(", ")})`;if(t.return_)return[o,this.ORDER_FUNCTION_CALL];return o+`
`}},{id:"return",mpy(t){return`return ${this.valueToCode(t,"VALUE",this.ORDER_NONE)}
`}}]});import{translate as tt,themeColors as m2}from"@blockcode/core";var et=()=>({id:"terminal",name:tt("esp32.blocks.terminal","Terminal"),themeColor:m2.blocks.debug.primary,inputColor:m2.blocks.debug.secondary,otherColor:m2.blocks.debug.tertiary,order:9,blocks:[{id:"print",text:tt("esp32.blocks.terminalPrint","print %1"),inputs:{STRING:{type:"string",defaultValue:"hello"}},mpy(t){return`print(str(${this.valueToCode(t,"STRING",this.ORDER_NONE)}))
`},emu(t){return`console.log(${this.valueToCode(t,"STRING",this.ORDER_NONE)})
`}}]});import{translate as R,themeColors as k2}from"@blockcode/core";import{ScratchBlocks as L2}from"@blockcode/blocks";var st=()=>({id:"text",name:R("esp32.blocks.text","Text"),themeColor:k2.blocks.text.primary,inputColor:k2.blocks.text.secondary,otherColor:k2.blocks.text.tertiary,order:8,blocks:[{id:"join",text:L2.Msg.OPERATORS_JOIN,output:"string",inputs:{STRING1:{type:"string",defaultValue:"hello"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),s=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`(${e} + ${s})`,this.ORDER_ADDITION]}},{id:"letter_of",text:L2.Msg.OPERATORS_LETTEROF,output:"string",inputs:{LETTER:{type:"integer",defaultValue:1},STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){let e=this.getAdjusted(t,"LETTER");return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${e}]`,this.ORDER_FUNCTION_CALL]}},{id:"replace",text:R("esp32.blocks.textReplace","replace %1 of %2 with %3"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"iotbit"},STRING3:{type:"string",defaultValue:"The E"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),s=this.valueToCode(t,"STRING2",this.ORDER_NONE),o=this.valueToCode(t,"STRING3",this.ORDER_NONE);return[`${s}.replace(${e}, ${o})
`,this.ORDER_FUNCTION_CALL]}},{id:"substring",text:R("esp32.blocks.textSubstring","substring of %1 from %2 to %3"),output:"string",inputs:{STRING:{type:"string",defaultValue:"iotbit"},FROM:{type:"integer",defaultValue:5},TO:{type:"integer",defaultValue:7}},mpy(t){let e=this.getAdjusted(t,"FROM"),s=this.valueToCode(t,"TO",this.ORDER_NONE);return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}[${e}:${s}]`,this.ORDER_FUNCTION_CALL]}},{id:"find",text:R("esp32.blocks.textFind","find %1 of %2 place"),output:"string",inputs:{STRING1:{type:"string",defaultValue:"e"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)}.find(${e}) + 1)
`,this.ORDER_FUNCTION_CALL]}},"---",{id:"contains",text:L2.Msg.OPERATORS_CONTAINS,output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},STRING2:{type:"string",defaultValue:"e"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE);return[`(${this.valueToCode(t,"STRING2",this.ORDER_NONE)} in ${e})`,this.ORDER_EQUALITY]}},{id:"with",text:R("esp32.blocks.textWith","%1 %2 with %3 ?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},WITH:{type:"string",menu:[[R("esp32.blocks.textStartsWith","starts"),"START"],[R("esp32.blocks.textEndsWith","ends"),"END"]]},STRING2:{type:"string",defaultValue:"a"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),s=this.valueToCode(t,"STRING2",this.ORDER_NONE),i=(t.getFieldValue("WITH")||"START")==="START"?"startswith":"endswith";return[`${e}.${i}(${s})`,this.ORDER_FUNCTION_CALL]}},{id:"equals",text:R("esp32.blocks.textEquals","%1 equals %2 (not case-sensitive)?"),output:"boolean",inputs:{STRING1:{type:"string",defaultValue:"iotbit"},STRING2:{type:"string",defaultValue:"iotbit"}},mpy(t){let e=this.valueToCode(t,"STRING1",this.ORDER_NONE),s=this.valueToCode(t,"STRING2",this.ORDER_NONE);return[`${e}.lower() == ${s}.lower()`,this.ORDER_EQUALITY]}},"---",{id:"case",text:R("esp32.blocks.textCase","get %1 case of %2"),output:"stirng",inputs:{WITH:{menu:[[R("esp32.blocks.textLowerCase","lower"),"LOWER"],[R("esp32.blocks.textUpperCase","upper"),"UPPER"]]},STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){let e=t.getFieldValue("WITH")||"LOWER";return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.${e==="LOWER"?"lower":"upper"}()
`,this.ORDER_FUNCTION_CALL]}},{id:"trim",text:R("esp32.blocks.textTrim","remove %1 leading and trailing whitespace"),output:"string",inputs:{STRING:{type:"string",defaultValue:"iotbit"}},mpy(t){return[`${this.valueToCode(t,"STRING",this.ORDER_NONE)}.strip()
`,this.ORDER_FUNCTION_CALL]}}]});import{MicroPythonGenerator as Ce,EmulatorGenerator as me}from"@blockcode/blocks";var ke=`# Generate by BlockCode
`;class K extends Ce{finish(t){return ke+`from iotbit import *
`+super.finish(t)}}class Q extends me{}function ot(){let t=F2(),e=G2(),s=U2(),o=Y2(),i=X2(),l=q2(),a=J2(),r=K2(),u=st(),p=et(),n=Q2(),m=j2();return[t,e,s,o,i,l,a,r,u,p,n,m]}import{Text as _}from"@blockcode/core";import{jsx as M}from"preact/jsx-runtime";var it=[{tag:"controller",label:M(_,{id:"esp32.extension.tags.controllers",defaultMessage:"Controllers"})},{tag:"sensor",label:M(_,{id:"esp32.extension.tags.sensors",defaultMessage:"Sensors"})},{tag:"actuator",label:M(_,{id:"esp32.extension.tags.actuators",defaultMessage:"Actuators"})},{tag:"display",label:M(_,{id:"esp32.extension.tags.displays",defaultMessage:"Displays"})},{tag:"module",label:M(_,{id:"esp32.extension.tags.modules",defaultMessage:"Modules"})},{tag:"communication",label:M(_,{id:"esp32.extension.tags.communication",defaultMessage:"Communication"})},{tag:"data",label:M(_,{id:"esp32.extension.tags.data",defaultMessage:"Data"})},{tag:"kit",label:M(_,{id:"esp32.extension.tags.kits",defaultMessage:"Kits"})}];import{jsx as xe}from"preact/jsx-runtime";var Te=(t)=>t.replaceAll(/[^a-z0-9]/gi,"_").replace(/^_/,""),R2=new K,lt=new Q,Ne=()=>[["device","!scratch"],"data"];function nt(){let{tabIndex:t}=ye(),{meta:e}=Oe();Re(()=>{if(!e.value.boardPins)Ee("boardPins",d2())},[]);let s=Le((o,i,l,a)=>{if(o===R2.name_){we.prototype.onDefinitions.call(R2);for(let r in l)for(let u of l[r])if(!u.common){let p=r2(u.name,p2(u.name));i(`import_${r}_${p}`,`from ${Te(r)} import ${p}`)}return}if(o===lt.name_);},[]);return xe(ve,{enableProcedureExecute:!0,enableProcedureReturns:!0,disableSensingBlocks:!0,disableGenerateCode:t.value!==0,extensionTags:it,generator:R2,emulator:lt,onBuildinExtensions:ot,onDefinitions:s,onExtensionsFilter:Ne})}import{useCallback as De}from"preact/hooks";import{useComputed as pt}from"@preact/signals";import{nanoid as Ie}from"@blockcode/utils";import{useAppContext as Ae,useProjectContext as Pe,setAppState as ct,Text as $e}from"@blockcode/core";import{setAlert as E2,delAlert as _e,translate as y2,logger as O2}from"@blockcode/core";import{MPYUtils as Me}from"@blockcode/board";var at=(t,e)=>{if(e<100)E2("downloading",{id:t,progress:e});else E2("downloadCompleted",{id:t}),setTimeout(()=>_e(t),1000)},j=async(t,e,s,o)=>{at(t,0),O2.log(y2("gui.logs.downloading","Downloading..."));let i=[].concat(s,o).map((l)=>({...l,filename:l.id}));try{await Me.write(e,i,at.bind(null,t)),O2.success(y2("gui.logs.downloaded","Download completed")),e.reset()}catch(l){E2("downloadError",{id:t},1000),O2.error(y2("gui.logs.downloadError","Download failed")+": "+l.message)}};var rt="./assets/icon-download-09b2xh4b.svg";import{jsx as w2,jsxs as Ze}from"preact/jsx-runtime";function dt({className:t}){let{appState:e}=Ae(),{file:s,assets:o}=Pe(),i=pt(()=>e.value?.device),l=pt(()=>e.value?.deviceAlertId),a=De(async()=>{if(!i.value)return;if(l.value)return;let r=Ie();ct("deviceAlertId",r),await j(r,i.value,s.value,o.value),ct("deviceAlertId",null)},[]);return Ze("label",{disabled:l.value||!i.value,className:t,onClick:a,children:[w2("img",{src:rt}),w2("span",{children:w2($e,{id:"gui.menubar.device.download",defaultMessage:"Download program"})})]})}import{useAppContext as Be}from"@blockcode/core";function N(t){let e=globalThis.document,s=e.createElement("style");s.appendChild(e.createTextNode(t)),e.head.append(s)}N(".LuJSkq_device-icon{width:20px;height:20px}.LuJSkq_blank-check-item>div{padding-left:calc(var(--space)/2 + 14px)}.LuJSkq_section-title{padding-left:calc(var(--space)*1.5 + 2px + 14px)}");var v={blankCheckItem:"LuJSkq_blank-check-item",sectionTitle:"LuJSkq_section-title",deviceIcon:"LuJSkq_device-icon"};import{jsx as We}from"preact/jsx-runtime";function ut(){let{appState:t}=Be();return We("img",{className:v.deviceIcon,src:q})}import{useCallback as P,useEffect as t1}from"preact/hooks";import{useComputed as Ot}from"@preact/signals";import{classNames as G,sleepMs as e1,nanoid as s1}from"@blockcode/utils";import{useAppContext as o1,useProjectContext as i1,setAlert as Y,setAppState as $,translate as s2,logger as o2}from"@blockcode/core";import{MPYUtils as Et}from"@blockcode/board";var t2=[{usbVendorId:12346},{usbVendorId:6790}];import{Text as U,MenuSection as wt,MenuItem as H}from"@blockcode/core";import{useEffect as ft,useCallback as Ve}from"preact/hooks";import{useSignal as gt}from"@preact/signals";import{nanoid as Fe,classNames as Ge,sleep as Ue,Base64Utils as He,getBinaryCache as kt,setBinaryCache as Ye}from"@blockcode/utils";import{useAppContext as Xe,setAlert as F,delAlert as ze}from"@blockcode/core";import{ESPTool as v2}from"@blockcode/board";var E3="0.2.1";var ht={download:"https://firmware.blockcode.fun/iotbit"};import{Text as Ct,MenuSection as qe,MenuItem as Je}from"@blockcode/core";import{jsx as e2}from"preact/jsx-runtime";var T=null,Ke=(t)=>{if(t<100)F("restoring",{id:T,progress:t});else F("recovering",{id:T})},mt=()=>{ze(T),T=null},Lt=(t)=>{if(t==="NotFoundError")return;F("connectionError",1000)},Rt=async(t)=>{try{return await fetch(t,{method:"GET"})}catch(e){return await Ue(1),Rt(t)}},A=async(t,e,s,o,i)=>{if(i.value)return;let l=await kt(t);if(l?.hash===s&&l?.binaryString){i.value=!0,delete A.downloading;return}if(A.downloading)return;A.downloading=!0;let r=await(await Rt(e)).arrayBuffer();delete A.downloading;let u=await crypto.subtle.digest("SHA-256",r);if(Array.from(new Uint8Array(u)).map((n)=>n.toString(16).padStart(2,"0")).join("")!==s){A(t,e,s,o,i);return}await Ye(t,{version:o,hash:s,binaryString:He.arrayBufferToBinaryString(r)}),i.value=!0},Qe=async(t,e)=>{T=Fe(),F("erasing",{id:T});try{await v2.writeFlash(t,e,!0,(s)=>Ke(s)),F("restoreCompleted",{id:T,onClose:mt})}catch(s){Lt(s.name),mt()}await v2.disconnect(t)},je=async(t)=>{if(T)return;let e;try{e=await v2.connect(t2,460800)}catch(o){Lt(o.name)}if(!e)return;let s=await kt(t);if(s)Qe(e,[{data:s.binaryString,address:4096}])};function yt({disabled:t,itemClassName:e}){let{appState:s}=Xe(),o=gt(!1),i=gt(null);return ft(()=>T=null,[]),ft(async()=>{o.value=!1;let l=ht.download;if(!i.value)i.value=await fetch(`${l}/version.json`).then((u)=>u.json());let a=`${l}/${i.value.download}`.replaceAll("{version}",i.value.version),r=i.value.hash;A("iotbitFirmware",a,r,i.value.version,o)},[]),e2(qe,{children:e2(Je,{disabled:t||T||s.value?.device||!o.value,className:Ge(e,v.blankCheckItem),onClick:Ve(()=>je("iotbitFirmware"),[]),children:o.value?e2(Ct,{id:"gui.menubar.device.firmwareVersion",defaultMessage:"Restore v{version} firmware...",version:i.value.version}):e2(Ct,{id:"gui.menubar.device.caching",defaultMessage:"Caching latest firmware..."})})})}import{jsx as L,jsxs as x2,Fragment as N2}from"preact/jsx-runtime";var T2=(t,e)=>{if(t.name==="NotFoundError")return;if(t.name==="NetworkError")Y("connectionBusy",{id:e},1000);else Y("connectionError",{id:e},1000)};function vt({itemClassName:t}){let{appState:e}=o1(),{file:s,assets:o}=i1(),i=Ot(()=>e.value?.device),l=Ot(()=>e.value?.deviceAlertId),a=P(async(d)=>{if(d===i.value)return;await i.value?.disconnect(),await e1(500);let c=()=>a(d),y=(I)=>{if(I)T2(I,l.value),o2.warn(s2("gui.logs.disconnected","Device disconnected")+": "+I.message);$("device",null),$("deviceAlertId",null),d.off("connect",c),d.off("disconnect",y)};d.on("connect",c),d.on("disconnect",y),$("device",d)},[]),r=P(async()=>{if(l.value)return;try{let d=await Et.connect(t2,{baudRate:115200});a(d),Y("connected",1000),o2.success(s2("gui.logs.connectedType","Device connected with {type}",{type:"USB"}))}catch(d){T2(d,l.value)}},[]),u=P(async()=>{if(l.value)return;try{let d=await Et.connectBLE();a(d),Y("connected",1000),o2.success(s2("gui.logs.connectedType","Device connected with {type}",{type:"BLE"}))}catch(d){T2(d,l.value)}},[]),p=P(async()=>{if(!i.value)return;if(l.value)return;let d=s1();$("deviceAlertId",d),await j(d,i.value,s.value,o.value),$("deviceAlertId",null)},[]),n=P(()=>{if(l.value)return;i.value?.disconnect(),o2.warn(s2("gui.logs.disconnected","Device disconnected"))},[]),m=P(()=>{if(l.value)return;i.value?.reset(),Y("reseting",1000)},[]);return t1(()=>{if(l.value&&!i.value)$("deviceAlertId",null)},[i.value]),x2(N2,{children:[L(wt,{disabled:l.value||!i.value,children:L(H,{className:G(t,v.blankCheckItem),label:L(U,{id:"gui.menubar.device.download",defaultMessage:"Download program"}),onClick:p})}),L(wt,{disabled:l.value,children:i.value?x2(N2,{children:[L(H,{className:G(t,v.blankCheckItem),label:L(U,{id:"gui.menubar.device.disconnect",defaultMessage:"Disconnect device"}),onClick:n}),L(H,{className:G(t,v.blankCheckItem),label:L(U,{id:"gui.menubar.device.reset",defaultMessage:"Reset device"}),onClick:m})]}):x2(N2,{children:[L(H,{className:G(t,v.blankCheckItem),label:L(U,{id:"gui.menubar.device.connectUsb",defaultMessage:"Connect device with USB..."}),onClick:r}),L(H,{disabled:!0,className:G(t,v.blankCheckItem),label:L(U,{id:"gui.menubar.device.connectBle",defaultMessage:"Connect device with Bluetooth (BLE)..."}),onClick:u})]})}),L(yt,{disabled:l.value,itemClassName:t})]})}import{useCallback as M1,useEffect as S1}from"preact/hooks";import{useSignal as D1}from"@preact/signals";import{classNames as I1}from"@blockcode/utils";import{useAppContext as A1,setAppState as P1}from"@blockcode/core";var k={Width:360,Height:300,Small:"small",Large:"large"};import{classNames as N1}from"@blockcode/utils";import{useAppContext as x1}from"@blockcode/core";import{useCallback as C1,useEffect as M2}from"preact/hooks";import{Konva as B}from"@blockcode/utils";import{useAppContext as m1,useProjectContext as k1}from"@blockcode/core";import{Emulator as L1}from"@blockcode/blocks";import{Konva as Z}from"@blockcode/utils";import{Runtime as l1}from"@blockcode/blocks";var Tt="Verdana",Nt=128,xt=64,S=(t)=>t-64,D=(t)=>64-t;class _2 extends l1{loadImage(t){return new Promise((e,s)=>{let o=new Image;o.onload=()=>e(o),o.onerror=s,o.src=t})}setScreen(){this.paintLayer.clip({x:S(-1),y:D(xt+1),width:Nt+2,height:xt+2})}clearScreen(){this.paintLayer.destroyChildren()}setLed(t,e,s){let o=this.spritesLayer.findOne("#led-"+t);if(o)o.fill(e),o.opacity(s/10)}clearLeds(){for(let t=0;t<3;t++)this.setLed(t,"white",10)}drawText(t,e,s){this.paintLayer.add(new Z.Text({text:t,x:S(e),y:D(s),scaleY:this.stage.scaleY(),fontFamily:Tt,fontSize:12,fill:"white"}))}drawTextLine(t,e){this.paintLayer.add(new Z.Text({text:t,x:S(2),y:D(e*13),width:Nt-2,scaleY:this.stage.scaleY(),fontFamily:Tt,fontSize:12,fill:"white"}))}drawPixel(t,e){this.drawLine(t,e,t,e+1)}drawLine(t,e,s,o){this.paintLayer.add(new Z.Line({points:[S(t),D(e),S(s),D(o)],stroke:"white",strokeWidth:1}))}drawEllipse(t,e,s,o){this.paintLayer.add(new Z.Ellipse({radiusX:s,radiusY:o,x:S(t),y:D(e),scaleY:this.stage.scaleY(),stroke:"white",strokeWidth:1}))}drawRect(t,e,s,o){this.paintLayer.add(new Z.Rect({width:s,height:o,x:S(t),y:D(e),scaleY:this.stage.scaleY(),stroke:"white",strokeWidth:1}))}fillRect(t,e,s,o){this.paintLayer.add(new Z.Rect({width:s,height:o,x:S(t),y:D(e),scaleY:this.stage.scaleY(),fill:"white"}))}}var _t="./assets/iotbit-brpdwrfr.svg";var Mt="./assets/display-kqrbdvf7.svg";var St="./assets/button-sbv3mknj.svg";var Dt="./assets/button-click-bfqpcpaa.svg";var It="./assets/pin-m6ajdypb.svg";var At="./assets/pin-click-xvmsgf4q.svg";var Pt="./assets/pin-0-375ttq8p.svg";var $t="./assets/pin-0-click-k2meafnk.svg";var Zt="./assets/pin-gnd-e880nqyp.svg";var Bt="./assets/pin-gnd-click-1zt7zrmx.svg";var Wt="./assets/pin-name-6qz7s9wj.svg";import{jsx as R1}from"preact/jsx-runtime";function Vt({runtime:t,onRuntime:e}){let{splashVisible:s,appState:o}=m1(),{meta:i,file:l,modified:a}=k1();M2(async()=>{if(!t)return;if(o.value?.running===!0){let u=`((/*${l.value.name}*/) => {
${l.value.script}})();`;t.launch(`${u}

runtime.start();`)}if(o.value?.running===!1){if(t.running)t.stop(),t.clearLeds(),t.clearScreen()}},[o.value?.running]),M2(async()=>{if(!t)return;if(s.value===!0){t.stop(),t.backdropLayer.destroyChildren(),t.paintLayer.destroyChildren(),t.spritesLayer.destroyChildren(),t.boardLayer.destroyChildren();return}if(o.value?.running)return},[t,s.value,a.value,i.value]),M2(()=>{if(!t)return},[t,o.value?.running]);let r=C1(async(u)=>{let p=new _2(u);e?.(p);let n={iotbit:await p.loadImage(_t),display:await p.loadImage(Mt),button:await p.loadImage(St),buttonClick:await p.loadImage(Dt),pin:await p.loadImage(It),pinClick:await p.loadImage(At),pin0:await p.loadImage(Pt),pin0Click:await p.loadImage($t),pinGND:await p.loadImage(Zt),pinGNDClick:await p.loadImage(Bt),pinName:await p.loadImage(Wt)};return p.backdropLayer.add(new B.Image({id:"iotbit",x:0,y:0,scaleY:p.stage.scaleY(),image:n.iotbit,width:n.iotbit.width,height:n.iotbit.height,offsetX:n.iotbit.width/2,offsetY:n.iotbit.height/2})),p.boardLayer.add(new B.Image({id:"display",x:0,y:20,scaleY:p.stage.scaleY(),image:n.display,width:n.display.width,height:n.display.height,offsetX:n.display.width/2,offsetY:n.display.height/2})),p.setScreen(),[-40,0,40].forEach((m,d)=>{let c=new B.Rect({id:"led-"+d,x:m-4,y:83,scaleY:p.stage.scaleY(),width:8,height:6,fill:"white"});p.spritesLayer.add(c)}),["a","b"].forEach((m,d)=>{let c=new B.Image({id:"button-"+m,name:m,x:-105+d*210,y:7,scaleY:p.stage.scaleY(),image:n.button,width:n.button.width,height:n.button.height,offsetX:n.button.width/2,offsetY:n.button.height/2});p.spritesLayer.add(c),c.on("pointerclick",({evt:y,target:I})=>{if(y.shiftKey)p.call("pressed:a+b");else p.call(`pressed:${I.name()}`)}),c.on("pointerdown",()=>{c.setAttrs({image:n.buttonClick,width:n.buttonClick.width,height:n.buttonClick.height,offsetX:n.buttonClick.width/2,offsetY:n.buttonClick.height/2})}),c.on("pointerup",()=>{c.setAttrs({image:n.button,width:n.button.width,height:n.button.height,offsetX:n.button.width/2,offsetY:n.button.height/2})})}),["0","1","2","3v","gnd"].forEach((m,d)=>{let c=d>0&&d<4?"pin":`pin${m.toUpperCase()}`,y=new B.Image({id:"pin-"+m,name:m,x:-123+d*61.5+(d===0?6:d===4?-7:d===3?0.2:0),y:-88,scaleY:p.stage.scaleY(),image:n[c],width:n[c].width,height:n[c].height,offsetX:n[c].width/2,offsetY:n[c].height/2});if(p.spritesLayer.add(y),d<3)y.on("pointerclick",({target:I})=>{p.call(`touched:P${I.name()}`)}),y.on("pointerdown",()=>{y.setAttrs({image:n[`${c}Click`],width:n[`${c}Click`].width,height:n[`${c}Click`].height,offsetX:n[`${c}Click`].width/2,offsetY:n[`${c}Click`].height/2})}),y.on("pointerup",()=>{y.setAttrs({image:n[c],width:n[c].width,height:n[c].height,offsetX:n[c].width/2,offsetY:n[c].height/2})})}),p.boardLayer.add(new B.Image({id:"pin-name",x:4,y:-95,scaleY:p.stage.scaleY(),image:n.pinName,width:n.pinName.width,height:n.pinName.height,offsetX:n.pinName.width/2,offsetY:n.pinName.height/2})),()=>{e(null)}},[e]);return R1(L1,{id:"iotbit-emulator",zoom:o.value?.stageSize!==k.Large?0.8:1,width:k.Width,height:k.Height,onRuntime:r})}import{useCallback as S2}from"preact/hooks";import{classNames as Yt}from"@blockcode/utils";import{useAppContext as v1,translate as i2,setAppState as D2}from"@blockcode/core";import{ToggleButtons as T1}from"@blockcode/core";N(".hZ1onW_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}.hZ1onW_green-flag,.hZ1onW_stop{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}.hZ1onW_green-flag:hover,.hZ1onW_stop:hover{background:var(--theme-light-transparent)}.hZ1onW_green-flag.hZ1onW_actived{background:var(--theme-transparent)}.hZ1onW_stop{opacity:.5}.hZ1onW_stop.hZ1onW_actived{opacity:1}.hZ1onW_green-flag.hZ1onW_disabled,.hZ1onW_stop.hZ1onW_disabled{opacity:.5}.hZ1onW_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.hZ1onW_space{margin-left:.2rem}.hZ1onW_toolbar-buttons-group{display:flex}.hZ1onW_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.hZ1onW_group-button{border-left:none;border-radius:0}.hZ1onW_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.hZ1onW_group-button-toggled-off{filter:saturate(0)}");var x={groupButtonToggledOff:"hZ1onW_group-button-toggled-off",stop:"hZ1onW_stop",groupButtonFirst:"hZ1onW_group-button-first",greenFlag:"hZ1onW_green-flag",groupButton:"hZ1onW_group-button",groupButtonLast:"hZ1onW_group-button-last",toolbarWrapper:"hZ1onW_toolbar-wrapper",disabled:"hZ1onW_disabled",space:"hZ1onW_space",toolbarButtonsGroup:"hZ1onW_toolbar-buttons-group",actived:"hZ1onW_actived",toolbarButton:"hZ1onW_toolbar-button"};var Ft="./assets/icon-green-flag-tz1g77je.svg";var Gt="./assets/icon-stop-all-zrx3gxr1.svg";var Ut="./assets/icon-small-stage-anyzs7w9.svg";var Ht="./assets/icon-large-stage-f6hyxzdr.svg";import{jsx as l2,jsxs as Xt}from"preact/jsx-runtime";function zt(){let{appState:t,tabIndex:e}=v1(),s=S2(()=>{if(e.value!==0)return;D2({running:!0})},[]),o=S2(()=>{D2({running:!1})},[]),i=S2((l)=>{D2({stageSize:l})},[]);return Xt("div",{className:x.toolbarWrapper,children:[Xt("div",{className:x.toolbarButtonsGroup,children:[l2("img",{className:Yt(x.greenFlag,{[x.actived]:t.value?.running,[x.disabled]:e.value!==0}),src:Ft,title:i2("iotbit.emu.greenFlag","Go"),onClick:s}),l2("img",{className:Yt(x.stop,{[x.actived]:t.value?.running}),src:Gt,title:i2("iotbit.emu.stop","Stop"),onClick:o})]}),l2("div",{className:x.toolbarButtonsGroup,children:l2(T1,{items:[{icon:Ut,title:i2("iotbit.emu.smallStage","Switch to small stage"),value:k.Small},{icon:Ht,title:i2("iotbit.emu.largeStage","Switch to large stage"),value:k.Large}],value:t.value?.stageSize??k.Small,onChange:i})})]})}N(".K-thSq_stage-wrapper{position:relative}.K-thSq_stage{z-index:10;width:362px;height:302px;position:relative;overflow:hidden}.K-thSq_small-stage{width:290px;height:242px}");var n2={smallStage:"K-thSq_small-stage",stage:"K-thSq_stage",stageWrapper:"K-thSq_stage-wrapper"};import{jsx as I2,jsxs as _1}from"preact/jsx-runtime";function qt({runtime:t,onRuntime:e}){let{appState:s}=x1();return _1("div",{className:n2.stageWrapper,children:[I2(zt,{}),I2("div",{className:N1(n2.stage,{[n2.smallStage]:s.value?.stageSize!==k.Large}),children:I2(Vt,{runtime:t,onRuntime:e})})]})}N(".-\\33 i13a_sidedock-wrapper{flex-direction:column;height:100%;display:flex}.-\\33 i13a_stage-wrapper{display:flex}.-\\33 i13a_selector-wrapper{margin-top:var(--space);flex-direction:row;flex-grow:1;width:362px;display:flex}.-\\33 i13a_selector-wrapper.-\\33 i13a_small{width:290px}");var X={selectorWrapper:"-3i13a_selector-wrapper",stageWrapper:"-3i13a_stage-wrapper",small:"-3i13a_small",sidedockWrapper:"-3i13a_sidedock-wrapper"};import{jsx as Jt,jsxs as $1}from"preact/jsx-runtime";function Kt(){let{appState:t}=A1(),e=D1(null);return S1(()=>{P1({stageSize:window.innerWidth<1200?k.Small:k.Large})},[]),$1("div",{className:X.sidedockWrapper,children:[Jt(qt,{className:X.stageWrapper,runtime:e.value,onRuntime:M1((s)=>e.value=s,[])}),Jt("div",{className:I1(X.selectorWrapper,{[X.small]:t.value?.stageSize!==k.Large})})]})}var Qt={assets:[],files:[{id:"main",type:"text/x-python"}]};import{jsx as jt}from"preact/jsx-runtime";var Ti={onNew(){return Qt},onSave(t,e){return{files:t,assets:e}},async onThumb(){let t=z.getMainWorkspace();if(t){let e=t.getCanvas();if(e)return await Z1(e,{})}},onUndo(t){if(t instanceof MouseEvent)z.getMainWorkspace()?.undo(!1)},onRedo(t){if(t instanceof MouseEvent)z.getMainWorkspace()?.undo(!0)},onEnableUndo(){let t=z.getMainWorkspace();return t?.undoStack_&&t.undoStack_.length!==0},onEnableRedo(){let t=z.getMainWorkspace();return t?.redoStack_&&t.redoStack_.length!==0},menuItems:[{icon:jt(ut,{}),label:jt(F1,{id:"iotbit.menubar.device",defaultMessage:"iot:bit"}),Menu:vt}],barItems:[{Label:dt}],tabs:[{...B1,Content:nt},{...W1},!1,{...V1}].filter(Boolean),docks:[{expand:"right",Content:Kt}]};export{Ti as default};
